/*! Copyright (c) 2015 WhatsApp Inc.  All Rights Reserved. */
webpackJsonp([0],Array(1144).concat([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){window.history.pushState({},"",window.location.href)}function a(){if(!Store.Conn.connected)return!1;var e=n(1327),t=Store.Msg.some(function(e){return 0===e.ack&&e.local&&e.isSentByMe}),r=Store.Chat.some(function(e){return!!e.composeContents.text});return t||r||e.hasText}var o=n(146),s=r(o),c=n(2),l=r(c),u=n(105),d=r(u),p=n(6),h=n(37);_.defaults(window.Store,n(1512));var f=n(86),m=n(10),g=n(12),v=n(107),y=n(15),E=n(1383),b=n(1443),w=n(432),M=n(1527),C=n(1366),S=n(145),T=n(8),k=n(14),x=n(148),N=n(230),P=n(1526),O=n(1413),D=n(142),A=n(141),I=n(83),R=n(1533),L=n(1492),U=n(1477),F=n(0),j=n(1),B=n(223),G=n(218),z=n(85),W=n(84),H=n(69);H&&!function(){var e=n(228),t=n(227);Store.ProfilePicThumb.on("change:tag",function(n){n.tag||e.request(navigator.serviceWorker.controller,t.REMOVE_PP,n.id)["catch"](function(){})})}();var q=[[document,"mousemove"],[document,"scroll"],[document,"keydown"],[window,"focus"],[window,"blur"],[window,"resize"]],V=p.createClass({displayName:"Main",mixins:[S,A,I,D],propTypes:{launchUrl:p.PropTypes.string,onLaunchUrlHandled:p.PropTypes.func.isRequired,animate:p.PropTypes.bool},statics:{hasPending:a},getInitialState:function(){return this.onBlur=this.safeDebounce(function(){if(document.activeElement===document.body){var e=z.Manager.top;e&&e.uie.requestFocus()}},10),{drawerActive:!1}},componentWillMount:function(){v.uiActive=!0,v.markAvailable(),this.regNativeListener(window,"click",function(e){var t=e.target;if(t&&"A"===t.nodeName&&t.hasAttribute("href")){var n=B.parseInviteLink(t.getAttribute("href"));n&&(e.preventDefault(),T.openModal(p.createElement(U,{groupCode:n})))}},!0)},componentWillReceiveProps:function(e){e.launchUrl&&this.props.launchUrl!==e.launchUrl&&(this.launchInviteUrl(e.launchUrl),this.props.onLaunchUrlHandled())},componentWillUnmount:function(){this.onBlur=null,R.trigger(P.Event+":"+P.Events.LOGGED_OUT),B.canMuckHistory()&&(window.removeEventListener("popstate",i),window.history.back()),v.uiActive=!1,this.clearIdleMonitor(),this.clearServerPropsQueryLoop()},componentDidMount:function(){if(R.trigger(P.Event+":"+P.Events.LOGGED_IN),this.props.launchUrl&&(this.launchInviteUrl(this.props.launchUrl),this.props.onLaunchUrlHandled()),B.canMuckHistory()&&(window.history.pushState({},"",window.location.href),window.addEventListener("popstate",i)),this.beginIdleMonitor(!0),this.beginServerPropsQueryLoop(),this.addObserverAndRun(Store.Conn,"change:tos",this.showTOS),W.focus(h.findDOMNode(this)),f.isSafari){var e=y.getNUX(m.NUX.SAFARI_LIMITED_SUPPORT);(!e||e<e.maxViews)&&(this.safeDelay(function(){var e=l10n.t("whatsapp_safari_limited").replace("__chrome_homepage__",m.BROWSER_LINK.CHROME).replace("__firefox_homepage__",m.BROWSER_LINK.FIREFOX).replace("__opera_homepage__",m.BROWSER_LINK.OPERA);T.openModal(p.createElement(w,{onOK:T.closeModal.bind(T),okText:l10n.t("ok_got_it")},p.createElement("div",{dangerouslySetInnerHTML:{__html:e}})))},250),y.setNUX(m.NUX.SAFARI_LIMITED_SUPPORT,{views:1,maxViews:1}))}},launchInviteUrl:function(e){j.log("main:openUrl:"+e)();var t=B.parseInviteLink(e);return!!t&&(j.log("code opened!"+t)(),T.openModal(p.createElement(U,{groupCode:t})),!0)},beginIdleMonitor:function(e){var t=this;e=e?m.IDLE_TIMEOUT:0,this.idleMonitor=l["default"].loop(function(){return l["default"].delay(e).addCancelControl().then(function(){v.markUnavailable(3e4);var t=void 0,n=new l["default"](function(e){t=e});return q.forEach(function(e){var n=(0,s["default"])(e,2),r=n[0],i=n[1];r.addEventListener(i,t)}),n.addCancelControl()["finally"](function(){q.forEach(function(e){var n=(0,s["default"])(e,2),r=n[0],i=n[1];r.removeEventListener(i,t)})}).then(function(){v.markAvailable(),e=m.IDLE_TIMEOUT})})})["finally"](function(){t.idleMonitor=null})["catch"](l["default"].CancellationError,_.noop).endWithControls("cancel")},clearIdleMonitor:function(){this.idleMonitor&&this.idleMonitor.control.cancel()},beginServerPropsQueryLoop:function(){var e=this;this.serverPropsQueryLoop=x.setTimeout(function(){Store.Props.fetch()["catch"](k.WapDrop,_.noop),e.beginServerPropsQueryLoop()},F().add("1","days").valueOf())},clearServerPropsQueryLoop:function(){x.clearTimeout(this.serverPropsQueryLoop)},calculateConversationPaneScale:function(){if(!(this.refs.chatlist&&this.refs.container&&this.refs.conversation))return null;var e=h.findDOMNode(this.refs.chatlist),t=h.findDOMNode(this.refs.conversation),n=h.findDOMNode(this.refs.container);return t.clientWidth/(n.clientWidth-e.clientWidth)},onRightDrawerIn:function(){this.rightDrawerOut=!1,T.onPanesWillChange(3),this.setState({drawerActive:!0},T.onPanesDidChange.bind(T,3));var e=this.calculateConversationPaneScale();null!==e&&this.animateConversationPane(e)},onRightDrawerOut:function(){this.rightDrawerOut=!0;var e=this.calculateConversationPaneScale();null!==e&&this.animateConversationPane(e),1!==e&&(T.onPanesWillChange(2),this.setState({drawerActive:!1},T.onPanesDidChange.bind(T,2)))},onRightDrawerAnimationComplete:function(){this.state.drawerActive&&this.rightDrawerOut&&this.setState({drawerActive:!1})},animateConversationPane:function(e){Velocity(h.findDOMNode(this.refs.conversation),{scaleX:[1,e]},{duration:300,easing:[.1,.82,.25,1]})},onRotateFocus:function(e){var t=this,n=1;e&&(e.stopPropagation(),e.preventDefault(),n=e.shiftKey?-1:1,d["default"].flashFocus=Date.now());var r=_.toArray(h.findDOMNode(this).querySelectorAll("[data-tab]"));if(T.existsDrawerLeft(function(e){if(e){var n=h.findDOMNode(t.refs.chatlist);r=_.reject(r,function(e){return n.contains(e)})}}),T.existsDrawerMid(function(e){if(e){var n=h.findDOMNode(t.refs.conversation);n&&(r=_.reject(r,function(e){return n.contains(e)}))}}),r.length){r=_.sortBy(r,function(e){return parseInt(e.getAttribute("data-tab"),10)||0});var i=0,a=document.activeElement;a&&(i=N.ring(_.findIndex(r,function(e){return e.contains(a)})+n,r));var o=r[i];d["default"].flashFocus=Date.now(),o.restoreFocus?o.restoreFocus():W.focus(o)}},showTOS:function(){switch(Store.Conn.tos){case 1:case 2:T.openModal(p.createElement(L,null),void 0,void 0,!0);break;case 3:g.logout()}},render:function(){var e=this.state.drawerActive?"app three":"app two";this.props.animate||(e+=" no-animation"),f.isSafari&&(e+=" safari-fix");var t={tab:this.onRotateFocus,"shift+tab":this.onRotateFocus};return p.createElement(G,{state:G.State.INACTIVE,ref:"container",displayName:"Main"},p.createElement(d["default"],{handlers:t,className:e,onBlur:this.onBlur},p.createElement(M,null),p.createElement(C,null),p.createElement("div",{className:"drawer-manager"},p.createElement(b,{direction:b.Dir.LEFT}),p.createElement(b,{direction:b.Dir.MID}),p.createElement(b,{direction:b.Dir.RIGHT,ref:"rightDrawer",onDrawerIn:this.onRightDrawerIn,onDrawerOut:this.onRightDrawerOut,onDrawerAnimationComplete:this.onRightDrawerAnimationComplete})),p.createElement(E,{ref:"chatlist"}),p.createElement(O,{ref:"conversation",animate:this.props.animate})))}});e.exports=V},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}function a(e){return e in A}function o(e){if(!e)return null;var t=new b({from:e.from,to:e.to,id:e.id,participant:e.participant,self:e.self}),n=Store.Msg.get(t);return n||(e.id=t,n=new D(e)),n}var s=n(2),c=i(s),l=n(1273),u=r(l),d=n(10),p=n(1),h=n(87),f=n(219),m=n(55),g=n(14),v=n(24),y=n(436),E=n(88),b=n(46),w=n(1349),M=n(104),C=n(1287),S=n(56),T=n(8),k=n(1250),x=n(455),N=n(1244),P={NOTIFICATION:"notification",GROUP_NOTIFICATION:"group_notification",GP2:"gp2",BROADCAST_NOTIFICATION:"broadcast_notification",E2E_NOTIFICATION:"e2e_notification",CALL_LOG:"call_log",CHAT:"chat",LOCATION:"location",VCARD:"vcard",CIPHERTEXT:"ciphertext",MULTI_VCARD:"multi_vcard",IMAGE:"image",VIDEO:"video",AUDIO:"audio",PTT:"ptt",DOCUMENT:"document",UNKNOWN:"unknown"},O=x.Message.VideoMessage.ATTRIBUTION,D=h.extend(w,{Collection:"Msg",props:{id:"msgKey",body:"string",type:{type:"string",values:_.values(P)},subtype:"string",t:"number",notifyName:"string",from:"string",to:"string",author:"string",self:{type:"string",values:["in","out"],"default":"in"},ack:"number",invis:"boolean",isNewMsg:"boolean",star:["boolean",!0,!1],recvFresh:"boolean",caption:"string",clientUrl:"string",loc:"string",lat:"string",lng:"string",mimetype:"string",duration:"string",filehash:"string",size:"number",height:"number",width:"number",filename:"string",streamingSidecar:"array",mediaKey:"string",pageCount:"number",isGif:"boolean",gifAttribution:"number",streamable:"boolean",title:"string",description:"string",canonicalUrl:"string",matchedText:"string",thumbnail:"string",recipients:"array",broadcast:"boolean",quotedMsg:"object",quotedStanzaID:"string",quotedRemoteJid:"string",quotedParticipant:"string",mentionedJidList:"array",multicast:"boolean",urlText:"boolean",urlNumber:"boolean",vcardList:"array"},session:{promises:{type:"object","default":function(){return{}}},local:"boolean",search:"boolean",msgChunk:"object",phoneUploading:"boolean",startOfDay:"number",startOfDaySkew:"number",_quotedMsgObj:"object",isQuotedMsgAvailable:{type:"boolean","default":!0}},children:{senderObj:f,mediaData:N},initialize:function(){this.sender&&(this.senderObj=Store.Contact.gadd({id:this.sender}),this.listenTo(this.senderObj,"all",this._getCachedEventBubblingHandler("senderObj")));var e;(e=Store.Msg.preAck[this.id])&&(p.log("Msg:initialize updating msg with out of order ack",e)(),this.updateAck(e.ack),delete Store.Msg.preAck[this.id]),this.type===P.CIPHERTEXT&&this.listenToOnce(this,"change:type",this.onCiphertextDecrypted),this._mediaObject=void 0,a(this.type)&&this.initializeMedia()},derived:{chat:{fn:function(){return Store.Chat.get(this.id.remote)}},isGroupMsg:{fn:function(){return v.isGroup(this.from)||v.isGroup(this.to)}},isSentByMe:{fn:function(){var e=this.id;return"in"!==e.self&&!this.isNotification&&this.from===Store.Conn.me}},isNotification:{deps:["type"],fn:function(){switch(this.type){case P.GROUP_NOTIFICATION:case P.GP2:case P.BROADCAST_NOTIFICATION:case P.NOTIFICATION:case P.E2E_NOTIFICATION:case P.CALL_LOG:return!0;default:return!1}}},isMedia:{deps:["type"],fn:function(){return["image","video","audio"].indexOf(this.type)>-1}},isLink:{deps:["type","subtype","title","description"],fn:function(){return"chat"===this.type&&"url"===this.subtype&&(this.title||this.description)}},isDoc:{deps:["type"],fn:function(){return"document"===this.type}},isMMS:{deps:["type"],fn:function(){return a(this.type)}},eventType:{deps:["type","invis","isNewMsg"],fn:function(){var e;return this.isNewMsg?(e=this.eventTypeFromMsgType(),this.invis?"i"===e?"i":"n":e):"i"}},sender:{fn:function(){return this.isSentByMe?this.from:this.isGroupMsg?this.author:this.from}},containsEmoji:{deps:["body","caption"],fn:function(){switch(this.type){case P.CHAT:return this.body&&y.containsEmoji(this.body);case P.IMAGE:return this.caption&&y.containsEmoji(this.caption);default:return!1}}},isFailed:{deps:["isSentByMe","ack"],fn:function(){return this.isSentByMe&&this.ack<0}},vcard:{deps:["type","body"],fn:function(){if(this.type===P.VCARD)try{return k.parse(this.body)}catch(e){return}}},isUnsentMedia:{deps:["ack","isMMS","isSentByMe"],fn:function(){return this.ack<1&&this.isMMS&&this.isSentByMe}},dir:{deps:["type","body","subtype","caption"],fn:function(){switch(this.type){case P.CHAT:return C.dir(this.body);case P.VCARD:return this.subtype?C.dir(this.subtype):void 0;case P.IMAGE:return this.caption?C.dir(this.caption):void 0;default:return}}},rtl:{deps:["type","body","subtype","caption"],fn:function(){switch(this.type){case P.CHAT:return"rtl"===C.dir(this.body);case P.VCARD:return!!this.subtype&&"rtl"===C.dir(this.subtype);case P.IMAGE:return!!this.caption&&"rtl"===C.dir(this.caption);default:return!1}}},linkPreview:{deps:["matchedText","body"],fn:function(){return _.isString(this.matchedText)&&this.body.indexOf(this.matchedText)>-1}},isPersistent:{fn:function(){return this.type===P.E2E_NOTIFICATION&&"encrypt"===this.subtype}}},typeCanChange:function(){return this.type===P.CIPHERTEXT},hasSymbol:function(){return["image","video","audio","ptt","location","vcard","document","ciphertext","unknown","call_log"].indexOf(this.type)>-1},mayFail:function(){return this.isSentByMe&&this.ack<1},isUnsentPhoneMsg:function(){return!this.local&&this.isSentByMe&&this.ack<1},canReply:function(){return this.chat.canSend&&!this.mayFail()&&!this.isNotification&&this.type!==P.UNKNOWN&&this.type!==P.CIPHERTEXT&&M.supportsFeature(M.F.REPLIES_OUT)},canForward:function(){if(this.isMMS){if(this.isUnsentMedia)return!1;var e=this.mediaData;if(!u.canSendType(e.type))return!1;if(e.mediaStage===N.STAGE.ERROR_MISSING)return!1;if(e.mediaStage===N.STAGE.ERROR_UNSUPPORTED)return!1}return this.type!==P.CIPHERTEXT&&this.type!==P.UNKNOWN},isGroupLeave:function(){return"gp2"===this.type&&("leave"===this.subtype||"remove"===this.subtype)&&_.head(this.recipients)===Store.Conn.me},isTrusted:function(){return this.sender===Store.Conn.me||(!(!this.senderObj||!this.senderObj.isMyContact)||(this.isGroupMsg?this.chat.isTrusted():!!M.supportsFeature(M.F.SPAM)&&this.chat.notSpam))},getWAids:function(){return this.type!==P.VCARD?null:k.vcardWAids(this.vcard)},getVCardThumbnailWAid:function(){return this.type!==P.VCARD?null:k.thumbnailWAid(this.getWAids())},resumeRemoteUpload:function(){var e=this;return this.isUnsentPhoneMsg()&&!this.phoneUploading&&(Store.Msg.send(this).then(function(t){"success"!==t&&(e.phoneUploading=!1)}),this.phoneUploading=!0),this.downloadMedia(!0)},forceDownloadMedia:function(){return this.downloadMedia(!0)},forceRMR:function(){return c["default"].reject(new Error("unimplemented forceRMR"))},isForcingRMR:function(){return!1},cancelDownload:function(){u.cancelDownloadMsg(this)},resumeUpload:function(){p.assert(this.mediaData.mediaStage===N.STAGE.NEED_UPLOAD,"resume-non-need-upload","resumeUpload called while state was "+this.mediaData.mediaStage)(),u.resumeUploadMsg(this)},cancelUpload:function(){u.cancelUploadMsg(this)},initializeMedia:function(){u.registerMsg(this)},downloadMedia:function(){var e=this,t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];if(p.assert(this.isMMS,"media-fault","downloadMedia called on non-mms msg")(),this.isUnsentPhoneMsg()){var n=this.promises.waitForPhoneUpload;return n||(n=this.promises.waitForPhoneUpload=S.waitForBBEvent(this,"change:mediaData.mediaStage change:filehash",function(){return!!e.filehash&&!e.isUnsentPhoneMsg()}).then(function(){e.promises.waitForPhoneUpload=null})),n.then(function(){return e.downloadMedia(t)})}return u.downloadMsg(this,t)},"delete":function(){a(this.type)&&u.deregisterMsg(this),this.decryptedMediaBlob&&this.unset("decryptedMediaBlob"),E.isBlob(this.url)&&URL.revokeObjectURL(this.url),Store.AllStarredMsgs.remove(this),h.prototype["delete"].call(this),Store.Msg.remove(this.id),this.msgChunk&&this.msgChunk.remove(this.id);var e=Store.Chat.get(this.id.remote);if(e&&(e.unreadMsgAnchor===this&&(e.unreadMsgAnchor=void 0),e.lastReceivedKey===this.id)){e.lastReceivedKey=void 0;var t=e.getLastReceivedMsg();t&&(e.lastReceivedKey=t.id)}},quotedMsgObj:function(){if(!this.quotedMsg)return null;if(this._quotedMsgObj){var e=Store.Msg.get(this._quotedMsgObj.id);return e?this._quotedMsgObj=e:this._quotedMsgObj}var t=!this.quotedParticipant||this.quotedParticipant===Store.Conn.me,n=t?"out":"in",r=this.quotedRemoteJid?this.quotedRemoteJid:this.id.remote,i={id:this.quotedStanzaID,from:t?Store.Conn.me:r,to:t?r:Store.Conn.me,self:n,author:this.quotedParticipant},a=v.isGroup(i.from)||v.isGroup(i.to);return a&&Store.Conn.me!==this.quotedParticipant&&(i.participant=this.quotedParticipant),_.assign(i,this.quotedMsg),this._quotedMsgObj=o(i)},contextInfo:function(e){var t,n=_.omit(this.toJSON(),["id","t","notifyName","from","to","author","self","ack","invis","isNewMsg","star","recvFresh","recipients","broadcast","quotedMsg","quotedStanzaID","quotedRemoteJid","quotedParticipant","senderObj","multicast"]);return e&&e!==this.id.remote&&(t=this.id.remote),{quotedMsg:n,quotedParticipant:this.sender,quotedStanzaID:this.id.id,quotedRemoteJid:t}},displayName:function(e,t){if(!this.sender)return"";if(this.sender===Store.Conn.me)return l10n.t("web_you");var n=this.senderObj,r=e?n.shortName:void 0;if(r)return r;if(n.name)return n.name;var i=t&&this.notifyName?" ~"+this.notifyName:"";return l10n.isRTL()?l10n.embedLTR(v.formattedUser(this.sender))+i:v.formattedUser(this.sender)+i},isQuoted:function(e){var t=this.quotedMsgObj();return!!t&&t.sender===e},isMentioned:function(e){return _.indexOf(this.mentionedJidList,e)>-1},mentionMap:function(){if(!this.isGroupMsg||!M.supportsFeature(M.F.MENTIONS_IN))return null;if(!_.size(this.mentionedJidList))return null;var e={};return _.forEach(this.mentionedJidList,function(t){var n=v.user(t),r=void 0,i=Store.Contact.get(t);i&&(i.name?r=i.name:i.notifyName&&(r=i.notifyName)),r||t!==Store.Conn.me||(r=Store.Conn.pushname),r=r||v.formattedUser(t),e["@"+n]={jid:t,display:r}}),e},updateAck:function(e){var t=this.ack;_.isNumber(e)&&("undefined"==typeof t||e>t)?this.ack=e:e===-1&&0===this.ack&&(this.ack=-1,this.phoneUploading=!1)},sendPlayed:function(){if("ptt"===this.type&&!(this.isSentByMe||this.ack>=d.ACK_PLAYED)){var e=this;m.sendMessagePlayed(this.id).then(function(t){e.ack=d.ACK_PLAYED})["catch"](g.WapDrop,_.noop)}},avParams:function(){var e=this.mediaData;return{url:this.clientUrl,type:this.type,mimetype:this.mimetype,filehash:this.filehash,filename:this.filename,duration:this.duration,width:e.fullWidth,height:e.fullHeight}},resend:function(){return this.isFailed?(this.ack=0,this.isMMS?this.resumeRemoteUpload():Store.Msg.send(this)):c["default"].resolve()},onCiphertextDecrypted:function(){a(this.type)&&this.initializeMedia();var e=this.chat,t=e.msgs.length,n=e.msgs.indexOf(this);n!==-1&&t-n<=10&&T.alertNewMsg(this)},eventTypeFromMsgType:function(){var e,t,n=this.type,r=this.subtype;return n===P.GP2||n===P.GROUP_NOTIFICATION?"subject"===r?e="n":"add"===r||"invite"===r?(t=_.head(this.recipients),e=t===Store.Conn.me?"s":"i"):"remove"===r?(t=_.head(this.recipients),e=t===Store.Conn.me?"n":"i"):e="create"===r?"n":"i":e=n===P.BROADCAST_NOTIFICATION||n===P.NOTIFICATION||n===P.E2E_NOTIFICATION?"create"===r?"n":"i":n===P.CALL_LOG?"n":this.broadcast?"i":"d",e}}),A={image:1,video:1,audio:1,ptt:1,document:1};D.TYPE=P,D.GIF_ATTRIBUTION=O,D.newTag=b.newTag,D.typeIsMMS=a,e.exports=D},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(45),a=r(i),o=n(441),s=r(o),c=n(1136),l=r(c),u=n(1140),d=r(u),p=n(146),h=r(p),f=n(1),m=n(14),g=n(8),v=n(38),y={async:function(e,t){var n=e.split(".").slice(-1),r=(0,h["default"])(n,1),i=r[0];return this._asyncKey(i,e,t)},asyncState:function(e,t){var n=this,r=v.mapValues(e,function(e,t){return n._asyncKey(t,e)});for(var i in t)void 0===r[i]&&(r[i]=t[i]);return r},_asyncKey:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?this.props:arguments[2],r=t.split("."),i=this._getAsyncIndex(r),a=r.slice(0,i),o=(0,d["default"])(a),s=o[0],c=o.slice(1),l=r.slice(i+1),u=n[r[0]];return i&&(u=this._getObservable(e,s,c,n,r[i])),u?v.isFunction(u.on)||v.isFunction(u.off)?this._asyncObserver(e,r,c,u,l):f.trace("asyncMixin path resolved to non-observable: "+t):f.trace("asyncMixin path resolved to nonexistent state! path: "+t)},_getObservable:function(e,t,n,r,i){var a=n.length?r[t].getp(n):r[t];return a?Store[i].get(a):null},_asyncObserver:function(e,t,n,r,i){var a=this;r.stale&&this._loadStale(r);var o="change:"+i.join("."),s=function(){return a.setOrQueueState((0,l["default"])({},e,r.getp(i)))};return r.on(o,s),r.isState&&r._uiObservers++,this._asyncs=this._asyncs||{},this._asyncs[e]={key:e,splitPath:t,basePath:n,observable:r,callback:s,eventKey:o},r.getp(i)},_loadStale:function(e){var t=this;g.uiBusy?!function(){var n=t._waAsyncIdle||(t._waAsyncIdle=[]),r=function i(){e.getCollection().find(e.id)["catch"](m.WapDrop,v.noop),t._waAsyncIdle&&(v.pull(t._waAsyncIdle,i),0===t._waAsyncIdle.length&&(t._waAsyncIdle=null))};g.once("ui_idle",r),n.push(r)}():e.getCollection().find(e.id)["catch"](m.WapDrop,v.noop)},componentWillMount:function(){this.__willMount=!0,this.__stateQueue&&(this.setState(v.assign.apply(v,[{}].concat((0,s["default"])(this.__stateQueue)))),this.__stateQueue=void 0)},setOrQueueState:function(e){this.__willMount?this.setState(e):(this.__stateQueue=this.__stateQueue||[],this.__stateQueue.push(e))},_observersMatch:function(e,t,n,r){return n[e]===r[e]&&(!t.length||n[e].getp(t)===r[e].getp(t))},componentWillReceiveProps:function(e){var t=this;if(this._asyncs){var n={};v.forIn(this._asyncs,function(r,i){var a=r.splitPath,o=r.basePath,s=(0,h["default"])(a,1),c=s[0];if(!t._observersMatch(c,o,t.props,e)){var l=r.observable,u=r.callback,d=r.eventKey;l.off(d,u),l.isState&&l._uiObservers--,n[i]=t._asyncKey(i,a.join("."),e)}}),(0,a["default"])(n).length&&this.setOrQueueState(n)}},componentWillUnmount:function(){this._waAsyncUnmount=!0,this._waAsyncIdle&&v.forIn(this._waAsyncIdle,function(e){g.off("ui_idle",e)}),this._asyncs&&v.forIn(this._asyncs,function(e){var t=e.observable,n=e.callback,r=e.eventKey;t.off(r,n),t.isState&&t._uiObservers--})},_getAsyncIndex:function(e){for(var t=1;t<e.length;++t)if(e[t].charAt(0).toLowerCase()!==e[t].charAt(0))return t;return 0}};e.exports=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){switch(t){case"text":return e.type===g.TYPE.CHAT&&"url"!==e.subtype;case"image":return e.type===g.TYPE.IMAGE;case"video":return e.type===g.TYPE.VIDEO&&!e.isGif;case"gif":return e.type===g.TYPE.VIDEO&&e.isGif;case"audio":return e.type===g.TYPE.AUDIO;case"ptt":return e.type===g.TYPE.PTT;case"document":return e.type===g.TYPE.DOCUMENT;case"location":return e.type===g.TYPE.LOCATION;case"vcard":return e.type===g.TYPE.VCARD||e.type===g.TYPE.MULTI_VCARD;case"url":return e.type===g.TYPE.CHAT&&"url"===e.subtype;case void 0:return!1;default:return!1}}var a=n(1145),o=r(a),s=n(2),c=r(s),l=n(1273),u=n(457),d=r(u),p=n(6),h=n(10),f=n(1),m=n(1286),g=n(1229),v=n(1347),y=n(219),E=n(1350),b=n(1285),w=n(1267),M=n(1505),C=n(1504),S=n(1503),T=n(1351),k=n(104),x=n(8),N=n(107),P=n(55),O=n(15),D=n(143),A=n(14),I=n(46),R=n(24),L=n(448),U=n(67).ActionToast,F=n(67).ActionType,j=n(1250),B=3e5,G={GROUP:"group",BROADCAST:"broadcast",CHAT:"chat"},z=v.extend({Collection:"Chat",props:{id:"string",t:"number",unreadCount:{type:"number","default":0},archive:"boolean",isReadOnly:"boolean",modifyTag:"number",muteExpiration:{type:"number","default":0},name:"string",notSpam:"boolean"},session:{createdLocally:"boolean",pendingAction:"number",formattedTitle:"string",active:"boolean",pausedTimerId:"number",presenceResendTimerId:"number",recording:"boolean",typing:"boolean",unreadDivider:"object",colors:"object",composeContents:{type:"object","default":function(){return{}}},popupPanels:"object",popupPositionChange:"number",squelch:"number",pendingSeenCount:{type:"number","default":0},markedUnread:"boolean",trusted:"boolean",canSend:"boolean",promises:{type:"object","default":function(){return{}}},ftsCache:{type:"object","default":function(){return{}}},composeQuotedMsg:"object"},collections:{mediaMsgs:M,linkMsgs:C,docMsgs:S,starredMsg:T},children:{presence:m,contact:y,mute:E,groupMetadata:b},initialize:function(){if(v.prototype.initialize.call(this),this._addQueue=new d["default"],this._sendQueue=new d["default"],this.msgs.msgLoadState.contextLoaded=!0,this.isVisible||(this.msgs.msgLoadState.noEarlierMsgs=!0),this.presence=Store.Presence.gadd(this.id),this.listenTo(this.presence,"all",this._getCachedEventBubblingHandler("presence")),this.mute=Store.Mute.add({id:this.id,expiration:this.muteExpiration},{merge:!0}),this.listenTo(this.mute,"all",this._getCachedEventBubblingHandler("mute")),R.isPSA(this.id)&&this._updatePSAName(),this.contact=Store.Contact.gadd(this.id),this.name&&!this.contact.name&&(this.contact.name=this.name),this.listenTo(this.contact,"all",this._getCachedEventBubblingHandler("contact")),this.listenTo(this.contact,"change:formattedName",this.updateTitle),this.isGroup&&(this.trusted=!0),this.isGroup||this.isBroadcast){var e;this.isBroadcast&&!Store.GroupMetadata.get(this.id)&&(e=!0),this.groupMetadata=Store.GroupMetadata.gadd({id:this.id}),this.listenTo(this.groupMetadata,"all",this._getCachedEventBubblingHandler("groupMetadata")),this.listenTo(this.groupMetadata,"change:stale",this.updateReadOnly),this.listenTo(this.groupMetadata,"change:trusted change:stale",this.isTrusted),this.listenTo(this.groupMetadata.participants,"add remove reset",this.updateReadOnly),this.listenTo(this.groupMetadata.participants,"change:contact.formattedShortName",this.updateTitle),this.updateReadOnly();var t=this.id;this.listenTo(this,"change:isReadOnly",function(){this.isTrusted(),this.updateCanSend(),Store.ProfilePicThumb.update(t)["catch"](A.WapDrop,_.noop),Store.GroupMetadata.update(t)["catch"](A.WapDrop,_.noop)}),e&&Store.GroupMetadata.update(t)["catch"](A.WapDrop,_.noop)}else this.listenTo(this.presence,"change:isOnline",this._presenceOnlineChanged),this.listenTo(this.contact,"change:isMyContact",this.isTrusted),this.listenTo(Store.Blocklist,"add remove reset",this.updateCanSend);Store.Chat.notSpam[this.id]&&!this.notSpam&&this.sendNotSpam()["catch"](_.noop),Store.Chat.notSpam[this.id]=!!this.notSpam,this.notSpam||this.listenTo(this,"change:notSpam",this.onNotSpamChange),this.updateTitle(),this.isTrusted(),this.updateCanSend(),this.listenTo(this.msgs,"add",this.onNewMsg),this.listenTo(this.msgs,"remove",this.updateSortTime),this.listenTo(this.msgs,"bulk_add",this.addMediaMsgs),this.listenTo(this,"change:msgs",this.resetMediaMsgs),this._saveAssignedColors=_.debounce(this.saveAssignedColors,1e3),this.listenTo(this,"change:active",this.onActiveUpdate),this.pendingAction=0,this.listenTo(this,"change:pendingAction",this.onPendingActionUpdate),this.listenTo(this,"change:t change:modifyTag",this._clearFtsCache)},derived:{kind:{fn:function(){return R.isGroup(this.id)?G.GROUP:R.isBroadcast(this.id)?G.BROADCAST:R.isUser(this.id)?G.CHAT:void 0}},isGroup:{fn:function(){return R.isGroup(this.id)}},isBroadcast:{fn:function(){return R.isBroadcast(this.id)}},isUser:{fn:function(){return R.isUser(this.id)}},isPSA:{fn:function(){return R.isPSA(this.id)}},hasUnread:{deps:["unreadCount"],fn:function(){return 0!==this.unreadCount}},isVisible:{deps:["createdLocally","msgs","msgsLength"],fn:function(){return!!this._isVisibleLatched||!R.isStatusV3(this.id)&&(this._isVisibleLatched=!this.createdLocally||this.msgs.some(function(e){return e.type!==g.TYPE.E2E_NOTIFICATION}),this._isVisibleLatched)}},previewMessage:{deps:["msgs","msgsChanged"],fn:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&t.type!==g.TYPE.E2E_NOTIFICATION)return t}return this.msgs.last()}}},addAndSendMsg:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1],r=c["default"].resolve(e),i=this._addQueue.enqueue(r).then(function(e){var n=window.Store.Msg.add(e);return t.msgs.add(n),n}),a=n?i.then(n)["return"](i):i,o=this.sendMsg(a);return[i,o]},sendMsg:function(e){return this._sendQueue.enqueue(e).then(function(e){return window.Store.Msg.send(e)})},onActiveUpdate:function(){this.isGroup&&this.active&&(this.squelch=-1),this.presence.chatActive=this.active},onPendingActionUpdate:function(){this.pendingAction<0&&(f.log("chat:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)},onNotSpamChange:function(){Store.Chat.notSpam[this.id]=this.notSpam,this.isTrusted(),this.notSpam&&this.stopListening(this,"change:notSpam")},hasMaybeSentMsgToChat:function(){return _.some(this.getAllMsgs(),function(e){return e.isSentByMe})},isTrusted:function(){var e=void 0;return this.isGroup?e=k.supportsFeature(k.F.SPAM)?this.isReadOnly||this.notSpam||this.groupMetadata.isTrusted():this.groupMetadata.isTrusted():this.isBroadcast?e=!0:this.isUser&&(e=!k.supportsFeature(k.F.SPAM)||(this.notSpam||this.contact.isMyContact)),!e&&this.hasMaybeSentMsgToChat()&&(e=!0),this.trusted=e},updateTitle:function(){this.isBroadcast?this.formattedTitle=this.contact.name||this.groupMetadata.participants.map(function(e){return e.contact.formattedShortName}).join(", "):this.isUser?this.formattedTitle=this.contact.name||R.formattedUser(this.id):this.isGroup&&(this.formattedTitle=this.contact.name)},title:function(){return this.isGroup?this.formattedTitle||l10n.t("unknown_subject"):this.formattedTitle},sendExit:function(){var e=this;if(!this.isGroup)return c["default"].reject(new A.ActionError);if(this.promises.sendExit)return this.promises.sendExit;this.promises.sendExit=P.leaveGroup(this.id);var t=new F(l10n.t("action_group_exiting")),n=this.promises.sendExit.then(function(e){return 200===e.status?new F(l10n.t("action_group_exited")):e.status>=400?new F(l10n.t("action_group_exit_failed")):void 0})["catch"](function(e){return f.error("models:chat:sendExit dropped")(e),new F(l10n.t("action_group_exit_failed"),l10n.t("action_try_again"),this.sendExit.bind(this))});return x.openToast(p.createElement(U,{id:U.genId(),initialAction:t,pendingAction:n})),this.promises.sendExit.bind(this).then(function(e){200!==e.status||e._duplicate||this.exit()})["finally"](function(){e.promises.sendExit=null})},canExit:function(){return k.supportsFeature(k.F.GROUP_EXIT)},exit:function(){this.isGroup&&(this.groupMetadata.participants.remove(Store.Conn.me),this.isReadOnly=!0)},sendDelete:function(){var e=this;if(this.promises.sendDelete)return this.promises.sendDelete;var t=this.msgs.last(),n=t?t.id:void 0;this.promises.sendDelete=P.sendConversationDelete(this.id,n);var r,i=this.kind;switch(i){case G.GROUP:r=l10n.t("action_group_deleting");break;case G.BROADCAST:r=l10n.t("action_broadcast_deleting");break;case G.CHAT:r=l10n.t("action_chat_deleting")}r=new F(r);var a=this.promises.sendDelete.bind(this).then(function(e){if(200===e.status)switch(i){case G.GROUP:return new F(l10n.t("action_group_deleted"));case G.BROADCAST:return new F(l10n.t("action_broadcast_deleted"));case G.CHAT:return new F(l10n.t("action_chat_deleted"))}else if(e.status>=400)switch(i){case G.GROUP:return new F(l10n.t("action_group_delete_failed"));case G.BROADCAST:return new F(l10n.t("action_broadcast_delete_failed"));case G.CHAT:return new F(l10n.t("action_chat_delete_failed"))}})["catch"](function(e){f.error("models:chat:sendDelete dropped")(e);var t=void 0;switch(i){case G.GROUP:t=l10n.t("action_group_delete_failed");break;case G.BROADCAST:t=l10n.t("action_broadcast_delete_failed");break;case G.CHAT:t=l10n.t("action_chat_delete_failed")}return new F(t,l10n.t("action_try_again"),this.sendDelete.bind(this))});return x.openToast(p.createElement(U,{id:U.genId(),initialAction:r,pendingAction:a})),this.promises.sendDelete.bind(this).then(function(e){if(200===e.status&&!e._duplicate){var n=this.msgs.last();t===n?this["delete"](!0):this.deleteMsgsBeforeMsgInclusive(t)}})["finally"](function(){e.promises.sendDelete=null})},updateCanSend:function(){return this.isReadOnly?this.canSend=!1:this.isUser?this.canSend=!(this.contact.isBlocked()||this.isPSA):this.canSend=!0},canDelete:function(){return k.supportsFeature(k.F.DELETE)},canClear:function(){return k.supportsFeature(k.F.CHAT_CLEAR)},sendClear:function(e){var t=this;if(this.promises.sendClear)return this.promises.sendClear;var n=this.msgs.last(),r=n?n.id:void 0;this.promises.sendClear=P.sendConversationClear(this.id,r,!e);var i=new F(l10n.t("action_chat_clearing")),a=this.promises.sendClear.then(function(e){return 200===e.status?new F(l10n.t("action_chat_cleared")):e.status>=400?new F(l10n.t("action_chat_clear_failed")):void 0})["catch"](function(n){return f.error("models:chat:sendClear dropped")(n),
new F(l10n.t("action_chat_clear_failed"),l10n.t("action_try_again"),t.sendClear.bind(t,e))});return x.openToast(p.createElement(U,{id:U.genId(),initialAction:i,pendingAction:a})),this.promises.sendClear.then(function(r){200!==r.status||r._duplicate||t.deleteMsgsBeforeMsgInclusive(n,e)})["finally"](function(){t.promises.sendClear=null})},"delete":function(e){v.prototype["delete"].call(this),this.cancelPendingPromises(),this.groupMetadata["delete"](),this.presence["delete"](),Store.Mute.remove(this.id),this.mute["delete"](),this.deleteMsgs(),Store.Chat.remove(this.id),x.clearChat(this),this.mediaMsgs["delete"](),this.linkMsgs["delete"](),this.docMsgs["delete"]()},isDirty:function(){return 0!==this.unreadCount},resetMediaMsgs:function(){this.mediaMsgs["delete"](),this.mediaMsgs.queryMedia(this),this.linkMsgs["delete"](),this.linkMsgs.queryLinks(this),this.docMsgs["delete"](),this.docMsgs.queryDocs(this)},addMediaMsgs:function(e,t){var n=_.isArray(e)?e:[e],r=n.filter(function(e){return e.isMedia});r.length>0&&this.mediaMsgs.add(r,t);var i=n.filter(function(e){return e.isLink});i.length>0&&this.linkMsgs.add(i,t);var a=n.filter(function(e){return e.isDoc});a.length>0&&this.docMsgs.add(a,t)},onNewMsg:function(e){if(e&&"i"!==e.eventType&&(this.t=e.t,this.promises.updateSortTime&&this.promises.updateSortTime.cancel(),this.archive&&(this.archive=!1),e.isSentByMe||this.presence.handle({id:this.id,participant:e.author,type:"available"}),!e.isSentByMe))if("d"===e.eventType)this.unreadCount=this.unreadCount+1||1,e.type!==g.TYPE.CIPHERTEXT&&x.alertNewMsg(e),this.msgs.length<h.MSG_PRELOAD_THRESHOLD&&this.loadEarlierMsgs();else if("s"===e.eventType){if("gp2"===e.type&&"add"===e.subtype&&_.head(e.recipients)===Store.Conn.me&&!this.contact.name)return;x.alertNewMsg(e)}},setArchive:function(e,t){var n=this;if(this.archive===e)return c["default"].reject(new A.ActionError);if(this.promises.setArchive)return this.promises.setArchive;var r=this.lastReceivedKey,i=P.sendConversationArchive(this.id,e,r),a=new F(e?l10n.t("action_chat_archiving"):l10n.t("action_chat_unarchiving"));t=t||U.genId();var o=i.then(function(r){var i=void 0;return 200===r.status?(i=e?l10n.t("action_chat_archived"):l10n.t("action_chat_unarchived"),new F(i,l10n.t("action_undo"),n.setArchive.bind(n,!e,t))):r.status>=400?new F(e?l10n.t("action_chat_archive_failed"):l10n.t("action_chat_unarchive_failed")):void 0})["catch"](function(r){f.error("models:chat:setArchive dropped")(r);var i=e?l10n.t("action_chat_archive_failed"):l10n.t("action_chat_unarchive_failed");return new F(i,l10n.t("action_try_again"),n.setArchive.bind(n,e,t))});return x.openToast(p.createElement(U,{id:t,initialAction:a,pendingAction:o})),this.promises.setArchive=i.bind(this).then(function(t){200!==t.status||t._duplicate||(this.archive=e)})["finally"](function(){n.promises.setArchive=null})},canArchive:function(){return this.isBroadcast?k.supportsFeature(k.F.ARCHIVE_BROADCAST):k.supportsFeature(k.F.ARCHIVE)},sendSeen:function(){if(this.markedUnread||0===this.unreadCount)return c["default"].resolve();if(!N.available)return this.listenTo(N,"change:available",this.sendSeen),c["default"].resolve();this.stopListening(N,"change:available",this.sendSeen);var e=this.unreadCount-this.pendingSeenCount,t=this.unreadCount===-1&&e===-1;if(e<=0&&!t)return c["default"].resolve();this.disableUnreadAnchor=!0,this.pendingSeenCount=this.unreadCount;var n=this,r=function(){n.pendingSeenCount=n.pendingSeenCount-e,n.pendingSeenCount<0&&(f.error("models:chat:sendSeen unread "+n.unreadCount+" pending: "+n.pendingSeenCount+" delta: "+e)(),n.pendingSeenCount=0)},i=this.lastReceivedKey;return k.gte([0,4])?P.sendConversationSeen(this.id,i,e).bind(this).then(function(t){return r(),200!==t.status||t._duplicate||this.markSeen(e),t})["catch"](A.WapDrop,function(e){r(),f.error("models:chat:sendConversationSeen dropped")()}):(r(),this.markSeen(e),P.sendConversationSeen(this.id,i,e).bind(this).then(function(e){return e})["catch"](A.WapDrop,function(e){f.error("models:chat:sendConversationSeen dropped")()}))},markSeen:function(e){e&&"number"==typeof e?e>0&&e<=this.unreadCount?this.unreadCount=this.unreadCount-e:e===-1&&this.unreadCount<=0&&(this.unreadCount=0):this.unreadCount=0,this.unreadMsgAnchor=void 0,this.markedUnread=!1},markUnread:function(e,t){var n=this;if(e?this.active&&(this.markedUnread=!0):this.markedUnread=!1,this.promises.markUnread)return this.promises.markUnread;this.promises.markUnread=e?this.sendUnseen():this.sendSeen();var r=new F(e?l10n.t("action_chat_marking_unread"):l10n.t("action_chat_marking_read"));t=t||U.genId();var i=this.promises.markUnread.then(function(r){if(200===r.status){var i=e?l10n.t("action_chat_marked_unread"):l10n.t("action_chat_marked_read");return new F(i,l10n.t("action_undo"),n.markUnread.bind(n,!e,t))}if(r.status>=400)return new F(e?l10n.t("action_chat_mark_unread_failed"):l10n.t("action_chat_mark_read_failed"))})["catch"](function(r){var i=e?l10n.t("action_chat_mark_unread_failed"):l10n.t("action_chat_mark_read_failed");return new F(i,l10n.t("action_try_again"),n.markUnread.bind(n,e,t))});return x.openToast(p.createElement(U,{id:t,initialAction:r,pendingAction:i})),this.promises.markUnread["finally"](function(){n.promises.markUnread=null})},canMarkUnseen:function(){return k.supportsFeature(k.F.CHAT_MARK_UNSEEN)},sendUnseen:function(){var e=this,t=this.msgs.last(),n=t?t.id:void 0;return P.sendConversationUnseen(this.id,n).then(function(t){return 200===t.status?e.markUnseen():e.markedUnread=!1,t})},markUnseen:function(){this.active&&(this.markedUnread=!0),this.unreadCount=-1},markRecording:function(){if((this.presence.isOnline||this.isGroup)&&!this.recording){var e=this.id;P.sendChatstateRecording(e).then(function(t){t.status>=400&&f.error("models:chat send presence recording error "+e)()})["catch"](A.WapDrop,_.noop),this.presenceResendTimerId=_.delay(this._resendPresence.bind(this),h.PRESENCE_RESEND_WAIT)}this.pausedTimerId&&(clearTimeout(this.pausedTimerId),this.unset("pausedTimerId")),this.recording=!0,this.typing=!1},markComposing:function(){if((this.presence.isOnline||this.isGroup)&&!this.typing){var e=this.id;P.sendChatstateComposing(e).then(function(t){t.status>=400&&f.error("models:chat send presence composing error "+e)()})["catch"](A.WapDrop,_.noop),this.presenceResendTimerId=_.delay(this._resendPresence.bind(this),h.PRESENCE_RESEND_WAIT)}this.typing=!0,this.pausedTimerId&&clearTimeout(this.pausedTimerId),this.pausedTimerId=_.delay(this.markPaused.bind(this),h.SEND_PAUSED_WAIT)},markPaused:function(){if((this.presence.isOnline||this.isGroup)&&(this.typing||this.recording)){var e=this.id;P.sendChatstatePaused(e).then(function(t){t.status>=400&&f.error("models:chat send presence paused error "+e)()})["catch"](A.WapDrop,_.noop)}this.presenceResendTimerId&&(clearTimeout(this.presenceResendTimerId),this.unset("presenceResendTimerId")),this.pausedTimerId&&(clearTimeout(this.pausedTimerId),this.unset("pausedTimerId")),this.typing=this.recording=!1},_resendPresence:function(){var e=this.id;if(this.recording)P.sendChatstateRecording(e).then(function(t){t.status>=400&&f.error("models:chat send presence resend recording error "+e)()})["catch"](A.WapDrop,_.noop);else{if(!this.typing)return void this.unset("presenceResendTimerId");P.sendChatstateComposing(e).then(function(t){t.status>=400&&f.error("models:chat send presence resend composing error "+e)()})["catch"](A.WapDrop,_.noop)}this.presenceResendTimerId=_.delay(this._resendPresence.bind(this),h.PRESENCE_RESEND_WAIT)},_messageSent:function(){this.presenceResendTimerId&&(clearTimeout(this.presenceResendTimerId),this.unset("presenceResendTimerId")),this.pausedTimerId&&(clearTimeout(this.pausedTimerId),this.unset("pausedTimerId")),this.typing=!1},_presenceOnlineChanged:function(){this.presence.isOnline?this._resendPresence():this.presenceResendTimerId&&(clearTimeout(this.presenceResendTimerId),this.unset("presenceResendTimerId"))},handleGroupAction:function(e,t,n){var r;switch(e){case"subject":return void(this.contact.name=n.subject);case"add":case"promote":case"demote":var i="promote"===e;return r=_.map(n.participants,function(e){return{id:e,isAdmin:i}}),void this.groupMetadata.participants.add(r,{merge:!0});case"remove":return r=this.groupMetadata.participants,void _.each(n.participants,function(e){r.remove(e)});case"modify":return;default:return}},preload:function(){1===this.msgs.length&&this.loadEarlierMsgs()},onEmptyMRM:function(){f.log("models:Chat:removeMsg 0 messages left, querying...")(),this.loadEarlierMsgs()},loadEarlierMsgs:function(e){return e||(e=this.msgs),e.msgLoadState.noEarlierMsgs?c["default"].resolve():e.msgLoadState.isLoadingEarlierMsgs?e.loadEarlierPromise:this._loadMsgs("before",e).then(function(t){return _.isArray(t)&&t.length<h.PAGE_SIZE&&(e.msgLoadState.noEarlierMsgs=!0),t})},isMostRecentCMC:function(e){return this.msgs===e},loadRecentMsgs:function(e){return e||(e=this.msgs),this.isMostRecentCMC(e)?c["default"].resolve():e.msgLoadState.isLoadingRecentMsgs?e.loadRecentPromise:this._loadMsgs("after",e)},_loadMsgs:function(e,t){var n;n="after"===e?t.last():t.head();var r={};return n?r=n.id.clone():r.remote=this.id,r.count=h.PAGE_SIZE,r.direction=e,this._loadMsgsPromise(n,t,Store.Msg.findQuery(r),e)},_loadMsgsPromise:function(e,t,n,r){"after"===r?t.msgLoadState.isLoadingRecentMsgs=!0:"before"===r?t.msgLoadState.isLoadingEarlierMsgs=!0:"around"===r&&(t.msgLoadState.isLoadingAroundMsgs=!0);var i=this.regCancellablePromise(n)["finally"](function(){var n=e&&e.msgChunk!==t;t.msgLoadState.contextLoaded=!0,n&&(e.msgChunk.msgLoadState.contextLoaded=!0),"after"===r?t.msgLoadState.isLoadingRecentMsgs=!1:"before"===r?t.msgLoadState.isLoadingEarlierMsgs=!1:"around"===r&&(t.msgLoadState.isLoadingAroundMsgs=!1)})["catch"](function(e){return f.error("chat:loadMsgs:error "+e)(),404===e?c["default"].reject(new A.E404):c["default"].reject(e)});return"after"===r?t.loadRecentPromise=i:"before"===r?t.loadEarlierPromise=i:"around"===r&&(t.loadAroundPromise=i),i},getSearchContext:function(e,t){var n=this,r=void 0,i=void 0;e instanceof g?r=e:e instanceof I&&(i=e);var a=r?r.msgChunk:void 0,s=(0,o["default"])(h.PAGE_SIZE/3*2);if(!a||!a.msgLoadState.contextLoaded){a||(a=new w,this.msgChunks.push(a),r&&a.add(r));var c=r?r.id.clone():i.clone();c.count=s;var l=function(){if(r)return r.msgChunk;var e=Store.Msg.get(i);return e&&e.msgChunk?e.msgChunk:a};this._loadMsgsPromise(r,a,Store.Msg.getContext(c,l),"around").then(function(e){var t=l();t!==a&&n.notifyMsgCollectionMerge(t,a,t);var o=e[0],c=i?Store.Msg.get(i):r;c&&_.isArray(o)&&o.length<s&&(c.msgChunk.msgLoadState.noEarlierMsgs=!0,c.msgChunk!==a&&(a.msgLoadState.noEarlierMsgs=!0))})["catch"](function(){t&&(t.isQuotedMsgAvailable=!1)})}return{collection:a,msg:r,key:i,highlightMsg:!0}},sendStarMsgs:function(e,t,n){var r=this;if(!e)return c["default"].reject(new A.ActionError);if(_.some(e,function(e){return!e.id}))return c["default"].reject(new A.ActionError);if(this.promises.sendStarMsgs)return this.promises.sendStarMsgs;this.promises.sendStarMsgs=P.sendMessageStarred(this.id,_.map(e,function(e){return e.id}),t);var i=_.size(e),a={count:i,_plural:i},o=new F(t?l10n.t("action_message_starring",a):l10n.t("action_message_unstarring",a));n=n||U.genId();var s=this.promises.sendStarMsgs.then(function(i){if(200===i.status){var o=t?l10n.t("action_message_starred",a):l10n.t("action_message_unstarred",a);return new F(o,l10n.t("action_undo"),r.sendStarMsgs.bind(r,e,!t,n))}if(i.status>=400)return new F(t?l10n.t("action_message_star_failed",a):l10n.t("action_message_unstar_failed",a))})["catch"](function(i){f.error("models:chat:sendStarMsgs dropped")(i);var o=t?l10n.t("action_message_star_failed",a):l10n.t("action_message_unstar_failed",a);return new F(o,l10n.t("action_try_again"),r.sendStarMsgs.bind(r,e,t,n))});return x.openToast(p.createElement(U,{id:n,initialAction:o,pendingAction:s})),this.promises.sendStarMsgs.then(function(n){200===n.status&&(_.forEach(e,function(e){e.set("star",t)}),t?Store.AllStarredMsgs.add(e):Store.AllStarredMsgs.remove(e))})["finally"](function(){r.promises.sendStarMsgs=null})},sendNotSpam:function(e,t){var n=this;if(!k.supportsFeature(k.F.SPAM))return c["default"].resolve();if(this.notSpam)return c["default"].resolve();if(this.notSpam=!0,this.promises.sendNotSpam)return this.promises.sendNotSpam;if(this.promises.sendNotSpam=P.sendConversationNotSpam(this.id),e){var r=new F(l10n.t("action_mark_as_not_spam"));t=t||U.genId();var i=this.promises.sendNotSpam.then(function(e){return 200===e.status?new F(l10n.t("action_marked_as_not_spam")):e.status>=400?new F(l10n.t("action_mark_as_not_spam_failed")):void 0})["catch"](function(r){return f.error("models:chat:sendNotSpam dropped")(r),new F(l10n.t("action_mark_as_not_spam_failed"),l10n.t("action_try_again"),n.sendNotSpam(e,t))});x.openToast(p.createElement(U,{id:t,initialAction:r,pendingAction:i}))}return this.promises.sendNotSpam["finally"](function(){n.promises.sendNotSpam=null})},sendSpamReport:function(e){var t=this;if(this.promises.sendSpamReport)return this.promises.sendSpamReport;this.promises.sendSpamReport=P.sendSpamReport(this.id);var n=new F(l10n.t("action_spam_report"));e=e||U.genId();var r=this.promises.sendSpamReport.then(function(e){return 200===e.status?new F(l10n.t("action_spam_reported")):e.status>=400?new F(l10n.t("action_spam_report_failed")):void 0})["catch"](function(n){return f.error("models:chat:sendSpamReport dropped")(n),new F(l10n.t("action_spam_report_failed"),l10n.t("action_try_again"),t.sendSpamReport.bind(t,e))});return x.openToast(p.createElement(U,{id:e,initialAction:n,pendingAction:r})),this.promises.sendSpamReport["finally"](function(){t.promises.sendSpamReport=null})},sendDeleteMsgs:function(e,t){var n=this;if(!e)return c["default"].reject(new A.ActionError);if(_.some(e,function(e){return!e.id}))return c["default"].reject(new A.ActionError);if(this.promises.sendDeleteMsgs)return this.promises.sendDeleteMsgs;this.promises.sendDeleteMsgs=P.sendMessageDelete(this.id,_.map(e,function(e){return e.id}),!0);var r=_.size(e),i={count:r,_plural:r},a=new F(l10n.t("action_message_deleting",i));t=t||U.genId();var o=this.promises.sendDeleteMsgs.then(function(e){return 200===e.status?new F(l10n.t("action_message_deleted",i)):e.status>=400?new F(l10n.t("action_message_delete_failed",i)):void 0})["catch"](function(r){return f.error("models:chat:sendDeleteMsgs dropped")(r),new F(l10n.t("action_message_delete_failed",i),l10n.t("action_try_again"),n.sendDeleteMsgs.bind(n,e,t))});return x.openToast(p.createElement(U,{id:t,initialAction:a,pendingAction:o})),this.promises.sendDeleteMsgs.then(function(t){200===t.status&&_.forEach(e,function(e){e["delete"]()})})["finally"](function(){n.promises.sendDeleteMsgs=null})},deleteMsgs:function(e,t){var n=this;this.getAllCMCs().forEach(function(r){r.filter(function(e){return!t||i(e,t)}).filter(function(t){return(e||!t.star)&&!t.isPersistent}).forEach(function(e){e["delete"]()}),0===r.length&&r!==n.msgs&&n.removeMsgsCollection(r)}),this.unreadCount=0},deleteMsgsOlderThan:function(e,t,n){var r=this.msgs,a=_.head(r.models);if(a&&!(a.t>=e)){if(a=_.last(r.models),a.t<e)return void this.deleteMsgs(t,n);var o=function(r){return r&&(n&&!i(r,n)||r.star&&!t||r.t>=e||r.isPersistent)};this.deleteMsgsPartial(o)}},deleteMsgsBeforeMsgInclusive:function(e,t){if(e&&this.msgs.get(e.id)){var n=this.msgs.indexOf(e),r=function(e,r){return e.msgChunk===this.msgs&&r>n||t&&e.star||e.isPersistent};this.deleteMsgsPartial(r)}},deleteMsgsPartial:function(e){var t=this,n=this.unreadCount,r=_.flatten(this.getAllCMCs().map(function(n){return n.filter(function(n,r,i){return!e.apply(t,[n,r,i])})}));if(r.forEach(function(e){e["delete"]()}),_.clone(this.msgChunks).forEach(function(e){0===e.length&&t.removeMsgsCollection(e)}),this.msgs.length>0){var i=n>this.msgs.length?this.msgs.length:n;this.unreadCount=i,this.msgs.msgLoadState.noEarlierMsgs=!0}},getFirstMsgWithStatus:function(){return _.find(this.msgs.models,function(e){return!e.isNotification&&(e.isSentByMe||e.type===g.TYPE.PTT)})},getFirstMsgFromMe:function(){return _.find(this.msgs.models,function(e){return!e.isNotification&&e.isSentByMe})},getLastReceivedMsg:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&(!t.local||t.ack>0))return t}},getLastTimestampMsg:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&"i"!==t.eventTypeFromMsgType())return t}},createMessageFromText:function(e){if(e=_.trim(e),""===e)return null;var t=this.id,n=Store.Conn.me,r=new I({from:n,to:t,id:g.newTag(),participant:void 0,selfDir:"out"}),i={id:r,body:e,type:"chat",subtype:null,t:D.globalUnixTime(),from:n,to:t,self:"out",local:!0,ack:0};return new g(i)},sendMessage:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments[2],r=arguments[3];if(e=_.trim(e),""===e)return c["default"].resolve();this._messageSent();var i=this.id,a=Store.Conn.me,o=new I({from:a,to:i,id:g.newTag(),participant:void 0,selfDir:"out"}),s=n&&n.contextInfo(),l=_.defaults({id:o,body:e,type:"chat",subtype:t&&!_.isEmpty(t)?"url":null,t:D.globalUnixTime(),from:a,to:i,self:"out",local:!0,ack:0},t,s,{mentionedJidList:r}),u=new g(l),d=Store.Msg.send(u);return this.msgs.add(u),d},sendContact:function(e){var t=j.cleanValue(e.formattedName),n="BEGIN:VCARD\nVERSION:3.0\nN:"+j.getName(e)+"\nFN:"+t+"\nTEL;type=CELL;waid="+e.userid+":"+R.formattedUser(e.userid)+"\nEND:VCARD",r={ack:0,body:n,from:Store.Conn.me,id:new I({from:Store.Conn.me,to:this.id,id:g.newTag(),participant:void 0,selfDir:"out"}),local:!0,self:"out",subtype:e.formattedName,t:D.globalUnixTime(),to:this.id,type:"vcard"};this.addAndSendMsg(r)},forwardMessages:function(e){var t=this,n=this.id,r=this.contact;if(r.isUser&&r.isBlocked())return c["default"].reject(new A.ContactBlocked("Forwarded to contact is blocked",r));var i=[];return c["default"].each(e,function(e){if(e.isMMS)return(0,l.forwardMediaMsg)(e,t);var r=_.omit(e.toJSON(),"quotedMsg"),i=new I({from:Store.Conn.me,to:n,id:g.newTag(),participant:void 0,selfDir:"out"});return _.assign(r,{id:i,from:Store.Conn.me,t:D.globalUnixTime(),to:n,ack:0,participant:void 0,local:!0,self:"out",isNewMsg:!0,star:!1}),t.addAndSendMsg(r)})["return"](i)},updateReadOnly:function(){this.isGroup&&!this.groupMetadata.stale&&(this.isReadOnly=!this.groupMetadata.participants.get(Store.Conn.me)),this.isBroadcast&&this.updateTitle()},sortMsgs:function(e){var t=_.map(e,function(e){var t=e.msgChunk;return{msg:e,chunkT:t.models[0].t,index:t.indexOf(e)}});return _(t).orderBy(["chunkT","index"]).map("msg").value()},_updateAssignedColor:function(){if(this.colors){var e=this.groupMetadata.participants;if(0!==e.size){var t=this.colors,n=_.difference(_.keys(t),e.map("id").map(L));n.forEach(function(e){delete t[e]}),n.length&&this._saveAssignedColors()}}},loadAssignedColors:function(){return this.listenTo(this.groupMetadata.participants,"remove reset ",this._updateAssignedColor),O.getGroupParticipantAssignedColor(this.id)||{}},saveAssignedColors:function(){var e=this.colors;e&&O.setGroupParticipantAssignedColor(this.id,e)},assignedColor:function(e){var t,n=this,r=this.colors||(this.colors=this.loadAssignedColors()),i=L(e);if(t=r[i])return t;var a=function(){var e={};_.forEach(r,function(t,n){e[t]?e[t].push(n):e[t]=[n]});for(var a=Number.POSITIVE_INFINITY,o=1;o<h.NUM_COLORS;o++){if(!e[o]){t=o;break}e[o].length<a&&(a=e[o].length,t=o)}return r[i]=t,n._saveAssignedColors(),{v:t}}();return"object"==typeof a?a.v:void 0},setSubject:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=arguments[1];if(t=t.trim(),!t)return c["default"].reject(new A.ActionError);if(t===this.contact.name)return c["default"].reject(new A.ActionError);var r=P.changeSubject(this.id,t),i=this.contact.name,a=new F(l10n.t("action_group_renaming"));n=n||U.genId();var o=r.then(function(r){return 200===r.status?new F(l10n.t("action_group_renamed",{subject:t}),l10n.t("action_undo"),e.setSubject.bind(e,i,n)):r.status>=400?new F(l10n.t("action_group_rename_failed")):void 0})["catch"](function(r){return f.error("models:chat:setSubject dropped")(r),new F(l10n.t("action_group_rename_failed"),l10n.t("action_try_again"),e.setSubject.bind(e,t,n))});return x.openToast(p.createElement(U,{id:n,initialAction:a,pendingAction:o})),r.then(function(n){200!==n.status||n._duplicate||(e.contact.name=t)})},unstarAll:function(){this.getAllMsgs().forEach(function(e){e&&(e.star=!1)}),Store.AllStarredMsgs.remove(this.getAllMsgs())},getMediaMsgs:function(e){if(!e)return this.mediaMsgs;var t=void 0;return this.mediaMsgs.contains(e)||e.msgChunk===this.msgs?(t=this.mediaMsgs,t.hasMediaAfter=!1):t=new M,t.contains(e)||(e.msgChunk?t.add(e.msgChunk.filter(function(e){return e.isMedia})):t.add(e)),t},fts:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?1:arguments[1],r=arguments[2];if(1===n){var i=this.ftsCache[e];if(i)return i;var a=Store.Msg.search(e,n,r,this.id);this.ftsCache[e]=a;var o=function(){t.ftsCache[e]=null};return _.delay(o,B),a["catch"](o),a}return Store.Msg.search(e,n,r,this.id)},_clearFtsCache:function(){this.ftsCache={}},_updatePSAName:function(){this.name=l10n.t("whatsapp_psa_contact_name")},updateSortTime:function(){var e=this;this.promises.updateSortTime||(this.promises.updateSortTime=c["default"].delay(0).cancellable().then(function(){var t=e.getLastTimestampMsg();return t?(e.t=t.t,c["default"].resolve()):e.msgs.msgLoadState.noEarlierMsgs?(e.t=void 0,c["default"].resolve()):e.pendingMsgs?c["default"].resolve():e.loadEarlierMsgs()}).then(function(t){if(t){var n=e.getLastTimestampMsg();e.t=n?n.t:void 0}})["catch"](_.noop)["finally"](function(){e.promises.updateSortTime=void 0}),this.regCancellablePromise(this.promises.updateSortTime))}}),W={};z.linkPreview=function(e){var t=W[e];return t?t:t=W[e]=c["default"].props({url:e,data:P.queryLinkPreview(e)})},z.KIND=G,e.exports=z},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=arguments.length<=2||void 0===arguments[2]?{found:!1}:arguments[2];if(e===t)return n.found=!0,"";if(e instanceof HTMLImageElement)return e.alt;if(e.nodeType===Node.TEXT_NODE)return e.nodeValue;for(var r=D.formatDelim(e)||"",a="",o=0;o<e.childNodes.length&&(a+=i(e.childNodes[o],t,n),!n.found);)o++;return r?""+r+a+r:a}function a(e,t,n,r,i,o){if(r<n)return-1;var s,c=Math.round((n+r)/2),l=e[c],u=l.offsetLeft-i;if(u>=t)s=o;else{if(u+l.clientWidth>t)return c;s=!o}return s?a(e,t,n,c-1,i,o):a(e,t,c+1,r,i,o)}function o(e,t){for(var n=0,r=e.childNodes,i=0;i<r.length;i++){var a=r[i];if(a===t)break;n+=a.clientWidth}return n}var s=n(1138),c=r(s),l=n(6),u=n(37),d=n(436),p=n(86),h=n(142),f=n(141),m=n(83),g=n(145),v=n(44),y=n(1137),E=n(104),b=n(1361),w=n(1535),M=n(1291),C=n(1359),S=n(1306),T=n(1307),k=n(1310),x=n(1311),N=n(1360),P=n(1308),O=n(1538),D=n(1288),A=4096,I={SMALL:"small",LARGE:"large"},R=l.createClass({displayName:"EmojiText",mixins:[m,f,h,g,y],statics:{EMOJI_SIZE:I},propTypes:{text:l.PropTypes.string,highlight:l.PropTypes.array,highlightBounary:l.PropTypes.bool,mention:l.PropTypes.object,emojiSize:l.PropTypes.oneOf(_.values(I)),element:l.PropTypes.string,className:l.PropTypes.oneOfType([l.PropTypes.string,l.PropTypes.arrayOf(l.PropTypes.string),l.PropTypes.objectOf(l.PropTypes.bool)]),direction:l.PropTypes.string,linkify:l.PropTypes.bool,titlify:l.PropTypes.bool,ellipsify:l.PropTypes.bool,selectable:l.PropTypes.bool,format:l.PropTypes.bool,wbr:l.PropTypes.number,dirMismatch:l.PropTypes.bool},getInitialState:function(){var e=this.props.text;return this.debouncedRecompute=this.safeDebounce(this.recompute,20),this.reged=!1,{ellipsified:null,text:d.removeFEOF(e)}},getDefaultProps:function(){return{emojiSize:I.SMALL,element:"span"}},componentWillMount:function(){p.isWebkit&&this.props.ellipsify&&this.containsEmoji()&&this.regResizeListener()},componentWillReceiveProps:function(e){var t=d.removeFEOF(e.text);if(p.isWebkit&&this.props.ellipsify&&t!==this.state.text){var n=(t||"").substring(0,A);d.containsEmoji(n)?(this.recompute(),this.regResizeListener()):(this.setState({ellipsified:null}),this.unregResizeListener())}this.setState({text:t})},containsEmoji:function(){var e=(this.state.text||"").substring(0,A);return d.containsEmoji(e)},regResizeListener:function(){this.reged||(this.regNativeListener(window,"resize",this.debouncedRecompute),this.regCmd("resize",this.debouncedRecompute),this.reged=!0)},unregResizeListener:function(){this.reged&&(this.unregNativeListener(window,"resize",this.debouncedRecompute),this.unregCmd("resize",this.debouncedRecompute),this.reged=!1)},recompute:function(){this.setState({ellipsified:null},this.ellipsify)},ellipsifyCheck:function(){this.isMounted()&&this.containsEmoji()&&this.ellipsify()},componentDidMount:function(){p.isWebkit&&this.props.ellipsify&&this.uiIdle(this.ellipsifyCheck)},ellipsify:function(){var e=u.findDOMNode(this);if(e){var t=e.querySelectorAll("img");if(0!==t.length){var n,r=0;if(n=e.clientWidth){if(n===e.scrollWidth)return;r=0}else{var s=e.parentNode;if(r=o(s,e),n=s.clientWidth-r,s.clientWidth===s.scrollWidth)return}var c=l10n.isRTL()===this.props.dirMismatch,l=a(t,c?n:0,0,t.length-1,c?r:0,c);if(!(l<0)){var d=t[l],p=10;p-=Math.floor(p/4);var h=a(t,c?n-p:p,0,l,c?r:0,c);h>-1&&(d=t[h]),this.setState({ellipsified:i(e,d)})}}}},render:function(){if(!this.state.text)return null;var e=this.state.ellipsified;e||(e=this.props.ellipsify?(this.state.text||"").substring(0,A):this.state.text);var t=this.props.selectable?"selectable-text":void 0,n=new c["default"];n.set("default",{className:t}),n.set(C,{size:this.props.emojiSize});var r=[],i=E.supportsFeature(E.F.RICH_TEXT)&&this.props.format;i&&r.push(new M),this.props.linkify&&r.push(new T),i&&(r.push(new x),r.push(new S),r.push(new k)),this.props.wbr&&r.push(new w(this.props.wbr)),r.push(new C);var a=this.props.highlight;a&&a.length>0&&r.push(new N(a,this.props.highlightBounary)),this.props.mention&&r.push(new P(this.props.mention));var o=b.parse(e,r),s=b.serialize(o,new O(n)),u=v(this.props.className,{emojitext:!this.props.className,ellipsify:this.props.ellipsify,"inverse-text-direction":this.props.dirMismatch,"selectable-text":this.props.selectable}),d={className:u,dir:this.props.direction};this.props.titlify&&(d.title=this.state.text);var p=this.props.element;return l.createElement(p,d,s,this.state.ellipsified?"…":null)}});e.exports=R},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e.dataTransfer){try{if(!e.dataTransfer.dropEffect)return}catch(e){return}e.dataTransfer.effectAllowed&&(e.nativeEvent.dataTransfer.dropEffect="copy")}}var a=n(1136),o=r(a),s=n(6),c=n(44),l={LEFT:"left",MID:"mid",RIGHT:"right"},u=s.createClass({displayName:"Drawer",propTypes:{children:s.PropTypes.node.isRequired,id:s.PropTypes.string,variant:s.PropTypes.string,noContainer:s.PropTypes.bool,position:s.PropTypes.oneOf(_.values(l)),onDragLeave:s.PropTypes.func,onDrop:s.PropTypes.func,onDragOver:s.PropTypes.func},getDefaultProps:function(){return{position:"left"}},statics:{RIGHT:"right",LEFT:"left",MID:"mid"},getInitialState:function(){return{isDragging:!1}},isDragDropDrawer:function(){return this.props.onDragOver&&this.props.onDragLeave&&this.props.onDrop},onDragOver:function(e){e.preventDefault(),this.isDragDropDrawer()&&(i(e),this.state.isDragging||(this.props.onDragOver(e),this.setState({isDragging:!0})))},onDrop:function(e){e.preventDefault(),e.stopPropagation(),this.setState({isDragging:!1}),this.props.onDrop(e)},onDragLeave:function(e){e.preventDefault(),e.stopPropagation(),this.state.isDragging&&(this.setState({isDragging:!1}),this.props.onDragLeave(e))},render:function(){var e,t=this.props,n=c(this.props.className,"drawer",(0,o["default"])({},"drawer-"+t.id,!!t.id));if(this.isDragDropDrawer()){var r=this.state.isDragging?{}:{display:"none"};e=s.createElement("div",{key:"mask",className:"drag-drop-mask",style:r,onDragLeave:this.onDragLeave,onDrop:this.onDrop})}return s.createElement("div",{className:n,onDragOver:this.onDragOver},e,t.children)}});u.Position=l,e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(438),s=r(o),c=n(6),l=n(44),u=c.createClass({displayName:"DrawerBody",propTypes:{classes:c.PropTypes.string,info:c.PropTypes.bool,wide:c.PropTypes.bool},getDefaultProps:function(){return{info:!1,wide:!1}},render:function(){var e=this.props,t=e.classes,n=e.info,r=e.wide,i=(0,s["default"])(e,["classes","info","wide"]),o=l("drawer-body",t,{"drawer-body-info":n,"drawer-body-wide":r});return c.createElement("div",(0,a["default"])({className:o},i),this.props.children)}});e.exports=u},function(e,t,n){"use strict";var r=n(6),i=n(437),a=n(44),o=n(1278),s=o.MenuBar,c=n(106),l={SMALL:"small",LARGE:"large",POPUP:"popup",OFFSET:"offset"},u=r.createClass({displayName:"DrawerHeader",propTypes:{children:r.PropTypes.node,title:r.PropTypes.string,onBack:r.PropTypes.func,onCancel:r.PropTypes.func,a8n:r.PropTypes.string,type:r.PropTypes.oneOf(_.values(l)).isRequired,menu:r.PropTypes.element},render:function(){var e=this.props,t=e.title,n=e.onBack,o=e.onCancel,u=e.type,d=e.children,p=null;if(t){var h=void 0,f=null,m={textAlign:"initial"};u===l.SMALL?(h={fontWeight:400,fontSize:16,lineHeight:"21px"},m.width=54):u===l.LARGE?(h={fontWeight:500,fontSize:19,lineHeight:"normal"},f={backgroundColor:"transparent",padding:"0px"},m.width=54):(h={fontWeight:500,fontSize:19,lineHeight:"19px"},m.width=48,m.opacity=.7);var g=a("icon btn-close-drawer",{"icon-back":u===l.SMALL,"icon-back-light":u!==l.SMALL}),v=n?r.createElement("span",{className:g,"data-a8n":i.key("btn-closer-drawer"),onClick:n}):null,y=a("icon btn-close-drawer",{"icon-x":u===l.SMALL,"icon-x-light":u!==l.SMALL}),_=o?r.createElement("span",{className:y,"data-a8n":i.key("btn-closer-drawer"),onClick:o}):null,E=a({"pane-header":u===l.LARGE},"drawer-title"),b=this.props.menu?r.createElement("span",{className:"pane-list-controls"},r.createElement(s,{key:"drawer-header"},r.createElement(c,{transitionName:"btn"},this.props.menu))):null;p=r.createElement("div",{className:E,style:f},r.createElement("div",{style:m,className:"drawer-title-action"},v,_),r.createElement("span",{"data-a8n":i.key(this.props.a8n),className:"drawer-title-body",style:h},t),b)}var w=a({"drawer-header":u===l.LARGE,"drawer-header-small":u===l.SMALL,"drawer-header-offset":u===l.OFFSET,"drawer-header-popup":u===l.POPUP});return r.createElement("header",{className:w},p,d)}});u.Type=l,e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(14),s={rejectOnUnmount:function(){var e=this;return this._reject?this._reject:(this._reject=new a["default"](function(t,n){e._rejectFn=n}),this._reject["catch"](_.noop),this._isMounted===!1&&this._rejectFn(new o.Unmount),this._reject)},componentWillUnmount:function(){this._isMounted=!1,this._rejectFn&&this._rejectFn(new o.Unmount)}};e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1253),a=r(i),o=n(44),s=n(6),c=n(1230),l=n(144),u=n(24),d=n(14),p=n(1252),h={SMALL:"small",MEDIUM:"medium",LARGE:"large",AUTO:"auto",NONE:"none"},f={LOW:"low",HIGH:"high"},m=s.createClass({displayName:"DetailImage",mixins:[c],propTypes:{id:s.PropTypes.string.isRequired,size:s.PropTypes.oneOfType([s.PropTypes.number,s.PropTypes.oneOf(_.values(h))]),className:s.PropTypes.string,loader:s.PropTypes.bool,quality:s.PropTypes.oneOf(_.values(f)),onClick:s.PropTypes.func,onLoad:s.PropTypes.func,quoted:s.PropTypes.bool},getDefaultProps:function(){return{size:h.SMALL,quality:f.LOW}},getInitialState:function(){var e=this.props,t=e.id,n=e.quality;if(u.isBroadcast(t))return{loading:!1};var r=Store.ProfilePicThumb.get(t),i=n===f.HIGH,a=!0;if(r){var o=i?r.imgFull:r.img;return o&&p.isCached(o)&&(this.props.onLoad&&this.props.onLoad(),a=!1),this.asyncState({src:i?"id.ProfilePicThumb.imgFull":"id.ProfilePicThumb.img"
},{loading:a})}},onLoad:function(e){this.state.loading&&this.setState({loading:!1}),this.props.onLoad&&this.props.onLoad()},onError:function(e){if(e instanceof d.ServerStatusError){var t=Store.ProfilePicThumb.get(this.props.id);t&&t.onError(e.status)}this.state.loading&&this.setState({loading:!1})},getClasses:function(){var e=this.props,t=e.id,n=e.className,r=e.quoted;return o("avatar",n,{"icon-user-default":u.isUser(t),"icon-user-default-square":u.isUser(t)&&r,"icon-group-default":u.isGroup(t),"icon-broadcast-default":u.isBroadcast(t),"icon-psa-default":u.isPSA(t)})},getStyle:function(){var e=void 0;switch(this.props.size){case h.SMALL:e=49;break;case h.MEDIUM:e=100;break;case h.LARGE:e=200;break;case h.NONE:e=void 0;break;default:e=this.props.size}var t={height:e,width:e};return this.props.onClick&&(t.cursor="pointer"),t},render:function(){var e=this.state.src,t=Store.ProfilePicThumb.get(this.props.id),n=void 0;this.props.loader&&this.state.loading&&(!t||t.stale||e)&&(n=s.createElement("div",{className:"avatar-spinner-container"},s.createElement(l,{size:50,stroke:3})));var r=o("avatar-image",{"is-loaded":!this.state.loading}),i=e?s.createElement(a["default"],{src:e,hasPrivacyChecks:!0,crossOrigin:!1,className:r,onLoad:this.onLoad,onError:this.onError}):null;return s.createElement("div",{className:this.getClasses(),style:this.getStyle(),onClick:this.props.onClick},s.createElement("div",{className:"avatar-body"},i,n))}});m.Size=h,m.Quality=f,e.exports=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(37),c=n(437),l=n(142),u=n(44),d=n(85),p=o.createClass({displayName:"MenuItem",mixins:[l],propTypes:{children:o.PropTypes.node.isRequired,a8n:o.PropTypes.string.isRequired,action:o.PropTypes.func,tooltip:o.PropTypes.node,filePickerMimes:o.PropTypes.string,onFilePick:o.PropTypes.func},getInitialState:function(){return{hover:!1,focus:!1}},componentWillMount:function(){this.props.filePickerMimes&&this.regNativeListener(window,"focus",this.onWindowFocus)},onMouseEnter:function(){this.setState({hover:!0})},onMouseLeave:function(){this.setState({hover:!1})},onFocus:function(){this.setState({focus:!0})},onBlur:function(){this.setState({focus:!1})},preventDefault:function(e){e.preventDefault()},onAction:function(e){if(e.isTrusted&&!e.repeat){var t=this.props,n=t.action,r=t.filePickerMimes;if(n){var i=n(e);if(r)return void(this.active=!0);var a=this.context.uim;a&&(i===!1&&a.pop(!1,!1),a.uie.requestDismiss())}}},triggerInput:function(){s.findDOMNode(this.refs.filePicker).click()},onWindowFocus:function(e){this.active&&this.onFilePick()},onFilePick:function(e){if(this.props.onFilePick){this.props.onFilePick(e);var t=this.context.uim;t&&t.uie.requestDismiss()}},render:function(){var e=this.props,t=e.children,n=e.tooltip,r=e.filePickerMimes,i=this.state,s=i.hover,l=i.focus;n=(s||l)&&n?n:null;var d={enter:this.onAction},p=u("menu-item menu-shortcut",{"highlighted-menu-item":s||l}),f=void 0;return r&&(f=o.createElement(h,{mime:r,ref:"filePicker",onPick:this.onFilePick})),_.isString(t)&&(t=o.createElement("a",{className:"ellipsify",title:t},t)),o.createElement(a["default"],{component:"li",className:p,handlers:d,"data-a8n":c.key(this.props.a8n),onContextMenu:this.preventDefault,onMouseDown:this.preventDefault,onClick:this.onAction,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onFocus,onBlur:this.onBlur},t,n,f)}});p.contextTypes={uim:o.PropTypes.instanceOf(d)};var h=o.createClass({displayName:"FilePicker",propTypes:{mime:o.PropTypes.string.isRequired,multiple:o.PropTypes.bool,onPick:o.PropTypes.func.isRequired},getDefaultProps:function(){return{multiple:!0}},render:function(){return o.createElement("input",{accept:this.props.mime,type:"file",multiple:this.props.multiple,style:{display:"none"},onClick:function(e){return e.stopPropagation()},onChange:this.props.onPick})}});e.exports=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(438),s=r(o),c=n(6),l=n(144),u=n(44),d=n(1232),p=function(e){var t=e.className,n=u("empty-icon",t);return c.createElement("div",{className:"empty-icon-container"},c.createElement("span",{className:n}))},h=function(e){var t=e.icon,n=e.title,r=e.text,i=e.className,o=e.children,l=(0,s["default"])(e,["icon","title","text","className","children"]),p=n?c.createElement("div",{className:"empty-title"},n):null,h=r?c.createElement(d,{element:"div",className:"empty-text",text:r}):null,f=u("empty",i);return c.createElement("div",(0,a["default"])({className:f},l),t,p,h,o)},f=function(){var e=c.createElement(p,{className:"icon-empty-blocked"});return c.createElement(h,{icon:e,title:l10n.t("blocked_empty"),text:l10n.t("add_blocked_description")})},m=function(){var e=c.createElement(p,{className:"icon-empty-archived"});return c.createElement(h,{icon:e,title:l10n.t("archived_empty")})},g=function(){return c.createElement(h,{className:"empty-top",text:l10n.t("search_no_chats_or_contacts")})},v=function(){return c.createElement(h,{className:"empty-top",text:l10n.t("searching_chats_contacts_messages")})},y=function(){return c.createElement(h,{className:"empty-top",text:l10n.t("searching_messages")})},_=function(){return c.createElement(h,{className:"empty-top",text:l10n.t("search_no_contacts")})},E=function(){return c.createElement(h,{className:"empty-top",text:l10n.t("search_no_groups")})},b=function(){return c.createElement(h,{className:"empty-top",text:l10n.t("search_no_messages")})},w=function(){return c.createElement(h,{text:l10n.t("no_chats")})},M=function(){return c.createElement(h,{text:l10n.t("no_contacts")})},C=function(){return c.createElement(h,{text:l10n.t("no_groups")})},S=function(e){return c.createElement(h,{className:"empty-top",text:l10n.t("chat_search_prompt",{chatName:e})})},T=function(){return c.createElement(h,{text:l10n.t("all_chats_archived")})},k=function(){return c.createElement(h,{text:l10n.t("no_starred_messages")})},x=function(){return c.createElement(h,{text:l10n.t("no_media")})},N=function(){return c.createElement(h,{text:l10n.t("no_links")})},P=function(){return c.createElement(h,{text:l10n.t("no_docs")})},O=function(){return c.createElement(h,null,c.createElement(l,{size:50,stroke:4}))};e.exports={Blocked:f,Archived:m,Search:g,SearchContacts:_,SearchGroups:E,SearchMessages:b,ListChats:w,ListContacts:M,ListGroups:C,AllArchived:T,StarredMsgs:k,MediaMsgs:x,LinkMsgs:N,DocMsgs:P,Loading:O,Searching:v,SearchingMessages:y,BeforeSearchMessages:S}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(37),g=n(44),v=n(8),y=n(38),_=n(1255),E=n(1392),b=72,w="data-list-scroll-container",M="data-list-scroll-offset",C=function(e){function t(){(0,s["default"])(this,t);var e=(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments));return e.scrollTop=0,e.offsetTop=0,e.bodyHeight=0,e.pointerEvents=!0,e.enablePointerEvents=y.debounce(function(){v.setUiBusy(!1),e.pointerEvents=!1,m.findDOMNode(e.refs.viewport).style.pointerEvents="auto",e.props.onPointerEventsOn&&e.props.onPointerEventsOn()},150),e.onScroll=function(){e.animationFrame||(e.animationFrame=window.requestAnimationFrame(e._onScroll))},e._onScroll=function(){var t=e.state.scrollTarget;e.disablePointerEvents(),t&&(e.scrollTop=t.scrollTop);var n=e.getPhysicalIndexes(e.props),r=n.firstPhysicalIndex,i=n.lastPhysicalIndex,a=void 0;for(a=r;a<i;a++){var o=e.props.data[a].id;if(!e.renderedItems[o])break}return a===i?e.animationFrame=void 0:void e.setState({firstPhysicalIndex:r,lastPhysicalIndex:i,renderVisible:!1},function(){e.animationFrame=void 0})},e.state={scrollTarget:void 0,firstVisibleIndex:0,firstPhysicalIndex:0,lastPhysicalIndex:0,renderVisible:!0},e}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillReceiveProps",value:function(e){y.isNumber(e.scrollTop)&&this.state.scrollTarget&&(this.state.scrollTarget.scrollTop=e.scrollTop),this.props.scrollTarget===e.scrollTarget&&this.props.height===e.height&&this.props.data.length===e.data.length||this.initialize(e)}},{key:"componentDidMount",value:function(){var e=this;this.props.addListenerAndRun(window,"resize",function(){return e.initialize()})}},{key:"componentWillUnmount",value:function(){this.animationFrame&&window.cancelAnimationFrame(this.animationFrame),this.enablePointerEvents.cancel()}},{key:"initialize",value:function(e){var t=e?e:this.props;this.state.scrollTarget&&this.props.removeListener(this.state.scrollTarget,"scroll",this.onScroll);for(var n=m.findDOMNode(this),r=void 0,i=n,a=0;a<5;a++){if(i.hasAttribute(w)){r=i;break}i=i.parentNode}var o=void 0;i=n;for(var s=0;s<a;s++){if(i.hasAttribute(M)){o=i;break}i=i.parentNode}if(!r)throw new Error("list scroll container not found");this.props.addListener(r,"scroll",this.onScroll),this.scrollTop=r.scrollTop,this.offsetTop=o?o.offsetTop:0,this.bodyHeight=r.clientHeight;var c=this.getPhysicalIndexes(t),l=c.firstPhysicalIndex,u=c.lastPhysicalIndex;return this.setState({scrollTarget:r,firstPhysicalIndex:l,lastPhysicalIndex:u,renderVisible:!0}),this.renderedItems={},r}},{key:"getFirstVisibleIndex",value:function(e){return Math.floor(Math.max(this.scrollTop-this.offsetTop,0)/e)}},{key:"getPhysicalIndexes",value:function(e){var t=this.getFirstVisibleIndex(e.height),n=Math.max(this.offsetTop-this.scrollTop,0),r=Math.max(this.bodyHeight-n,0),i=Math.min(Math.ceil(r/e.height),e.data.length),a=Math.max(t-e.extraItems,0),o=Math.min(t+i+e.extraItems,e.data.length);return{firstPhysicalIndex:a,lastPhysicalIndex:o}}},{key:"disablePointerEvents",value:function(){this.enablePointerEvents(),this.pointerEvents||(this.props.onPointerEventsOff&&this.props.onPointerEventsOff(),m.findDOMNode(this.refs.viewport).style.pointerEvents="none",v.setUiBusy(!0),this.pointerEvents=!0)}},{key:"getComponents",value:function(){var e=this,t=this.props,n=t.height,r=t.data,i=this.state,a=i.firstPhysicalIndex,o=i.lastPhysicalIndex,s={},c=y.chain(r).forEach(function(e,t){s[e.key]=t}).slice(a,o).forEach(function(t){e.renderedItems[t.key]=t}).value(),l=this.state.renderVisible?c:this.renderedItems;return y.sortBy(l,"key").map(function(e){return f.createElement(E,{key:e.key,rowHeight:n,className:0===s[e.key]?"first":void 0,zIndex:r.length-s[e.key]-1,rowNumber:s[e.key]},e)})}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.height,r=e.className,i=e.animate,a={container:{},viewport:{height:t.length*n}},o={container:g("infinite-list",r,{"infinite-list-animate":i&&!this.animationFrame}),viewport:"infinite-list-viewport"};return f.createElement("div",{className:o.container,style:a.container},f.createElement("div",{className:o.viewport,ref:"viewport",style:a.viewport},this.getComponents()))}}]),t}(f.Component);C.defaultProps={scrollTarget:null,data:null,height:b,extraItems:30},C.DEFAULT_HEIGHT=b,C.SCROLL_ATTR=w,C.SCROLL_OFFSET_ATTR=M;t.Component=C;t["default"]=_(C)},function(e,t,n){"use strict";var r=n(6),i=n(1246),a=n(1232),o=n(1229),s=n(8),c=n(24),l=n(44),u=function(e){var t=e.msg,n=e.displaySelf,o=e.className,u=e.disableClick,d=t.chat.assignedColor(t.sender),p=t.senderObj,h=l("message-author color-"+d,o,{"title-number":!p.name}),f=u?_.noop:function(){Store.Chat.find(t.author).then(function(e){s.openChatFromUnread(e).then(function(t){t&&s.focusChatTextInput(e)})})},m=u?null:"text-clickable",g=void 0;return g=n?r.createElement(a,{text:l10n.t("web_you")}):p.name?r.createElement("span",{className:m,onClick:f},r.createElement(a,{text:p.name})):[r.createElement("span",{className:l("number",m),key:t.id+"-number",onClick:f},c.formattedUser(p.id)),r.createElement("span",{className:l("ellipsify","screen-name",m),key:t.id+"-push-name",onClick:f},r.createElement(a,{className:"screen-name-text",direction:"auto",text:p.notifyName}))],r.createElement("h3",{className:h},r.createElement(i,null,g))};u.shouldRender=function(e){return!e.isSentByMe&&e.isGroupMsg},u.propTypes={msg:r.PropTypes.instanceOf(o).isRequired,displaySelf:r.PropTypes.bool,disableClick:r.PropTypes.bool,className:r.PropTypes.string},e.exports=u},function(e,t,n){"use strict";function r(e){var t,n,r="";switch(e.subtype){case"identity":t=Store.Contact.get(e.body),n=t?t.formattedName:f.formattedUser(e.body),r=l10n.t("web_security_code_change",{name:n});break;case"encrypt":var i=e.id.remote;r=f.isGroup(i)?l10n.t("web_group_info_encrypted"):f.isBroadcast(i)?l10n.t("web_broadcast_info_encrypted"):l10n.t("web_contact_info_encrypted")}return r}function i(e,t){var n="";switch(e.subtype){case"miss":n=t?l10n.t("web_missed_voice_call_system_message",{time:h.timestampStr(e.t)}):l10n.t("web_missed_voice_call_chatlist");break;case"miss_video":n=t?l10n.t("web_missed_video_call_system_message",{time:h.timestampStr(e.t)}):l10n.t("web_missed_video_call_chatlist")}return n}function a(e,t){var n,r,i="";if("create"===e){var a=parseInt(t,10);i=l10n.t("web_you_created_list_unnamed",{count:a,_plural:a})}else"add"===e?(n=Store.Contact.get(t),r=n?n.get("name"):"",r=r?r:f.formattedUser(t),i=l10n.t("web_list_recipient_added",{name:r})):"remove"===e&&(n=Store.Contact.get(t),r=n?n.get("name"):"",r=r?r:f.formattedUser(t),i=l10n.t("web_list_recipient_removed",{name:r}));return i}function o(e){var t,n,r="",i=e.get("type"),a=e.get("subtype"),o=e.displayName(),s=e.get("author"),c=e.get("body");if("group_notification"===i)switch(a){case"add":r=s===Store.Conn.me?l10n.t("web_group_participant_added_you"):l10n.t("web_group_participant_added_name",{name:o});break;case"remove":r=s===Store.Conn.me?l10n.t("web_group_participant_removed_you"):l10n.t("web_group_participant_removed_name",{name:o});break;case"leave":r=s===Store.Conn.me?l10n.t("web_group_participant_left_you"):l10n.t("web_group_participant_left_name",{name:o});break;case"picture":r="remove"===c?s===Store.Conn.me?l10n.t("web_photo_removed_by_you"):l10n.t("web_photo_removed_by",{name:o}):s===Store.Conn.me?l10n.t("web_photo_changed_by_you"):l10n.t("web_photo_changed_by",{name:o});break;case"subject":r=s===Store.Conn.me?l10n.t("web_group_subject_changed_by_you",{subject:c}):l10n.t("web_group_subject_changed_by_name",{name:o,subject:c});break;case"modify":t=f.formattedUser(e.get("author")),n=f.formattedUser(c),r=t===o?l10n.t("web_group_participant_changed_number_unknown_name",{name:o,new_number:n}):l10n.t("web_group_participant_changed_number",{name:o,old_number:t,new_number:n});break;default:d.log("wa:formatGroupNotification:unknown message subtype: "+a)()}else if("gp2"===i){var l,u=e.recipients,p=u?u.map(function(e){var t=Store.Contact.get(e);return t?t.get("formattedName"):f.formattedUser(e)}).join(l10n.t("enumeration_comma")):"",h=u?_.head(u):"",m=Store.Contact.get(h),g=m?m.get("formattedName"):h?f.formattedUser(h):"";switch(a){case"add":r=s?s===Store.Conn.me?l10n.t("web_group_participants_you_added_names",{participants:p}):h===Store.Conn.me?l10n.t("web_group_participants_name_added_you",{name:o}):l10n.t("web_group_participants_name_added_names",{name:o,participants:p}):h===Store.Conn.me?l10n.t("web_group_participant_added_you"):l10n.t("web_group_participant_added_name",{name:g});break;case"remove":r=s?s===Store.Conn.me?l10n.t("web_group_participants_you_removed_names",{participants:p}):h===Store.Conn.me?l10n.t("web_group_participants_name_removed_you",{name:o}):l10n.t("web_group_participants_name_removed_names",{name:o,participants:p}):h===Store.Conn.me?l10n.t("web_group_participant_removed_you"):l10n.t("web_group_participant_removed_name",{name:g});break;case"leave":r=h===Store.Conn.me?l10n.t("web_group_participant_left_you"):l10n.t("web_group_participant_left_name",{name:p});break;case"picture":r="remove"===c?s===Store.Conn.me?l10n.t("web_photo_removed_by_you"):l10n.t("web_photo_removed_by",{name:o}):s===Store.Conn.me?l10n.t("web_photo_changed_by_you"):l10n.t("web_photo_changed_by",{name:o});break;case"subject":r=s===Store.Conn.me?l10n.t("web_group_subject_changed_by_you",{subject:c}):l10n.t("web_group_subject_changed_by_name",{name:o,subject:c});break;case"modify":t=f.formattedUser(s),n=f.formattedUser(h),r=t===o?l10n.t("web_group_participant_changed_number_unknown_name",{name:o,new_number:n}):l10n.t("web_group_participant_changed_number",{name:o,old_number:t,new_number:n});break;case"create":r=s===Store.Conn.me?c?l10n.t("web_group_created_by_you",{subject:c}):l10n.t("web_group_created_by_you_no_subject"):c?l10n.t("web_group_created_by_name",{name:o,subject:c}):l10n.t("web_group_created_by_name_no_subject",{name:o});break;case"delete":r=s===Store.Conn.me?l10n.t("web_group_ended_you"):l10n.t("web_group_ended_name",{name:o});break;case"promote":l=u.length,r=1===l&&h===Store.Conn.me?l10n.t("web_group_participant_promoted_you"):l10n.t("web_group_participant_promoted_names",{count:l,participants:p,_plural:l});break;case"demote":l=u.length,r=1===l&&h===Store.Conn.me?l10n.t("web_group_participant_demoted_you"):l10n.t("web_group_participant_demoted_names",{count:l,participants:p,_plural:l});break;case"invite":r=h===Store.Conn.me?l10n.t("web_group_participant_join_via_invite_you"):l10n.t("web_group_participant_join_via_invite_name",{name:g});break;default:d.log("wa:formatGroupNotification:unknown message subtype: "+a)()}}return l10n.isRTL()&&(r=l10n.forceRTL(r)),r}function s(e,t){var n=e.mentionMap();if(n){var r=u.supportsFeature(u.F.RICH_TEXT)?[].concat(x,[new S(n)]):[new S(n)],i=m.parse(t,r);return m.serialize(i,new v)}return c(t)}function c(e){if(!u.supportsFeature(u.F.RICH_TEXT))return e;var t=m.parse(e,x);return m.serialize(t,new v)}var l=n(1287),u=n(104),d=n(1),p=n(86),h=n(143),f=n(24),m=n(1361),g=n(1229).TYPE,v=n(1540),y=n(1291),E=n(1307),b=n(1311),w=n(1306),M=n(1310),C=n(1537),S=n(1308),T=n(1539),k=n(1358),x=[new y,new E,new b,new w,new M];e.exports={formatBroadcastNotification:a,formatGroupNotification:o,formatE2ENotification:r,formatCallLog:i,asDesktopNotification:function(e){var t,n,c,u,f="",m=e.dir,v=Store.Mute.getGlobalPreviews();switch(e.from!==Store.Conn.me&&e.isGroupMsg&&(f=e.displayName()),e.type){case g.CHAT:if(v)t=s(e,e.body);else if(e.isGroupMsg)t=f?l10n.t("hidden_group_message_text_with_author",{author:f}):l10n.t("hidden_group_message_text"),f="";else{var y=e.chat;t=l10n.t("hidden_message_text",{unreadCount:l10n.n(y.unreadCount),_plural:y.unreadCount})}break;case g.IMAGE:c=p.hasEmoji?"📷 ":"",t=c+(v&&e.caption||l10n.t("web_conversations_most_recent_image"));break;case g.VIDEO:e.isGif?(c=p.hasEmoji?"👾 ":"",u=v&&e.caption||"GIF"):(c=p.hasEmoji?"🎥 ":"",u=v&&e.caption||l10n.t("web_conversations_most_recent_video"),u=u+" ("+h.durationStr(e.duration)+")"),t=c+" "+u;break;case g.PTT:c=p.hasEmoji?"🎤 ":"",t=c+" "+l10n.t("web_conversations_most_recent_voice")+" ("+h.durationStr(e.duration)+")";break;case g.AUDIO:c=p.hasEmoji?"🎵 ":"",t=c+" "+l10n.t("web_conversations_most_recent_audio")+" ("+h.durationStr(e.duration)+")";break;case g.LOCATION:c=p.hasEmoji?"📍 ":"",t=c+(v&&e.loc||l10n.t("web_conversations_most_recent_location"));break;case g.GROUP_NOTIFICATION:case g.GP2:t=o(e),f="";break;case g.BROADCAST_NOTIFICATION:n=e.subtype;var _=e.body;t=a(n,_);break;case g.NOTIFICATION:t=e.body;break;case g.VCARD:c=p.hasEmoji?"👤 ":"",t=c+(e.subtype||l10n.t("web_conversations_most_recent_contact"));break;case g.DOCUMENT:c=p.hasEmoji?"📄 ":"",t=c+(e.subtype||l10n.t("web_conversations_most_recent_file"));break;case g.E2E_NOTIFICATION:t=r(e);break;case g.CALL_LOG:t=i(e,!1);break;case g.CIPHERTEXT:t=l10n.t("placeholder_msg");break;case g.UNKNOWN:t=l10n.t("unsupported_msg");break;default:return d.error("asDesktopNotification: Unrecognized type "+e.type)(),""}var E=l10n.isRTL()?"rtl":"ltr",b="";if(b=h.relativeStr(e.t),f){var w=l.dir(f);return"ltr"!==E||m&&"ltr"!==m||w&&"ltr"!==w?"ltr"!==E||m&&"ltr"!==m?"ltr"!==E||w&&"ltr"!==w?"ltr"===E?(b&&(b="- ‪"+b+"‬‬"),"‫"+f+"‏: "+t+"‏"+b):m&&"rtl"!==m||w&&"rtl"!==w?m&&"rtl"!==m?w&&"rtl"!==w?(b&&(b="- ‪"+b+"‬‬"),"‪"+f+"‎: "+t+"‎"+b):(b&&(b=" - "+b),f+"‏: ‪"+t+"‬‏"):(b&&(b=" - "+b),"‏‪"+f+"‬: "+t+"‏"):(b&&(b=" - "+b),f+"‏: "+t+"‏"):(b&&(b=" - "+b),f+"‎: ‫"+t+"‬‎"):(b&&(b=" - "+b),"‎‫"+f+"‬: "+t+"‎"):(b&&(b=" - "+b),f+"‎: "+t+"‎")}return b?"ltr"===E?t+"‎‏ - ‪"+b+"‬":t+"‏‎ - ‫"+b+"‬":t},msgText:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];switch(e.type){case g.CIPHERTEXT:return l10n.t("placeholder_msg");case g.CHAT:return t?s(e,e.body):e.body;case g.IMAGE:return e.caption?t?s(e,e.caption):e.caption:l10n.t("web_conversations_most_recent_image");case g.VIDEO:return e.caption?t?s(e,e.caption):e.caption:e.isGif?"GIF":l10n.t("web_conversations_most_recent_video");case g.PTT:var n=h.durationStr(e.duration);return n?n:l10n.t("web_conversations_most_recent_voice");case g.AUDIO:return l10n.t("web_conversations_most_recent_audio");case g.LOCATION:return e.loc||l10n.t("web_conversations_most_recent_location");case g.GROUP_NOTIFICATION:case g.GP2:return o(e);case g.BROADCAST_NOTIFICATION:return a(e.subtype,e.body);case g.NOTIFICATION:return e.body;case g.VCARD:return e.subtype||l10n.t("web_conversations_most_recent_contact");case g.MULTI_VCARD:return k.getNameString(e.vcardList);case g.DOCUMENT:var c=e.pageCount>0?l10n.t("web_conversations_most_recent_document",{count:e.pageCount+"",_plural:e.pageCount}):null;return _.compact([e.caption||e.filename||l10n.t("web_conversations_most_recent_file"),c]).join(" • ");case g.E2E_NOTIFICATION:return r(e);case g.CALL_LOG:return i(e,!1);case g.UNKNOWN:return l10n.t("unsupported_msg");default:return""}},emojify:function(e){if(!u.supportsFeature(u.F.RICH_TEXT))return e;var t=[new y,new C((!0))],n=m.parse(e,t);return m.serialize(n,new T)}}},function(e,t,n){"use strict";var r=n(6),i=n(1246),a=n(1433),o=n(1229),s=n(44),c=n(143),l=n(8),u=n(104),d=r.createClass({displayName:"Meta",propTypes:{msg:r.PropTypes.instanceOf(o).isRequired},openInfoDrawer:function(){l.msgInfoDrawer(this.props.msg)},render:function(){var e,t,n=this.props.msg,l=n.broadcast||n.star?(n.type===o.TYPE.IMAGE||n.type===o.TYPE.VIDEO||n.type===o.TYPE.AUDIO)&&!n.caption:null;if(n.broadcast){var d=s("icon-s",{"icon-broadcast-light":l,"icon-broadcast":!l});e=r.createElement("span",{className:d})}if(n.star){var p=s("icon-s",{"icon-star-light":l,"icon-star":!l&&n.isSentByMe,"icon-star-in":!l&&!n.isSentByMe});t=r.createElement("span",{className:p})}var h=n.isSentByMe?r.createElement(a,{msg:this.props.msg}):null,f=n.isSentByMe&&u.supportsFeature(u.F.MESSAGE_INFO);return r.createElement("div",{className:f?"message-meta text-clickable":"message-meta",onClick:f?this.openInfoDrawer:null},t,e,r.createElement(i,null,r.createElement("span",{className:"message-datetime"},n.t?c.timestampStr(n.t):null)),h)}});e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(68),a=r(i),o=n(1302),s=a["default"].extend({extraProperties:"reject",props:{type:{type:"string",values:_.values(o.OUTWARD_TYPES),"default":o.OUTWARD_TYPES.UNKNOWN},mmsUrl:"string",mediaBlob:"object",encryptionKey:"string",uploadHash:"string",mediaStage:{type:"string",values:_.values(o.STAGE),"default":o.STAGE.INIT},size:"number",filehash:"string",mimetype:"string",renderableUrl:"string",thumbHeight:"number",thumbWidth:"number",fullHeight:"number",fullWidth:"number",preview:"string",sidecar:"array",duration:"string",isGif:"boolean",gifAttribution:"number",streamable:{type:"boolean","default":!1},filename:"string",pageCount:"number"}});s.TYPE=o.OUTWARD_TYPES,s.STAGE=o.STAGE,s.FIELDS_TO_MSG_PROPS=o.FIELDS_TO_MSG_PROPS,e.exports=s},function(e,t,n){"use strict";function r(e,t){this.list=e,this.index=-1,this.value=void 0,this.getter=t||function(e){return e}}var i=n(58);_.assign(r.prototype,i,{init:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=void 0,r=void 0;if(this.list=e,this.value){if(_.isEmpty(e))return void this.unset();if(n=_.indexOf(e,this.value),n>-1){if(n===this.index)return;r=!0,t=!1}else n=t&&this.index>-1?Math.min(Math.max(this.index,0),e.length-1):-1,r=n>-1;this.set(n,t,r)}},unset:function(){this.value&&this.trigger(this.getter(this.value),!1),this.value=void 0,this.index=-1},reset:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];this.index<0||this.value&&this.trigger(this.getter(this.value),"focus",e)},set:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=arguments.length<=2||void 0===arguments[2]||arguments[2];if(this.list.length){var r=Math.min(Math.max(e,-1),this.list.length-1),i=this.value,a=r>-1?this.list[r]:void 0;a?(this.trigger(this.getter(a),t?"focus":"select"),this.value=a):n&&(this.value=void 0),n&&i&&i!==a&&this.trigger(this.getter(i),!1),this.index=r}},getVal:function(){return this.value},setVal:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=_.indexOf(this.list,e);n>-1?this.set(n,t):(this.unset(),this.value=e)},setFirst:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];_.isEmpty(this.list)||this.set(0,e)},setLast:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];_.isEmpty(this.list)||this.set(this.list.length-1,e)},setPrev:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];_.isEmpty(this.list)||this.set(this.prev(),e)},setNext:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];_.isEmpty(this.list)||this.set(this.next(),e)},prev:function(){return _.isEmpty(this.list)?-1:this.index===-1?-1:this.index-1},next:function(){return _.isEmpty(this.list)?-1:Math.min(this.index+1,this.list.length-1)}}),e.exports=r},function(e,t,n){"use strict";var r=n(6),i=r.createClass({displayName:"HiddenToken",propTypes:{children:r.PropTypes.node.isRequired},render:function(){return r.createElement("span",{className:"hidden-token"},"⁠⁠⁠⁠",this.props.children,"⁠⁠⁠⁠⁠")}});e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){return++m}var a=n(1136),o=r(a),s=n(1),c=n(6),l=n(44),u=n(106),d=n(85),p=n(218),h={DEFAULT_PUSH:"flow-transition-drawer-push",DEFAULT_POP:"flow-transition-drawer-pop",NONE:"none"},f={PUSH:"push",POP:"pop"},m=0,g={getInitialState:function(){return{_stack:[],_activeKey:void 0,_transition:void 0}},defaultTransition:function(e){var t,n=_.isFunction(this.getDefaultTransition)?this.getDefaultTransition():{};return _.assign((t={},(0,o["default"])(t,f.PUSH,h.DEFAULT_PUSH),(0,o["default"])(t,f.POP,h.DEFAULT_POP),t),n)[e]},push:function(e){var t=arguments.length<=1||void 0===arguments[1]?this.defaultTransition(f.PUSH):arguments[1],n=this.state._stack.concat(e),r=i();this.setState({_stack:n,_transition:t,_activeKey:r})},pop:function(){var e=arguments.length<=0||void 0===arguments[0]?this.defaultTransition(f.POP):arguments[0],t=_.dropRight(this.state._stack);if(t.length){var n=i();this.setState({_stack:t,_transition:e,_activeKey:n})}else this.endFlow()},endFlow:function(e){this.context.uim.uie.requestDismiss(e)},render:function(){var e=this,t=this.state,n=t._stack,r=t._transition,i=t._activeKey,a=_.last(n);s.assert(!!a,"empty-flow",a)(),a=c.createElement(p,{displayName:"FlowDrawer"+i,key:i,escapable:!0,requestDismiss:function(){return e.pop()}},a);var o=l("flow-drawer-container");return c.createElement(u,{transitionName:r,className:o},a)}};g.Transition=h,g.Dir=f,g.contextTypes={uim:c.PropTypes.instanceOf(d)},e.exports=g},function(e,t,n){"use strict";function r(e,t){this.list=e,this.selected=_.reduce(e,function(e,t,n){return e[n]=!1,e},{}),this.getter=t||function(e){return e}}var i=n(58);_.assign(r.prototype,i,{init:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];if(!_.isEmpty(this.selected)){if(_.isEmpty(t))return void this.unsetAll();var n=_.reduce(t,function(t,n,r){var i=e.list.indexOf(n);t[r]=i>-1&&e.selected[i]},{});this.selected=n,this.list=t}},unsetAll:function(){var e=this;_.forEach(this.selected,function(t,n){t&&e.set(n,!1)})},reset:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0];_.forEach(this.selected,function(n,r){n&&e.trigger(e.getter(e.list[r]),!0,!0,t)})},set:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=arguments.length<=2||void 0===arguments[2]||arguments[2];if(this.list.length){var r=Math.min(Math.max(e,-1),this.list.length-1),i=r>-1?this.list[r]:void 0;i&&(this.selected[r]&&!t||!this.selected[r]&&t)&&(this.selected[r]=t,this.trigger(this.getter(i),t,n))}},setVal:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=arguments.length<=2||void 0===arguments[2]||arguments[2],r=_.indexOf(this.list,e);r===-1&&(r=this.list.length,this.list.push(e),this.selected[r]=!1),this.set(r,t,n)},setFirst:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];_.isEmpty(this.list)||this.set(0,!0,e)},setLast:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];_.isEmpty(this.list)||this.set(this.list.length-1,!0,e)},getSelected:function(){var e=this;return _.reduce(this.list,function(t,n,r){return e.selected[r]&&t.push(n),t},[])},isSelected:function(e){return!!this.selected[this.list.indexOf(e)]}}),e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return function(n){n?"function"==typeof n._getComponent?t[e]=n._getComponent():t[e]=n:t[e]=void 0}}Object.defineProperty(t,"__esModule",{value:!0}),t.HOCRef=void 0;var a=n(36),o=r(a),s=n(23),c=r(s),l=n(26),u=r(l),d=n(82),p=r(d),h=n(81),f=r(h);t.GetRef=i;var m=n(6),g=(t.HOCRef="component",function(e){function t(){return(0,c["default"])(this,t),(0,p["default"])(this,(0,o["default"])(t).apply(this,arguments))}return(0,f["default"])(t,e),(0,u["default"])(t,[{key:"_getComponent",value:function(){var e=this.refs.component;return"function"==typeof e._getComponent?e._getComponent():e}}]),t}(m.Component));t["default"]=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n,r){this.type=e,this.index=t,this.value=r,this.properties=n}function a(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function o(e){var t={};return e?(e.split(";").forEach(function(e){var n=e.split(/=/);if(1===n.length){var r=n[0];a(t,r.toLowerCase(),!0)}else if(2===n.length){var i=(0,p["default"])(n,2),o=i[0],s=i[1];a(t,o.toLowerCase(),s.toLowerCase())}}),t):t}function s(e){if(e)return e.replace(/^_\$!<([^>]*)>!\$_$/,"$1").replace(/\\,/,",").replace(/\\;/,";").replace(/\\\\/,"\\")}function c(e){var t={};return _.forEach(e,function(e,n){t[n]=_.sortBy(e,function(e){return e.index})}),t}var l=n(1140),u=r(l),d=n(146),p=r(d),h=n(0),f=n(24),m=/X-([^;:]+)(?:;[^:]+)*:(.+)/,g={"X-ABLabel":[/X-ABLabel(?:;([^:]+))*:(.+)/,1],ADR:[/ADR(?:;([^:]+))*:;;(.*);(.*);(.*);(.*);(.*)/,5],"X-ABADR":[/X-ABADR(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.*)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1],TEL:[/TEL(?:;([^:]+))*:(.+)/,1]},v={N:[/N(?:;([^:]+))*:([^;]*);([^;]*);([^;]*);([^;]*);(.*)/,5],FN:[/FN(?:;([^:]+))*:(.*)/,1],NICKNAME:[/NICKNAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-FIRST-NAME":[/X-PHONETIC-FIRST-NAME(?:;([^:]+))*:(.*)/,1],"X-PHONETIC-LAST-NAME":[/X-PHONETIC-LAST-NAME(?:;([^:]+))*:(.*)/,1],ORG:[/ORG(?:;([^:]+))*:([^;]*)(?:;(.*))*/,2],TITLE:[/TITLE(?:;([^:]+))*:(.*)/,1],TEL:[/TEL(?:;([^:]+))*:(.*)/,1],PHOTO:[/PHOTO(?:;([^:]+))*:(.*)/,1],BDAY:[/BDAY(?:;([^:]+))*:(.*)/,1],URL:[/URL(?:;([^:]+))*:(.+)/,1],EMAIL:[/EMAIL(?:;([^:]+))*:(.+)/,1]},y={getDate:function(e){var t=[/-([^-]*)-([^-]*)-([^-]*)/,/([^-]*)-([^-]*)-([^-]*)/],n=e;return _.forEach(t,function(t){var r=e.match(t);if(r){var i=!r[1].length||"1604"===r[1],a=i?"0000":r[1];return n=h(a+"-"+r[2]+"-"+r[3]).format("l"),i&&(n=n.replace(/[.,-\/\s]*0000[.,-\/\s]*/,"")),!1}}),n},getOrganizationString:function(e){var t=_.first(e.ORG),n=_.first(e.TITLE);if(t&&_.isArray(t.value)&&t.value.length>0){var r=null;n&&n.value&&(r=(""+n.value).trim());var i=(0,u["default"])(t.value),a=i[0],o=i.slice(1);o.push(a);
var s=o.map(function(e){return _.isString(e)?e.trim():""}).filter(function(e){return e.length}).join(l10n.t("enumeration_comma"));return(r||"")+(r&&r.length&&s.length?" - ":"")+s}return""},getType:function(e){var t={jabber:l10n.t("vcard_jabber"),"skype-username":l10n.t("vcard_skype"),skype:l10n.t("vcard_skype"),msn:l10n.t("vcard_msn"),aim:l10n.t("vcard_aim"),yahoo:l10n.t("vcard_yahoo"),icq:l10n.t("vcard_icq")},n=e.properties["X-ABLabel"]||t[e.type.toLowerCase()];if(n)return s(n);var r={TEL:[[["cell"],l10n.t("vcard_cell")],[["iphone"],l10n.t("vcard_iphone")],[["main"],l10n.t("vcard_main")],[["home","fax"],l10n.t("vcard_home_fax")],[["work","fax"],l10n.t("vcard_work_fax")],[["home"],l10n.t("vcard_home")],[["work"],l10n.t("vcard_work")],[["pager"],l10n.t("vcard_pager")],[[],l10n.t("vcard_home")]],EMAIL:[[["home"],l10n.t("vcard_home")],[["work"],l10n.t("vcard_work")],[["internet"],l10n.t("vcard_email")]],URL:[[["home"],l10n.t("vcard_home")],[["work"],l10n.t("vcard_work")]],ADR:[[["home"],l10n.t("vcard_home")],[["work"],l10n.t("vcard_work")]]};return n=e.type,_.forEach(r[e.type],function(t){if(t){var r=(0,p["default"])(t,2),i=r[0],a=r[1];if(0===_.difference(i,_.map(e.properties.type,function(e){return e.toLowerCase()})).length)return n=a,!1}}),n},vcardWAids:function(e){var t=[];return e&&e.TEL&&_.forEach(e.TEL,function(e){e.properties&&e.properties.waid&&e.properties.waid.length>0&&(t=t.concat(_.map(e.properties.waid,f.numberToWid)))}),t},thumbnailWAid:function(e){return _.find(e,function(e){return(Store.ProfilePicThumb.get(e)||{}).img})},parse:function(e){e=e.replace(/\n^[ \t]/gm,"").trim();var t=e.split(/\n/),n={},r={};if("BEGIN:VCARD"===t[0].trim()&&"VERSION:3.0"===t[1].trim()&&"END:VCARD"===_.last(t).trim()){for(var s=2;s<t.length-1;s++){var l=t[s],u=l.match(/item(\d+)\.(.*)/),d=u?u[2]:l,h=d.match(/([^:;]*)[:;].*/)[1],f=u?g:v,y=h,E=h,b=void 0,w=void 0;if(f[y]){var M=(0,p["default"])(f[y],2),C=M[0],S=M[1],T=d.match(C);T&&(b=o(T[1]),w=1===S?w=T[2]:T.slice(2,2+S))}else{var k=d.match(m);k&&(E="SERVICE",y=k[1],w=k[2],b={})}if(w)if(u){var x=u[1];r[x]?r[x].fields.push(new i(y,null,b,w)):r[x]={type:y,index:s,key:E,properties:b,value:w,fields:[]}}else a(n,E,new i(y,s,b,w))}return _.forEach(_.keys(r),function(e){var t=r[e],o=t.key,s=t.index,c=t.type,l=t.value,u=t.properties,d=t.fields;_.forEach(d,function(e){u[e.type]=e.value}),a(n,o,new i(c,s,u,l))}),c(n)}},vCardSerialize:function(e){return e.map(function(e){return e.line.replace(/(.{75,75})/g,"$1\n ").replace(/\n^-$/gm,"")}).join("\n")},thumbnail:function(e){if(e){e=e.replace(/\n^ /gm,"");var t=e.match(/^PHOTO;(BASE64|ENCODING=b;TYPE=image\/jpeg):(.*)$/m);return t?t[2]:void 0}},getName:function(e){var t=_.filter(e.formattedName.split(e.formattedShortName)),n=t.length?_.trim(t[0]):void 0,r=n?e.formattedShortName:e.formattedName;return this.cleanValue(n)+";"+this.cleanValue(r)+";;;"},cleanValue:function(e){return e?e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,"):""}};e.exports=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(37),c=n(219),l=n(1259),u=n(1237),d=n(1378),p=n(1230),h=n(141),f=n(44),m=n(1232),g=n(1268),v=n(84),y={SMALL:"small",DEFAULT:"default"},E=o.createClass({displayName:"Contact",mixins:[p,h],propTypes:{contact:o.PropTypes.instanceOf(c).isRequired,onClick:o.PropTypes.func,mouseDownAsClick:o.PropTypes.bool,onDelete:o.PropTypes.func,onContext:o.PropTypes.func,contextEnabled:o.PropTypes.func,contextMenu:o.PropTypes.bool,admin:o.PropTypes.bool,active:o.PropTypes.object,className:o.PropTypes.string,secondary:o.PropTypes.node,type:o.PropTypes.oneOf(_.values(y)),showNotifyName:o.PropTypes.bool,searchText:o.PropTypes.string},getInitialState:function(){var e=this.props.contact,t=this.props.active,n={formattedName:this.async("contact.formattedName"),pendingAction:this.async("contact.pendingAction"),active:!!t&&t.value===e,contextMenu:!1};return this.props.showNotifyName&&(n.notifyName=this.async("contact.notifyName")),n},componentWillMount:function(){this.props.active&&this.addObserver(this.props.active,this.props.contact.id.toString(),this.onActiveChange)},onActiveChange:function(e,t){if("focus"===e){var n=s.findDOMNode(this);v.focus(n),t&&g.scrollIntoViewIfNeeded(n)}this.setState({active:!!e})},contextEnabled:function(){return!1},onDelete:function(e){e.stopPropagation(),this.props.onDelete(e,this.props.contact)},onClick:function(e){_.isFunction(this.props.onClick)&&this.props.onClick(e,this.props.contact)},onMouseDown:function(e){0===e.button&&this.onClick(e)},onEnter:function(e){e.preventDefault(),e.stopPropagation(),this.onClick(e)},onContext:function(e){return this.state.contextMenu?void this.setState({contextMenu:!1}):(this.props.onContext(e,this.props.contact,this.onContextClose),void this.setState({contextMenu:!0}))},onContextClose:function(){this.setState({contextMenu:!1})},indicateFocus:function(e){if(!(Date.now()-(a["default"].flashFocus||0)>200)){var t=s.findDOMNode(this.refs.cell);Velocity(t,"stop"),Velocity(t,{backgroundColor:["#e9eaeb","#cbdde7"]},{duration:1300,easing:[.19,.69,.01,.99],complete:this.onBlur})}},onBlur:function(e){var t=s.findDOMNode(this.refs.cell);t&&(Velocity(t,"stop"),t.style.backgroundColor="")},render:function(){var e=this.props,t=e.contact,n=e.secondary,r=e.onContext,i=e.onDelete,s=e.contextEnabled,c=e.contextMenu,p=e.admin,h=e.showNotifyName,g=e.className;g=f("contact",g,{active:!!this.state.active});var v=void 0,_=void 0,E=void 0;if(!t.name&&h&&this.state.notifyName&&(E=o.createElement("span",{className:"ellipsify screen-name"},o.createElement(m,{className:"screen-name-text",direction:"auto",text:this.state.notifyName}))),p&&(_=o.createElement("div",{className:"chat-meta"},o.createElement("div",{className:"chat-marker chat-marker-admin"},l10n.t("web_group_admin")))),i){var b=f("icon",{"icon-x-alt-small":this.props.type===y.SMALL,"icon-x-alt":this.props.type!==y.SMALL});v=o.createElement("div",{className:"chat-controls"},o.createElement("button",{className:b,onClick:this.onDelete}))}n||(n=o.createElement(d,{status:t.status})),r&&(r=this.onContext);var w=this.props.type===y.SMALL?26:u.Size.DEFAULT,M=o.createElement("div",{className:"chat-avatar"},o.createElement(u,{id:t.id,size:w})),C={enter:this.onEnter},S=this.props.mouseDownAsClick;return o.createElement(a["default"],{handlers:C,onFocus:this.indicateFocus,onBlur:this.onBlur},o.createElement(l,{id:t.id,ref:"cell",className:g,contextEnabled:s||this.contextEnabled,contextMenu:c,pendingAction:this.state.pendingAction,detail:v,image:M,primary:this.state.formattedName,searchText:this.props.searchText,primaryDetail:_,secondary:n,secondaryDetail:E,onClick:S?null:this.onClick,onMouseDown:S?this.onMouseDown:null,onContext:r}))}});E.Type=y,e.exports=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=t.x||0,r=t.y||0;t.degrees&&(t.radians=t.degrees*(Math.PI/180)),e.translate(n,r),e.rotate(t.radians),e.translate(-n,-r)}function a(e,t,n){var r=e.getContext("2d"),i=r.getImageData(0,0,t,n);e.width=t,e.height=n,r.putImageData(i,0,0)}function o(e){var t=e.getContext("2d");t.fillStyle="rgb(247,247,247)",t.fillRect(0,0,e.width,e.height)}function s(e,t,n){var r=p.boundHeightWidth(e.height,e.width,n,t),i=r.width,a=r.height;if(i>e.width&&a>e.height)return e;var o=document.createElement("canvas"),s=o.getContext("2d");return o.width=i,o.height=a,s.drawImage(e,0,0,i,a),o}function c(e){var t=new g;return t.writeBytes(255,216,255,224,0,16,74,70,73,70,0),t.writeUint16(e.version),t.writeUint8(e.densityUnits),t.writeUint16(e.xDensity),t.writeUint16(e.yDensity),t.writeBytes(0,0),t.readByteArray()}function l(e,t,n,r,i){if(t>r||n>i)throw new Error("Image is too big and must be resized.");var a=new g(e),o=new g(e),s=new g,l=2,u=2,d=!1,p=!1,h=!1,f=!1,m=void 0,v={version:257,densityUnits:0,xDensity:1,yDensity:1};if(a.readUint8()!==E||a.readUint8()!==b.SOI)throw new Error("SOI marker not at the start of the file.");o.advance(l);for(var y=void 0;y||a.size();){if(void 0===y){var M=a.readUint8();if(M!==E)throw new Error("0x"+M.toString(16)+" is not a marker prefix.");y=a.readUint8()}switch(y){case b.APP0:if(p)m=a.readUint16(),o.advance(m+l),a.advance(a.size()-o.size());else{if(m=a.readUint16(),"JFIF\0"!==a.readString(5))throw new Error("APP0 marker missing 'JFIF' magic bytes.");f=!0,v.version=a.readUint16(),v.densityUnits=a.readUint8(),v.xDensity=a.readUint16(),v.yDensity=a.readUint16(),o.advance(m+l),a.advance(a.size()-o.size()),p=!0}break;case b.SOS:if(!h&&!f)throw new Error("Missing magic bytes marker.");a.advance(a.readUint16()-u);for(var C=void 0,S=void 0,T=a.readUint8();a.size();){if(S=a.readUint8(),C=T===E&&_.indexOf(w,S)===-1){y=S;break}T=S}s.writeByteArray(o.readByteArray(o.size()-a.size()-l));continue;case b.APP1:if(m=a.readUint16(),!h&&"Exif\0\0"!==a.readString(6))throw new Error("APP1 marker missing 'EXIF' magic bytes.");h=!0,o.advance(m+l),a.advance(a.size()-o.size());break;case b.APP13:case b.COM:if(!h&&!f)throw new Error("Missing magic bytes marker.");m=a.readUint16(),o.advance(m+l),a.advance(a.size()-o.size());break;case b.EOI:if(!h&&!f)throw new Error("Missing magic bytes marker.");d=!0,s.writeByteArray(o.readByteArray(l));break;case b.SOF0:case b.SOF1:case b.SOF2:case b.SOF3:case b.SOF5:case b.SOF6:case b.SOF7:case b.SOF9:case b.SOF10:case b.SOF11:case b.SOF13:case b.SOF14:case b.SOF15:case b.DQT:case b.DHT:case b.DRI:if(!h&&!f)throw new Error("Missing magic bytes marker.");m=a.readUint16(),s.writeByteArray(o.readByteArray(l+m)),a.advance(a.size()-o.size());break;case b.APP2:case b.APP3:case b.APP4:case b.APP5:case b.APP6:case b.APP7:case b.APP8:case b.APP9:case b.APP10:case b.APP11:case b.APP12:case b.APP14:case b.APP15:throw new Error("Received unexpected APP marker 0x"+y.toString(16));default:throw new Error("Did not understand marker: 0x"+y.toString(16))}if(y=void 0,d)break}if(!d)throw new Error("No EOI tag found.");var k=c(v);return new Blob([k,s.readByteArray()],{type:"image/jpeg"})}var u=n(2),d=r(u),p=n(1356),h=n(1146),f=n(439),m=n(14),g=n(13),v=n(1),y=n(1357),E=255,b={SOF0:192,SOF1:193,SOF2:194,SOF3:195,DHT:196,SOF5:197,SOF6:198,SOF7:199,SOF9:201,SOF10:202,SOF11:203,SOF13:205,SOF14:206,SOF15:207,RST0:208,RST1:209,RST2:210,RST3:211,RST4:212,RST5:213,RST6:214,RST7:215,SOI:216,EOI:217,SOS:218,DQT:219,DRI:221,APP0:224,APP1:225,APP2:226,APP3:227,APP4:228,APP5:229,APP6:230,APP7:231,APP8:232,APP9:233,APP10:234,APP11:235,APP12:236,APP13:237,APP14:238,APP15:239,COM:254},w=[0,b.RST0,b.RST1,b.RST2,b.RST3,b.RST4,b.RST5,b.RST6,b.RST7],M={DATA_URL:1,BLOB:2,CANVAS:4,generateVideoThumbAndDuration:function(e,t,n){return y.video(e,!0).then(function(e){var r=e.video,i=e.fullWidth,a=e.fullHeight,o=document.createElement("canvas"),s=p.boundHeightWidth(a,i,n,t);o.width=s.width,o.height=s.height;var c=o.getContext("2d");return c.drawImage(r,0,0,s.width,s.height),{duration:~~r.seekable.end(0),thumb:{url:o.toDataURL("image/jpeg"),width:s.width,height:s.height,fullWidth:i,fullHeight:a}}})},crop:function(e,t,n,r,i,a,o){var s=this,c=arguments.length<=7||void 0===arguments[7]?M.DATA_URL:arguments[7],l=e instanceof HTMLCanvasElement?d["default"].resolve(e):y.loadImage(e);return l.then(function(e){var l=document.createElement("canvas"),u=l.getContext("2d");a&&o?(l.height=o,l.width=a,u.drawImage(e,t,n,r,i,0,0,a,o)):(l.height=i,l.width=r,u.drawImage(e,t,n,r,i));var p={};return s.getImagePromises(p,l,c),d["default"].props(p).then(function(e){return{images:e,width:r,height:i}})})},generateLinkPreview:function(e){return y.loadImage(e).then(function(e){var t=100,n=140;if(e.width<t||e.height<t)return null;var r=document.createElement("canvas"),i=r.getContext("2d");r.height=n,r.width=n;var a=Math.min(e.width,e.height),o=(e.width-a)/2,s=(e.height-a)/2;return i.drawImage(e,o,s,a,a,0,0,n,n),r.toDataURL("image/jpeg").replace(/^data:image\/jpeg;base64,/,"")})["catch"](function(){return null})},resizeDataURI:function(e,t,n){return y.loadImage(e).then(function(e){var r=document.createElement("canvas"),i=p.boundHeightWidth(e.height,e.width,n,t);r.width=i.width,r.height=i.height;var a=r.getContext("2d");return a.drawImage(e,0,0,i.width,i.height),r.toDataURL("image/jpeg")})},getImagePromises:function(e,t,n){!e.blob&&n&this.BLOB&&(e.blob=this.canvasToBlob(t)),!e.dataUrl&&n&this.DATA_URL&&(e.dataUrl=d["default"].resolve(t.toDataURL("image/jpeg"))),!e.canvas&&n&this.CANVAS&&(e.canvas=d["default"].resolve(t))},rotateAndResize:function(e,t,n){var r=this,c=arguments.length<=3||void 0===arguments[3]?M.BLOB:arguments[3],u=e instanceof HTMLCanvasElement,m=void 0,g=void 0,_=void 0;return u?(g=d["default"].resolve(e),_=d["default"].resolve(null)):(m=window.URL.createObjectURL(e),g=y.loadImage(m),_=f.blobToArrayBuffer(e)),d["default"].props({buffer:_,image:g}).then(function(e){var u=e.buffer,f=e.image,m={};try{m=h(u)}catch(g){}var y=0;switch(m.orientation||"UNKNOWN"){case"right-top":y=1;break;case"left-bottom":y=-1;break;case"bottom-right":y=2}var _=document.createElement("canvas"),E=f.naturalWidth||f.width,b=f.naturalHeight||f.height,w=_.getContext("2d"),C={};if(y)switch(y){case 1:case-1:var S=Math.max(E,b),T=S/2;_.width=_.height=S,o(_),i(w,{x:T,y:T,degrees:90*y}),1===y?w.drawImage(f,0,S-b):w.drawImage(f,S-E,0),i(w,{x:T,y:T,degrees:y*-90}),a(_,b,E);var k=s(_,t,n);return r.getImagePromises(C,k,c),d["default"].props(C).then(function(e){return{width:k.width,height:k.height,images:e}});case 2:var x=p.boundHeightWidth(b,E,n,t),E=_.width=x.width,b=_.height=x.height;return o(_),i(w,{x:E/2,y:b/2,degrees:90*y}),w.drawImage(f,0,0,E,b),i(w,{x:E/2,y:b/2,degrees:y*-90}),r.getImagePromises(C,_,c),d["default"].props(C).then(function(e){return{width:_.width,height:_.height,images:e}})}else{var N=function(){var e=void 0,i=void 0,a=c&M.BLOB;if(u&&a)try{var s=l(u,E,b,t,n);C.blob=s,a=!1,e=E,i=b}catch(h){v.log("Could not parse JPEG: "+h.message)()}if(a||c&~M.BLOB){var m=p.boundHeightWidth(b,E,n,t);_.width=m.width,_.height=m.height,e=_.width,i=_.height,o(_),w.drawImage(f,0,0,e,i),r.getImagePromises(C,_,c)}return{v:d["default"].props(C).then(function(t){return{width:e,height:i,images:t}})}}();if("object"==typeof N)return N.v}})["finally"](function(){m&&window.URL.revokeObjectURL(m)})},canvasToBlob:function(e){arguments.length<=1||void 0===arguments[1]?"image/jpeg":arguments[1];return e.toBlob?new d["default"](function(t){e.toBlob(t,"image/jpeg")}):d["default"].resolve(window.dataURLtoBlob(e.toDataURL("image/jpeg")))},urlToFile:function(e){var t=this;return y.loadImage(e).then(function(e){var n=document.createElement("canvas");n.width=e.naturalWidth,n.height=e.naturalHeight;var r=n.getContext("2d");return o(n),r.drawImage(e,0,0),t.canvasToBlob(n)})["catch"](function(){return d["default"].reject(new m.MediaDragDropError("unable to render image",e))})},isCached:function(e){if(!e)return!1;var t=new Image;return t.src=e,!!t.complete},loadImage:y.loadImage};e.exports=M},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n,r){this.key=e,this.src=t,this.crossOrigin=n,this.noXHR=r,this.isHttp="/"===t[0]||k.isHttp(t),this.hasPrivacyChecks=!0,this.promise=null,this.retainCount=0,this.generation=0}function a(e){var t=e.src,n=e.crossOrigin,r=e.noXHR,a=e.hasPrivacyChecks;n=!!n,r=!!r;var o="CO:"+(n?"y":"n")+",XHR:"+(r?"y":"n")+","+t,s=A[o];if(s)return s.retainCount++,s.generation=0,a||(s.hasPrivacyChecks=!1),s;var l=new i(o,t,n,r);return A[o]=l,l.retainCount++,l.promise=c["default"].loop(function(e){var n=l.generation++;if(n>D)throw new T.GaveUpRetry("Too many image retries "+l.src);return c["default"].delay(Math.floor(1e3*x.expBackoff(n,60,0))).then(function(){return l.hasPrivacyChecks&&!w.phoneActive&&n>0?C.waitForBBEvent(w,"change:phoneActive",O.matches({phoneActive:!0})):M.waitForOnline}).cancellable().then(function(){return!(0!==n&&l.isHttp&&!l.noXHR)||S.get(t).timeout(3e4,"imageTagRetryTimeout").then(function(e){var t=e.status;if(t>=200&&t<400)return!0;if(t>=500)return!1;throw new T.ServerStatusError(null,l.src,t)},function(){return!1})}).then(function(t){if(t)return P.loadImage(l.src,l.crossOrigin).then(e)["catch"](function(){if(!l.isHttp)throw new T.ImageError("Invalid Data URI",l.src)})})}).cancellable()["finally"](function(){l===A[l.key]&&delete A[l.key]}),l}function o(e){--e.retainCount<=0&&e.promise.cancel()}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var s=n(2),c=r(s),l=n(36),u=r(l),d=n(23),p=r(d),h=n(26),f=r(h),m=n(82),g=r(m),v=n(81),y=r(v),_=n(1455),E=r(_),b=n(6),w=n(107),M=n(108),C=n(56),S=n(147),T=n(14),k=n(88),x=n(90),N=n(10),P=n(1252),O=n(38),D=10,A={},I=function(e){function t(e){(0,p["default"])(this,t);var n=(0,g["default"])(this,(0,u["default"])(t).call(this,e));return n.state=n._initSrc(e),n}return(0,y["default"])(t,e),(0,f["default"])(t,[{key:"componentWillReceiveProps",value:function(e){this.props.src!==e.src&&this.setState(this._initSrc(e))}},{key:"_initSrc",value:function(e){var t=e.src;if(t){if(P.isCached(t))return{src:t};this.ensureLoaded(e)}return{src:null}}},{key:"componentWillUnmount",value:function(){this.ensureLoadedQuery&&o(this.ensureLoadedQuery)}},{key:"ensureLoaded",value:function(e){var t=this,n=this.ensureLoadedQuery,r=this.ensureLoadedQuery=a(e);n&&o(n),n!==r&&r.promise.checkpoint(this.props.rejectOnUnmount()).then(function(){r===t.ensureLoadedQuery&&(t.setState({src:t.props.src}),t.props.onLoaded&&t.props.onLoaded())})["catch"](T.ImageError,T.ServerStatusError,T.GaveUpRetry,function(e){r===t.ensureLoadedQuery&&(t.props.rejectOnUnmount().isRejected()||t.props.onError&&t.props.onError(e))})["catch"](T.Unmount,c["default"].CancellationError,O.noop)}},{key:"render",value:function(){var e=this.state.src,t=this.props,n=t.onLoad,r=t.alt,i=t.onClick,a=t.onMouseMove,o=t.style,s=t.className,c=t.draggable;return e||(e=N.ONE_BY_ONE_TRANS_GIF,n=void 0),c=!!c,b.createElement("img",{src:e,alt:r,onLoad:n,onClick:i,onMouseMove:a,style:o,draggable:c,className:s})}}]),t}(b.Component);I.defaultProps={crossOrigin:!0};t.Component=I;t["default"]=(0,E["default"])(I)},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(142),o=n(44),s={CONTAIN:"contain",COVER:"cover",SCALE_DOWN:"scaleDown",ZOOM_IN:"zoomIn"},c=r.createClass({displayName:"ObjectFit",mixins:[a],propTypes:{children:r.PropTypes.node.isRequired,type:r.PropTypes.oneOf(_.values(s)).isRequired,size:r.PropTypes.shape({width:r.PropTypes.number.isRequired,height:r.PropTypes.number.isRequired}),style:r.PropTypes.object,zoomIn:r.PropTypes.shape({factor:r.PropTypes.number,translateX:r.PropTypes.number,translateY:r.PropTypes.number}),onObjectLoad:r.PropTypes.func},statics:{TYPES:s},getInitialState:function(){return{style:this.props.size,className:"object-fit",computed:!1}},componentDidMount:function(){if(!this.shouldUseNativeObjectFit()){this.initialize();var e=this;this.regNativeListener(window,"resize",function(){e.initialize()})}},componentWillReceiveProps:function(e){this.initialize(e)},initialize:function(e){var t=this;this.shouldUseNativeObjectFit()||(e=e||this.props,e.size&&this.setState(this[e.type](e.size.width,e.size.height,e.zoomIn),function(){_.isFunction(t.props.onObjectLoad)&&t.props.onObjectLoad(t.refs.object.firstChild)}))},shouldUseNativeObjectFit:function(){return!1},cover:function(e,t){var n=i.findDOMNode(this),r=n.clientWidth,a=n.clientHeight,o=e,s=t,c=0,l=0;return o!==r&&(s*=r/o,o=r,s>a&&(c=a/2-s/2)),s<a&&(o*=a/s,s=a,o>r&&(l=r/2-o/2)),{style:{width:o,height:s,top:c,left:l,position:"absolute"},className:"object-fit object-fit-cover",computed:!0}},contain:function(e,t){var n=i.findDOMNode(this),r=n.clientWidth,a=n.clientHeight,o=e,s=t,c=0,l=0,u=o/r,d=s/a;return u>d?(s*=r/o,o=r,s<a&&(c=a/2-s/2)):(o*=a/s,s=a,o<r&&(l=r/2-o/2)),{style:{width:o,height:s,top:c,left:l,position:"absolute"},className:"object-fit object-fit-contain",computed:!0}},scaleDown:function(e,t){var n=i.findDOMNode(this),r=n.clientWidth,a=n.clientHeight,o=t,s=e;return o>a&&(o=a,s=e*(a/t)),s>r&&(s=r,o=t*(r/e)),{style:{width:s,height:o},className:"object-fit object-fit-scaledown",computed:!0}},zoomIn:function(e,t,n){var r=this.scaleDown(e,t);return r.className+=" object-fit-zoomin",r.style.transition="transform 300ms cubic-bezier(.1,.82,.25,1)",n&&(r.style.transform="translateX("+n.translateX+"px) translateY("+n.translateY+"px) scale("+n.factor+")"),r},render:function(){if(this.shouldUseNativeObjectFit())return r.createElement("div",{className:"native-scale-down"},this.props.children);var e=this.state.computed?this.state.style:{visibility:"hidden"};return r.createElement("div",{style:this.props.style,className:o(this.state.className)},r.createElement("div",{style:e,ref:"object"},this.props.children))}});e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(36),s=r(o),c=n(23),l=r(c),u=n(26),d=r(u),p=n(82),h=r(p),f=n(81),m=r(f),g=n(6),v=r(g),y=n(1249),_=r(y),E=n(38),b=r(E),w=n(221),M=r(w),C=n(1),S=r(C),T=n(8),k=r(T);e.exports=function(e){var t,n,r;return n=t=function(t){function n(){var e,t,i,a;(0,l["default"])(this,n);for(var o=arguments.length,c=Array(o),u=0;u<o;u++)c[u]=arguments[u];return t=i=(0,h["default"])(this,(e=(0,s["default"])(n)).call.apply(e,[this].concat(c))),r.call(i),a=t,(0,h["default"])(i,a)}return(0,m["default"])(n,t),(0,d["default"])(n,[{key:"componentDidMount",value:function(){var e=this;this.mounted=!0;var t=this.listeners;this.listeners=[],t.forEach(function(t){e._addListener(t.source,t.event,t.cb,t.capture,t.wrapped)})}},{key:"componentWillUnmount",value:function(){var e=this;this.mounted=!1,this.listeners.forEach(function(t){e._removeListener(t.source,t.event,t.cb,t.capture,t.wrapped)}),this.listeners=[]}},{key:"render",value:function(){return v["default"].createElement(e,(0,a["default"])({ref:y.HOCRef,addListener:this.addListener,addListenerOnce:this.addListenerOnce,addListenerAndRun:this.addListenerAndRun,removeListener:this.removeListener,uiIdle:this.uiIdle},this.props))}},{key:"listeners",get:function(){return this._listeners||(this._listeners=[]),this._listeners},set:function(e){this._listeners=e}}]),n}(_["default"]),r=function(){var e=this;this.mounted=!1,this.rr=function(){e.setState({})},this._addListener=function(t,n){var r=arguments.length<=2||void 0===arguments[2]?e.rr:arguments[2],i=arguments[3],a=arguments[4];if(e.listeners.push({source:t,event:n,cb:r,capture:i,wrapped:a}),e.mounted){var o=a||r;if("function"==typeof t.on)t.on(n,o),"number"==typeof t._uiObservers&&t._uiObservers++;else{var s=M["default"].prefix(n,t);t.addEventListener(s,o,i)}}},this.addListener=this._addListener,this.addListenerAndRun=function(t,n){var r=arguments.length<=2||void 0===arguments[2]?e.rr:arguments[2],i=arguments[3];e.addListener(t,n,r,i),r()},this.addListenerOnce=function(t,n){var r=arguments.length<=2||void 0===arguments[2]?e.rr:arguments[2],i=arguments[3],a=function(){r.apply(void 0,arguments),e.removeListener(t,n,r,i)};e._addListener(t,n,r,i,a)},this.uiIdle=function(t){k["default"].uiBusy?e.addListenerOnce(k["default"],"ui_idle",function(){t()}):t()},this.removeListener=function(t,n){var r=arguments.length<=2||void 0===arguments[2]?e.rr:arguments[2],i=arguments[3],a=b["default"].find(e.listeners,{source:t,event:n,cb:r,capture:i});a?(e.listeners=b["default"].reject(e.listeners,a),e._removeListener(t,n,r,i,a.wrapped)):S["default"].error("ListenerHOC:removeListener could not find event: "+n)()},this._removeListener=function(t,n){var r=arguments.length<=2||void 0===arguments[2]?e.rr:arguments[2],i=arguments[3],a=arguments[4],o=a||r;if("function"==typeof t.off)t.off(n,o),"number"==typeof t._uiObservers&&t._uiObservers--;else{var s=M["default"].prefix(n,t);t.removeEventListener(s,o,i)}}},n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(438),s=r(o),c=n(6),l=n(437),u=n(1298),d=n(44),p=c.createClass({displayName:"DrawerSection",propTypes:{children:c.PropTypes.node.isRequired,title:c.PropTypes.node,subtitle:c.PropTypes.node,titleOnClick:c.PropTypes.func,footer:c.PropTypes.node,classes:c.PropTypes.string,onMouseDown:c.PropTypes.func,noContainer:c.PropTypes.bool,a8n:c.PropTypes.string},getDefaultProps:function(){return{noContainer:!1}},render:function(){var e=this.props,t=e.children,n=e.title,r=e.subtitle,i=e.footer,o=e.classes,p=e.onMouseDown,h=e.noContainer,f=e.titleOnClick,m=e.a8n,g=(0,s["default"])(e,["children","title","subtitle","footer","classes","onMouseDown","noContainer","titleOnClick","a8n"]),v=d(o,"drawer-section",{well:!!n});if(!n)return c.createElement("div",{className:v},t);var y=r?r:null,_=t;return!h&&_&&(_=c.createElement("div",{className:"drawer-section-body"},t)),c.createElement("div",(0,a["default"])({className:v,onMouseDown:p},g),c.createElement(u,{classes:"drawer-section-title",side:y,ellipsify:!0,"data-a8n":l.key(m),onClick:f},n),_,i)}});e.exports=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(234),a=r(i),o=n(1138),s=r(o),c=n(434),l=r(c);e.exports={},e.exports.matchAll=function(e,t,n){for(var r=[],i=void 0;i=e.exec(t);){var a=n?n(i,e):i;a&&r.push(a)}return r};var u=n(44),d=n(6),p=d.createElement,h=0,f=function(e){return function(t,n,r){return p(e,(0,l["default"])({key:"k-"+h++},r),n)}},m=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(function(e){return!!e});return function(){var e=arguments.length<=0||void 0===arguments[0]?new s["default"]:arguments[0],t=arguments[1],n=arguments[2];return r.reduce(function(r,i){var o=i(e,t,n)||{},s=u(r.className,o.className);return(0,a["default"])(r,o,s?{className:s}:{})},{})}},g=function(e,t){return function(n,r,i){return e(n,r,t(i,n,r))}},v=function(e,t){return m(function(e){return e.get("default")},function(t){return t.get(e)},t)},y=function(e,t,n){return g(f(e),v(t,n))};e.exports.jsx={make:y}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(23),a=r(i),o=n(26),s=r(o),c=n(1141),l=function(){function e(){(0,a["default"])(this,e)}return(0,s["default"])(e,[{key:"match",value:function(e){c(!1,"Subclasses of `Mutator` must implement `match(text)`")}},{key:"mutate",value:function(e,t){return e}},{key:"group",get:function(){return 0}},{key:"isFragment",get:function(){return!1}},{key:"isFormatter",get:function(){return!1}},{key:"alwaysApply",get:function(){return!1}},{key:"formatResult",get:function(){return!0}},{key:"mutates",get:function(){return this.mutate!==e.prototype.mutate}}]),e}();e.exports=l},function(e,t,n){"use strict";var r=n(6),i=n(1232),a=n(144),o=n(1230),s=n(1137),c=n(106),l=n(44),u=r.createClass({displayName:"Cell",mixins:[o,s],propTypes:{id:r.PropTypes.string,contextEnabled:r.PropTypes.func.isRequired,pendingAction:r.PropTypes.number,contextMenu:r.PropTypes.bool,className:r.PropTypes.string,style:r.PropTypes.object,image:r.PropTypes.node,detail:r.PropTypes.node,primary:r.PropTypes.string,searchText:r.PropTypes.string,primaryDetail:r.PropTypes.node,secondary:r.PropTypes.node,secondaryDetail:r.PropTypes.node,isPSA:r.PropTypes.bool,onClick:r.PropTypes.func,onContext:r.PropTypes.func,onMouseDown:r.PropTypes.func},getInitialState:function(){return{hover:!1,contextMenu:!1}},componentWillUpdate:function(e){this.props.contextMenu&&this.state.contextMenu&&!e.contextMenu&&this.setState({contextMenu:!1})},onMenuClick:function(e){this.props.contextEnabled()&&(e.stopPropagation(),e.preventDefault(),this.props.onContext({anchor:e.target}))},onMenuMouseDown:function(e){e.stopPropagation()},onContextMenu:function(e){this.props.contextEnabled()&&(e.stopPropagation(),e.preventDefault(),this.props.onContext({event:e}))},openContextMenu:function(){var e=this;this.props.contextEnabled()&&this.setState({contextMenu:!0},function(){e.refs.context.click()})},mouseOver:function(){this.state.hover||this.props.contextMenu||!this.props.contextEnabled()||this.setState({hover:!0})},mouseEnter:function(){this.state.hover||this.props.contextMenu||!this.props.contextEnabled()||this.setState({hover:!0})},mouseLeave:function(){this.state.hover&&this.setState({hover:!1})},render:function(){var e=this.props.contextMenu||this.state.contextMenu,t=e||this.state.hover,n=l(this.props.className,{chat:!0,hover:t}),o=null,s=null;this.props.pendingAction?s=r.createElement("div",{className:"btn-context icon-spinner"},r.createElement(a,{size:18,stroke:6})):t&&(o=r.createElement("span",{className:"icon icon-down btn-context",key:"icon-context",ref:"context",onMouseDown:this.onMenuMouseDown,onClick:this.onMenuClick}));var u=this.props.detail?r.createElement("div",{className:"chat-body chat-detail"},this.props.detail):null,d=null,p="chat-title";this.props.isPSA&&(d=r.createElement("span",{className:"icon-psa-verified"}),p+=" chat-title-psa");var h=this.props.primary?r.createElement("div",{className:p},r.createElement(i,{text:this.props.primary,direction:"auto",highlight:this.props.searchText?[this.props.searchText]:null,titlify:!0,ellipsify:!0}),d):null;return r.createElement("div",{className:n,style:this.props.style,onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onContextMenu:this.props.contextEnabled()?this.onContextMenu:null,onMouseEnter:this.state.hover?null:this.mouseEnter,onMouseOver:this.state.hover?null:this.mouseOver,onMouseLeave:this.state.hover?this.mouseLeave:null},this.props.image,r.createElement("div",{className:"chat-body"},r.createElement("div",{className:"chat-main"},h,this.props.primaryDetail),r.createElement("div",{className:"chat-secondary"},this.props.secondary,r.createElement("div",{className:"chat-meta"},this.props.secondaryDetail,r.createElement(c,{transitionName:"pop"},s),r.createElement(c,{transitionName:"pop-fast-chat"},t?o:null)))),u)}});e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(1444),c=n(1334),l=n(106),u=n(442),d=n(44),p=n(144),h=n(1292),f=n(218),m=n(1261),g=o.createClass({displayName:"TextInput",propTypes:{placeholder:o.PropTypes.string,value:o.PropTypes.string,error:o.PropTypes.string,lowProfile:o.PropTypes.bool,multiline:o.PropTypes.bool,supportsEmoji:o.PropTypes.bool,onChange:o.PropTypes.func.isRequired,onBlur:o.PropTypes.func,onFocus:o.PropTypes.func,onEnter:o.PropTypes.func,onFiles:o.PropTypes.func,maxLength:o.PropTypes.number,showRemaining:o.PropTypes.bool,editable:o.PropTypes.bool,spellCheck:o.PropTypes.bool,focusOnMount:o.PropTypes.bool,className:o.PropTypes.oneOfType([o.PropTypes.string,o.PropTypes.arrayOf(o.PropTypes.string),o.PropTypes.objectOf(o.PropTypes.bool)]),lockable:o.PropTypes.bool,pending:o.PropTypes.bool,onCancel:o.PropTypes.func,onSave:o.PropTypes.func,onError:o.PropTypes.func,validate:o.PropTypes.func},getDefaultProps:function(){return{maxLength:25,editable:!0}},getInitialState:function(){return{active:!1,locked:this.props.lockable,emojiPicker:!1}},componentDidMount:function(){this.props.focusOnMount&&this.restoreFocus()},onEmojiPicker:function(e){e&&(e.preventDefault(),e.stopPropagation());var t=o.createElement(c,{onEmoji:this.onEmoji,onFocusRelease:this.restoreFocus});this.setState({emojiPicker:{menu:t,menuDirection:{y:u.Direction.Y.TOP},type:u.Type.EMOJI_PICKER,anchor:e.target}}),this.restoreFocus()},emojiPickerClose:function(){this.setState({emojiPicker:!1})},restoreEmojiPickerFocus:function(){this.refs.emojiPickerUIE&&this.refs.emojiPickerUIE.getRef()&&this.refs.emojiPickerUIE.getRef().getElement()&&this.refs.emojiPickerUIE.getRef().getElement().restoreFocus()},onEmoji:function(e){this.refs.inputLine.restoreFocus(!1),this.refs.inputLine.replaceSelection(e)},onEnter:function(){this.props.lockable&&this.onSaveAndLock(),this.props.onEnter&&!this.props.multiline&&this.props.onEnter()},onChange:function(e){this.props.onChange&&this.props.onChange(e)},restoreFocus:function(){this.refs.inputLine&&this.refs.inputLine.restoreFocus()},onBlur:function(e){this.state.active&&this.setState({active:!1}),this.props.onBlur&&this.props.onBlur(e)},onFocus:function(e){e.stopPropagation(),this.state.active||this.setState({
active:!0}),this.props.onFocus&&this.props.onFocus(e);var t=this.refs.uiTextInput;t&&t.raiseToTop()},onUnlock:function(e){this.setState({locked:!1})},onSaveAndLock:function(e){var t=!(!this.props.lowProfile&&this.props.error);this.props.validate&&t&&(t=this.props.validate(this.props.value)),t?(this.props.onSave&&this.props.onSave(),this.setState({locked:!0})):this.props.onError&&this.props.onError()},onCancel:function(){this.props.onCancel&&this.props.onCancel(),this.setState({locked:!0})},render:function(){var e=this.props.editable&&!this.state.locked,t=e&&!!this.props.error&&!this.props.lowProfile,n=h.multibyteLength(this.props.value||""),r=this.props.maxLength-n<50&&e,i={container:d("text-input",this.props.className,{"no-placeholder":!this.props.placeholder,active:e}),label:d("label-text",{"label-text-float":!!this.props.value}),inputWrapper:d("input-wrapper",{"input-text-error":t,"input-text-active":this.state.active,locked:this.state.locked}),infoWrapper:d("input-info-strip",{"input-text-error":t,"input-text-active":this.state.active})},c=this.props.showRemaining?o.createElement("div",{className:"control-button-container char-counter"},o.createElement("div",{className:"char-counter"},r?this.props.maxLength-n:null)):null,u=e&&this.props.supportsEmoji?o.createElement("button",{className:"icon icon-emoji icon-emoji-input",onClick:this.onEmojiPicker}):void 0,g=void 0;this.props.lockable&&(this.props.pending?g=o.createElement("div",{className:"icon icon-spinner"},o.createElement(p,{size:18,stroke:6})):this.state.locked?this.props.editable&&(g=o.createElement("span",{className:"lock-icon icon icon-pencil",onClick:this.onUnlock,key:"btn-edit",title:l10n.t("edit_button")})):g=o.createElement("span",{className:"lock-icon icon icon-checkmark",onClick:this.onSaveAndLock,key:"btn-done",title:l10n.t("click_to_save_esc_to_cancel")}),g=o.createElement(l,{transitionName:"pop",component:"div",className:"control-button-container"},g));var v=this.props.lowProfile?null:o.createElement("div",{className:i.infoWrapper},o.createElement("div",{className:"error-text"},t?this.props.error:null)),y=void 0;if(this.props.lockable&&!this.state.locked){var _=void 0;this.state.emojiPicker&&(_=o.createElement(f,{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:"emojiPickerUIE",requestDismiss:this.emojiPickerClose,requestFocus:this.restoreEmojiPickerFocus},o.createElement(m,{contextMenu:this.state.emojiPicker}))),y=o.createElement(f,{displayName:"TextInput",escapable:!0,requestFocus:this.restoreFocus,requestDismiss:this.onCancel},o.createElement("div",null,_))}else!this.props.lockable&&this.state.emojiPicker&&(y=o.createElement(f,{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:"emojiPickerUIE",requestDismiss:this.emojiPickerClose,requestFocus:this.restoreEmojiPickerFocus},o.createElement(m,{contextMenu:this.state.emojiPicker})));return o.createElement(a["default"],{className:i.container,onFocus:this.restoreFocus},o.createElement("span",{className:i.label},this.props.placeholder),o.createElement("div",{className:"input-spacer"}),o.createElement("div",{className:i.inputWrapper,"data-trump-dominateparent":"click"},o.createElement(s,{ref:"inputLine",value:this.props.value,className:"input-text",multiline:this.props.multiline,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onEnter:this.onEnter,onFiles:this.props.onFiles,focusOnChange:!1,spellCheck:this.props.spellCheck,maxLength:this.props.maxLength,showRemaining:this.props.showRemaining,editable:this.props.editable&&!this.state.locked}),o.createElement("div",{className:"textinput-controls"},g,o.createElement(l,{transitionName:"pop",component:"div",className:"control-button-container"},u),c)),v,y)}});e.exports=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(438),s=r(o),c=n(6),l=n(8),u=n(85),d=c.createClass({displayName:"UIEMenu",propTypes:{contextMenu:c.PropTypes.object.isRequired},componentDidMount:function(){var e=this,t=this.props.contextMenu,n=t.menu,r=(0,s["default"])(t,["menu"]);l.openContextMenu(n,(0,a["default"])({},r),this.context.uim,function(t){return e.element=t})},componentWillUnmount:function(){l.closeContextMenu(this.context.uim)},getElement:function(){return this.element},render:function(){return null}});d.contextTypes={uim:c.PropTypes.instanceOf(u)},e.exports=d},function(e,t,n){"use strict";var r=n(6),i=n(44),a=n(437),o=r.createClass({displayName:"DrawerListItem",propTypes:{onClick:r.PropTypes.func,iconClass:r.PropTypes.string,className:r.PropTypes.string,a8n:r.PropTypes.string.isRequired},render:function(){var e=this.props,t=e.onClick,n=e.iconClass,o=e.className,s=e.children,c=n?r.createElement("div",{className:"chat-avatar"},r.createElement("div",{className:"avatar"},r.createElement("span",{className:i("icon",n)}))):null;return r.createElement("div",{className:i("chat",o),"data-ignore-capture":"any"},r.createElement("div",{className:"chat-cell",onClick:t,"data-a8n":a.key(this.props.a8n)},c,r.createElement("div",{className:"chat-body"},r.createElement("div",{className:"chat-main"},r.createElement("div",{className:"chat-title"},r.createElement("span",{className:"emojitext ellipsify",dir:"auto"},s))))))}});e.exports=o},function(e,t,n){"use strict";var r=n(6),i=n(10),a=n(432),o=n(8),s=n(86),c={GUIDE_ALLOW:"guide-allow",GUIDE_UNBLOCK:"guide-unblock",GUIDE_NONE:"guide-none"},l={CHROME_MEDIA_ERROR:"__chrome_media_error__",FIREFOX_LOCK:"__firefox_lock__",OPERA_MEDIA:"__opera_media__"},u=r.createClass({displayName:"GuidePopup",propTypes:{title:r.PropTypes.string.isRequired,desc:r.PropTypes.string.isRequired,browserPrefixDesc:r.PropTypes.bool.isRequired,type:r.PropTypes.oneOf(_.values(c)).isRequired,onConfirm:r.PropTypes.func,onCancel:r.PropTypes.func},statics:{TYPE:c},getDefaultProps:function(){return{browserPrefixDesc:!0,type:c.GUIDE_NONE,onConfirm:o.closeModal.bind(o)}},componentDidMount:function(){var e=this.getDescription(),t=this.refs.description;e.indexOf(l.CHROME_MEDIA_ERROR)>-1&&(t.innerHTML=t.innerHTML.replace(l.CHROME_MEDIA_ERROR,'<span class="chrome-media-icon"></span>')),e.indexOf(l.FIREFOX_LOCK)>-1&&(t.innerHTML=t.innerHTML.replace(l.FIREFOX_LOCK,'<span class="firefox-lock-icon"></span>')),e.indexOf(l.OPERA_MEDIA)>-1&&(t.innerHTML=t.innerHTML.replace(l.OPERA_MEDIA,'<span class="opera-media-icon"></span>'))},getDescription:function(){var e=this.props.desc+"_"+s.browser;return this.props.browserPrefixDesc&&l10n.hasT(e)?l10n.t(e):l10n.t(this.props.desc)},render:function(){var e="popup-guide";if(s.browser===i.BROWSER_TYPE.CHROME)switch(s.os){case i.OS_TYPE.MAC:e+=" popup-guide-mac";break;case i.OS_TYPE.CHROMEOS:e+=" popup-guide-chrome";break;case i.OS_TYPE.WINDOWS:}var t=null;this.props.type!==c.GUIDE_NONE&&s.browser===i.BROWSER_TYPE.CHROME&&(t=r.createElement("div",{className:"round"},r.createElement("div",{className:"round-body "+this.props.type})));var n=this.props.onCancel?l10n.t("learn_more"):void 0;return r.createElement(a,{title:l10n.t(this.props.title),classes:e,onOK:this.props.onConfirm,okText:l10n.t("ok_got_it"),onCancel:this.props.onCancel,cancelText:n},t,r.createElement("div",{className:"text text-tip",ref:"description"},this.getDescription()))}});e.exports=u},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(8),o=n(432),s=r.createClass({displayName:"MediaMissingModal",propTypes:{msg:r.PropTypes.instanceOf(i).isRequired},render:function(){var e=void 0,t=void 0;switch(this.props.msg.type){case i.TYPE.VIDEO:e=l10n.t("missing_video_title"),t=l10n.t("missing_video_text");break;case i.TYPE.AUDIO:e=l10n.t("missing_audio_title"),t=l10n.t("missing_audio_text");break;case i.TYPE.IMAGE:e=l10n.t("missing_photo_title"),t=l10n.t("missing_photo_text");break;case i.TYPE.DOCUMENT:e=l10n.t("missing_document_title"),t=l10n.t("missing_document_text")}return r.createElement(o,{title:e,onOK:a.closeModal.bind(a),okText:l10n.t("web_ok")},t)}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(6),s=n(44),c=o.createClass({displayName:"Modal",propTypes:{type:o.PropTypes.oneOf(["compact","box","tower"]),classes:o.PropTypes.string,title:o.PropTypes.string,children:o.PropTypes.node.isRequired},getDefaultProps:function(){return{classes:"",type:"compact"}},statics:{COMPACT:"compact",BOX:"box",TOWER:"tower"},render:function(){var e=this.props.title?o.createElement("div",{className:"popup-title",dir:"auto"},this.props.title):null,t=s("popup",this.props.classes,(0,a["default"])({},"popup-"+this.props.type,this.props.type!==c.COMPACT));return o.createElement("div",{className:"backdrop"},o.createElement("div",{className:"popup-container"},o.createElement("div",{className:t},o.createElement("div",{className:"popup-body"},e,o.createElement("div",{className:"popup-contents"},this.props.children)))))}});e.exports=c},function(e,t,n){"use strict";var r=n(6),i=n(432),a=n(1229),o=n(8),s=r.createClass({displayName:"RemoteUpload",propTypes:{msg:r.PropTypes.instanceOf(a).isRequired},render:function(){var e,t;switch(this.props.msg.type){case a.TYPE.IMAGE:e=l10n.t("retry_upload_photo_title"),t=l10n.t("retry_upload_photo_text");break;case a.TYPE.VIDEO:e=l10n.t("retry_upload_video_title"),t=l10n.t("retry_upload_video_text");break;case a.TYPE.AUDIO:case a.TYPE.PTT:e=l10n.t("retry_upload_audio_title"),t=l10n.t("retry_upload_audio_text");break;case a.TYPE.DOCUMENT:e=l10n.t("retry_upload_doc_title"),t=l10n.t("retry_upload_doc_text");break;default:e=l10n.t("retry_upload_media_title"),t=l10n.t("retry_upload_media_text")}return r.createElement(i,{title:e,onOK:o.closeModal.bind(o),okText:l10n.t("web_ok")},t)}});e.exports=s},function(e,t,n){"use strict";var r=n(433),i=n(1229),a=n(87),o=a.extend({props:{noEarlierMsgs:"boolean",isLoadingEarlierMsgs:"boolean",isLoadingRecentMsgs:"boolean",isLoadingAroundMsgs:"boolean",contextLoaded:"boolean"}}),s=r.extend({model:i,initialize:function(){r.prototype.initialize.call(this),this.msgLoadState=new o({noEarlierMsgs:!1,isLoadingEarlierMsgs:!1,isLoadingRecentMsgs:!1,isLoadingAroundMsgs:!1,contextLoaded:!1})},add:function(){var e=this,t=r.prototype.add.apply(this,arguments),n=Store.Msg.add(t,arguments[1]);return _.isArray(n)?n.forEach(function(t){e.isModel(t)&&(t.msgChunk=e)}):this.isModel(n)&&(n.msgChunk=this),this.trigger("bulk_add",t,arguments[1]),t},replace:function(e){var t=this;this.msgLoadState=e.msgLoadState,this.loadRecentPromise=e.loadRecentPromise,this.loadEarlierPromise=e.loadEarlierPromise,this.loadAroundPromise=e.loadAroundPromise,this.set(e.models,{silent:!0,merge:!1}),e.models.forEach(function(e){t.isModel(e)&&(e.msgChunk=t)}),this.trigger("bulk_add",e.models)}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o={scrollIntoViewIfNeeded:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=arguments[2];if(_.isFunction(e.scrollIntoViewIfNeeded))return e.scrollIntoViewIfNeeded(t);n=n||e.parentNode;var r=window.getComputedStyle(n,null),i=parseInt(r.getPropertyValue("border-top-width")),a=e.offsetTop-n.offsetTop<n.scrollTop,o=e.offsetTop-n.offsetTop+e.clientHeight-i>n.scrollTop+n.clientHeight,s=a&&!o;return(a||o)&&t&&(n.scrollTop=e.offsetTop-n.offsetTop-n.clientHeight/2-i+e.clientHeight/2),!a&&!o||t||e.scrollIntoView(s),!(a||o)},scrollIntoView:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=arguments[2];n=n||e.parentNode;var r=window.getComputedStyle(n,null),i=parseInt(r.getPropertyValue("border-top-width")),a=e.offsetTop-n.offsetTop<n.scrollTop,o=e.offsetTop-n.offsetTop+e.clientHeight-i>n.scrollTop+n.clientHeight,s=a&&!o;return t?n.scrollTop=e.offsetTop-n.offsetTop-n.clientHeight/2-i+e.clientHeight/2:e.scrollIntoView(s),!(a||o)},scrollAt:function(e,t,n){n=n||{};var r=n.pos||"center",i=n.duration||1e3;switch(t=t||e.offsetParent,r){case"top":return t.scrollTop=e.offsetTop,a["default"].resolve();case"bottom":return t.scrollTop=e.offsetTop+e.clientHeight-t.clientHeight,a["default"].resolve();case"center":return n.animate?(Velocity(e,"stop"),Velocity(t,"stop"),Velocity(e,"scroll",{duration:i,container:t,offset:(e.clientHeight-t.clientHeight)/2,easing:n.easing})):(t.scrollTop=e.offsetTop+e.clientHeight/2-t.clientHeight/2,a["default"].resolve());case"offset":var o=n.offset||0;return t.scrollTop=e.offsetTop-o,a["default"].resolve()}return a["default"].resolve()}};e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(37),c=n(1231),l=n(1259),u=n(1237),d=n(1319),p=n(1385),h=n(1316),f=n(1393),m=n(1313),g=n(1372),v=n(1317),y=n(1299),E=n(1375),b=n(1230),w=n(141),M=n(10),C=n(8),S=n(44),T=n(1268),k=n(1354),x=n(14),N=n(1261),P=n(218),O=n(84),D={LAST:"last",INFO:"info"},A=o.createClass({displayName:"Chat",mixins:[b,w],propTypes:{chat:o.PropTypes.instanceOf(c).isRequired,mode:o.PropTypes.oneOf(_.values(D)).isRequired,secondary:o.PropTypes.element,searchText:o.PropTypes.string,noContext:o.PropTypes.bool,mouseDownAsClick:o.PropTypes.bool,onClick:o.PropTypes.func,active:o.PropTypes.object},statics:{Mode:D},getDefaultProps:function(){return{mode:D.LAST}},getInitialState:function(){this.hoverCounter=0;var e=this.props.chat,t=this.props.active;return{formattedTitle:this.async("chat.formattedTitle"),hasUnread:this.async("chat.hasUnread"),isReadOnly:this.async("chat.isReadOnly"),pendingAction:this.async("chat.pendingAction"),active:!!t&&t.value===e,contextMenu:!1}},componentDidMount:function(){this.props.active&&this.addObserver(this.props.active,this.props.chat.id.toString(),this.onActiveChange)},onActiveChange:function(e,t){if("focus"===e){var n=s.findDOMNode(this);O.focus(n),t&&T.scrollIntoViewIfNeeded(n)}this.setState({active:!!e})},contextEnabled:function(){var e=this.props,t=e.chat,n=e.noContext;return!n&&(t.mute.canMute()||t.canArchive()||t.canDelete()||t.canExit())},onMenu:function(e){if(this.state.contextMenu)return void this.setState({contextMenu:!1});var t=this.props.chat,n=[];t.canArchive()&&n.push(o.createElement(p,{key:"archive",onArchive:this.onArchive,chat:t})),t.mute.canMute()&&n.push(o.createElement(d,{key:"mute",onMute:this.onMute,chat:t})),t.canDelete()&&n.push(o.createElement(h,{key:"delete",onDeleteOrExit:this.onDeleteOrExit,chat:t})),t.canMarkUnseen()&&n.push(o.createElement(f,{key:"mark_unread",onMarkUnread:this.onMarkUnread,chat:t})),e.event&&e.event.persist(),this.setState({contextMenu:{menu:n,event:e.event,anchor:e.anchor}})},removeContext:function(){this.setState({contextMenu:!1})},onMute:function(e){C.muteChat(this.props.chat,e,this)},onArchive:function(e){C.archiveChat(this.props.chat,e)},onDeleteOrExit:function(){C.deleteOrExitChat(this.props.chat,this)},onMarkUnread:function(e){C.markChatUnread(this.props.chat,e)},onClick:function(e){_.isFunction(this.props.onClick)&&this.props.onClick(e,this.props.chat)},onMouseDown:function(e){0===e.button&&this.onClick(e)},onEnter:function(e){e.preventDefault(),e.stopPropagation(),a["default"].flashFocus=Date.now(),this.onClick(e)},onDragEnter:function(e){if(this.props.chat.canSend){var t=e.dataTransfer;_.includes(t.types,M.DRAG_TYPE_FILE)&&(0===this.hoverCounter&&this.setState({dragging:!0}),this.hoverCounter+=1)}},onDragLeave:function(e){if(this.props.chat.canSend){var t=e.dataTransfer;_.includes(t.types,M.DRAG_TYPE_FILE)&&(this.hoverCounter-=1,0===this.hoverCounter&&this.setState({dragging:!1}))}},onDrop:function(e){var t=this;if(this.props.chat.canSend){this.setState({dragging:!1});var n=e.dataTransfer;(_.includes(n.types,M.DRAG_TYPE_FILE)||_.includes(n.types,"text/uri-list")||_.includes(n.types,"text/html"))&&k.getFiles(e,0).then(function(e){C.openChatFromUnread(t.props.chat).then(function(n){n&&C.attachMediaDrawer(t.props.chat,e)})})["catch"](x.MediaDragDropError,function(e){C.openChatFromUnread(t.props.chat).then(function(n){n&&C.pasteChatTextInput(t.props.chat,e.src)})})}},indicateFocus:function(e){if(!(Date.now()-(a["default"].flashFocus||0)>200)){var t=s.findDOMNode(this.refs.cell);Velocity(t,"stop"),Velocity(t,{backgroundColor:["#e9eaeb","#cbdde7"]},{duration:1300,easing:[.19,.69,.01,.99],complete:this.onBlur})}},onBlur:function(e){var t=s.findDOMNode(this.refs.cell);t&&(Velocity(t,"stop"),t.style.backgroundColor="")},render:function(){var e=this,t=this.props,n=t.chat,r=t.mode,i=t.secondary,s=t.className;s=S(s,{unread:this.state.hasUnread,active:!!this.state.active,"chat-drag":this.state.dragging});var c=void 0,d=void 0,p=void 0;switch(r){case D.LAST:c=o.createElement(m,{chat:n}),i||(i=o.createElement(g,{chat:n}),d=o.createElement(E,{chat:n})),p={enter:this.onEnter},p[l10n.LR("right","left")]=function(){return e.refs.cell.openContextMenu()};break;case D.INFO:i||(i=n.isGroup?o.createElement(v,{presence:n.presence,groupMetadata:n.groupMetadata,location:"list"}):o.createElement(y,{presence:n.presence,location:"list"})),p={enter:this.onEnter}}var h=o.createElement("div",{className:"chat-avatar"},o.createElement(u,{id:n.id,size:u.Size.NONE})),f=this.props.mouseDownAsClick,_=void 0;return this.state.contextMenu&&(_=o.createElement(P,{displayName:"ChatContextMenu",escapable:!0,popable:!0,requestDismiss:this.removeContext},o.createElement(N,{contextMenu:this.state.contextMenu}))),o.createElement(a["default"],{handlers:p,onFocus:this.indicateFocus,onBlur:this.onBlur,className:"chat-drag-cover",onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDrop:this.onDrop},o.createElement(l,{id:n.id,ref:"cell",className:s,contextEnabled:this.contextEnabled,pendingAction:this.state.pendingAction,contextMenu:!!this.state.contextMenu,image:h,primary:n.title(),searchText:this.props.searchText,primaryDetail:c,secondary:i,secondaryDetail:d,isPSA:n.isPSA,onClick:f?null:this.onClick,onMouseDown:f?this.onMouseDown:null,onContext:this.onMenu}),_)}});e.exports=A},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(37),g=n(1456),v=n(144),y=n(218),_=n(84),E=n(440),b=n(44),w=n(106),M=function(e){function t(){var e,n,r,i;(0,s["default"])(this,t);for(var o=arguments.length,c=Array(o),l=0;l<o;l++)c[l]=arguments[l];return n=r=(0,d["default"])(this,(e=(0,a["default"])(t)).call.apply(e,[this].concat(c))),r.state={searchText:"",isSearching:!1},r.onBlur=function(){return r.props.setTimeout(function(){r.state.searchText||r.onCancel()},0)},r.onChange=function(e){e.target instanceof HTMLInputElement&&!function(){var t=e.target.value;r.setState({searchText:t},function(){r.props.onSearch(t)})}()},r.onCancel=function(){r.refs.input.blur(),r.setState({searchText:"",isSearching:!1}),r.props.onSearch("")},r.onReset=function(e){e.stopPropagation(),r.focus(),r.setState({searchText:""}),r.props.onSearch("")},r.onSearchOn=function(){r.setState({isSearching:!0}),r.props.setTimeout(r.focus,0)},r.focus=function(){_.focus(r.refs.input)},i=n,(0,d["default"])(r,i)}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillReceiveProps",value:function(e){this.state.isSearching&&!this.state.searchText&&(m.findDOMNode(this).contains(document.activeElement)||this.onCancel())}},{key:"componentWillUnmount",value:function(){this.onCancel()}},{key:"isAtBeginning",value:function(){var e=this.refs.input;return 0===e.selectionStart&&0===e.selectionEnd}},{key:"isAtEnd",value:function(){var e=this.refs.input,t=e.value.length;return e.selectionStart===t&&e.selectionEnd===t}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.placeholder,r=e.spellCheck,i=this.state,a=i.isSearching,o=i.searchText,s=null;a&&(t?s=f.createElement("button",{className:"btn-context icon-spinner icon-x-alt",key:"icon-clear-search",onClick:this.onReset},f.createElement(v,{size:20,stroke:5})):o.length&&(s=f.createElement("button",{className:"icon icon-x-alt",key:"icon-clear-search",onClick:this.onReset})));var c=void 0;a&&(c=f.createElement(y,{displayName:"ListSearch",escapable:!0,requestDismiss:this.onCancel,requestFocus:this.focus}));var l=a?this.onCancel:this.onSearchOn,u=b("pane-subheader","pane-list-subheader","subheader-search",{active:a});return f.createElement("div",{className:u},f.createElement("button",{className:"icon icon-search-morph",onMouseDown:l},f.createElement("div",{className:"icon icon-back-blue"}),f.createElement("div",{className:"icon icon-search"})),f.createElement(w,{transitionName:"pop"},s),f.createElement("div",{className:"input-placeholder"},o?null:n),f.createElement("label",{htmlFor:"input-chatlist-search",className:"cont-input-search"},f.createElement("input",{type:"text",ref:"input",className:"input input-search","data-tab":2,dir:"auto",spellCheck:r,title:n,value:o,onBlur:this.onBlur,onFocus:a?null:this.onSearchOn,onChange:a?this.onChange:null})),c)}}]),t}(f.Component);M.defaultProps={placeholder:E.t("search_or_start_new_chat")};t.Component=M;t["default"]=g(M)},function(e,t,n){"use strict";var r=n(6),i=n(142),a=n(44),o=r.createClass({displayName:"CheckBox",mixins:[i],propTypes:{checked:r.PropTypes.bool.isRequired,onChange:r.PropTypes.func.isRequired,disabled:r.PropTypes.bool},onToggle:function(e){e&&e.stopPropagation(),this.props.onChange()},render:function(){var e=a("checkbox",{checked:this.props.checked,unchecked:!this.props.checked,disabled:this.props.disabled});return r.createElement("div",{className:"checkbox-container",onClick:this.onToggle},r.createElement("div",{className:e,ref:"checkbox"},r.createElement("div",{className:"checkmark"})))}});e.exports=o},function(e,t){"use strict";e.exports=function(e){return!e.getModifierState("Shift")&&!e.getModifierState("Alt")&&!e.getModifierState("Control")}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}function a(e){switch(e){case q.OUTWARD_TYPES.IMAGE:return F["default"].supportsFeature(F["default"].F.ENC_IMAGE);case q.OUTWARD_TYPES.VIDEO:return F["default"].supportsFeature(F["default"].F.ENC_VIDEO);case q.OUTWARD_TYPES.PTT:case q.OUTWARD_TYPES.AUDIO:return F["default"].supportsFeature(F["default"].F.ENC_AUDIO);case q.OUTWARD_TYPES.DOCUMENT:return F["default"].supportsFeature(F["default"].F.ENC_DOC);default:return!0}}function o(e,t){return B["default"].assert(e._mediaObject,"media-fault","msg has no _mediaObject")(e),H.downloadMedia(e._mediaObject,t)}function s(e){return B["default"].assert(e._mediaObject,"media-fault","msg.cancel with no _mediaObject")(e),H.cancelDownloadMedia(e._mediaObject)}function c(e,t){B["default"].info("Prepping raw media")(e,t);var n=void 0;return n=t.isPtt?q.OUTWARD_TYPES.PTT:t.asDocument?q.OUTWARD_TYPES.DOCUMENT:q.OUTWARD_TYPES.UNKNOWN,new $(n,H.processRawMedia(e,t))}function l(e,t){B["default"].info("Prepping media msg")(e);var n=e._mediaObject;B["default"].assert(n,"media-fault","fwding media msg without mediaObject")();var r=e.mediaData.toJSON();return r.type===q.OUTWARD_TYPES.PTT&&(r.type=q.OUTWARD_TYPES.AUDIO),new $(r.type,E["default"].resolve(r)).sendToChat(t,{caption:r.type===q.OUTWARD_TYPES.DOCUMENT?e.caption:void 0})}function u(e){return B["default"].assert(e._mediaObject,"media-fault","msg.cancelUpload with no _mediaObject")(e),H.cancelUploadMedia(e._mediaObject)}function d(e){var t=e._mediaObject;B["default"].assert(t,"media-fault","msg.resumeUpload with no _mediaObject")(e),t.addUploadTargets([window.Store.Conn.me]);var n=e.chat,r=H.uploadMediaForChat(t,n.id).then(function(n){return e.set({clientUrl:n.mmsUrl,mediaKey:n.encryptionKey,filehash:t.filehash,size:t.size}),e}),i=e.chat.sendMsg(r);return i["catch"](function(){e.ack=-1}),H.cancelUploadMedia(e._mediaObject)}function p(e){e.mimetype||e.type!==q.OUTWARD_TYPES.IMAGE||(e.mimetype="image/jpeg"),e.on(Q,f),f(e),e._mediaObject&&e._mediaObject.notifyMsgsNow()}function h(e){e.off(null,f);var t=e._mediaObject;t&&(e._mediaObject=null,t.removeMsg(e),t.hasAssociatedMsgs()||(t.filehash&&delete J[t.filehash],t["delete"]()))}function f(e){for(var t={},n=0;n<Z.length;n++){var r=Z[n];t[X[r]]=e[r]}if(e.isUnsentPhoneMsg())return B["default"].assert(!e._mediaObject,"media-fault","Managing unsent message")(),t.mediaStage=e.phoneUploading?q.STAGE.REMOTE_UPLOADING:q.STAGE.REMOTE_NEED_UPLOAD,void e.mediaData.set(t);var i=e._mediaObject,a=e.filehash;i?a&&a!==i.filehash&&(i.removeMsg(e),i.hasAssociatedMsgs()||(i.filehash&&delete J[i.filehash],i["delete"]()),i=m(a),e._mediaObject=i,i.addMsg(e)):(i=a?m(a):new V["default"],e._mediaObject=i,i.addMsg(e));var o=!1;if(e.clientUrl){o=!i.entries.knowsUrl(e.clientUrl);var s=i.entries.addEntry(e.clientUrl,e.mediaKey,e.uploadhash);s||(o=!1),o&&i.downloadStage===q.DOWNLOAD_STAGE.ERROR_MISSING&&(t.downloadStage=q.STAGE.INIT)}i.consolidate(t)||i.notifyMsgsAsync(),o&&i.downloadStage===q.DOWNLOAD_STAGE.NEED_POKE&&H.downloadMedia(i,!1)}function m(e){return J.hasOwnProperty(e)?J[e]:J[e]=new V["default"]}function g(e,t,n){function r(e){l=e;var n=e._mediaObject;return B["default"].assert(n,"media-fault","incorrect media object for created msg")(),n.addUploadTargets([window.Store.Conn.me]),H.uploadMediaForChat(n,t.id).then(function(e){l.set({clientUrl:e.mmsUrl,mediaKey:e.encryptionKey,filehash:n.filehash,size:n.size})})}var i=n.caption,a=n.quotedMsg?n.quotedMsg.contextInfo():{},o=window.Store.Conn.me,s={t:P["default"].globalUnixTime(),from:o,isNewMsg:!0,to:t.id,self:"out",type:e._baseType,ack:0,local:!0,id:new z["default"]({from:o,to:t.id,id:z["default"].newTag(),participant:void 0,selfDir:"out"}),caption:i,quotedMsg:a.quotedMsg,quotedParticipant:a.quotedParticipant,quotedStanzaID:a.quotedStanzaID,quotedRemoteJid:a.quotedRemoteJid},c=e.waitForPrep().then(function(e){var t=e.filehash;B["default"].assert(t,"media-fault","filehash undefined for send")();var n=m(t);n.mediaBlob&&(e.mediaBlob=n.mediaBlob),n.specifics&&n.specifics.renderableUrl||(e.renderableUrl=window.URL.createObjectURL(e.mediaBlob)),n.consolidate(e.toJSON()),H.downloadMedia(n,!0);var r=n.msgProps(e);return i||e.type!==q.OUTWARD_TYPES.DOCUMENT||(r.caption=e.filename),r}),l=void 0,u=void 0;if(n.addEvenWhilePreparing)u=t.addAndSendMsg(s,function(e){return l=e,c.then(function(e){return l.set(e),r(l)})})[1];else{var d=c.then(function(e){return(0,y["default"])({},s,e)});u=t.addAndSendMsg(d,r)[1]}u["catch"](function(){l&&(l.ack=-1)})}Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPrep=void 0;var v=n(434),y=i(v),_=n(2),E=i(_),b=n(23),w=i(b),M=n(26),C=i(M),S=n(45),T=i(S);t.canSendType=a,t.downloadMsg=o,t.cancelDownloadMsg=s,t.prepRawMedia=c,t.forwardMediaMsg=l,t.cancelUploadMsg=u,t.resumeUploadMsg=d,t.registerMsg=p,t.deregisterMsg=h;var k=n(38),x=i(k),N=n(143),P=i(N),O=n(8),D=i(O),A=n(14),I=i(A),R=n(439),L=i(R),U=n(104),F=i(U),j=n(1),B=i(j),G=n(46),z=i(G),W=n(1458),H=r(W),q=n(1302),V=i(q),Y=n(1244),K=i(Y),X=x["default"].invert(q.FIELDS_TO_MSG_PROPS),Z=(0,T["default"])(X),Q="change:phoneUploading change:clientUrl change:mediaKey change:filehash change:ack "+Z.map(function(e){return"change:"+e}).join(" "),J={},$=t.MediaPrep=function(){function e(t,n){var r=this;(0,w["default"])(this,e),this._baseType=t,this._mediaData=new K["default"]({mediaStage:q.STAGE.PREPARING}),this._prepwork=n.then(function(e){return r._mediaData.set(e),L["default"].getHash(e.mediaBlob)},function(e){return r._mediaData.stage=q.STAGE.ERROR_UNSUPPORTED,E["default"].reject(e)}).then(function(e){var t=e.hash;r._mediaData.filehash=t})}return(0,C["default"])(e,[{key:"sendToChat",value:function(e,t){E["default"].callSynchronously(g,null,this,e,t)}},{key:"waitForPrep",value:function(){var e=this;return this._prepwork.then(function(){var t=e._mediaData;return a(t.type)?t:E["default"].reject(new I["default"].CapabilityUnsupported)})}}]),e}();D["default"].on("logout",function(){var e=J;J={};for(var t in e)e[t]["delete"]()})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(220),d=n(47),p=n(1545),h=n(1),f=n(1229),m=n(143),g=n(0),v=function(){function e(){(0,s["default"])(this,e)}return(0,l["default"])(e,[{key:"_getDefaultName",value:function(e){var t=u.getExtension(e.mimetype);switch(e.type){case f.TYPE.DOCUMENT:return e.caption||e.filename||l10n.t("untitled_document")+t;case f.TYPE.IMAGE:case f.TYPE.VIDEO:case f.TYPE.AUDIO:default:var n=g.unix(e.t).locale("en");return e.filename||"WhatsApp "+_.capitalize(e.type)+" "+(n.format("YYYY-MM-DD")+" at ")+(""+n.format(m.getIs24Hour()?"HH.mm.ss":"h.mm.ss A"))+t}}},{key:"_getDownloadData",value:function(e){var t=this,n=_.isArray(e)?e:[e];return a["default"].map(n,function(e){return e.isGif?t._mp4ToGif(e):{name:t._getDefaultName(e),url:e.mediaData.renderableUrl,blob:e.mediaData.mediaBlob}}).then(function(e){return e.length>1?p(e).then(function(e){var n={t:Math.round(Date.now()/1e3),type:"zip",mimetype:"application/zip"};return{blob:e,name:t._getDefaultName(n)}}):_.head(e)})["catch"](function(e){h.error("Failed to get download data!")(e)})}},{key:"_mp4ToGif",value:function(e){var t=this;return new a["default"](function(e,t){throw new Error("unimplemented")}).then(function(t,n){return{url:t,blob:n,name:"WhatsApp-Image-"+g.unix(e.t).format("YYYYMMDD")+".gif"}})["catch"](function(){return{url:e.mediaData.renderableUrl,blob:e.mediaData.mediaBlob,name:t._getDefaultName(e)}})}},{key:"initDownload",value:function(e){d.startDownloading();var t=document.createElement("a");this._getDownloadData(e).then(function(n){t.href=n.url||window.URL.createObjectURL(n.blob),t.download=n.name,t.target="_blank",t.style.display="none",_.isArray(e)&&1===e.length&&(e=_.head(e)),h.assert(t.href,"no-download-url",_.isArray(e)?"download a zip file":"download "+e.id+" type "+e.type+" with state "+e.mediaData.mediaStage)(),document.body.appendChild(t),t.click(),document.body.removeChild(t),n.url||window.URL.revokeObjectURL(t.href)})}}]),e}();e.exports=new v},function(e,t,n){"use strict";var r=n(6),i=n(1),a=n(1229),o=n(141),s=r.createClass({displayName:"MsgSymbol",mixins:[o],propTypes:{msg:r.PropTypes.instanceOf(a)},componentWillMount:function(){var e=this.props.msg;"ptt"===e.type&&e.ack<4&&this.addObserver(this.props.msg,"change:ack")},getClasses:function(){var e=this.props.msg;switch(e.type){case"location":case"video":case"audio":case"vcard":case"document":case"ciphertext":case"unknown":case"image":return"icon media-icon icon-status-"+(e.isGif?"gif":e.type);case a.TYPE.CALL_LOG:return"icon icon-status-missed";case"ptt":var t=4===e.ack?"blue":e.isSentByMe?"gray":"green";return"icon media-icon icon-status-"+e.type+"-"+t;default:i.log("chat:getClasses Invalid msg type.")()}return""},render:function(){return r.createElement("span",{className:this.getClasses()})}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(10),g=n(1255),v=n(38),y=n(44),_=(n(1231),n(1244)),E=(n(1229),n(8)),b=n(1264),w=n(144),M=n(1318),C=n(1239),S=(n(1248),n(440)),T=function(e){function t(){(0,s["default"])(this,t);var e=(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments));return e.onScroll=function(t){e.handleScroll(t.target)},e.handleScroll=v.throttle(function(t){var n=e.props.chat.mediaMsgs;n.hasMediaBefore&&t.scrollTop+m.SCROLL_FUDGE>t.scrollHeight-t.clientHeight&&e.queryMedia(v.head(n.models))},100),e}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillMount",value:function(){this.props.chat.mediaMsgs.hasMediaBefore&&this.queryMedia()}},{key:"componentDidMount",value:function(){this.props.addListener(this.props.chat.mediaMsgs,"add remove reset"),this.props.addListener(this.props.chat.mediaMsgs,"query_media_before")}},{key:"queryMedia",value:function(e){var t=this,n=this.props.chat.mediaMsgs;n.hasMediaBefore&&this.props.uiIdle(function(){n.queryMedia(t.props.chat,e)})}},{key:"render",value:function(){var e=this,t=this.props.chat.mediaMsgs,n=this.props,r=n.fullCollection,i=n.selectedMessages,a=t.map(function(n,a){
var o=null;return!e.props.fullCollection&&a>=t.length-6&&a<=t.length-4&&(o="media-canvas-second-row"),f.createElement(N,{msg:n,hoverEvent:r,selectable:e.props.selectable,selectedMessages:i,onMessageSelect:e.props.onMessageSelect,className:o,key:n.id})});if(a.reverse(),r||(a=v.slice(a,0,6)),t.queryMediaBefore&&(r||a.length<6)){var o=y("more","media-canvas-component",{"media-canvas-second-row":!r&&a.length>=3});a.push(f.createElement("div",{className:o,key:"spinner"},f.createElement(w,{stroke:6,size:24})))}for(var s=0;s<6;s++)a.push(f.createElement("div",{className:"media-canvas-empty",key:"empty"+s}));var c=y("media-gallery",{"drawer-media-gallery":r});if(0===t.length){if(r)return t.queryMediaBefore?f.createElement("div",{className:"drawer-media-gallery drawer-body"},f.createElement(C.Loading,null)):f.createElement(C.MediaMsgs,null);t.queryMediaBefore||t.hasMediaBefore||(c=y(c,"media-gallery-empty"),a=[S.t("no_media")])}return f.createElement("div",{onScroll:this.onScroll,className:c},a)}}]),t}(f.Component),k=function(e){function t(){(0,s["default"])(this,t);var e=(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments));x.call(e);var n=e.props,r=n.msg,i=n.selectedMessages;return e.state={selected:!(!i||!i.isSelected(r))},e}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentDidMount",value:function(){this.props.selectedMessages&&this.props.addListener(this.props.selectedMessages,this.props.msg.id.toString(),this.onSelectChange)}},{key:"render",value:function(){var e=this.props.msg,t=e.mediaData,n=t.type===_.TYPE.IMAGE&&t.renderableUrl?this.onDragStart:null,r=y("media-canvas-component",this.props.className);return f.createElement(M,{classes:r,onClick:this.onClick,hoverEvent:this.props.hoverEvent,selectable:this.props.selectable,selected:this.state.selected,onMessageSelect:this.props.onMessageSelect,onDragStart:n,msg:e,ref:"canvas"})}}]),t}(f.Component),x=function(){var e=this;this.onSelectChange=function(t){e.state.selected!==t&&e.setState({selected:t})},this.onClick=function(t){var n=e.props,r=n.msg,i=n.selectable,a=n.onMessageSelect,o=r.mediaData;if(i&&a)return void a(r,!e.state.selected);if(o.mediaStage===_.STAGE.ERROR_MISSING)return void E.openModal(f.createElement(b,{msg:r}));t&&t.stopPropagation();var s=void 0,c=r.id;o.type===_.TYPE.IMAGE&&!function(){var t=e.refs&&e.refs.canvas;s=function(e){return c.equals(e)&&t?t.refs.component.refs.img:null}}(),E.mediaViewerModal(r,s)},this.onDragStart=function(t){t.nativeEvent.dataTransfer.setData(m.DRAG_TYPE_LOCAL_IMAGE,!0),t.nativeEvent.dataTransfer.setData("text/uri-list",e.props.msg.mediaData.renderableUrl)}},N=g(k);e.exports=g(T)},function(e,t,n){"use strict";var r=n(6),i=n(1246),a=n(144),o=r.createClass({displayName:"Pending",render:function(){return r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"icon-media icon-media-disabled"},r.createElement(a,{size:50,stroke:3})))}}),s=r.createClass({displayName:"PendingCancel",render:function(){return r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"icon-xl icon-media-cancel"},r.createElement(a,{size:50,stroke:3})))}}),c=r.createClass({displayName:"Cancel",render:function(){return r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"icon-xl icon-media-download"}))}}),l=r.createClass({displayName:"Download",propTypes:{filesize:r.PropTypes.number.isRequired,onClick:r.PropTypes.func},render:function(){var e=this.props.onClick||null;return this.props.filesize>0?r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"btn-meta",onClick:e},r.createElement("span",{className:"icon-xl icon-media-download-noborder"}),r.createElement(i,null,l10n.filesize(this.props.filesize)))):r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"icon-xl icon-media-download",onClick:e}))}}),u=r.createClass({displayName:"Upload",propTypes:{filesize:r.PropTypes.number.isRequired},render:function(){return this.props.filesize>0?r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"btn-meta"},r.createElement("span",{className:"icon-xl icon-media-upload-noborder"}),r.createElement(i,null,l10n.filesize(this.props.filesize)))):r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"icon-xl icon-media-upload"}))}}),d=r.createClass({displayName:"Play",render:function(){return r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"icon-xl icon-media-play"}))}}),p=r.createClass({displayName:"Missing",render:function(){var e;switch(this.props.msg.type){case"image":e=l10n.t("missing_photo_title");break;case"video":e=l10n.t("missing_video_title");break;case"audio":e=l10n.t("missing_audio_title")}return r.createElement("div",{className:"media-state-controls"},r.createElement("button",{className:"btn-meta missing-text"},e))}});e.exports={Pending:o,Cancel:c,PendingCancel:s,Download:l,Upload:u,Play:d,Missing:p}},function(e,t,n){"use strict";var r=n(6),i=n(106),a=n(437),o=n(44),s=n(218),c=r.createClass({displayName:"MenuBar",propTypes:{children:r.PropTypes.node},render:function(){return r.createElement("div",{className:"menu menu-horizontal"},this.props.children)}}),l=r.createClass({displayName:"MenuBarItem",propTypes:{icon:r.PropTypes.string.isRequired,title:r.PropTypes.string.isRequired,children:r.PropTypes.node,transitionName:r.PropTypes.string,onClick:r.PropTypes.func,a8n:r.PropTypes.string.isRequired},getDefaultProps:function(){return{transitionName:"dropdown"}},getInitialState:function(){return{active:!1}},onOpen:function(e){this.setState({active:!0})},onClose:function(e){this.setState({active:!1})},clickHandler:function(e){this.props.onClick&&this.props.onClick(e),e.isDefaultPrevented()||this.state.active||this.onOpen(e)},render:function(){var e=this,t=this.props,n=t.children,c=t.icon,l=t.transitionName,u=t.title,d=this.state.active,p=void 0;n&&d&&(p=r.createElement(s,{displayName:"MenuBarMenuItem",escapable:!0,popable:!0,requestDismiss:function(){return e.onClose()}},r.Children.only(n)));var h={container:o("menu-item",{active:d}),icon:"icon icon-"+c};return r.createElement("div",{"data-a8n":a.key(this.props.a8n),className:h.container},r.createElement("button",{className:h.icon,onMouseDown:this.clickHandler,title:u}),r.createElement(i,{transitionName:l},p))}});e.exports={MenuBar:c,MenuBarItem:l}},function(e,t){"use strict";e.exports=function(e,t){for(var n=e.childNodes,r=0;r<n.length;++r)if(n[r]===t)return r;return-1}},function(e,t,n){"use strict";var r=n(1297),i=r({FORWARD:void 0,BACKWARD:void 0});e.exports=function(e,t){var n=window.getSelection();if(!n||!n.rangeCount)return null;var r=n.getRangeAt(0);if(!r.collapsed)return null;var a=r.startContainer,o=r.startOffset;if(a===e){var s=a.childNodes,c=s.length;if(t===i.FORWARD&&o>c||t===i.BACKWARD&&!o)return null;var l=t===i.BACKWARD?1:0,u=s[o-l];return u instanceof Element?u:null}var d=a.length===o;if(t===i.BACKWARD&&o)return null;if(t===i.FORWARD&&!d)return null;var p=t===i.BACKWARD?"previousSibling":"nextSibling",h=a[p];return h instanceof Element?h:null},e.exports.Direction=i},function(e,t,n){"use strict";var r=n(6),i=r.createClass({displayName:"SectionHeader",propTypes:{header:r.PropTypes.string.isRequired},render:function(){return r.createElement("div",{className:"list-title"},this.props.header)}});e.exports=i},function(e,t,n){"use strict";var r=n(6),i=n(1332),a=n(1237),o=n(141),s=n(1236),c=n(1229),l=a.Size,u=r.createClass({displayName:"ProfileImage",mixins:[o,s],propTypes:{size:r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.oneOf(_.values(l))]),waid:r.PropTypes.string,thumb:r.PropTypes.string,className:r.PropTypes.string,quoted:r.PropTypes.bool},componentWillMount:function(){var e=this,t=this.props.waid;t&&Store.ProfilePicThumb.find(t).checkpoint(this.rejectOnUnmount()).then(function(t){e.addObserverAndRun(t,"change:img",function(){e.setState({img:t.img})})})["catch"](_.noop)},render:function(){return this.state.img?r.createElement(a,{id:this.props.waid,className:this.props.className,quoted:this.props.quoted,size:this.props.size}):r.createElement(i,{className:this.props.className,thumb:this.props.thumb,type:c.TYPE.VCARD,quoted:this.props.quoted,shade:!1})}});u.Size=l,e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(6),s=n(37),c=n(1268),l=n(1),u=n(141),d=n(1244),p=n(1229),h=n(8),f=n(83),m=n(432),g=n(1232),v=n(1284),y=n(1238),E=n(1266),b=n(1271),w=n(1422),M=n(1331),C=n(1333),S=n(1426),T=n(1274),k=new(n(1291)),x=n(1248),N=n(1261),P=n(218),O=n(1142),D=n(44),A=n(104),I=n(10),R=n(106),L={FRONT:"front",MID:"mid",END:"end",SINGLE:"single"},U=o.createClass({displayName:"Wrapper",mixins:[u,f],propTypes:{msg:o.PropTypes.instanceOf(p).isRequired,position:o.PropTypes.oneOf(_.values(L)),displayType:o.PropTypes.oneOf(_.values(I.DISP_TYPE)),isMsgVisible:o.PropTypes.func,hideMsgInfo:o.PropTypes.bool,selectable:o.PropTypes.bool,selectedMessages:o.PropTypes.instanceOf(x),current:o.PropTypes.bool,onMessageSelect:o.PropTypes.func,tailOverride:o.PropTypes.oneOf(["left","right"]),isFocusedMsg:o.PropTypes.bool},getDefaultProps:function(){return{displayType:I.DISP_TYPE.CONVERSATION}},getInitialState:function(){return{contextMenu:!1,hover:!1,highlighting:!1,selected:!!this.props.selectedMessages&&this.props.selectedMessages.isSelected(this.props.msg)}},componentWillReceiveProps:function(e){this.props.isFocusedMsg&&!e.isFocusedMsg&&(this.unregCmd("scroll_to_focused_msg",this.scrollMsg),this.unregCmd("flash_focused_msg",this.flashFocusedMsg)),!this.props.isFocusedMsg&&e.isFocusedMsg&&(this.regCmd("scroll_to_focused_msg",this.scrollMsg),this.regCmd("flash_focused_msg",this.flashFocusedMsg))},shouldComponentUpdate:function(e,t){return O(this,e,t)},componentWillMount:function(){var e=this,t=this.props.msg;t.mayFail()&&(A.supportsFeature(A.F.RESEND_ICON)||t.type===p.TYPE.PTT)&&(this.addObserver(t,"change:isFailed",function(){return e.forceUpdate()}),this.addObserver(t,"change:mediaData.mediaStage",function(){return e.forceUpdate()})),this.props.isFocusedMsg&&(this.regCmd("scroll_to_focused_msg",this.scrollMsg),this.regCmd("flash_focused_msg",this.flashFocusedMsg)),t.typeCanChange()&&this.addObserver(t,"change:type",function(){return e.forceUpdate()})},componentDidMount:function(){this.props.selectedMessages&&this.addObserver(this.props.selectedMessages,this.props.msg.id.toString(),this.onSelectChange)},componentWillUnmount:function(){var e=this.refs.bubble;e&&Velocity(s.findDOMNode(e),"stop",!0)},scrollMsg:function(e,t){var n=s.findDOMNode(this);c.scrollAt(n,null,t).then(e)},flashFocusedMsg:function(e){this.highlight(e)},highlight:function(e){var t=this,n=this.refs.highlightTail,r=this.refs.bubble;if(n&&r){this.setState({highlighting:!0});var i=s.findDOMNode(n),a=s.findDOMNode(r),o=250;Velocity(i,"stop",!0),Velocity(i,{opacity:[1,0]},{duration:o}),Velocity(i,{opacity:[0,1]},{duration:o,delay:o});var c=this.props.msg.isSentByMe?"#dcf8c6":"#ffffff",l=this.props.msg.isSentByMe?"#b3cba1":"#cccccc";Velocity(a,"stop",!0),Velocity(a,{backgroundColor:[l,c]},{duration:o}),Velocity(a,{backgroundColor:[c,l]},{duration:o,delay:o,complete:function(){t.onHighlightComplete(e)}})}},onHighlightComplete:function(e){this.setState({highlighting:!1},function(){e&&e()})},resend:function(){var e=this.props.msg;return e.isMMS&&!A.supportsFeature(A.F.MEDIA_RETRY)?void h.openModal(o.createElement(E,{msg:e})):void e.resend()["catch"](function(e){l.log("wrapper:resend failure: "+e)()})},openSingleForwardFlow:function(){return this._openForwardFlow(!1)},openForwardFlow:function(){return this._openForwardFlow(!0)},_openForwardFlow:function(e){var t,n=this.props.msg;if(n.type===p.TYPE.CIPHERTEXT?t=l10n.t("err_unsent_forward_text_decrypting"):n.isUnsentMedia&&(t=l10n.t("err_unsent_forward_text")),t)h.openModal(o.createElement(m,{title:l10n.t("err_unsent_forward_title"),onOK:h.closeModal.bind(h),okText:l10n.t("web_ok")},t));else{if(e&&this.props.displayType===I.DISP_TYPE.CONVERSATION)return void this.onSelectClick();h.openModal(o.createElement(v,{msgs:[this.props.msg]}),"modal-flow")}},openInfoDrawer:function(){h.msgInfoDrawer(this.props.msg)},openContactChat:function(){Store.Chat.find(this.props.msg.author).then(function(e){h.openChatFromUnread(e).then(function(t){t&&h.focusChatTextInput(e)})})},mouseEnter:function(){!this.state.hover&&this.contextEnabled()&&this.setState({hover:!0})},mouseLeave:function(){this.state.hover&&this.contextEnabled()&&this.setState({hover:!1})},contextMenu:function(e){e.stopPropagation()},contextEnabled:function(){return!this.props.msg.isNotification},removeContext:function(){this.setState({contextMenu:!1})},onDeleteMessage:function(){var e=this,t=function(){h.closeModal(),e.props.msg.chat.sendDeleteMsgs([e.props.msg])},n=l10n.t("delete_message_confirmation");h.openModal(o.createElement(m,{onOK:t,okText:l10n.t("web_delete"),onCancel:h.closeModal.bind(h),cancelText:l10n.t("web_cancel")},o.createElement(g,{text:n})))},onReplyMessage:function(){this.props.msg.chat.composeQuotedMsg=this.props.msg,h.focusChatTextInput(this.props.msg.chat)},onDownload:function(){T.initDownload(this.props.msg)},onStarMessage:function(){this.props.msg.chat.sendStarMsgs([this.props.msg],!0)},onUnstarMessage:function(){this.props.msg.chat.sendStarMsgs([this.props.msg],!1)},onMenu:function(e){if(e.stopPropagation(),e.preventDefault(),e.isTrusted&&this.state.contextMenu)return void this.setState({contextMenu:!1});var t=this.props.msg,n=[];t.isSentByMe&&A.supportsFeature(A.F.MESSAGE_INFO)&&this.props.displayType!==I.DISP_TYPE.MSG_INFO&&n.push(o.createElement(y,{key:"info",a8n:"mi-msg-info",action:this.openInfoDrawer},l10n.t("message_info"))),t.canReply()&&n.push(o.createElement(y,{key:"reply",a8n:"mi-msg-reply",action:this.onReplyMessage},l10n.t("reply"))),t.mediaData.renderableUrl&&n.push(o.createElement(y,{key:"download",a8n:"mi-msg-download",action:this.onDownload},l10n.t("web_button_download"))),t.canForward()&&n.push(o.createElement(y,{key:"forward",a8n:"mi-msg-forward",action:this.openForwardFlow},l10n.t("forward_message"))),A.supportsFeature(A.F.STARRED)&&(t.star?n.push(o.createElement(y,{key:"star",a8n:"mi-msg-unstar",action:this.onUnstarMessage},l10n.t("unstar_message"))):n.push(o.createElement(y,{key:"star",a8n:"mi-msg-star",action:this.onStarMessage},l10n.t("star_message")))),A.supportsFeature(A.F.MESSAGE_DELETE)&&n.push(o.createElement(y,{key:"delete",a8n:"mi-msg-delete",action:this.onDeleteMessage},l10n.t("delete_message"))),t.isGroupMsg&&t.author&&!t.isSentByMe&&n.push(o.createElement(y,{key:"author",a8n:"mi-msg-author",action:this.openContactChat},l10n.t("message_author",{author:t.displayName()}))),this.setState({contextMenu:{menu:n,anchor:e.target,classes:"dropdown-compact"}})},contextOpen:function(){var e=this.refs.context;e&&e.click()},contextClose:function(){this.setState({contextMenu:!1})},getMsgComponent:function(){var e=this.props,t=e.msg,n=e.position,r=e.displayType,i=e.isMsgVisible,a=r!==I.DISP_TYPE.STARRED_MSGS&&!!t.quotedMsg||!(n===L.MID||n===L.END),s=void 0;if(A.supportsFeature(A.F.REPLIES_IN)){var c=t.quotedMsgObj();c&&(s=o.createElement(C,{msg:c,rootMsg:t,displayType:r,chat:t.chat}))}return o.createElement(M,{msg:t,ref:"component",quotedMsg:s,displayAuthor:a,displayType:r,isMsgVisible:i})},onSelectClick:function(){this.props.onMessageSelect(this.props.msg,!this.state.selected)},onSelectChange:function(e){this.state.selected!==e&&this.setState({selected:e})},onDoubleClick:function(e){var t=this.props.msg;if(t.canReply()&&!this.props.selectable){var n=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1};n(this.refs.bubble,e.target)||(t.chat.composeQuotedMsg=t,h.focusChatTextInput(t.chat),this.highlight())}},render:function(){var e,t=this.props,n=t.msg,r=t.position,i=t.displayType,s=n.mediaData.mediaStage,c=i===I.DISP_TYPE.CONVERSATION;(this.state.hover&&!this.state.highlighting||this.props.current||this.state.contextMenu)&&(e=o.createElement(S,(0,a["default"])({},this.props,{key:"icon-context",ref:"context",onClick:this.onMenu})));var l;n.type===p.TYPE.PTT&&n.isFailed&&s===d.STAGE.PREPARING?l=o.createElement(w,{onResend:_.noop,errMsg:l10n.t("ptt_failed")}):A.supportsFeature(A.F.RESEND_ICON)&&c&&n.isFailed&&s!==d.STAGE.REMOTE_UPLOADING?l=o.createElement(w,{onResend:this.resend,errMsg:l10n.t("resend_message")}):!n.isUnsentMedia||s!==d.STAGE.ERROR_MISSING&&s!==d.STAGE.ERROR_UNSUPPORTED||(l=o.createElement(w,{onResend:_.noop,errMsg:l10n.t("send_failed")}));var u=!n.isNotification&&this.props.selectable?o.createElement("div",{className:"msg-select",onClick:this.onSelectClick},o.createElement(b,{onChange:this.onSelectClick,checked:this.state.selected})):null,h=r===L.MID||r===L.END,f=k.match(n.body),m=n.type===p.TYPE.CHAT&&1===f.length&&_.first(f)[0].length===n.body.length,g="message-"+(n.mediaData.isGif?p.TYPE.IMAGE:n.type),v=n.type===p.TYPE.CIPHERTEXT||n.type===p.TYPE.UNKNOWN,y=n.type===p.TYPE.CHAT&&!n.linkPreview,E=n.chat&&n.chat.isPSA,M={wrapper:D("msg",{"msg-continuation":r===L.FRONT||r===L.MID,"msg-group":n.isGroupMsg&&!h,"msg-psa":i!==I.DISP_TYPE.STARRED_MSGS&&E,selected:this.state.selected}),container:D("message "+g,{"message-system":n.isNotification,"message-out":!n.isNotification&&n.isSentByMe,"message-in":!n.isNotification&&!n.isSentByMe,hover:this.state.contextMenu||this.state.hover,tail:!(E||this.props.tailOverride||r!==L.FRONT&&r!==L.SINGLE),"tail-override-left":"left"===this.props.tailOverride,"tail-override-right":"right"===this.props.tailOverride,"message-chat":y||v,"message-code":m,"message-placeholder":v})},C=this.state.contextMenu?"none":"pop-fast",T=o.createElement("span",{className:"tail-container highlight",ref:"highlightTail"}),x=void 0;this.state.contextMenu&&(x=o.createElement(P,{displayName:"MsgContextMenu",escapable:!0,popable:!0,requestDismiss:this.contextClose},o.createElement(N,{contextMenu:this.state.contextMenu})));var O=void 0;return c&&!this.props.selectable&&n.canForward()&&(n.isMedia||n.linkPreview)&&(O=o.createElement("div",{className:"icon icon-forward-chat btn-forward-chat",onClick:this.openSingleForwardFlow})),o.createElement("div",{className:M.wrapper,onDoubleClick:this.onDoubleClick},o.createElement(R,{transitionName:"delay-leave"},u),o.createElement("div",{className:M.container,ref:"bubble"},o.createElement("div",{onContextMenu:this.contextMenu,onMouseOver:this.mouseEnter,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave},o.createElement("span",{className:"tail-container"}),"  ",T,"                      ",l,this.getMsgComponent(),o.createElement(R,{transitionName:C},e)),O),x)}});U.Position=L,e.exports=U},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1136),s=r(o),c=n(6),l=n(1247),u=n(432),d=n(1229),p=n(8),h=n(14),f=n(1232),m=n(1465),g=c.createClass({displayName:"ForwardMessageFlow",mixins:[l],propTypes:{msgs:c.PropTypes.arrayOf(c.PropTypes.instanceOf(d)).isRequired,onFoward:c.PropTypes.func,isGroupInviteForward:c.PropTypes.bool},getDefaultTransition:function(){var e;return e={},(0,s["default"])(e,l.Dir.PUSH,l.Transition.NONE),(0,s["default"])(e,l.Dir.POP,l.Transition.NONE),e},componentWillMount:function(){var e=void 0;e=this.props.isGroupInviteForward?l10n.t("group_invite_send_link_title"):l10n.t("forward_message_to",{_plural:this.props.msgs.length});var t=_.head(this.props.msgs)&&_.head(this.props.msgs).chat;this.push(c.createElement(m,{onChat:this.confirmForward,excludeChat:t,title:e}))},checkCanForward:function(){return a["default"].map(this.props.msgs,function(e){return a["default"].props({message:e,canForward:e.canForward()})})},confirmForward:function(e){var t,n=!1;this.props.isGroupInviteForward?t=e.isGroup?l10n.t("confirm_send_to_group",{chat:e.title()}):l10n.t("confirm_send_to_contact",{chat:e.title()}):e.isGroup?t=l10n.t("confirm_forward_to_group",{chat:e.title()}):e.isUser&&e.contact.isBlocked()?(t=l10n.t("confirm_unblock_contact_and_forward",{chat:e.title()}),n=!0):t=l10n.t("confirm_forward_to_contact",{chat:e.title()}),this.push(c.createElement(u,{onOK:_.partial(this.onForwardConfirmed,e,n),okText:l10n.t("forward"),onCancel:this.pop.bind(null,void 0),key:"ConfirmPopup",cancelText:l10n.t("web_cancel")},c.createElement(f,{text:t})))},onForwardConfirmed:function(e,t){var n,r=this,i=Date.now();n=t?e.contact.setBlock(!1):a["default"].resolve(!0),a["default"].all([this.checkCanForward(),n]).spread(function(t,n){var r=_.map(_.filter(t,{canForward:!0}),"message"),i=_.map(_.filter(t,{canForward:!1}),"message");return a["default"].props({undelivered:e.forwardMessages(r),canForward:r,cannotForward:i})}).then(function(t){var n=t.undelivered,a=t.canForward,o=t.cannotForward;(n.length||o.length)&&r.showMediaSendError(e,a,o,n,i)})["catch"](h.ContactBlocked,function(){r.showContactBlocked(e,i)}),this.endFlow(),_.isFunction(this.props.onForward)&&this.props.onForward(this.props.msgs),p.openChatFromUnread(e).then(function(t){t&&p.focusChatTextInput(e)})},showContactBlocked:function(e,t){var n=Date.now()-t>1e3&&void 0;p.openModal(c.createElement(u,{key:"contactBlocked",onOK:p.closeModal.bind(p)},l10n.t("web_cannot_send_to_blocked_contact_1",{contact:e.contact.formattedName})),n)},showMediaSendError:function(e,t,n,r,i){var a=t.length-r.length,o=[];if(a){o.push(l10n.t("forwarded_some_messages",{count:a,_plural:a}));var s=void 0,l=n.length+r.length;s=r.length?n.length?e.isUser?l10n.t("cannot_forward_media_missing_and_capability_contact",{count:l,_plural:l,contact:e.title()}):l10n.t("cannot_forward_media_missing_and_capability_group",{count:l,_plural:l}):l10n.t("cannot_forward_media_missing",{count:l,_plural:l}):e.isUser?l10n.t("cannot_forward_capability_contact",{count:l,_plural:l,contact:e.title()}):l10n.t("cannot_forward_capability_group",{count:l,_plural:l}),s&&o.push(s)}else{var d=void 0;d=r.length?n.length?e.isUser?l10n.t("cannot_forward_media_missing_and_capability_contact_none",{contact:e.title()}):l10n.t("cannot_forward_media_missing_and_capability_group_none"):l10n.t("cannot_forward_media_missing_none"):e.isUser?l10n.t("cannot_forward_capability_contact_none",{contact:e.title()}):l10n.t("cannot_forward_capability_group_none"),d&&o.push(d)}p.openModal(c.createElement(u,{onOK:p.closeModal.bind(p),okText:l10n.t("web_ok")},o.map(function(e,t){return c.createElement("p",{key:t},e)})),!1)},onForwardConfirmed2:function(e){var t=this,n=this.checkCanForward();a["default"].map(e,function(e){var t=void 0;return t=e.isUser&&e.contact.isBlocked()?e.contact.setBlock(!1):a["default"].resolve(!0),a["default"].all([n,t]).spread(function(t,n){var r=_.map(_.filter(t,{canForward:!0}),"message"),i=_.map(_.filter(t,{canForward:!1}),"message");return a["default"].props({chat:e,undelivered:e.forwardMessages(r),canForward:r,cannotForward:i})})}).then(function(e){var n=_.compact(e.map(function(e){var n=e.chat,r=e.undelivered,i=e.canForward,a=e.cannotForward,o=null;return(r.length||a.length)&&(o=t.getForwardFailReason(n,r,i,a)),o?{chat:n,reason:o}:null}));n.length&&t.showMediaSendError2(n)}),this.endFlow(),_.isFunction(this.props.onForward)&&this.props.onForward(this.props.msgs),p.openChatFromUnread(_.head(e))},getForwardFailReason:function(e,t,n,r){var i=n.length-t.length,a=void 0;if(i){var o=r.length+t.length;a=t.length?r.length?e.isUser?l10n.t("cannot_forward_media_missing_and_capability_contact",{count:o,_plural:o,contact:e.formattedTitle}):l10n.t("cannot_forward_media_missing_and_capability_group",{count:o,_plural:o}):l10n.t("cannot_forward_media_missing",{count:o,_plural:o}):e.isUser?l10n.t("cannot_forward_capability_contact",{count:o,_plural:o,contact:e.formattedTitle}):l10n.t("cannot_forward_capability_group",{count:o,_plural:o})}else a=t.length?r.length?e.isUser?l10n.t("cannot_forward_media_missing_and_capability_contact_none",{contact:e.formattedTitle}):l10n.t("cannot_forward_media_missing_and_capability_group_none"):l10n.t("cannot_forward_media_missing_none"):e.isUser?l10n.t("cannot_forward_capability_contact_none",{contact:e.formattedTitle}):l10n.t("cannot_forward_capability_group_none");return a},showMediaSendError2:function(e){var t=e.map(function(e){var t=e.chat,n=e.reason;return c.createElement("p",{key:t.id},t.formattedTitle," : ",n)});p.openModal(c.createElement(u,{onOK:p.closeModal.bind(p),okText:l10n.t("web_ok")},t),void 0)}});e.exports=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(1),c=n(443),l=n(445),u=n(219),d=n(87),p=n(55),h=n(8),f=n(104),m=n(14),g=n(10),v=n(435),y=n(67).ActionToast,_=n(67).ActionType,E=d.extend({props:{id:"string",isAdmin:"boolean"},children:{contact:u},initialize:function(){this.contact=Store.Contact.gadd({id:this.id}),this.listenTo(this.contact,"all",this._getCachedEventBubblingHandler("contact"))}}),b=c.extend(l,{model:E,comparator:function(e,t){return u.Comparator(e.contact,t.contact)},initialize:function(){this.listenTo(this,"change:contact.name",this.sort),this.listenTo(h,"locale_change",this.sort)},addParticipant:function(e,t){var n=this;if(this.get(e.id))return h.openToast(o.createElement(v,{id:v.genId(),msg:l10n.t("action_participant_failed_already_added",{participant:e.formattedShortName})})),a["default"].reject(new m.ActionError);if(!this.canAdd())return a["default"].reject(new m.ActionError);var r=p.addParticipant(this.parent.id,e.id),i=new _(l10n.t("action_participant_adding",{participant:e.formattedShortName}));t=t||y.genId();var c=r.then(function(t){return 200===t.status?new _(l10n.t("action_participant_added",{participant:e.formattedShortName})):404===t.status?new _(l10n.t("action_participant_add_failed")+" "+l10n.t("action_participant_failed_404")):401===t.status?new _(l10n.t("action_participant_add_failed")+" "+l10n.t("action_participant_failed_401")):403===t.status?new _(l10n.t("action_participant_add_failed")+" "+l10n.t("action_participant_failed_403")):void 0})["catch"](function(r){return s.error("models:groupMetadata:participantCollection:addParticipant dropped")(r),new _(l10n.t("action_participant_add_failed"),l10n.t("action_try_again"),n.addParticipant.bind(n,e,t))});return h.openToast(o.createElement(y,{id:t,initialAction:i,pendingAction:c})),r},removeParticipant:function(e,t){var n=this;if(!this.canRemove(e))return a["default"].reject(new m.ActionError);var r=p.removeParticipant(this.parent.id,e.id),i=new _(l10n.t("action_participant_removing",{participant:e.contact.formattedShortName}));t=t||y.genId();var c=r.then(function(t){return 200===t.status?new _(l10n.t("action_participant_removed",{participant:e.contact.formattedShortName})):404===t.status?new _(l10n.t("action_participant_remove_failed")+" "+l10n.t("action_participant_failed_404")):401===t.status?new _(l10n.t("action_participant_remove_failed")+" "+l10n.t("action_participant_failed_401")):403===t.status?new _(l10n.t("action_participant_remove_failed")+" "+l10n.t("action_participant_failed_403")):void 0})["catch"](function(r){return s.error("models:groupMetadata:participantCollection:removeParticipant dropped")(r),new _(l10n.t("action_participant_remove_failed"),l10n.t("action_try_again"),n.removeParticipant.bind(n,e,t))});return h.openToast(o.createElement(y,{id:t,initialAction:i,pendingAction:c})),r},promoteParticipant:function(e,t){var n=this;if(!this.canPromote(e))return a["default"].reject(new m.ActionError);var r=p.promoteParticipant(this.parent.id,e.id),i=new _(l10n.t("action_participant_promoting",{participant:e.contact.formattedShortName}));t=t||y.genId();var c=r.then(function(t){return 200===t.status?new _(l10n.t("action_participant_promoted",{participant:e.contact.formattedShortName})):404===t.status?new _(l10n.t("action_participant_promote_failed")+" "+l10n.t("action_participant_failed_404")):401===t.status?new _(l10n.t("action_participant_promote_failed")+" "+l10n.t("action_participant_failed_401")):403===t.status?new _(l10n.t("action_participant_promote_failed")+" "+l10n.t("action_participant_failed_403")):void 0})["catch"](function(r){return s.error("models:groupMetadata:participantCollection:removeParticipant dropped")(r),new _(l10n.t("action_participant_promote_failed"),l10n.t("action_try_again"),n.promoteParticipant.bind(n,e,t))});return h.openToast(o.createElement(y,{id:t,initialAction:i,pendingAction:c})),r},canAdd:function(){return!!f.supportsFeature(f.F.GROUP_ADD_PARTICIPANT)&&!!this.iAmAdmin()},canPromote:function(e){return!!f.supportsFeature(f.F.GROUP_PROMOTE_PARTICIPANT)&&(!!e&&(Store.Conn.me!==e.id&&(!!this.iAmAdmin()&&!e.isAdmin)))},canRemove:function(e){return!!f.supportsFeature(f.F.GROUP_REMOVE_PARTICIPANT)&&(!!e&&(Store.Conn.me!==e.id&&!!this.iAmAdmin()))},canVerifyIdentity:function(e){return!!f.supportsFeature(f.F.QUERY_IDENTITY)&&(!!e&&(Store.Conn.me!==e.id&&!!e.contact.plaintextDisabled))},iAmMember:function(){return 1===this.where({id:Store.Conn.me}).length},iAmAdmin:function(){return 1===this.where({id:Store.Conn.me,isAdmin:!0}).length}}),w=d.extend({Collection:"GroupMetadata",props:{id:"string",creation:"number",owner:"string"},session:{stale:["boolean",!1,!0],trusted:["boolean",!1,!0],inviteCode:"string",promises:{type:"object","default":function(){return{}}}},derived:{groupInviteLink:{deps:["inviteCode"],fn:function(){return this.inviteCode?""+g.GROUP_INVITE_LINK_URL+this.inviteCode:null}}},collections:{participants:b},"delete":function(){d.prototype["delete"].call(this),Store.GroupMetadata.remove(this.id),this.participants.invokeMap("delete"),this.participants.stopListening(),this.participants.reset()},canSetSubject:function(){return!!f.supportsFeature(f.F.GROUP_SET_SUBJECT)&&!!this.participants.iAmMember()},initialize:function(){this.listenTo(this.participants,"change:isAdmin change:contact.isMyContact sort remove reset",this.isTrusted),this.listenTo(this,"change:owner",this.isTrusted),this.isTrusted(),this.listenTo(this.participants,"add remove reset",this.onParticipantChange)},isTrusted:function(){if(this.stale)return this.trusted;if(!this.owner)return this.trusted=!1;if(this.owner===Store.Conn.me)return this.trusted=!0;var e=Store.Contact.get(this.owner);if(e&&e.isMyContact)return this.trusted=!0;for(var t=this.participants.models,n=0,r=t.length;n<r;++n){var i=t[n];if(i.isAdmin&&i.id!==Store.Conn.me&&i.contact.isMyContact)return this.trusted=!0}return this.trusted=!1},onParticipantChange:function(){Store.Contact.get(this.id).unset("_capabilities"),Store.GroupMetadata.trigger("group_participant_change",this.id)},groupInviteCode:function(){var e=this;return this.promises.groupInviteCode?this.promises.groupInviteCode:this.promises.groupInviteCode=p.groupInviteCode(this.id).then(function(t){var n=t.status,r=t.code;return 200===n&&(e.inviteCode=r),n})["finally"](function(){e.promises.groupInviteCode=null})},revokeGroupInvite:function(){var e=this;return this.promises.revokeGroupInvite?this.promises.revokeGroupInvite:this.promises.revokeGroupInvite=p.revokeGroupInvite(this.id).then(function(t){var n=t.status,r=t.code;return 200===n&&(e.inviteCode=r),n})["finally"](function(){e.promises.revokeGroupInvite=null})}});e.exports=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(10),s=n(1),c=n(24),l=n(87),u=n(443),d=n(55),p=n(143),h=1500,f=2e3,m=l.extend({props:{id:"string",type:{type:"string",values:["available","unavailable","composing","recording"]},t:{type:"number",allowNull:!0},deny:"boolean"},session:{updateTime:"number",_expireTimerId:["number",!1,0]}}),g=u.extend({model:m}),v=l.extend({Collection:"Presence",props:{id:"string"},session:{isOnline:"boolean",stale:["boolean",!1,!0],hasData:["boolean",!1,!1],isSubscribed:["boolean",!1,!1],withholdDisplay:["boolean",!1,!0],forceDisplay:["boolean",!1,!1],chatActive:["boolean",!1,!1],withholdDisplayTimer:"number",forceDisplayTimer:"number"},children:{chatstate:m
},collections:{chatstates:g},derived:{isGroup:{fn:function(){return c.isGroup(this.id)}},isUser:{fn:function(){return c.isUser(this.id)}}},initialize:function(){this.isGroup?(this.chatstate.set({id:"",type:"unavailable"}),this.listenTo(this.chatstates,"add change",_.debounce(function(){var e,t=!1;this.chatstates.forEach(function(n){"composing"!==n.type&&"recording"!==n.type||e&&!(e.updateTime<n.updateTime)||(e=n),t=t||"unavailable"!==n.type}),this.set({isOnline:t,chatstate:{id:e?e.id:"",type:e?e.type:"unavailable"}})}))):(this.chatstate.set({id:this.id}),this.listenTo(this.chatstate,"change:type",function(){this.isOnline="unavailable"!==this.chatstate.type})),this.listenTo(this,"change:chatActive",this.onChatActiveChange)},"delete":function(){l.prototype["delete"].call(this),Store.Presence.remove(this.id),this.chatstate["delete"](),this.chatstates.forEach(function(e){e["delete"]()})},handle:function(e){"undefined"==typeof e.type?e.type=this.chatstate.type||"unavailable":"paused"===e.type&&(e.type="available"),this.isGroup&&"available"!==e.type&&(e.updateTime=Date.now());var t;if(this.isGroup){if(e.id=e.participant,e.participant=void 0,!e.id)return;t=this.chatstates.add(e,{merge:!0})}else t=this.chatstate.set(e);t._expireTimerId&&clearTimeout(t._expireTimerId),"composing"===t.type||"recording"===t.type?t._expireTimerId=_.delay(this._expireComposing,o.PRESENCE_COMPOSING_TIMEOUT,t):t._expireTimerId=0;var n=this.forceDisplay||this.isOnline||this.isUser&&!this.chatstate.deny;this.set({hasData:!0,forceDisplay:n})},_expireComposing:function(e){var t=e.type;"composing"===t||"recording"===t?e.type="available":s.error("models:presence:expireComposing "+t)()},reset:function(){this.hasData=!1,this.isGroup?this.chatstates.forEach(function(e){e.type="unavailable"}):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})},isActive:function(){var e=this.chatstate.type;return this.hasData&&("composing"===e||"recording"===e)},getFormattedString:function(){if(!this.hasData)return null;if(this.isGroup){var e=this.chatstate.id;if(!e)return null;var t=Store.Contact.get(e);if(!t)return null;var n=t.formattedShortName;return"composing"===this.chatstate.type?l10n.t("web_conversation_name_is_composing",{participant:n}):l10n.t("web_conversation_name_is_recording",{participant:n})}if(!this.isUser)return null;var r=this.chatstate;switch(r.type){case"available":return l10n.t("web_conversation_contact_online");case"composing":return l10n.t("web_conversation_is_composing");case"recording":return l10n.t("web_conversation_is_recording");case"unavailable":return r.deny||!r.t?null:p.lastSeenStr(r.t)}},onChatActiveChange:function(){var e=this.chatActive;e?(this.hasData?this.withholdDisplay=!1:this.withholdDisplayTimer=_.delay(function(e){e.set({withholdDisplay:!1,withholdDisplayTimer:0})},h,this),this.forceDisplayTimer=_.delay(function(e){e.set({forceDisplay:!0,forceDisplayTimer:0})},f,this)):(this.withholdDisplayTimer&&(clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=0),this.forceDisplayTimer&&(clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=0))},subscribe:function(){return this.isSubscribed?a["default"].resolve():this.isUser?this.update():this.isGroup?(this.isSubscribed=!0,a["default"].all([this.update(),d.presenceSubscribe(this.id)]).bind(this)["catch"](function(e){return this.isSubscribed=!1,a["default"].reject(e)})):a["default"].resolve()}});e.exports=v},function(e,t,n){"use strict";function r(){if(!a){var e=n(1549),t=e.length/2;a=new Int32Array(t),o=new Int32Array(t);for(var r=0,i=0;r<t;r++,i+=2)a[r]=e[i]+(0===r?0:a[r-1]),o[r]=e[i+1]}}function i(e){r();for(var t=0;t<e.length;t++){var n=0|e.charCodeAt(t);if(55296<=n&&n<56320){if(++t===e.length)break;var i=e.charCodeAt(t);if(!(56320<=i&&i<57344))continue;n=65536+((1023&n)<<10|1023&i)}else if(56320<=n&&n<57344)continue;if(!(n<a[0])){for(var s=0|a.length,c=0,l=s-1|0;c<l;){var u=l+c>>1;if(a[u]>n)l=u-1|0;else{if(a[u+1]>n){l=u;break}c=u+1|0}}var d=o[l],p=a[l]+Math.abs(d)|0;if(n<p)return d<0?"rtl":"ltr"}}}var a,o;e.exports={dir:i}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(e=e.replace(E,""),e=e.replace(P,""),e=e.replace(I,"$1"),e=e.replace(R,"$1"),!D.test(e)&&O.test(e)){for(var n,r=t.getRangeAt(0).startContainer,i=0;i<5&&!(n=r.getAttribute&&r.getAttribute("data-id"));i++)r=r.parentNode;var a=Store.Msg.get(n);if(a){var o="["+g.timeStr(a.t)+"]",s=a.senderObj.formattedUser;e=C+o+" "+s+": "+S+e}}e=e.replace(A,"");var c=e.match(O);return c&&1===c.length&&(e=e.replace(O,"")),e=e.replace(O,"\n$1"),"\n"===e.charAt(0)&&(e=e.slice(1)),e}function a(e){var t=_.range(e.rangeCount).map(function(t){return e.getRangeAt(t).cloneContents()}).map(c).join("");return i(t,e)}function o(e){var t={},n=_.range(e.rangeCount).map(function(t){return e.getRangeAt(t).cloneContents()}).map(function(e){return l(e,t)}).join("");return(0,h["default"])({text:i(n,e),jids:t})}function s(e){var t=_.range(e.rangeCount).map(function(t){return e.getRangeAt(t).cloneContents()}).map(c).join("");if(t.indexOf(b)>-1){var n=_.compact(t.match(M));if(n.length)return n.join("\n").replace(w,"")}return t}function c(e){return e instanceof HTMLImageElement?e.alt:e.nodeType===Node.TEXT_NODE?e.nodeValue:_.map(e.childNodes,c).join("")}function l(e,t){if(e instanceof HTMLImageElement)return e.alt;if(e.nodeType===Node.TEXT_NODE)return e.nodeValue;if(d(e)){var n=e.getAttribute("data-jid");return t[n]=!0,"@"+f.user(n)}var r=u(e)||"",i=_.map(e.childNodes,function(e){return l(e,t)}).join("");return r?""+r+i+r:i}function u(e){switch(e.tagName){case"CODE":return"```";case"STRONG":return"*";case"EM":return"_";case"DEL":return"~";default:return""}}function d(e){return e&&e instanceof HTMLSpanElement&&e.hasAttribute("data-jid")&&e.getAttribute("data-display")===m.NodeToEmoji(e)}var p=n(16),h=r(p),f=n(24),m=n(436),g=n(143),v="​",y="⁠",E=new RegExp(v,"g"),b=""+v+y+v,w=new RegExp(""+b),M=new RegExp("(?:"+b+"|^)(.+?)(?:"+b+"|$)","g"),C=y+y,S=y+y+y,T=C+"([^"+y+"]+)"+S,k=y+y+y+y,x=y+y+y+y+y,N=k+"[^"+y+"]+"+x,P=new RegExp(N,"g"),O=new RegExp(T,"g"),D=new RegExp("^"+T),A=new RegExp(T+"$"),I=new RegExp("^[^"+y+"]+"+x+"(.*)","g"),R=new RegExp("(.*)"+k+"[^"+y+"]+$","g");e.exports={asPlainText:a,asRichText:o,formatDelim:u,extractIsolatedBlocks:s}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(8),c=n(14),l=n(1263),u=n(1),d={start:function(e){var t=this;if("camera"!==e&&"microphone"!==e)return void u.error("mediaCapture:start incompatible type given")();var n=new a["default"](function(r,i){t.timeout=setTimeout(function(){var t="camera"===e?"guide_desktop_camera_title":"guide_desktop_mic_title",n="camera"===e?"guide_desktop_camera_description":"guide_desktop_mic_description";s.openModal(o.createElement(l,{title:t,desc:n,type:l.TYPE.GUIDE_ALLOW}))},1e3);var a="camera"===e?{video:!0}:{audio:!0};navigator.getUserMedia(a,function(e){s.closeModal(),clearTimeout(t.timeout),r(e)},function(e){var r=_.isString(e)?e:e.name,a=c.GUM[r]||c.GUM.GUMError;clearTimeout(t.timeout),i(new a),n&&!n.isPending()&&s.closeModal()})});return n},stop:function(e){if(_.isFunction(e.stop))e.stop();else for(var t=e.getTracks(),n=0;n<t.length;n++)t[n].stop()}};e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1258),m=function(e){function t(e,n,r){(0,s["default"])(this,t);var i=(0,d["default"])(this,(0,a["default"])(t).call(this));return i._delimiter=e,i._regex=n,i._group=r,i}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"match",value:function n(e){for(var t=[],n=void 0;n=this._regex.exec(e);){var r=this._delimiter.length,i=2*r+n[this._group].length;if(n[0].length!==i){var a=n[0].length-i;n.index+=a,n[0]=n[0].slice(a)}this._regex.lastIndex--,t.push(n)}return t}},{key:"group",get:function(){return this._group}},{key:"isFormatter",get:function(){return!0}}]),t}(f);e.exports=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1290),m=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).call(this,"```",/```([\s\S]+?)```/g,1))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"formatResult",get:function(){return!1}}]),t}(f);e.exports=m},function(e,t,n){"use strict";var r=n(449),i={multibyteLength:function(e){return r.ucs2.decode(e).length},multibyteSubstr:function(e,t,n){var i=r.ucs2.decode(e);if("undefined"==typeof n)i=i.slice(t);else{if(n<=0)return"";i=i.slice(t,t+n)}return r.ucs2.encode(i)}};e.exports=i},function(e,t,n){"use strict";var r=n(6),i=n(44),a=n(220).MIMETYPES,o=_.pickBy(a,function(e){return"document"===e.msgType}),s=r.createClass({displayName:"AttachMediaTypeFile",propTypes:{mimeType:r.PropTypes.string,filename:r.PropTypes.string},render:function(){var e=this.props,t=e.mimeType,n=e.filename,a="icon-doc";return o[t]&&(a=i(a,o[t].icon)),r.createElement("div",{className:"media-element-container"},r.createElement("div",{className:"media-element"},r.createElement("div",{className:"media-document"},r.createElement("div",{className:a}),r.createElement("div",{className:"media-document-text"},n))))}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(1230),o=n(44),s=r.createClass({displayName:"MsgAck",mixins:[a],propTypes:{msg:r.PropTypes.instanceOf(i)},getInitialState:function(){return{ack:this.async("msg.ack")}},render:function(){var e=this.props.msg.ack,t=o("icon",{"icon-status-time":e<1,"icon-status-check":1===e,"icon-status-dblcheck":2===e,"icon-status-dblcheck-ack":e>2});return r.createElement("span",{className:t})}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1253),s=r(o),c=n(6),l=n(1),u=n(1238),d=n(1411),p=n(1342),h=n(1254),f=n(1252),m=n(437),g=n(1388),v=n(144),y=n(432),E=n(218),b=n(1261),w=n(8),M=n(10),C=n(44),S=n(106),T=200,k=1.3,x=2,N={GROUP:"group",PROFILE:"profile",NO_EDIT:"no_edit"},P=c.createClass({displayName:"PhotoPicker",propTypes:{startImage:c.PropTypes.string,type:c.PropTypes.oneOf(_.values(N)).isRequired,id:c.PropTypes.string,pending:c.PropTypes.bool,className:c.PropTypes.oneOfType([c.PropTypes.string,c.PropTypes.arrayOf(c.PropTypes.string),c.PropTypes.objectOf(c.PropTypes.bool)]),onImageSet:c.PropTypes.func.isRequired},statics:{Type:N},getInitialState:function(){return{img:this.props.startImage,imgCanvas:null,left:0,top:0,isEditing:!1,hover:!1,contextMenu:!1}},componentWillReceiveProps:function(e){this.props.startImage!==e.startImage&&this.setState({img:e.startImage,imgCanvas:null,isEditing:!1,left:0,top:0})},cropImage:function(){if(!this.state.img)return a["default"].reject("Image missing from state");var e=this.state.imgCanvas||this.state.img,t=this.state.scale,n=Math.abs(this.state.left/t),r=Math.abs(this.state.top/t),i=T/t,o=i;i>M.MAX_PIC_SIDE?o=M.MAX_PIC_SIDE:i<M.MIN_PIC_SIDE&&(o=M.MIN_PIC_SIDE);var s;return new a["default"](function(t,a){f.crop(e,n,r,i,i,o,o,f.DATA_URL|f.CANVAS).then(function(e){var t=e.images;return s=t.dataUrl,f.crop(t.canvas,0,0,M.PROF_PIC_THUMB_SIDE,M.PROF_PIC_THUMB_SIDE,f.DATA_URL)}).then(function(e){var n=e.images;t({thumb:n.dataUrl,full:s})})["catch"](a)})},onZoomIn:function(){var e=this.state.scale*k;x<=e||this.setState({scale:e})},onZoomOut:function(){var e=this.state.scale/k;this.state.minScale>=e&&(e=this.state.minScale),this.setState({scale:e})},onCrop:function(){this.props.pending||this.cropImage().bind(this).then(function(e){this.props.onImageSet(e.thumb,e.full)})["catch"](function(){this.setState({img:this.props.startImage,imgCanvas:null,isEditing:!1})})},onDragEnd:function(e,t){this.setState({left:e,top:t})},onUpload:function(e){var t=this.refs.imageInput;return t.click(),!0},removeImage:function(){this.props.onImageSet(),w.closeModal()},onRemove:function(e){var t=this.props.type===N.GROUP?l10n.t("remove_group_icon"):l10n.t("remove_profile_photo");w.openModal(c.createElement(y,{onOK:this.removeImage,okText:l10n.t("remove"),onCancel:w.closeModal.bind(w),cancelText:l10n.t("web_cancel")},t))},onView:function(){var e=this.refs.imageContainer,t=function(t){t(e)};w.openModalMedia(c.createElement(p,{contact:Store.Contact.get(this.props.id),animateBorderRadius:!0,getZoomNode:t}),"profile-viewer")},onImageTake:function(e){this.createAndSetImage(e)},onImagePick:function(e){this.contextClose();var t=e.target.files[0];return!!t&&(this.createAndSetImage(t),void(e.target.value=""))},createAndSetImage:function(e){var t=this;f.rotateAndResize(e,3*M.IMG_MAX_EDGE,3*M.IMG_MAX_EDGE,f.DATA_URL|f.CANVAS).then(function(e){var n=e.width,r=e.height,i=e.images,a=T/Math.min(n,r);t.setState({img:i.dataUrl,imgCanvas:i.canvas,isEditing:!0,scale:a,minScale:a})})["catch"](function(e){l.error("PhotoPicker:createAndSetImage:error "+e)(e)})},onImageClick:function(e){if(this.props.type===N.NO_EDIT&&this.state.img)return void this.onView();if(!this.state.isEditing){e.stopPropagation(),e.preventDefault();var t=[];this.props.id&&this.state.img&&t.push(c.createElement(u,{a8n:"mi-view-photo",key:"view",action:this.onView},l10n.t("view_photo"))),navigator.getUserMedia&&t.push(c.createElement(d,{key:"take",onImageTake:this.onImageTake})),t.push(c.createElement(u,{a8n:"mi-upload-photo",key:"upload",action:this.onUpload},l10n.t("upload_photo"))),this.state.img&&t.push(c.createElement(u,{a8n:"mi-remove-photo",key:"remove",action:this.onRemove},l10n.t("remove_photo"))),e.persist(),this.setState({contextMenu:{menu:t,event:e}})}},contextClose:function(){this.setState({contextMenu:!1})},onMouseOver:function(e){this.state.hover||this.setState({hover:!0})},onMouseEnter:function(e){this.state.hover||this.setState({hover:!0})},onMouseLeave:function(e){this.state.hover&&this.setState({hover:!1})},onLoad:function(e){var t=e.target.clientWidth,n=e.target.clientHeight;this.setState({imageSize:{width:t,height:n}})},render:function(){var e;if(this.state.img&&this.state.isEditing){var t={width:T,height:T};e=c.createElement(g,{ref:"img",container:t,onStop:this.onDragEnd,scale:this.state.scale},c.createElement("img",{className:"avatar-original",src:this.state.img}))}else this.state.img&&(e=c.createElement(h,{type:h.TYPES.COVER,size:this.state.imageSize},c.createElement(s["default"],{src:this.state.img,crossOrigin:!1,style:{height:"100%",width:"100%"},onLoad:this.onLoad})));var n;(this.props.pending||!this.state.isEditing&&this.state.img&&!this.state.imageSize)&&(n=c.createElement("div",{className:"avatar-spinner-container"},c.createElement(v,{size:50,stroke:3})));var r=null;if(!this.props.pending&&this.props.type!==N.NO_EDIT&&(!this.state.img||this.state.imageSize)&&(!this.state.img||this.state.contextMenu||!this.state.isEditing&&this.state.hover)){var i;switch(this.props.type){case"group":i=this.state.img?l10n.t("change_group_icon"):l10n.t("add_group_icon");break;case"profile":i=this.state.img?l10n.t("change_profile_photo"):l10n.t("add_profile_photo")}r=c.createElement("div",{className:"avatar-overlay",key:"avatar-overlay"},c.createElement("span",{className:"icon icon-camera-light"}),c.createElement("div",{"data-a8n":m.key("avatar-text"),className:"avatar-overlay-text"},i))}var a,o,l=C("avatar","avatar-l","draggable-container",{"icon-group-default":this.props.type!==N.PROFILE,"icon-user-default":this.props.type===N.PROFILE});this.state.isEditing&&(a=c.createElement("div",{className:"avatar-picker-controls",key:"zoom-controls"},c.createElement("button",{className:"icon icon-plus",onClick:this.onZoomIn}),c.createElement("button",{className:"icon icon-minus",onClick:this.onZoomOut})),o=c.createElement("div",{className:"tip-container tip-avatar-picker",key:"tip-controls"},c.createElement("div",{className:"tip"},c.createElement("div",{className:"tip-body"},l10n.t("adjust_image")),c.createElement("div",{className:"tip-controls"},c.createElement("button",{className:"button",onClick:this.onCrop},l10n.t("done_adjusting"))))));var u=this.props.type===N.NO_EDIT||this.props.pending||!this.state.imageSize&&this.state.img?_.noop:this.onImageClick,d=void 0;this.state.contextMenu&&(d=c.createElement(E,{displayName:"PhotoPickerContextMenu",escapable:!0,popable:!0,requestDismiss:this.contextClose},c.createElement(b,{contextMenu:this.state.contextMenu})));var p=C("avatar-picker",this.props.className);return c.createElement("div",{className:p},c.createElement("div",{className:l,onClick:u,onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,ref:"imageContainer",dir:"ltr"},c.createElement("div",{className:"avatar-body"},e),c.createElement(S,{transitionName:"fade"},n,r)),c.createElement(S,{transitionName:"fade"},a),c.createElement(S,{transitionName:"slide"},o),c.createElement("input",{ref:"imageInput",type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",style:{display:"none"},onChange:this.onImagePick}),d)}});e.exports=P},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(441),a=r(i),o=n(1138),s=r(o),c=n(23),l=r(c),u=n(26),d=r(u),p=function(){},h=function(){function e(){(0,l["default"])(this,e),this.internalHandlers=new s["default"]}return(0,d["default"])(e,[{key:"initialize",value:function(e){this.ctx=e}},{key:"registerHandler",value:function(e,t){this.internalHandlers.set(e,t)}},{key:"unregisterHandler",value:function(e){this.internalHandlers["delete"](e)}},{key:"handle",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return(this.internalHandlers.get(e)||p).apply(void 0,(0,a["default"])(t))}}]),e}();e.exports=h},function(e,t){"use strict";var n=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=n);return t};e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(438),s=r(o),c=n(6),l=n(44),u=c.createClass({displayName:"Row",propTypes:{side:c.PropTypes.node,ellipsify:c.PropTypes.bool,classes:c.PropTypes.string,onClick:c.PropTypes.func},getDefaultProps:function(){return{ellipsify:!1}},render:function(){var e=this.props,t=e.onClick,n=e.side,r=e.ellipsify,i=e.classes,o=e.children,u=(0,s["default"])(e,["onClick","side","ellipsify","classes","children"]),d=l("row",i,{clickable:t}),p=l("row-main",{ellipsify:r}),h=n?c.createElement("div",{className:"row-side"},n):null;return c.createElement("div",(0,a["default"])({className:d,onClick:t},u),c.createElement("div",{className:"row-body"},c.createElement("div",{className:p},o),h))}});e.exports=u},function(e,t,n){"use strict";var r=n(6),i=n(1230),a=n(1232),o=n(1286),s=r.createClass({displayName:"UserSubtitle",mixins:[i],propTypes:{presence:r.PropTypes.instanceOf(o),placeholder:r.PropTypes.node,location:r.PropTypes.oneOf(["list","title"])},getInitialState:function(){return{hasData:this.async("presence.hasData"),type:this.async("presence.chatstate.type"),deny:this.async("presence.chatstate.deny"),t:this.async("presence.chatstate.t"),forceDisplay:this.async("presence.forceDisplay"),withholdDisplay:this.async("presence.withholdDisplay")}},render:function(){var e,t=this.props.presence;return"list"===this.props.location?(e=t.getFormattedString(),e?r.createElement(a,{ellipsify:!0,titlify:!0,text:e}):null):(e=t.withholdDisplay?this.props.placeholder:t.getFormattedString()||(t.forceDisplay?"":this.props.placeholder),e?r.createElement("div",{className:"chat-status ellipsify"},r.createElement(a,{ellipsify:!0,titlify:!0,text:e})):null)}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1232),a=n(1329),o=n(1229),s=r.createClass({displayName:"Caption",propTypes:{msg:r.PropTypes.instanceOf(o).isRequired},render:function(){var e=this.props.msg,t=e.mentionMap();return r.createElement("div",{className:"image-caption message-text","data-id":e.id},r.createElement(a,{msg:e}),r.createElement(i,{direction:e.dir,dirMismatch:!(!e.dir||e.rtl===l10n.isRTL()),selectable:!0,text:e.caption,linkify:!0,mention:t,format:!0,wbr:15}))}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(37),c=n(1229),l=n(141),u=n(1283),d=n(44),p=n(143),h=n(1232),f=n(1268),m=n(1237),g=n(24),v=n(84),y=n(1248),_=n(10),E=o.createClass({displayName:"StarredMsg",mixins:[l],propTypes:{msg:o.PropTypes.instanceOf(c).isRequired,isMsgVisible:o.PropTypes.func,selectable:o.PropTypes.bool,selectedMessages:o.PropTypes.instanceOf(y),onMessageSelect:o.PropTypes.func,currSelection:o.PropTypes.object,activeSelection:o.PropTypes.object,onClickMsg:o.PropTypes.func.isRequired,multiMedia:o.PropTypes.bool},getInitialState:function(){var e=this.props.currSelection,t=this.props.activeSelection,n=this.props.msg;return{hover:!1,current:!!e&&e.value===n,active:!!t&&t.value===n,focus:!1}},componentWillMount:function(){var e=this.props.msg,t=this.props.currSelection;t&&this.addObserver(t,e.id.toString(),this.onSelectionChange);var n=this.props.activeSelection;n&&this.addObserver(n,e.id.toString(),this.onActiveChange)},onSelectionChange:function(e,t){var n="focus"===e;if(n){var r=s.findDOMNode(this);v.focus(r),t&&f.scrollIntoViewIfNeeded(r)}this.setState({current:n})},onActiveChange:function(e){if("focus"===e){var t=s.findDOMNode(this);v.focus(t),f.scrollIntoViewIfNeeded(t)}this.setState({active:!!e})},mouseOver:function(){this.state.hover||this.setState({hover:!0})},mouseEnter:function(){this.state.hover||this.setState({hover:!0})},mouseLeave:function(){this.state.hover&&this.setState({hover:!1})},onEnter:function(e){e.stopPropagation(),e.preventDefault(),this.props.onClickMsg(this.props.msg)},openContextMenu:function(e){this.refs.wrapper.contextOpen()},onFocus:function(e){this.setState({focus:!0}),this.indicateFocus(e)},onBlur:function(e){this.finishFocusIndication(e),this.setState({focus:!1})},indicateFocus:function(e){if(!(Date.now()-(a["default"].flashFocus||0)>200)){var t=this.refs.row,n=this.state.active?"#d6d7d8":"#e2e3e3";Velocity(t,"stop"),Velocity(t,{backgroundColor:[n,"#cbdde7"]},{duration:1300,easing:[.19,.69,.01,.99],complete:this.finishFocusIndication})}},finishFocusIndication:function(e){var t=this.refs.row;t&&(Velocity(t,"stop"),t.style.backgroundColor="")},render:function(){var e=this,t=this.props,n=t.msg,r=t.selectedMessages,i=n.senderObj.formattedName,s=n.chat.isUser?Store.Contact.get(n.to).formattedName?Store.Contact.get(n.to).formattedName:g.formattedUser(n.to):n.chat.title(),c=d("starred-msg-wrapper",{hover:this.state.hover,current:this.state.current&&this.state.focus,active:this.state.active}),l=this.props.multiMedia?null:o.createElement("div",{className:"starred-msg-title"},o.createElement("div",{className:"starred-title-main"},o.createElement(m,{id:n.senderObj.id,size:26}),o.createElement(h,{className:"starred-msg-author",text:i,direction:"auto",ellipsify:!0,titlify:!0}),o.createElement("span",{className:"starred-title-divider"}),o.createElement(h,{className:"starred-msg-chat",text:s,direction:"auto",ellipsify:!0,titlify:!0})),o.createElement("div",{className:"starred-title-meta"},p.relativeStr(n.t)),o.createElement("div",{className:"icon icon-chevron-right-alt"})),f={enter:this.onEnter};f[l10n.LR("right","left")]=this.openContextMenu;var v=this.props.selectable||this.state.hover&&this.props.multiMedia;return o.createElement(a["default"],{handlers:f,onFocus:this.onFocus,onBlur:this.onBlur},o.createElement("div",{ref:"row",className:c,onClick:function(){return e.props.onClickMsg(n,r&&!r.isSelected(n))},onMouseEnter:this.state.hover?null:this.mouseEnter,onMouseOver:this.state.hover?null:this.mouseOver,onMouseLeave:this.state.hover?this.mouseLeave:null},l,o.createElement(u,{msg:n,key:n.id,ref:"wrapper",current:this.state.current&&this.state.focus,displayType:_.DISP_TYPE.STARRED_MSGS,isMsgVisible:this.props.isMsgVisible,selectable:v,selectedMessages:r,onMessageSelect:this.props.onMessageSelect,position:u.Position.END,tailOverride:"left"})))}});e.exports=E},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){var n=!1,r=o(t.type);if(r){if(!e.specifics)switch(r){case x.TYPE.VIDEO:e._uploadAsGif=!!t.isGif,e.specifics=new x.VideoSpecifics(t);break;case x.TYPE.IMAGE:e.specifics=new x.ImageSpecifics(t);break;case x.TYPE.AUDIO:e.specifics=new x.AudioSpecifics(t);break;case x.TYPE.DOCUMENT:e.specifics=new x.DocumentSpecifics(t);break;default:b["default"].assert(!1,"media-fault","bad type "+r)()}b["default"].assert(e.type()===r,"media-fault","type mismatch "+e.type+" !== "+r)()}var i=t.downloadStage,a=t.uploadStage;i&&i!==e.downloadStage&&(e.downloadStage=i,n=!0),a&&a!==e.uploadStage&&(e.uploadStage=a,n=!0);for(var s=0;s<N.length;s++){var c=N[s],l="streamable"!==c&&t[c];void 0!==l&&e[c]!==l&&(b["default"].assert(void 0===e[c]||"size"===c||"mediaBlob"===c&&null===e.mediaBlob,"media-fault","value mismatch for "+c+": "+e[c]+" !== "+l)(),e[c]=l,n=!0)}for(var u=e.specifics,d=u.FIELDS,p=0;p<d.length;p++){var h=d[p],f=t[h];void 0!==f&&f!==u[h]&&(u[h]=f,n=!0)}var m=e.mediaBlob,g=e.size;return m&&g!==m.size&&(e.size=m.size,n=!0),n}function o(e){switch(e){case R.IMAGE:return x.TYPE.IMAGE;case R.VIDEO:return x.TYPE.VIDEO;case R.AUDIO:case R.PTT:return x.TYPE.AUDIO;case R.DOCUMENT:return x.TYPE.DOCUMENT;default:return}}function s(e){var t={};c(t,e,N),e.specifics&&c(t,e.specifics,e.specifics.FIELDS);for(var n=e._msgs,r=n.length,i=0;i<r;i++){var a=(0,h["default"])(n[i],2),o=a[0],s=a[1];if(!s){t.mediaStage=l(o,e);for(var u=0;u<A.length;u++){var d=A[u];t[d]=o[I[d]]}o.mediaData.set(t)}}for(var p=n.length-1;p>=0;p--)n[p][1]&&n.splice(p,1);var f=e._callOnConsolidate;f&&(e._callOnConsolidate=null,f.forEach(function(e){e()}))}function c(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];e[i]=t[i]}}function l(e,t){if(!t.filehash)return D.PREPARING;if(e.id.fromMe&&e.ack<1)switch(b["default"].assert(e.local,"media-fault","unsent media system message not local")(),t.uploadStage){case O.INIT:return D.PREPARING;case O.PREPARING:return D.PREPARING;case O.UPLOADING:return D.UPLOADING;case O.NEED_UPLOAD:return D.NEED_UPLOAD;case O.ERROR_MISSING:return D.ERROR_MISSING;case O.UPLOADED:return D.SENDING}else switch(t.downloadStage){case P.INIT:return D.INIT;case P.PREPARING:return D.PREPARING;case P.REUPLOADING:return D.REUPLOADING;case P.FETCHING:return D.FETCHING;case P.PROCESSING:return D.DECRYPTING;case P.NEED_POKE:return D.NEED_POKE;case P.ERROR_MISSING:return D.ERROR_MISSING;case P.ERROR_UNSUPPORTED:return D.ERROR_UNSUPPORTED;case P.RESOLVED:return D.RESOLVED}}Object.defineProperty(t,"__esModule",{value:!0}),t.OUTWARD_TYPES=t.FIELDS_TO_MSG_PROPS=t.MSG_SPECIFIC_FIELDS=t.STAGE=t.UPLOAD_STAGE=t.DOWNLOAD_STAGE=void 0;var u=n(45),d=i(u),p=n(146),h=i(p),f=n(2),m=i(f),g=n(23),v=i(g),y=n(26),_=i(y),E=n(1),b=i(E),w=n(89),M=i(w),C=n(55),S=i(C),T=n(1459),k=n(1303),x=r(k),N=["mediaBlob","size","filehash","mimetype"],P=t.DOWNLOAD_STAGE={INIT:"INIT",PREPARING:"PREPARING",REUPLOADING:"REUPLOADING",FETCHING:"FETCHING",PROCESSING:"PROCESSING",NEED_POKE:"NEED_POKE",ERROR_MISSING:"ERROR_MISSING",ERROR_UNSUPPORTED:"ERROR_UNSUPPORTED",RESOLVED:"RESOLVED"},O=t.UPLOAD_STAGE={INIT:"INIT",PREPARING:"PREPARING",UPLOADING:"UPLOADING",NEED_UPLOAD:"NEED_UPLOAD",ERROR_MISSING:"ERROR_MISSING",UPLOADED:"UPLOADED"},D=t.STAGE={INIT:"INIT",PREPARING:"PREPARING",UPLOADING:"UPLOADING",SENDING:"SENDING",REUPLOADING:"REUPLOADING",FETCHING:"FETCHING",DECRYPTING:"DECRYPTING",RESOLVED:"RESOLVED",NEED_POKE:"NEED_POKE",NEED_UPLOAD:"NEED_UPLOAD",ERROR_MISSING:"ERROR_MISSING",ERROR_UNSUPPORTED:"ERROR_UNSUPPORTED",REMOTE_UPLOADING:"REMOTE_UPLOADING",REMOTE_NEED_UPLOAD:"REMOTE_NEED_UPLOAD"},A=t.MSG_SPECIFIC_FIELDS=["type","filename","isGif","gifAttribution"],I=t.FIELDS_TO_MSG_PROPS={preview:"body",encryptionKey:"mediaKey",size:"size",filehash:"filehash",mimetype:"mimetype",thumbWidth:"width",thumbHeight:"height",duration:"duration",streamable:"streamable",pageCount:"pageCount",sidecar:"streamingSidecar",type:"type",filename:"filename",isGif:"isGif",gifAttribution:"gifAttribution"},R=t.OUTWARD_TYPES={IMAGE:"image",VIDEO:"video",AUDIO:"audio",PTT:"ptt",DOCUMENT:"document",UNKNOWN:"unknown"},L=function(){function e(){var t=this;(0,v["default"])(this,e),this._msgs=[],this._notifyTimer=new M["default"](function(){s(t)}),this._uploadAsGif=!1,this._callOnConsolidate=null,this.entries=new T.MediaEntryList,this.downloadStage=P.INIT,this.uploadStage=O.INIT,this.mustDownloadMedia=!1,this.downloadPromise=null,this.uploadPromise=null,this.uploadTargets=null,this.mediaBlob=null,this.size=void 0,this.filehash=void 0,this.mimetype=void 0,this.specifics=null}return(0,_["default"])(e,[{key:"consolidate",value:function(e){return!!a(this,e)&&(this.notifyMsgsAsync(),!0)}},{key:"resolveWhenConsolidated",value:function(){var e=this;return this._notifyTimer.ts?new m["default"](function(t){e._callOnConsolidate?e._callOnConsolidate.push(t):e._callOnConsolidate=[t]}):m["default"].resolve()}},{key:"notifyMsgsAsync",value:function(){this._notifyTimer.debounce(0)}},{key:"notifyMsgsNow",value:function(){this._notifyTimer.forceRun()}},{key:"addMsg",value:function(e){for(var t=this._msgs,n=0;n<t.length;n++){var r=(0,h["default"])(t[n],2),i=r[0],a=r[1];b["default"].assert(i!==e||a,"redundant-media-msg")()}t.push([e,!1]),this.notifyMsgsAsync()}},{key:"removeMsg",value:function(e){for(var t=this._msgs,n=!1,r=0;!n&&r<t.length;r++){var i=(0,h["default"])(t[r],2),a=i[0],o=i[1];a!==e||o||(t[r][1]=!0,n=!0)}}},{key:"hasAssociatedMsgs",value:function(){for(var e=this._msgs,t=0;t<e.length;t++)if(!e[t][1])return!0;return!1}},{key:"rmr",value:function(){for(var e=this,t=void 0,n=this._msgs,r=0;!t&&r<n.length;r++){var i=(0,h["default"])(n[r],2),a=i[0],o=i[1];o||a.isUnsentPhoneMsg()||(t=a)}return b["default"].assert(t,"media-fault","rmr called on MediaObject with no msg")(),t?S["default"].requestMediaReupload(t).tap(function(n){200===n.status&&t&&e.entries.addEntry(n.url,n.mediaKey||t.mediaKey,void 0,!0)}):m["default"].reject(new Error("rmr called on MediaObject with no msg"))}},{key:"msgProps",value:function(e){var t={};c(t,this,N),this.specifics&&c(t,this.specifics,this.specifics.FIELDS),c(t,e,A);var n={};for(var r in t)n[I[r]]=t[r];return n}},{key:"addUploadTargets",value:function(e){var t=this.uploadTargets;t||(this.uploadTargets=t={});for(var n=0;n<e.length;n++)t[e[n]]=!0}},{key:"hasUploadTarget",value:function(e){return!(!this.uploadTargets||!this.uploadTargets[e])}},{key:"claimUploadTargets",value:function(){var e=this.uploadTargets;return e?(this.uploadTargets=null,(0,d["default"])(e)):[]}},{key:"type",value:function(){if(this.specifics)return this.specifics.type;throw b["default"].assert(!1,"media-fault","upload type asked with no specifics")(),new Error("MediaObject:uploadType no specific for upload")}},{key:"uploadType",value:function(){switch(this.type()){case x.TYPE.VIDEO:return this._uploadAsGif?"gif":"video";case x.TYPE.IMAGE:return"image";case x.TYPE.AUDIO:return"audio";case x.TYPE.DOCUMENT:return"document";default:throw new Error("MediaObject:uploadType has unknown specific")}}},{key:"delete",value:function(){this.specifics&&this.specifics.renderableUrl&&window.URL.revokeObjectURL(this.specifics.renderableUrl),this.downloadPromise&&this.downloadPromise.control.waitForPoke(),this.uploadPromise&&this.uploadPromise.control.cancel()}}]),e}();t["default"]=L},function(e,t){"use strict";function n(e){this.renderableUrl=e&&e.renderableUrl,this.thumbWidth=e&&e.thumbWidth,this.thumbHeight=e&&e.thumbHeight,this.fullWidth=e&&e.fullWidth,this.fullHeight=e&&e.fullHeight,this.preview=e&&e.preview,this.duration=e&&e.duration,this.streamable=e&&e.streamable,this.sidecar=e&&e.sidecar}function r(e){this.renderableUrl=e&&e.renderableUrl,this.thumbWidth=e&&e.thumbWidth,
this.thumbHeight=e&&e.thumbHeight,this.fullWidth=e&&e.fullWidth,this.fullHeight=e&&e.fullHeight,this.preview=e&&e.preview}function i(e){this.renderableUrl=e&&e.renderableUrl,this.duration=e&&e.duration}function a(e){this.renderableUrl=e&&e.renderableUrl,this.pageCount=e&&e.pageCount,this.preview=e&&e.preview}Object.defineProperty(t,"__esModule",{value:!0}),t.VideoSpecifics=n,t.ImageSpecifics=r,t.AudioSpecifics=i,t.DocumentSpecifics=a;var o=t.TYPE={VIDEO:"VIDEO",IMAGE:"IMAGE",AUDIO:"AUDIO",DOCUMENT:"DOCUMENT"};n.prototype={FIELDS:["renderableUrl","thumbWidth","thumbHeight","fullWidth","fullHeight","preview","duration","streamable","sidecar"],type:o.VIDEO},r.prototype={FIELDS:["renderableUrl","thumbWidth","thumbHeight","fullWidth","fullHeight","preview"],type:o.IMAGE},i.prototype={FIELDS:["renderableUrl","duration"],type:o.AUDIO},a.prototype={FIELDS:["renderableUrl","pageCount","preview"],type:o.DOCUMENT}},function(e,t,n){"use strict";var r=n(6),i=n(1341),a=n(1245),o=n(219),s=n(1251),c=n(1281),l=n(1239),u=n(141),d=n(44),p=r.createClass({displayName:"ContactsModal",mixins:[u],propTypes:{title:r.PropTypes.string.isRequired,contacts:r.PropTypes.arrayOf(r.PropTypes.instanceOf(o)),filter:r.PropTypes.func,onCancel:r.PropTypes.func.isRequired,onSelect:r.PropTypes.func.isRequired},getDefaultProps:function(){return{filter:function(e){return Store.Contact.isFilteredContact(e)}}},getInitialState:function(){return this.selection=new a([],function(e){return e.id}),{searchFilter:void 0}},componentWillMount:function(){this.props.contacts||this.addObserver(Store.Contact,"add remove change:name")},onSelect:function(e,t){var n=t.props.contact;this.props.filter(n)===!0&&this.props.onSelect(n)},onSearch:function(e){this.setState({searchFilter:e})},render:function(){var e=this.props,t=e.title,n=e.onCancel,a=e.filter,o=e.onSelect,u=l10n.accentFold(this.state.searchFilter),p=this.props.contacts||Store.Contact,h=p.filter(function(e){return a(e)&&(!u||u&&e.searchMatch(u))}),f=[];if(h.length){this.selection.init(h.filter(function(e){return a(e)===!0}));for(var m=void 0,g=void 0,v=h.length>10,y=0;y<h.length;y++){m=h[y],v&&m.header!==g&&f.push(r.createElement(c,{key:m.header,header:m.header}));var E=_.isString(a(m)),b=void 0;y<h.length-1&&h[y+1].header!==m.header&&(b="last");var w=void 0;E&&(w=r.createElement("div",{className:"chat-status ellipsify",title:a(m)},a(m)),b=d(b,"member")),f.push(r.createElement(s,{contact:m,active:this.selection,className:b,secondary:w,onClick:E?void 0:_.once(o.bind(null,m)),key:m.id})),g=m.header}}else f=r.createElement(l.SearchContacts,null);return r.createElement(i,{title:t,selection:this.selection,onSearch:this.onSearch,searchPlaceholder:l10n.t("search_contacts"),onSelect:this.onSelect,onCancel:n},f)}});e.exports=p},function(e,t,n){"use strict";function r(e){try{return L.exec(e)}catch(t){return l.assert(!1,"linkify-regex-error","text size: "+e.length+", error: "+t)(t),null}}function i(e){L.lastIndex=0;for(var t=[],n=void 0;n=r(e);)n=o(n),n&&t.push(n);return t}function a(e){return L.lastIndex=0,o(r(e))}function o(e){if(!e)return null;var t=e[T].length,n=e[0],r=e.index+t,i=e.index,a="_"===e[T];if(a&&i-1&&/\S/.test(e.input[i-1]))return null;if(e[P]){var o=parseInt(e[P].slice(1),10);if("0"===e[P][1]||!(0<o&&o<65536))return null}var s=c.find([A,D,O],function(t){return e[t]})||0;if(s){var l=[],u=e[s];"_"===u.slice(-1)&&"_"===n[r-1]&&(n=n.slice(0,-1),e[s]=u=u.slice(0,-1));for(var d=0,p=0,h=0;h<u.length;h++){var f=u.charCodeAt(h);f===p?(p=l.pop()||0,0===p&&(d=h)):f in R?(0!==p&&l.push(p),p=R[f]):f in I||0===p&&(d=h)}for(;0!==l.length;)l.pop();d!==u.length-1?(n=c.compact(e.slice(k,s)).join("")+u.slice(0,d+1),L.lastIndex=r+n.length):n=n.slice(t)}else n=n.slice(t);var m=n,g=e[k];return g?g=g.toLowerCase():(g=0===m.toLowerCase().indexOf("irc.")?"irc://":0===m.toLowerCase().indexOf("ftp.")?"ftp://":e[x]?"mailto:":"http://",m=g+m),{href:m,url:n,index:r,input:e.input,scheme:g,username:e[x],domain:e[N],port:e[P],path:e[O],params:e[D],anchor:e[A]}}function s(e){var t=a(e);return t&&t.url===e&&"mailto:"===t.scheme&&t.username&&!t.params&&!t.anchor?t:null}var c=n(38),l=n(1),u="abbott|ac|academy|ad|adult|ae|aero|af|ag|agency|ai|al|am|ao|app|ar|as|asia|at|au|audio|ax|az|ba|barclays|bb|bd|be|berlin|best|bet|bf|bg|bh|bi|bid|bike|bio|biz|bj|black|blog|blue|bm|bn|bnpparibas|bo|br|bradesco|brussels|bs|bt|business|buzz|bw|by|bz|bzh|ca|cab|cafe|camera|camp|canon|capital|cards|care|careers|casa|cash|casino|cat|cc|cd|center|cern|cf|cg|ch|chat|cheap|church|ci|city|cl|click|cloud|club|cm|cn|co|coach|codes|coffee|com|community|company|cool|coop|cr|cricket|cu|cv|cx|cy|cz|date|de|deals|desi|design|dev|diamonds|digital|direct|directory|dj|dk|do|dog|domains|download|dz|earth|ec|edu|education|ee|eg|email|engineering|es|et|eu|eus|events|exchange|expert|faith|farm|fi|film|finance|fit|fj|fm|fo|forsale|fr|fund|futbol|fyi|ga|gal|gallery|game|gd|gdn|ge|gg|gh|gi|gift|gl|global|gold|google|gov|gp|gq|gr|graphics|gratis|group|gs|gt|guide|guru|gy|help|hk|hm|hn|horse|host|hosting|house|how|hr|ht|hu|id|ie|il|im|in|info|ink|institute|int|international|io|iq|ir|is|ist|istanbul|it|je|jm|jo|jobs|jp|ke|kg|kh|kim|kitchen|kiwi|koeln|kp|kr|krd|kred|kw|kz|la|land|lat|lb|lc|legal|li|life|limited|link|live|lk|lol|london|love|ls|lt|ltd|lu|lv|ly|ma|market|marketing|md|me|media|men|menu|mg|mil|mk|ml|mm|mn|mo|mobi|moda|moe|monash|money|moscow|movie|mr|ms|mt|mu|museum|mv|mw|mx|my|mz|na|nagoya|name|nc|net|network|news|nf|ng|ngo|ni|nico|ninja|nl|no|np|nr|nu|nyc|nz|office|okinawa|om|one|onl|online|ooo|org|ovh|pa|paris|party|pe|pf|pg|ph|photo|photography|photos|pics|pictures|pink|pk|pl|place|plus|pm|pn|porn|post|pr|press|pro|prod|ps|pt|pub|pw|py|qa|re|red|ren|report|rest|review|reviews|rip|ro|rocks|rs|ru|run|rw|sa|sale|sc|school|science|scot|sd|se|services|sex|sexy|sg|sh|shop|show|si|site|sk|sl|sm|sn|so|social|software|solutions|soy|space|sr|st|store|stream|studio|study|style|su|support|sv|sx|sy|systems|sz|taipei|tc|team|tech|technology|tf|tg|th|tips|tj|tk|tl|tm|tn|to|today|tokyo|tools|top|town|tr|trade|training|travel|tt|tv|tw|tz|ua|ug|uk|uno|uol|us|uy|uz|va|vc|ve|ventures|vg|video|vip|vn|vote|vu|wales|wang|watch|webcam|website|wf|wiki|win|work|works|world|ws|wtf|xyz|ye|yt|za|zm|zone|zw|онлайн|рф",d="(?:http|https)://|mailto:",p="\\w|[^\\s\0-«»‘’“”]|%[0-9a-f][0-9a-f]",h="(?:"+p+")|(?:"+p+")(?:"+p+"|-)*(?:"+p+")",f="(?!_)(?:(?:"+h+")\\.)+(?:"+u+")(?!\\."+h+")",m=":\\d{1,5}",g="+@!.?,(\\[{<«‘“:",v="(?:"+p+"|[^\\s%])",y="/"+v+"*?",_="["+g+"]*(?!"+v+"|#)",E="\\?(?!"+_+")"+v+"*?",b="#"+v+"*?",w="0-9a-z!#$%&'*+/=?^_`{|}~\\-",M="\\b\\w["+w+"]*(?:\\.["+w+"]+)*",C="^|\\W\\.|[^/\\w.]|_",S="("+C+")("+d+")?("+M+"@)?("+f+")(?:(?!"+h+")|(?=_))(?:(?=[^:/?#])|("+m+")?("+y+")?("+E+")?("+b+")?(?="+_+"))",T=1,k=2,x=3,N=4,P=5,O=6,D=7,A=8,I={34:34,39:39,41:40,62:60,93:91,125:123,187:171,8217:8216,8221:8220},R={34:34,39:39,40:41,60:62,91:93,123:125,171:187,8216:8217,8220:8221},L=new RegExp(""+S,"ig");e.exports={findLink:a,findLinks:i,validateEmail:s}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(82),l=r(c),u=n(81),d=r(u),p=n(1290),h=function(e){function t(){return(0,s["default"])(this,t),(0,l["default"])(this,(0,a["default"])(t).call(this,"_",/(?:^|[*_~\s])_((?:[\S])|(?:\S[^\n]*?\S))_(?=_|\W|$)/g,1))}return(0,d["default"])(t,e),t}(p);e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1258),m=n(1305),g=m.findLinks,v=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"match",value:function(e){return g(e).map(function(e){return{0:e.url,href:e.href,input:e.input,index:e.index}})}}]),t}(f);e.exports=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1258),m=n(1257),g=m.matchAll,v=n(38),y=function(e){function t(e){(0,s["default"])(this,t);var n=(0,d["default"])(this,(0,a["default"])(t).call(this));n._map=e;var r=v.keys(e).map(v.escapeRegExp).join("|");return n._regex=new RegExp("("+r+")","g"),n}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"match",value:function(e){var t=this;return g(this._regex,e,function(e){return e.jid=t._map[e[0]].jid,e})}},{key:"mutate",value:function(e){var t=this._map[e];return"@"+t.display}}]),t}(f);e.exports=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(23),a=r(i),o=n(26),s=r(o),c=function(){function e(t){(0,a["default"])(this,e),this.args=t}return(0,s["default"])(e,[{key:"onRoot",value:function(e){return e}},{key:"onMutatorNode",value:function(e,t){return{mutator:e.mutator,children:t}}},{key:"onDelimiter",value:function(e){return e}},{key:"onText",value:function(e){return e}}]),e}();e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(82),l=r(c),u=n(81),d=r(u),p=n(1290),h=function(e){function t(){return(0,s["default"])(this,t),(0,l["default"])(this,(0,a["default"])(t).call(this,"~",/(?:^|[*_~\s])~((?:[\S])|(?:\S[^\n]*?\S))~(?=_|\W|$)/g,1))}return(0,d["default"])(t,e),t}(p);e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(82),l=r(c),u=n(81),d=r(u),p=n(1290),h=function(e){function t(){return(0,s["default"])(this,t),(0,l["default"])(this,(0,a["default"])(t).call(this,"*",/(?:^|[*_~\s])\*((?:[\S])|(?:\S[^\n]*?\S))\*(?=_|\W|$)/g,1))}return(0,d["default"])(t,e),t}(p);e.exports=h},,function(e,t,n){"use strict";var r=n(6),i=n(1231),a=n(1229),o=n(143),s=n(0),c=n(141),l=n(83),u=r.createClass({displayName:"Timestamp",mixins:[c,l],propTypes:{chat:r.PropTypes.instanceOf(i),msg:r.PropTypes.instanceOf(a)},componentWillMount:function(){this.props.chat&&this.addObserver(this.props.chat,"change:previewMessage")},componentDidMount:function(){this.maybeRegMidnight()},componentDidUpdate:function(){this.maybeRegMidnight()},rerender:function(){this.forceUpdate()},maybeRegMidnight:function(){var e=this.timestamp();if(e){this.unregCmd("midnight",this.rerender);var t=s().startOf("day").subtract(7,"day");e>=t.unix()&&this.regCmd("midnight",this.rerender)}},timestamp:function(){if(this.props.msg)return this.props.msg.t;var e=this.props.chat.previewMessage;return e&&e.t},render:function(){var e=this.timestamp();return e?r.createElement("div",{className:"chat-meta"},r.createElement("span",{className:"chat-time"},o.relativeStr(e))):null}});e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1240),a=r(i),o=n(105),s=r(o),c=n(6),l=n(37),u=n(1251),d=n(1281),p=n(1245),h=c.createClass({displayName:"ContactList",propTypes:{contacts:c.PropTypes.array.isRequired,exclude:c.PropTypes.array,onClick:c.PropTypes.func,onFocusSearch:c.PropTypes.func},getInitialState:function(){this.selection=new p(this.props.contacts,function(e){return e.id});var e=this.props.exclude;return e&&(e=_.fromPairs(e.map(function(e){return[e.id,!0]}))),{exclude:e}},componentWillReceiveProps:function(e){this.selection.init(e.contacts)},onFocusGain:function(e){e.target===l.findDOMNode(this)&&(this.selection.index<0?this.focusFirst():this.selection.reset())},focusFirst:function(){this.selection.setFirst()},onNextContact:function(e){e.preventDefault(),e.stopPropagation(),this.selection.setNext()},onPrevContact:function(e){e.preventDefault(),e.stopPropagation();var t=this.selection.prev();t>-1?this.selection.setPrev():(this.selection.unset(),this.props.onFocusSearch(e))},render:function(){for(var e,t=this.props.contacts,n=[],r=t.length>10,i=this.state.exclude||{},o="XXX",l=0;l<t.length;l++){var p=t[l];if(e=null,r){var h=p.header;l<t.length-1&&h!==t[l+1].header&&(e="last"),h!==o&&(n.push(c.createElement(d,{key:h,header:h})),o=h)}var f=p.id;n.push(c.createElement(u,{contact:p,active:this.selection,className:e,onClick:this.props.onClick,member:i[f],key:f}))}var m={down:this.onNextContact,up:this.onPrevContact};return c.createElement(s["default"],{handlers:m,onFocus:this.onFocusGain,"data-tab":3},c.createElement(a["default"],{className:"chatlist",data:n,height:72,extraItems:4}))}});e.exports=h},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(12),o=n(83),s=n(142),c=n(145),l=n(8),u=n(86),d=n(1229),p=r.createClass({displayName:"AudioTag",mixins:[o,s,c],propTypes:{msg:r.PropTypes.instanceOf(d).isRequired,className:r.PropTypes.string,controls:r.PropTypes.bool,preload:r.PropTypes.string,type:r.PropTypes.string,onClick:r.PropTypes.func,onPlay:r.PropTypes.func,onError:r.PropTypes.func,autoPlay:r.PropTypes.bool},componentDidMount:function(){var e=i.findDOMNode(this);this.regNativeListener(e,"error",this.onPlayerError,!0),this.regNativeListener(e,"playing",this.onPlaying),this.regCmd("mediaPlaying",this.onOtherPlaying),(u.isGecko||u.isSafari)&&(this.props.autoPlay?(this.checkIteration=0,this.checkForSuccessInterval=this.safeInterval(this.checkForSuccess,250)):this.props.autoPlay?this.startCheckForSuccess():this.regNativeListener(e,"play",this.startCheckForSuccess))},startCheckForSuccess:function(){this.checkIteration=0,this.checkForSuccessInterval=this.safeInterval(this.checkForSuccess,250)},clearCheckForSuccess:function(){this.checkForSuccessInterval&&(this.clearSafeInterval(this.checkForSuccessInterval),delete this.checkForSuccessInterval,delete this.checkIteration)},checkForSuccess:function(){if(a.state===a.STATE.CONNECTED){if(this.checkIteration++,this.checkIteration>40)return void this.onPlayerError({target:{src:this.state.src,error:{code:window.MediaError.MEDIA_ERR_NETWORK}}});var e=i.findDOMNode(this),t=e.buffered;t&&t.length&&t.end(0)>0&&this.onPlaying({target:e})}},onPlayerError:function(e){this.clearCheckForSuccess(),this.props.onError&&this.props.onError(e.target.src)},onOtherPlaying:function(e){e!==this&&i.findDOMNode(this).pause()},onPlaying:function(e){this.clearCheckForSuccess(),l.mediaPlaying(this),this.props.onPlay&&this.props.onPlay(e)},render:function(){return r.createElement("audio",{src:this.props.msg.mediaData.renderableUrl,className:this.props.className,onClick:this.props.onClick,controls:this.props.controls,preload:this.props.preload,type:this.props.type,autoPlay:this.props.autoPlay},this.props.children)}});e.exports=p},function(e,t,n){"use strict";var r=n(6),i=n(1231),a=n(1230),o=n(1238),s=r.createClass({displayName:"DeleteMenuItem",mixins:[a],propTypes:{chat:r.PropTypes.instanceOf(i).isRequired,onDeleteOrExit:r.PropTypes.func.isRequired},getInitialState:function(){return{isReadOnly:this.async("chat.isReadOnly")}},render:function(){var e;switch(this.props.chat.kind){case i.KIND.GROUP:e=this.props.chat.isReadOnly?l10n.t("web_delete_group"):l10n.t("web_exit_group");break;case i.KIND.BROADCAST:e=l10n.t("web_delete_list");break;case i.KIND.CHAT:e=l10n.t("delete_chat")}return r.createElement(o,{a8n:"mi-delete",action:this.props.onDeleteOrExit,shortcut:"x"},e)}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(141),a=n(1232),o=n(14),s=n(1286),c=n(1285),l=r.createClass({displayName:"GroupSubtitle",mixins:[i],propTypes:{presence:r.PropTypes.instanceOf(s),groupMetadata:r.PropTypes.instanceOf(c),placeholder:r.PropTypes.node,location:r.PropTypes.oneOf(["list","title"])},_init:function(){Store.GroupMetadata.find(this.props.groupMetadata.id)["catch"](o.WapDrop,_.noop)},componentWillMount:function(){this.uiIdle(this._init);var e=this.props.groupMetadata.participants;this.addObserver(e,"sort remove reset"),"list"!==this.props.location&&this.addObserver(this.props.presence,"change:chatstate.id change:chatstate.type change:forceDisplay change:withholdDisplay")},getSubtitle:function(){return this.props.groupMetadata.participants.map(function(e){return e.contact.formattedShortNameWithNonBreakingSpaces}).join(", ")},render:function(){var e,t=this.props.presence;return"list"===this.props.location?(e=this.getSubtitle(),e?r.createElement(a,{ellipsify:!0,titlify:!0,text:e}):null):(e=t.withholdDisplay?this.props.placeholder:t.getFormattedString()||(t.forceDisplay?this.getSubtitle():this.getSubtitle()||this.props.placeholder),e?r.createElement("div",{className:"chat-status ellipsify"},r.createElement(a,{ellipsify:!0,titlify:!0,text:e})):null)}});e.exports=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=e.duration,n=v.durationStr(t);return n?m.createElement("span",{className:"media-canvas-duration"},n):null}var a=n(36),o=r(a),s=n(23),c=r(s),l=n(26),u=r(l),d=n(82),p=r(d),h=n(81),f=r(h),m=n(6),g=(n(1229),n(1244)),v=n(143),y=n(1271),_=n(1255),E=function(e){function t(){(0,c["default"])(this,t);var e=(0,p["default"])(this,(0,o["default"])(t).apply(this,arguments));return e.onSelectClick=function(t){e.props.onMessageSelect&&e.props.onMessageSelect(e.props.msg,!e.props.selected)},e.onMouseOver=function(t){e.state.hover||e.setState({hover:!0})},e.onMouseEnter=function(t){e.state.hover||e.setState({hover:!0})},e.onMouseLeave=function(t){e.state.hover&&e.setState({hover:!1})},e.state={hover:!1},e}return(0,f["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.addListener(this.props.msg.mediaData,"change:preview")}},{key:"render",value:function(){var e=this.props,t=e.msg.mediaData,n=e.selected,r=e.selectable,a=void 0,o=null,s=null,c=null,l=null;switch(t.type){case g.TYPE.AUDIO:a="media-canvas attach-media-audio-thumb",s=m.createElement("span",{className:"icon-s icon-msg-audio-light"}),c=m.createElement(i,{duration:t.duration});break;case g.TYPE.VIDEO:o=m.createElement("div",{className:"shade"}),t.isGif?(a=t.preview?"media-canvas":"media-canvas media-video-thumb",s=m.createElement("span",{className:"icon-s icon-msg-gif-light"})):(a="media-canvas",s=m.createElement("span",{className:"icon-s icon-msg-video-light"}),c=m.createElement(i,{duration:t.duration})),t.preview&&(l={backgroundImage:'url("data:image/jpeg;base64,'+t.preview+'")'});break;case g.TYPE.IMAGE:a="media-canvas",t.renderableUrl?l={backgroundImage:"url("+t.renderableUrl+")"}:t.preview&&(l={backgroundImage:'url("data:image/jpeg;base64,'+t.preview+'")'})}var u=void 0;u=this.props.onDragStart?m.createElement("div",{className:a,style:l,onClick:this.props.onClick||null,ref:"img",onDragStart:this.props.onDragStart,draggable:!0}):m.createElement("div",{className:a,style:l,onClick:this.props.onClick||null,ref:"img"});var d=r||this.state.hover?m.createElement("div",{className:"media-select",onClick:this.onSelectClick},m.createElement("div",{className:"shade"}),m.createElement(y,{onChange:this.onSelectClick,checked:n})):null,p=null,h=null,f=null;return this.props.hoverEvent&&(p=this.onMouseOver,h=this.onMouseEnter,f=this.onMouseLeave),m.createElement("div",{className:this.props.classes,onMouseOver:p,onMouseEnter:h,onMouseLeave:f},d,u,o,s,c)}}]),t}(m.Component);e.exports=_(E)},function(e,t,n){"use strict";var r=n(6),i=n(1231),a=n(1230),o=n(1238),s=r.createClass({displayName:"MuteMenuItem",mixins:[a],propTypes:{chat:r.PropTypes.instanceOf(i).isRequired,onMute:r.PropTypes.func.isRequired},getInitialState:function(){return{isMuted:this.async("chat.mute.isMuted")}},render:function(){var e=this.props.onMute.bind(null,!this.state.isMuted);return r.createElement(o,{action:e,shortcut:"m",a8n:"mi-mute"},this.state.isMuted?l10n.t("web_menuitem_mute_off"):l10n.t("web_menuitem_mute"))}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1230),a=n(8),o=n(1298),s=n(1271),c=n(1231),l=n(432),u=r.createClass({displayName:"MuteRow",mixins:[i],propTypes:{chat:r.PropTypes.instanceOf(c).isRequired},getInitialState:function(){return this.asyncState({isMuted:"chat.mute.isMuted"})},onMute:function(e){a.muteChat(this.props.chat,e,this)},onUnmute:function(){var e=this.props.chat.isGroup?l10n.t("confirm_unmute_group"):l10n.t("confirm_unmute_chat");a.openModal(r.createElement(l,{onOK:this.unmute,okText:l10n.t("action_chat_unmute"),onCancel:function(){return a.closeModal()},cancelText:l10n.t("web_cancel")},e))},unmute:function(){this.onMute(!1),a.closeModal()},render:function(){var e=this,t=this.props.chat.mute.isMuted,n=t?this.onUnmute:function(){e.onMute(!0)},i=r.createElement(s,{checked:t,onChange:n}),a=t?l10n.t("web_chat_muted"):l10n.t("web_menuitem_mute");return r.createElement(o,{classes:"row-drawer-item",side:i,onClick:n,ellipsify:!0},r.createElement("span",{className:"title"},a))}});e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(441),a=r(i),o=n(146),s=r(o),c=n(45),l=r(c),u=function(e){for(var t={edges:{}},n=t,r=0;r<e.length;++r){for(var i=e[r],a=0;a<i.length;++a){var o=i[a];n.edges[o]||(n.edges[o]={edges:{}}),n=n.edges[o],a===i.length-1&&(n.idx=r)}n=t}return t},d=(0,l["default"])(n(456)),p=u(d),h=function(e,t){for(var n=[],r=e.length,i=t,a=0,o=void 0;(o=a)<r;){var s=i.edges[e[a++]];if(s){i=s;for(var c=i.idx;(i=i.edges[e[a]])&&++a;)void 0!==i.idx&&(c=i.idx);void 0===c?a=o+1:n.push([o,a-1]),i=t}}return n},f=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var a=e.charCodeAt(n++);if(56320===(64512&a)){t.push(""+e[n-2]+e[n-1]);continue}--n}t.push(e[n-1])}return t};e.exports=function(e){if(!e||!e.length)return[];for(var t=[],n=0,r=h(e,p),i=0;i<r.length;++i){var o=(0,s["default"])(r[i],2),c=o[0],l=o[1];c!==n&&t.push.apply(t,(0,a["default"])(f(e.substring(n,c)))),t.push(e.slice(c,l+1)),n=l+1}return n<e.length&&t.push.apply(t,(0,a["default"])(f(e.substr(n)))),t}},function(e,t,n){"use strict";var r=n(1297);e.exports=r({CHANGE:void 0,MOUNT:void 0})},function(e,t,n){"use strict";var r=n(1297);e.exports=r({SEARCH:void 0,INACTIVE:void 0,ENTER:void 0,TAB:void 0,DOWN:void 0,UP:void 0})},function(e,t,n){"use strict";var r=n(6),i=n(44),a=r.createClass({displayName:"Tooltip",propTypes:{body:r.PropTypes.node.isRequired,className:r.PropTypes.string,direction:r.PropTypes.oneOf(["top","right","bottom","left"]).isRequired},getDefaultProps:function(){return{className:null}},render:function(){var e=i("tooltip",this.props.className,this.props.direction);return r.createElement("div",{className:e},this.props.body)}});e.exports=a},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(142),o=n(1137),s=r.createClass({displayName:"Video",mixins:[a,o],propTypes:{src:r.PropTypes.string.isRequired,onPlay:r.PropTypes.func},componentDidMount:function(){var e=i.findDOMNode(this),t=this;this.regNativeListener(e,"playing",function(n){e.videoHeight&&e.videoWidth||(e.pause(),e.play()),e.videoHeight&&e.videoWidth&&t.props.onPlay(n)})},render:function(){return r.createElement("video",this.props)}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(12),o=n(83),s=n(142),c=n(145),l=n(8),u=n(86),d=n(1229),p=n(10),h=r.createClass({displayName:"VideoTag",mixins:[o,s,c],propTypes:{msg:r.PropTypes.instanceOf(d).isRequired,poster:r.PropTypes.string,style:r.PropTypes.object,className:r.PropTypes.string,controls:r.PropTypes.bool,width:r.PropTypes.number,height:r.PropTypes.number,onClick:r.PropTypes.func,onPlay:r.PropTypes.func,onError:r.PropTypes.func,autoPlay:r.PropTypes.bool,loop:r.PropTypes.bool,muted:r.PropTypes.bool,onLoad:r.PropTypes.func,onResize:r.PropTypes.func},componentDidMount:function(){var e=i.findDOMNode(this),t=this.props.msg.mediaData;t.isGif||(this.regNativeListener(e,"playing",this.onPlaying),this.regCmd("mediaPlaying",this.onOtherPlaying)),this.regNativeListener(e,"error",this.onPlayerError,!0),(u.isGecko||u.isSafari)&&(this.props.autoPlay?this.startCheckForSuccess():this.regNativeListener(e,"play",this.startCheckForSuccess))},startCheckForSuccess:function(){this.checkIteration=0,this.checkForSuccessInterval=this.safeInterval(this.checkForSuccess,250)},clearCheckForSuccess:function(){this.checkForSuccessInterval&&(this.clearSafeInterval(this.checkForSuccessInterval),delete this.checkForSuccessInterval,delete this.checkIteration)},checkForSuccess:function(){if(a.state===a.STATE.CONNECTED){if(this.checkIteration++,this.checkIteration>240)return void this.onPlayerError({target:{src:this.props.src,error:{code:window.MediaError.MEDIA_ERR_NETWORK}}});var e=i.findDOMNode(this),t=e.buffered;t&&t.length&&t.end(0)>0&&this.onPlaying({target:e})}},onPlayerError:function(e){this.clearCheckForSuccess(),this.props.onError&&this.props.onError(e)},onOtherPlaying:function(e){e!==this&&i.findDOMNode(this).pause()},onPlaying:function(e){this.clearCheckForSuccess(),l.mediaPlaying(this),this.props.onPlay&&this.props.onPlay(e)},render:function(){var e=this.props.msg.mediaData,t=e.streamable&&!e.renderableUrl?p.VIDEO_STREAM_URL+"?key="+this.props.msg.id.toString():e.renderableUrl;return r.createElement("video",{src:t,poster:this.props.poster,style:this.props.style,width:this.props.width,height:this.props.height,className:this.props.className,onClick:this.props.onClick,controls:this.props.controls,autoPlay:this.props.autoPlay,loop:this.props.loop,muted:this.props.muted,onEnded:this.props.onEnded,onLoadStart:this.props.onLoad},this.props.children)}});e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(2),s=r(o),c=n(105),l=r(c),u=n(6),d=n(37),p=n(10),h=n(1231),f=n(1334),m=n(1400),g=n(83),v=n(145),y=n(1230),E=n(141),b=n(8),w=n(432),M=n(14),C=n(439),S=n(88),T=n(1441),k=n(1333),x=n(1416),N=n(1305),P=n(1),O=n(1236),D=n(1242),A=n(104),I=n(44),R=n(218),L=n(1384),U=n(147),F=n(1440),j=function(){return A.supportsFeature(A.F.LINK_PREVIEW)||A.supportsFeature(A.F.SEND_LINK_PREVIEW)&&!1},B=u.createClass({displayName:"ComposeBox",mixins:[g,v,y,O,E],propTypes:{chat:u.PropTypes.instanceOf(h).isRequired,onPageUpDown:u.PropTypes.func.isRequired,onComposeHeightChange:u.PropTypes.func},getInitialState:function(){var e=this.props.chat;this.text=e.composeContents.text||"",this.selection=e.composeContents.selection,this.omittedURL=e.composeContents.omittedURL,this.pendingLinkPreviewPromises=[],this.preview=this.omittedURL,this.scanForLinks=this.safeDebounce(this._scanForLinks,500);var t;return t=0,{trusted:this.async("chat.trusted"),hasText:!!this.text,emojiExpanded:!1,recording:!1,linkPreview:null,quotedMsg:e.composeQuotedMsg,textsize:t}},componentWillMount:function(){var e=this.props.chat;e.composeContents={},this.regCmd("focus_chat_text_input_"+this.props.chat.id,this.restoreFocus),this.regCmd("focus_chat_text_input",this.restoreFocus),this.regCmd("paste_chat_text_input_"+this.props.chat.id,this.pasteEmojiInput),this.regCmd("enter_chat_text_input_"+this.props.chat.id,this.onSendText),this.addObserver(e,"change:composeQuotedMsg",this.onQuotedMsgChange)},componentDidMount:function(){var e=this;this.height=d.findDOMNode(this.refs.composeBlock).clientHeight,j()&&this.scanForLinks(),this.regCmd("textsize_change",function(t){e.setState({textsize:t})})},componentWillUnmount:function(){var e=this.props.chat;e.composeContents.text=this.text,e.composeContents.selection=this.selection,e.composeContents.omittedURL=this.omittedURL},pasteEmojiInput:function(e){return" "!==e||this.hasText()?void(this.refs.input&&(this.refs.input.focus(!0),this.refs.input.replaceSelection(e))):b.scrollMessages()},onMaxPasteExceeded:function(){b.openModal(u.createElement(w,{title:l10n.t("message_too_large_title"),onOK:b.closeModal.bind(b),okText:l10n.t("web_ok")},l10n.t("message_too_large_text")))},restoreFocus:function(){this.refs.input&&this.refs.input.focus()},clearLinkPreview:function(){this.preview=null,this.omitLinkPreview()},cancelPendingLinkPreviews:function(){_.forEach(this.pendingLinkPreviewPromises,function(e){return e.cancel()}),this.pendingLinkPreviewPromises=[]},omitLinkPreview:function(e){e!==!0&&this.state.linkPreview&&(this.setState({linkPreview:null}),this.omittedURL=this.preview)},omitQuotedPreview:function(e){e!==!0&&(this.props.chat.composeQuotedMsg=null)},_findFirstWebLink:function(){return _.head(N.findLinks(this.text).filter(function(e){var t=e.url;return S.isHttp(t)}))},_scanForLinks:function(){var e=this;if(!this.state.hasText)return void this.clearLinkPreview();var t=this._findFirstWebLink();if(!t)return void this.clearLinkPreview();var n=t.url;if(!this.preview||this.preview!==n){this.preview=n,this.omittedURL=null;var r=h.linkPreview(n).checkpoint(this.rejectOnUnmount()).cancellable();this.pendingLinkPreviewPromises.push(r),r.then(function(t){var n=t.url,r=t.data;e.preview&&e.preview!==n||(r.title||r.description)&&e.setState({linkPreview:r})})["catch"](M.Unmount,_.noop)["catch"](M.WapDrop,_.noop)["catch"](s["default"].CancellationError,_.noop)}},onQuotedMsgChange:function(){var e=this.props.chat,t=!1;(this.state.quotedMsg?!e.composeQuotedMsg:e.composeQuotedMsg)&&(t=!0),t&&!e.composeQuotedMsg?this.setState({quotedMsg:null}):this.setState({quotedMsg:e.composeQuotedMsg})},indicateFocus:function(e){var t=this.refs.container;if(t&&t.activate(),!(Date.now()-(l["default"].flashFocus||0)>200)){var n=d.findDOMNode(this.refs.input_hotkey);Velocity(n,"stop"),Velocity(n,{backgroundColor:["#ffffff","#D9F3FF"],borderColor:["#ffffff","#CBE4EF"]},{duration:1300,easing:[.24,.91,.01,.99]}),this.refs.input.focus(!1)}},onPageUpDown:function(e){var t=this;this.props.onPageUpDown&&(e.stopPropagation(),this.props.onPageUpDown(e),this.safeDefer(function(){return t.refs.input&&t.refs.input.focus(!0)}))},handleEmoji:function(e){this.refs.input.replaceSelection(e)},handleGif:function(e,t){var n=U.get(e,U.RESP_TYPE.BLOB).then(function(e){var n=e.response;return n.isGifHackDoNotUse=!0,n.gifAttributionHackDoNotUse=t,n})["catch"](function(e){throw P.error("failed loading gif ("+e+")")(),new M.MediaFileFailedLoad});this.closeEmojiPanel(),b.attachMediaDrawer(this.props.chat,[n])},openEmojiPanel:function(){this.state.emojiExpanded!==!0&&this.setState({emojiExpanded:!0})},closeEmojiPanel:function(){this.state.emojiExpanded!==!1&&this.setState({emojiExpanded:!1})},onPTT:function(e){this.setState({recording:e===F.REC})},preventBlur:function(e){var t=e.target,n=d.findDOMNode(this.refs.input),r=d.findDOMNode(this.refs.container);do if(t===n)return;while(t!==r&&(t=t.parentNode));e.preventDefault(),e.stopPropagation(),this.refs.input.focus(!1)},onChange:function(e){var t=d.findDOMNode(this.refs.composeBlock),n=t.clientHeight,r=n-this.height;r&&this.props.onComposeHeightChange({input:r}),this.height=n;var i=this.hasText();this.text=e;var a=this.hasText();if(a!==i&&this.setState({hasText:a}),a?(this.props.chat.presence.subscribe()["catch"](M.WapDrop,_.noop),this.props.chat.markComposing()):this.props.chat.markPaused(),j()){var o=this._findFirstWebLink();(!o&&this.preview||o&&o.url!==this.preview)&&this.clearLinkPreview(),this.scanForLinks()}},_getSendButton:function(){var e=navigator.getUserMedia&&window.AudioContext;if(this.state.hasText||!e)return u.createElement("button",{className:"icon btn-icon icon-send send-container",onClick:this.onSendText,disabled:!this.hasText});var t=this.props.chat;return u.createElement(F,{key:"ptt",chat:t,onStateChange:this.onPTT})},_restoreEmojiPanelFocus:function(){this.refs.emojiPanel&&this.refs.emojiPanel.restoreFocus()},_getPopupPanel:function(){var e=void 0;this.state.linkPreview&&(e=u.createElement(R,{displayName:"ComposeBoxLinkPreview",escapable:!0,requestDismiss:this.omitLinkPreview},u.createElement("div",{className:"compose-popup-panel"},u.createElement(x,(0,a["default"])({onOmit:this.omitLinkPreview},this.state.linkPreview)))));var t=void 0;this.state.quotedMsg&&(t=u.createElement(R,{displayName:"ComposeBoxQuotedMsg",escapable:!0,requestDismiss:this.omitQuotedPreview},u.createElement("div",{className:"compose-popup-panel"},u.createElement(k,{msg:this.state.quotedMsg,onOmit:this.omitQuotedPreview,chat:this.state.quotedMsg.chat}))));var n=null;return this.state.emojiExpanded&&(n=u.createElement(R,{displayName:"ComposeBoxEmojiPanel",escapable:!0,requestDismiss:this.closeEmojiPanel,requestFocus:this._restoreEmojiPanelFocus
},u.createElement("div",null,u.createElement(f,{ref:"emojiPanel",key:"compose-emoji-panel",onEmoji:this.handleEmoji,onFocusRelease:this.restoreFocus,onGif:p.SHOW_GIF_SEARCH?this.handleGif:void 0,text:this.text})))),u.createElement("div",{className:"compose-box-items-positioning-container"},u.createElement("div",{className:"compose-box-items-overlay-container"},u.createElement(L,{onHeightChange:this.onHeightChange},n,t,e)))},onHeightChange:function(e,t){this.props.onComposeHeightChange({overlay:e},t)},onFiles:function(e){var t=e.getFiles(),n=_.filter(t,function(e){var t=C.typeFromMimetype(e.type);return"image"===t||"video"===t});if(n.length){var r=_.reject(t,{kind:"string",type:"text/html"});if(r.length===n.length)return void b.attachMediaDrawer(this.props.chat,n)}},onSelectionChange:function(e){this.selection=e},hasText:function(){return B.hasText=this.text.trim().length>0},onEnter:function(e){e&&e.repeat||this.onSendText()},onSendText:function(){var e=this.text.trim();if(e.length){var t=/\u200B((\d+)@c\.us)\u200B/g,n=[],r=e.replace(t,function(e,t,r){return n.push(t),"@"+r});this.props.chat.sendMessage(D.emojify(r),this.state.linkPreview,this.props.chat.composeQuotedMsg,n),this.cancelPendingLinkPreviews(),this.setState({emojiExpanded:!1,hasText:!1,linkPreview:null,quotedMsg:this.props.chat.composeQuotedMsg=null}),this.props.chat.composeContents={},this.refs.input.reset(),this.text="",this.hasText()}},render:function(){var e,t=this,n=this.props.chat,r=this.state.emojiExpanded?u.createElement("button",{className:"icon icon-hide btn-emoji",onClick:this.closeEmojiPanel}):u.createElement("button",{className:"icon icon-smiley btn-emoji",onClick:this.openEmojiPanel}),i=I("input-container",{disabled:this.state.recording}),a={pagedown:this.onPageUpDown,pageup:this.onPageUpDown},o=l10n.t("type_a_message"),s=A.supportsFeature(A.F.SPAM)?u.createElement(T,{chat:n}):null,c=_.find(p.TEXTSIZE_CLASS_MAP,function(e){return e.scale===t.state.textsize});c&&(e=c.classname);var d=I("block-compose",e,{"ptt-open":this.state.recording});return u.createElement(R,{displayName:"ComposeBox",ref:"container",state:R.State.PASSIVE,requestFocus:this.restoreFocus},u.createElement(l["default"],{component:"footer",handlers:a,className:"pane-footer pane-chat-footer",onMouseDown:this.preventBlur,onContextMenu:this.preventBlur},s,u.createElement("div",{className:d,ref:"composeBlock"},r,u.createElement(l["default"],{ref:"input_hotkey",className:i,onFocus:this.indicateFocus},u.createElement(m,{placeholder:o,readOnly:this.state.recording,ref:"input",initialValue:this.text,initialSelection:this.selection,spellCheck:!0,multiline:!0,maxLength:p.MAX_TXT_MSG_SIZE,onMaxPasteExceeded:this.onMaxPasteExceeded,onEnter:this.onEnter,onFiles:this.onFiles,onChange:this.onChange,onSelect:this.onSelectionChange,className:"input"})),this._getSendButton()),this._getPopupPanel(),u.createElement(m.Suggestions,{chat:this.props.chat})))}});e.exports=B},function(e,t,n){"use strict";function r(e,t){var n=[];return n.push(o.createElement(c,{key:"info",a8n:"mi-group-info",action:function(){return s.chatInfoDrawer(e)},shortcut:"i"},l10n.t("web_group_info"))),n.push(o.createElement(c,{a8n:"mi-select-messages",key:"select",action:t,shortcut:"e"},l10n.t("web_select_messages"))),e.mute.canMute()&&n.push(o.createElement(l,{key:"mute",onMute:function(t){return s.muteChat(e,t)},chat:e})),e.canClear()&&n.push(o.createElement(c,{key:"clear",a8n:"mi-clear",shortcut:"e",action:function(){return s.clearChatMsgs(e)}},l10n.t("clear_chat"))),e.canDelete()&&n.push(o.createElement(u,{key:"delete",onDeleteOrExit:function(){return s.deleteOrExitChat(e)},chat:e})),n}function i(e,t){var n=[];return n.push(o.createElement(c,{key:"info",a8n:"mi-broadcast-info",action:function(){return s.chatInfoDrawer(e)},shortcut:"i"},l10n.t("web_list_info"))),n.push(o.createElement(c,{a8n:"mi-select-messages",key:"select",action:t,shortcut:"e"},l10n.t("web_select_messages"))),e.canClear()&&n.push(o.createElement(c,{key:"clear",a8n:"mi-clear",shortcut:"e",action:function(){return s.clearChatMsgs(e)}},l10n.t("clear_chat"))),e.canDelete()&&n.push(o.createElement(u,{key:"delete",onDeleteOrExit:function(){return s.deleteOrExitChat(e)},chat:e})),n}function a(e,t){var n=[];return e.isPSA||n.push(o.createElement(c,{key:"info",a8n:"mi-contact",action:function(){return s.chatInfoDrawer(e)},shortcut:"i"},l10n.t("web_contact_info"))),n.push(o.createElement(c,{a8n:"mi-select-messages",key:"select",action:t,shortcut:"e"},l10n.t("web_select_messages"))),e.mute.canMute()&&n.push(o.createElement(l,{key:"mute",onMute:function(t){return s.muteChat(e,t)},chat:e})),e.canClear()&&n.push(o.createElement(c,{key:"clear",a8n:"mi-clear",shortcut:"e",action:function(){return s.clearChatMsgs(e)}},l10n.t("clear_chat"))),e.canDelete()&&n.push(o.createElement(u,{key:"delete",onDeleteOrExit:function(){return s.deleteOrExitChat(e)},chat:e})),n}var o=n(6),s=n(8),c=n(1238),l=n(1319),u=n(1316);e.exports={group:r,contact:a,broadcast:i}},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(143),o=r.createClass({displayName:"HiddenText",propTypes:{msg:r.PropTypes.instanceOf(i).isRequired},render:function(){var e=this.props.msg,t=e.senderObj.formattedUser,n="["+a.timeStr(e.t)+"]";return r.createElement("span",{className:"message-pre-text"},"⁠⁠",n," ",t,": ⁠⁠⁠")}});e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1253),a=r(i),o=n(6),s=n(1246),c=n(1230),l=n(142),u=n(1229),d=n(1243),p=n(1241),h=n(88),f=n(44),m=n(447),g=n(1252),v=50,y=["foursquare.com","facebook.com","maps.google.com"],E=o.createClass({displayName:"Location",mixins:[c,l],propTypes:{msg:o.PropTypes.instanceOf(u).isRequired,quotedMsg:o.PropTypes.element,displayAuthor:o.PropTypes.bool},statics:{previewWidth:270,previewHeight:150},getInitialState:function(){var e="",t=!1,n=this.getStaticMapUrl();return g.isCached(n)&&(e=n,t=!0),{src:e,hiResAvail:t}},componentDidMount:function(){this.updateResolution(),this.regNativeListener(window,"dpichange",this.updateResolution)},getClientThumb:function(){return"data:image/jpeg;base64,"+this.async("msg.body")},getStaticMapUrl:function(){var e=this.props.msg,t=E.previewWidth,n=E.previewHeight+v,r=m.currentRes===m.RES.HIGH?2:1,i=h.build("https://maps.googleapis.com/maps/api/staticmap",{markers:"color:red|"+e.lat+", "+e.lng,zoom:14,size:t+"x"+n,scale:r,language:l10n.getLocale(),client:h.GSM_NAME});return h.gsmURL(i,h.GSM_NUMS)},getMapUrl:function(){var e=this.props.msg,t=this.loc();return t&&t.name?["https://maps.google.com/maps/search",encodeURIComponent(t.name),"@"+e.lat+","+e.lng+",17z"].join("/")+"?hl="+l10n.getLocale():h.build("https://maps.google.com/maps",{q:e.lat+","+e.lng,z:17,hl:l10n.getLocale()})},loc:function b(){var b=this.props.msg.get("loc");if(b)return b=b.split("\n"),2===b.length?{name:b[0],addr:b[1]}:{name:b}},getLocationDetails:function(){var e=this.props.msg,t=this.loc(),n=this.props.msg.clientUrl||this.getMapUrl(),r=void 0,i=void 0,a=void 0,c=h.hostname(n),l=_.isEmpty(y.filter(function(e){return c.indexOf(e)>-1}));if(a=l?o.createElement("div",{className:"location-page-host location-caption"},o.createElement(s,null,c)):null,t){r=t.name?o.createElement("a",{href:n,title:t.name,target:"_blank",className:"text-title"},o.createElement(s,null,t.name)):null;var u=f("text-contents",{"location-caption":!a});i=t.addr?o.createElement("div",{title:t.addr,className:u},o.createElement(s,null,t.addr)):null}var d=r&&i?o.createElement("div",{className:"image-caption message-text","data-id":e.id},r,i,a):null;return d},updateResolution:function(){this.setState({src:this.getStaticMapUrl()})},onImgLoaded:function(){this.state.hiResAvail||this.setState({hiResAvail:!0})},onClick:function(e){e.stopPropagation()},render:function(){var e=this.props.msg,t=this.getLocationDetails(),n=t?null:o.createElement("div",{className:"shade"}),r=this.props.displayAuthor&&p.shouldRender(e)?o.createElement(p,{msg:e}):null,i=f("bubble-location",{"bubble-location-caption":t,"bubble-broadcast":t&&e.broadcast,"bubble-star":t&&e.star}),s={background:"url("+this.getClientThumb()+")",backgroundSize:"cover",width:E.previewWidth,height:this.state.hiResAvail?void 0:E.previewHeight},c={height:E.previewHeight},l=f("image-thumb-body",{"image-thumb-location-lores":!this.state.hiResAvail});return o.createElement("div",{className:i},r,this.props.quotedMsg,o.createElement("div",{className:"image-thumb",onClick:this.onClick,style:c},o.createElement("a",{href:this.getMapUrl(),target:"_blank"},o.createElement(a["default"],{src:this.state.src,className:l,style:s,hasPrivacyChecks:!1,onLoaded:this.onImgLoaded,noXHR:!0})),n),t,o.createElement(d,{msg:e}))}});e.exports=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(1229),g=n(1242),v=n(1435),y=n(1430),_=n(1419),E=n(1429),b=n(1418),w=n(1438),M=n(1330),C=n(1431),S=n(1421),T=n(1423);n(1236);var k=n(1437),x=n(1428),N=n(1),P=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.msg,n=e.quotedMsg,r=e.displayAuthor,i=e.displayType,a=e.isMsgVisible;switch(t.type){case m.TYPE.CIPHERTEXT:return f.createElement(_,{msg:t,ref:"msg",displayAuthor:r});case m.TYPE.CHAT:return f.createElement(v,{msg:t,ref:"msg",quotedMsg:n,trusted:t.isTrusted(),senderName:t.senderObj?t.senderObj.name:void 0,displayAuthor:r});case m.TYPE.IMAGE:return f.createElement(y,{msg:t,ref:"msg",quotedMsg:n,isMsgVisible:a,displayAuthor:r});case m.TYPE.GROUP_NOTIFICATION:case m.TYPE.GP2:case m.TYPE.BROADCAST_NOTIFICATION:case m.TYPE.NOTIFICATION:case m.TYPE.E2E_NOTIFICATION:case m.TYPE.CALL_LOG:var o=t.body,s=void 0,c=void 0,l=void 0;switch(t.type){case m.TYPE.GP2:case m.TYPE.GROUP_NOTIFICATION:o=g.formatGroupNotification(t);break;case m.TYPE.BROADCAST_NOTIFICATION:o=g.formatBroadcastNotification(t.subtype,t.body);break;case m.TYPE.E2E_NOTIFICATION:o=g.formatE2ENotification(t),s=t.subtype,l=t.body,c=t.id.remote;break;case m.TYPE.CALL_LOG:o=g.formatCallLog(t,!0)}return f.createElement(E,{text:o,type:t.type,ref:"msg",e2eSubtype:s,participantJid:l,chatId:c});case m.TYPE.AUDIO:case m.TYPE.VIDEO:return t.isGif?f.createElement(T,{msg:t,ref:"msg",quotedMsg:n,isMsgVisible:a,displayType:i,displayAuthor:r}):f.createElement(b,{msg:t,ref:"msg",quotedMsg:n,isMsgVisible:a,displayAuthor:r});case m.TYPE.VCARD:return f.createElement(w,{msg:t,ref:"msg",quotedMsg:n,displayAuthor:r});case m.TYPE.MULTI_VCARD:return f.createElement(x,{msg:t,quotedMsg:n,displayAuthor:r});case m.TYPE.LOCATION:return f.createElement(M,{msg:t,ref:"msg",quotedMsg:n,displayAuthor:r});case m.TYPE.PTT:return f.createElement(C,{msg:t,quotedMsg:n,displayAuthor:r,ref:"msg"});case m.TYPE.DOCUMENT:return f.createElement(S,{msg:t,ref:"msg",quotedMsg:n,trusted:t.isTrusted(),senderName:t.senderObj?t.senderObj.name:null,displayAuthor:r});case m.TYPE.UNKNOWN:return f.createElement(k,{msg:t,displayAuthor:r});default:return N.log("messageList:render Unknown message type: "+t.type)(),f.createElement(k,{msg:t,displayAuthor:r})}}}]),t}(f.Component);e.exports=P},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(6),s=n(1246),c=n(1229),l=n(143),u=n(44),d=n(88),p=o.createClass({displayName:"PreviewImage",propTypes:{duration:o.PropTypes.oneOfType([o.PropTypes.string,o.PropTypes.number]),shade:o.PropTypes.bool,thumb:o.PropTypes.string,className:o.PropTypes.string,type:o.PropTypes.oneOf([c.TYPE.AUDIO,c.TYPE.LOCATION,c.TYPE.VIDEO,c.TYPE.PTT,c.TYPE.VCARD]).isRequired,quoted:o.PropTypes.bool},getDefaultProps:function(){return{shade:!0}},getIconClassNames:function(){return this.props.type===c.TYPE.VIDEO?"icon-sm icon-video-inv":this.props.type===c.TYPE.AUDIO?"icon-sm icon-arrow-inv":void 0},getClassNames:function(){var e=this.props.type===c.TYPE.VCARD||this.props.type===c.TYPE.PTT;return u("preview",this.props.className,(0,a["default"])({"icon-user-default":e,"icon-user-default-square":e&&this.props.quoted},"preview-"+this.props.type+" no-image",!this.props.thumb))},getStyles:function(){var e=this.props.thumb;return e?d.isHttp(e)?{backgroundImage:'url("'+e+'")'}:{backgroundImage:'url("data:image/jpeg;base64,'+e+'")'}:{}},render:function(){var e=l.durationStr(this.props.duration),t=this.props.shade?o.createElement("span",{className:"shade"}):null;return o.createElement("div",{className:this.getClassNames()},o.createElement("div",{className:"preview-image",style:this.getStyles()}),t,o.createElement("span",{className:"meta meta-audio"},o.createElement("span",{className:this.getIconClassNames()}),o.createElement(s,null,e)))}});e.exports=p},function(e,t,n){"use strict";var r=n(6),i=n(8),a=n(1246),o=n(1229),s=n(1231),c=n(1242),l=n(1241),u=n(1275),d=n(1137),p=n(1232),h=n(1282),f=n(143),m=n(1250),g=n(1230),v=n(44),y=n(106),_=n(10),E=n(1331),b=n(218),w=o.TYPE,M=w.CHAT,C=w.IMAGE,S=w.VIDEO,T=w.LOCATION,k=w.DOCUMENT,x=w.VCARD,N=w.AUDIO,P=w.MULTI_VCARD,O=r.createClass({displayName:"QuotedMsg",mixins:[g,d],propTypes:{msg:r.PropTypes.instanceOf(o).isRequired,chat:r.PropTypes.instanceOf(s).isRequired,onOmit:r.PropTypes.func,rootMsg:r.PropTypes.instanceOf(o),displayType:r.PropTypes.string},getInitialState:function(){var e={hover:!1,preview:!1};return this.props.msg.isMMS&&(e.url=this.async("msg.mediaData.renderableUrl")),e},onClick:function(){var e=this.props,t=e.chat,n=e.rootMsg,r=e.msg;if(n&&!n.isQuotedMsgAvailable)return void this.setState({preview:!0});var a=r.id,o=t.getSearchContext(Store.Msg.get(a)||a,n);o&&(o.slideToMsg=!0),i.openChatAt(t,o)},onMouseOver:function(e){!this.state.hover&&this.props.rootMsg&&this.setState({hover:!0})},onMouseEnter:function(e){!this.state.hover&&this.props.rootMsg&&this.setState({hover:!0})},onMouseLeave:function(e){this.state.hover&&this.setState({hover:!1})},render:function(){var e=this,t=this.props,n=t.msg,i=t.displayType,o=this.props.chat.assignedColor(n.sender),s=i===_.DISP_TYPE.CONVERSATION,d=r.createElement(l,{msg:n,className:"quoted-msg-bubble-ptt-author",displaySelf:n.sender===Store.Conn.me,disableClick:!0}),g=[];n.hasSymbol()&&g.push(r.createElement(u,{msg:n,key:"msg-symbol"})),[S,N].indexOf(n.type)>-1&&!n.isGif&&!n.caption&&g.push(f.durationStr(n.duration)+" "),[C,S,M].indexOf(n.type)>-1?g.push(r.createElement(p,{format:!0,mention:n.mentionMap(),text:c.msgText(n,!1),direction:"auto",key:"status"})):g.push(r.createElement(p,{format:!0,text:c.msgText(n),direction:"auto",key:"status"}));var w=null,O=this.props.rootMsg;if(this.state.preview&&O){var D=v("quoted-msg-preview",O.isSentByMe?"right":"left",{"chat-msg":n.type===M});w=r.createElement(b,{displayName:"QuotedMsgPreview",escapable:!0,popable:!0,requestDismiss:function(){return e.setState({preview:!1})}},r.createElement("div",{className:D},r.createElement(E,{msg:n}),r.createElement("div",{className:"nib-wrapper"},r.createElement("div",{className:"nib"}))))}var A=void 0,I="quoted-msg-image";switch(n.type){case C:case S:case T:case k:if(n.body){var R=n.type===C&&n.url?n.url:"data:image/jpeg;base64,"+n.body;A=r.createElement("div",{style:{backgroundImage:"url("+R+")"},className:I})}break;case M:n.thumbnail&&(A=r.createElement("div",{style:{backgroundImage:'url("data:image/jpeg;base64,'+n.thumbnail+'")'},className:I}));break;case x:A=r.createElement(h,{waid:n.getVCardThumbnailWAid(),size:h.Size.NONE,thumb:n.body&&m.thumbnail(n.body),quoted:!0,className:I});break;case P:A=r.createElement(h,{className:I,quoted:!0})}var L=v("quoted-msg",{"quoted-msg-hover":this.state.hover}),U=this.props.onOmit?r.createElement("div",{style:{display:"flex",flex:"0 0 auto"}},A,r.createElement("div",{className:"btn-background"},r.createElement("button",{className:"icon icon-x",onClick:this.props.onOmit}))):A;return r.createElement("div",{onMouseOver:s?this.onMouseOver:null,onMouseEnter:s?this.onMouseEnter:null,onMouseLeave:s?this.onMouseLeave:null},r.createElement(y,{transitionName:"quoted-msg-preview",className:"quoted-msg-preview-wrapper"},w),r.createElement("div",{className:L,onClick:s?this.onClick:null},r.createElement("div",{className:"quoted-msg-status"},r.createElement("span",{className:"bg-color-"+o+" quoted-msg-color-bar"}),r.createElement("div",{className:"quoted-msg-info"},r.createElement("div",null,d,r.createElement("div",{className:"chat-status message-text quoted-msg-text"},r.createElement(a,null,g))))),U))}});e.exports=O},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){this.key=e,this.css=t,this.title=n,this.className="emoji-"+e}var a,o=n(1136),s=r(o),c=n(105),l=r(c),u=n(6),d=n(15),p=n(84),h=p.focus,f=n(37),m=n(141),g=n(142),v=n(145),y=n(83),E=n(436),b=n(1531),w=n(1232),M=n(1238),C=n(442),S=n(1454),T=n(106),k=n(85),x=n(218),N=n(1412),P=n(1532),O=n(57),D=n(224),A=D.EMOJI.CATEGORIES,I=44,R=(a={},(0,s["default"])(a,A.RECENT,new i(A.RECENT,"icon-emoji-recent",function(){return l10n.t("emoji_tab_recent")})),(0,s["default"])(a,A.SMILEYS_PEOPLE,new i(A.SMILEYS_PEOPLE,"icon-emoji-people",function(){return l10n.t("emoji_tab_smileys_people")})),(0,s["default"])(a,A.ANIMALS_NATURE,new i(A.ANIMALS_NATURE,"icon-emoji-nature",function(){return l10n.t("emoji_tab_animals_nature")})),(0,s["default"])(a,A.FOOD_DRINK,new i(A.FOOD_DRINK,"icon-emoji-food",function(){return l10n.t("emoji_tab_food_drink")})),(0,s["default"])(a,A.ACTIVITY,new i(A.ACTIVITY,"icon-emoji-activity",function(){return l10n.t("emoji_tab_activity")})),(0,s["default"])(a,A.TRAVEL_PLACES,new i(A.TRAVEL_PLACES,"icon-emoji-travel",function(){return l10n.t("emoji_tab_travel_places")})),(0,s["default"])(a,A.OBJECTS,new i(A.OBJECTS,"icon-emoji-objects",function(){return l10n.t("emoji_tab_objects")})),(0,s["default"])(a,A.SYMBOLS,new i(A.SYMBOLS,"icon-emoji-symbols",function(){return l10n.t("emoji_tab_symbols")})),(0,s["default"])(a,A.FLAGS,new i(A.FLAGS,"icon-emoji-flags",function(){return l10n.t("emoji_tab_flags")})),(0,s["default"])(a,A.GIFS,new i(A.GIFS,"icon-emoji-gifs",function(){return l10n.t("emoji_tab_gifs")})),a),L=[R.RECENT,R.SMILEYS_PEOPLE,R.ANIMALS_NATURE,R.FOOD_DRINK,R.ACTIVITY,R.TRAVEL_PLACES,R.OBJECTS,R.SYMBOLS,R.FLAGS],U=L.concat([R.GIFS]),F=[""].concat(E.skinToneVariations),j=u.createClass({displayName:"EmojiPanel",propTypes:{onEmoji:u.PropTypes.func.isRequired,onGif:u.PropTypes.func,onFocusRelease:u.PropTypes.func},getInitialState:function(){var e=L;this.props.onGif&&(e=U);var t=Store.RecentEmoji.length>0?R.RECENT:R.SMILEYS_PEOPLE,n=R[d.getLastEmojiTab()];return n&&e.indexOf(n)>-1&&(t=n),{tabs:e,selected:t}},componentDidMount:function(){new O.WebcEmojiOpen({webcEmojiOpenTab:this.state.selected.key}).commit()},componentWillUnmount:function(){d.setLastEmojiTab(this.state.selected.key)},onSelectTab:function(e){var t=this.state.tabs,n=t.indexOf(this.state.selected),r=t.indexOf(e),i=r>n?"right":"left";this.setState({selected:e,direction:i})},onEmoji:function(e){this.props.onEmoji(e),Store.RecentEmoji.increment(e)},restoreFocus:function(){this.refs.emojiTab&&this.refs.emojiTab.restoreFocus()},render:function(){var e=this,t=void 0;t=this.state.selected===R.GIFS?u.createElement(S,{onGif:this.props.onGif}):u.createElement("div",{className:"emoji-panel-body",key:this.state.selected.key},u.createElement(G,{ref:"emojiTab",tab:this.state.selected,onEmoji:this.onEmoji,onFocusRelease:this.props.onFocusRelease}));var n=this.state.tabs,r=n.indexOf(this.state.selected),i=n.map(function(t){return u.createElement("button",{className:"menu-tab"+(e.state.selected===t?" active":""),onClick:function(){return e.onSelectTab(t)},key:t.key,title:t.title()},u.createElement("span",{className:"icon "+t.css}))}),a=l10n.isRTL()?-1:1,o={width:100/i.length+"%",transform:"translateX("+100*r*a+"%)"},s="right"===this.state.direction?"slide-forward":"slide-back";return u.createElement("div",{className:"emoji-panel k"},u.createElement("div",{className:"menu-tabs menu-tabs-emoji emoji-panel-header","data-active-tab":this.state.selected.key},u.createElement("div",{style:o,className:"menu-tabs-marker"}),i),u.createElement(T,{transitionName:s},t))}});e.exports=j;var B=function(e,t,n){for(var r=arguments.length,i=Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];return function(r){return r&&(r.preventDefault(),r.stopPropagation()),t&&(n?t.call.apply(t,[e,r].concat(i)):t.apply(e,i))}},G=u.createClass({displayName:"EmojiTab",mixins:[m,v,g,y],propTypes:{tab:u.PropTypes.oneOf(L).isRequired,onEmoji:u.PropTypes.func.isRequired,onFocusRelease:u.PropTypes.func},lastFocusedElement:null,getInitialState:function(){var e={skinTonePicker:!1,searchText:null};return this.props.tab===R.RECENT&&(e.recent=Store.RecentEmoji.models.map(function(e){return E.emojiMap[e["char"]]}),e.variants={}),e},componentDidMount:function(){var e=this;this.addObserver(Store.EmojiVariant,"add remove change:variant",function(){return e.forceUpdate()}),this.restoreFocus()},onEmoji:function(e){this.props.onEmoji(e),this.releaseFocus()},releaseFocus:function(){this.props.onFocusRelease&&this.props.onFocusRelease()},setEmojiVariant:function(e,t){if(this.onEmoji(t),Store.EmojiVariant.setVariant(e,t),this.state.recent){var n=this.state.variants;n[e]=t,this.setState({variants:n})}return!1},onContextMenu:function(e,t,n){this.clearPickerTimer(),e&&(e.preventDefault(),e.stopPropagation());var r=this.setEmojiVariant,i=e instanceof KeyboardEvent;i||(this.lastFocusedElement=null);var a=E.skinToneEmojis[t],o=F.map(function(e,n){var i=E.variantToUnicode(a,e);return u.createElement(M,{key:i,a8n:"mi-emoji-variant",action:function(e){return r(t,i)}},u.createElement("div",{className:"emoji-picker"},u.createElement(w,{text:i,emojiSize:w.EMOJI_SIZE.LARGE,tabIndex:"-1"})))});this.setState({skinTonePicker:{menu:o,anchor:n||e.target,type:C.Type.PICKER,menuDirection:{x:C.Direction.X.RIGHT,y:C.Direction.Y.TOP},layoutDirection:C.LayoutDirection.HORIZONTAL,focusFirstOnMount:i}})},closeSkinTonePicker:function(){this.setState({skinTonePicker:!1})},clearPickerTimer:function(){this.pickerTimer&&(this.unregNativeListener(window,"mouseup",this.clearPickerTimer,!0),this.clearSafeTimeout(this.pickerTimer),this.pickerTimer=null)},eatClick:function(e){e.preventDefault(),e.stopPropagation(),this.unregCmd("window_click",this.eatClick)},startPickerTimer:function(e,t){var n=this;this.clearPickerTimer();var r=e.target;this.pickerTimer=this.safeDelay(function(){n.regCmd("window_click",n.eatClick),n.onContextMenu(null,t,r)},250),this.regNativeListener(window,"mouseup",this.clearPickerTimer,!0)},getEmojiList:function(){var e=void 0;if(this.state.recent){if(e=this.state.recent,this.state.searchText&&"en"===l10n.getLocale()){var t=P.getMatchedEmojiUnicode(this.state.searchText);e=_.compact(_.map(t,function(e){return _.get(E.emojiMap,e)}))}}else e=b[this.props.tab.key];return e},getEmoji:function(){var e=this,t=this.onContextMenu,n=this.startPickerTimer,r=this.onEmoji,i=this.state,a=i.recent,o=i.variants,s=this.getEmojiList(),c=s.map(function(i,s){var c=E.codeToEmoji[i],l=void 0,d=void 0,p=void 0;if(E.skinToneEmojis[c]){p=B(e,t,!0,c),l=B(e,n,!0,c);var h;a&&!e.state.searchText?(h=o[c],h?(i=E.emojiMap[h],d=B(e,r,!1,h)):d=B(e,r,!1,c)):(h=Store.EmojiVariant.getVariant(c),h?(i=E.emojiMap[h],d=B(e,r,!1,h)):d=p)}else l=B(),d=B(e,r,!1,c);return u.createElement("span",{key:c,ref:c,tabIndex:"-1","data-emoji-index":s,onClick:d,onContextMenu:p,onMouseDown:l,className:"emojik emoji"+i})}),d={};return u.createElement(l["default"],{handlers:d},c)},onSearchEmoji:function(e){this.setState({searchText:e.target.value.trim()})},onSearchEnter:function(e){var t=_.first(this.getEmojiList());if(t){var n=E.codeToEmoji[t];this.keyboardSelectEmoji(e,n)}},onSearchDown:function(){this.getEmojiList().length&&this.focusEmoji(0)},onEmojiArrow:function(e,t){var n=e.target.dataset.emojiIndex;if(n){n=Number(n);var r=this.getEmojiList(),i=this.getEmojiRowLength(),a=n;switch(t){case"up":if(n<i&&this.refs.searchInput)return l["default"].flashFocus=Date.now(),void this.focusSearchInput();a=n-i;break;case"down":a=Math.min(n+i,r.length-1);break;case"left":a=Math.max(n-1,0);break;case"right":a=Math.min(n+1,r.length-1)}this.focusEmoji(a)}},getEmojiRowLength:function(){var e=this.refs.emojiPanel&&this.refs.emojiPanel.offsetWidth;return e?Math.floor(e/I):1},onEmojiEnter:function(e){var t=e.target.dataset.emojiIndex;if(t){var n=this.getEmojiList(),r=n[t],i=E.codeToEmoji[r];this.keyboardSelectEmoji(e,i)}},keyboardSelectEmoji:function(e,t){if(E.skinToneEmojis[t])if(this.state.recent&&!this.state.searchText){var n=this.state.variants[t];this.onEmoji(n||t)}else{var r=Store.EmojiVariant.getVariant(t);r?this.onEmoji(r):this.onContextMenu(e,t,f.findDOMNode(this.refs[t]))}else this.onEmoji(t)},focusElement:function(e){h(e),this.lastFocusedElement=e},focusEmoji:function(e){var t=this.getEmojiList();if(!(e<0||e>t.length-1)){var n=E.codeToEmoji[t[e]];this.refs[n]&&this.focusElement(this.refs[n])}},searchInputHasFocus:function(){var e=document.activeElement;return!!e&&e===this.refs.searchInput},focusSearchInput:function(){if(this.refs.searchInput&&!(this.searchInputHasFocus()||(h(this.refs.searchInput),this.lastFocusedElement=null,Date.now()-(l["default"].flashFocus||0)>200))){var e=f.findDOMNode(this.refs.searchContainer);Velocity(e,"stop"),Velocity(e,{backgroundColor:["#e0e1e2","#D9F3FF"]},{duration:1300,easing:[.24,.91,.01,.99]})}},getSearchBox:function(){if(this.state.recent){var e=l10n.t("search_emoji"),t={enter:B(this,this.onSearchEnter,!0),down:B(this,this.onSearchDown,!1)};return u.createElement(l["default"],{handlers:t,"data-tab":4,onFocus:this.focusSearchInput},u.createElement("div",{className:"emoji-search-row"},u.createElement("label",{ref:"searchContainer",className:"emoji-search-row-input"},u.createElement("div",{className:"input-container"},u.createElement("input",{ref:"searchInput",className:"input input-search",type:"text",dir:"auto",title:e,placeholder:e,onMouseDown:function(e){e.stopPropagation()},onChange:this.onSearchEmoji})))))}return null},restoreFocus:function(){this.lastFocusedElement?this.focusElement(this.lastFocusedElement):this.focusSearchInput()},render:function(){var e=void 0;this.state.skinTonePicker&&(e=u.createElement(x,{displayName:"SkinTonePicker",popable:!0,escapable:!0,requestDismiss:this.closeSkinTonePicker},u.createElement(N,{tooltip:this.state.skinTonePicker})));var t=null;return"en"===l10n.getLocale()&&(t=this.getSearchBox()),u.createElement("div",{ref:"emojiPanel",className:this.props.tab.className},t,this.getEmoji(),e)}});G.contextTypes={uim:u.PropTypes.instanceOf(k)}},function(e,t,n){"use strict";var r=n(6),i=n(1247),a=n(1231),o=n(1344),s=n(1482),c=n(1476),l=n(104),u=n(1475),d=n(1468),p=n(1463),h=r.createClass({displayName:"InfoFlow",mixins:[i],propTypes:{chat:r.PropTypes.instanceOf(a).isRequired},componentWillMount:function(){var e=l.supportsFeature(l.F.STARRED)&&l.supportsFeature(l.F.FULL_TEXT_SEARCH),t=e?this.onStarred:null,n=l.supportsFeature(l.F.MEDIA_GALLERY)?this.onMediaGallery:null,i=null;this.props.chat.isGroup?i=r.createElement(u,{chat:this.props.chat,onVerification:this.onVerification,onStarred:t,onMediaGallery:n,onGroupInviteLink:this.onGroupInviteLink,onClose:this._pop}):this.props.chat.isBroadcast?i=r.createElement(p,{chat:this.props.chat,onStarred:t,onMediaGallery:n,onClose:this._pop}):this.props.chat.isUser&&(i=r.createElement(d,{contact:this.props.chat.contact,onVerification:this.onVerification,onStarred:t,onMediaGallery:n,onClose:this._pop})),this.push(i)},onStarred:function(){var e=r.createElement(o,{type:this.props.type,chat:this.props.chat,onClose:this._pop});this.push(e)},onMediaGallery:function(){var e=r.createElement(s,{chat:this.props.chat,onBack:this._pop});this.push(e)},onGroupInviteLink:function(){var e=r.createElement(c,{chat:this.props.chat,onBack:this._pop});this.push(e)},_pop:function(){this.pop()}});e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=new p.WebcMediaAnalyzed;return o({type:"prep",file:e,asGif:t}).then(function(e){var t=e.type,n=e.result,r=e.error,i=e.filename,a=e.file;switch(t){case"result":return u.log("MediaAnalyzer:checkAndRepair approved file")(),n;case"parsingError":return u.info("trouble parsing file "+a+" (fossil "+i+") "+r)(),a&&(u.error("mediajs-error "+r)(),l.uploadFossil(a,i)),void u.log("MediaAnalyzer:checkAndRepair rejected file ("+r+")")()}})["catch"](function(e){u.assert(!1,"media-detection-error","MediaAnalyzer:checkAndRepair got error! "+e)()})["finally"](function(t){if(n){var r=void 0;if(e.name){var i=e.name.split(".");i.length>1&&(r=i[i.length-1])}n.set({webcMediaSupported:!!t,webcMediaExtensions:r}),n.markWebcMediaAnalyzeT(),n.commit()}})}function a(e,t){return u.log("MediaAnalyzer:reportFossil fossilizing for "+t)(),o({type:"fossilize",file:e}).then(function(t){var n=t.file;u.log("MediaAnalyzer:reportFossil successfully fossilized: "+!!n)(),n&&l.uploadFossil(n,e.name+".prefos")})}function o(e){var t=void 0;return new c["default"](function(n,r){u.log("MediaAnalyzer:sendMessageToWorker")(),t=new d,t.onmessage=function(e){try{e.data&&"log"===e.data.type?u.log("(via Milan) "+e.data.msg)():n(e.data)}catch(t){r(t)}},t.onerror=function(e){r("Milan.onerror = "+(e&&e.message?e.message:e))},t.postMessage(e)})["finally"](function(){t&&t.terminate()})}var s=n(2),c=r(s),l=n(27),u=n(1),d=n(1552),p=n(57);e.exports={checkAndRepair:i,reportFossil:a}},function(e,t,n){"use strict";var r=n(89),i=50,a=75,o={getInitialState:function(){var e=this;this._setState=this.setState,this.setState=function(t,n,r){_.assign(e.getBatchRenderState(),t),_.isUndefined(n)&&_.isUndefined(r)?e._debounceSetState.forceRun():_.isUndefined(r)?e._debounceSetState.debounce(n):e._debounceSetState.debounceAndCap(n,r)}},componentWillMount:function(){var e=this;this._debounceSetState=new r(function(){e._setState(e._batchRenderMixinState),e._batchRenderMixinState={}})},componentWillUnmount:function(){this._debounceSetState.cancel()},getBatchRenderState:function(){return this._batchRenderMixinState||(this._batchRenderMixinState={}),this._batchRenderMixinState}};o.DD=a,o.CD=i,e.exports=o},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(1),o=n(1325),s=n(1254),c=n(145),l=n(142),u=n(1233),d=n(1235),p=n(1234),h=n(44),f=n(1260),m=n(10),g=n(1242),v=n(1289),y=n(106),E={ANIMATING:"animating",LOADING:"loading",RECORDING:"active",SENDING:"sending"},b=r.createClass({displayName:"CaptureDrawer",mixins:[l,c],propTypes:{noContainer:r.PropTypes.bool,stream:r.PropTypes.object.isRequired,caption:r.PropTypes.bool,onBack:r.PropTypes.func.isRequired,onSend:r.PropTypes.func.isRequired},statics:{State:E},getInitialState:function(){return{state:E.ANIMATING,img:void 0,url:void 0}},componentDidMount:function(){this.safeDelay(function(){this.setState({state:E.LOADING,url:window.URL.createObjectURL(this.props.stream)})},300)},componentWillUnmount:function(){if(this.state.url){var e=this.props.stream;v.stop(e),window.URL.revokeObjectURL(this.state.url)}},onCapture:function(e){var t=document.createElement("canvas");if(this.refs.video){var n=i.findDOMNode(this.refs.video);t.height=n.videoHeight,t.width=n.videoWidth;var r=t.getContext("2d");r.translate(t.width,0),r.scale(-1,1),r.drawImage(n,0,0,n.videoWidth,n.videoHeight);var a=t.toDataURL("image/jpeg");this.setState({state:E.SENDING,img:a})}},onVideoLoaded:function(e){this.setState({state:E.RECORDING,videoSize:{width:e.target.videoWidth,height:e.target.videoHeight}})},onRetake:function(e){this.setState({state:E.RECORDING,caption:void 0})},onSend:function(e){this.props.onSend({file:window.dataURLtoBlob(this.state.img),caption:g.emojify(_.trim(this.state.caption))})},onCaptionChange:function(e){this.setState({caption:e.target.value})},render:function(){var e,t,n,i;switch(this.state.state){case E.ANIMATING:break;case E.LOADING:case E.RECORDING:var c=h("capture-video media-viewer-img webcam",{"capture-video-inactive":this.state.state===E.LOADING
});n=r.createElement("div",{key:"webcam"},r.createElement(s,{type:s.TYPES.CONTAIN,size:this.state.videoSize},r.createElement(o,{className:c,autoPlay:!0,ref:"video",onPlay:this.onVideoLoaded,src:this.state.url}))),e=r.createElement("div",{className:"drawer-controls fade",key:"btn-capture"},r.createElement("button",{className:"btn btn-round btn-l",onClick:this.onCapture},r.createElement("span",{className:"icon icon-camera-light"})));break;case E.SENDING:n=r.createElement("div",{key:"snapshot"},r.createElement(s,{type:s.TYPES.CONTAIN,size:this.state.videoSize},r.createElement("img",{className:"capture-image snapshot",src:this.state.img})));var l=this.props.noContainer?"icon icon-checkmark-light-l":"icon icon-send-light";e=r.createElement("div",{className:"drawer-controls btn-send",key:"btn-send"},r.createElement("button",{className:"btn btn-round btn-l",onClick:this.onSend},r.createElement("span",{className:l}))),t=r.createElement("div",{className:"drawer-header-action",onClick:this.onRetake},r.createElement("span",{className:"icon icon-refresh-light"}),l10n.t("retake")),i=r.createElement(f,{ref:"emojiInput",editable:!0,value:this.state.caption,maxLength:m.MAX_CAPTION_LENGTH,showRemaining:!0,placeholder:l10n.t("add_a_caption"),onEnter:this.onSend,onChange:this.onCaptionChange,supportsEmoji:!0,focusOnMount:!0});break;default:a.log("captureDrawer:render Unhandled video capture state "+this.state.state)()}var g=void 0;g=this.props.caption?r.createElement("div",{className:"capture-footer"},r.createElement(y,{transitionName:"media-caption",className:"media-caption"},i),r.createElement(y,{transitionName:"pop_delay"},e)):r.createElement("div",{className:"capture-footer"},r.createElement(y,{transitionName:"pop_delay"},e));var v=this.props.noContainer?d.Type.POPUP:d.Type.OFFSET;return r.createElement(u,{key:"attach-capture-modal",position:"right",id:"capture",variant:"noheader",noContainer:this.props.noContainer},r.createElement(d,{title:l10n.t("take_photo"),type:v,onCancel:this.props.onBack},t),r.createElement(p,null,r.createElement("div",{className:"media-body"},r.createElement("div",{className:"media-body-container"},r.createElement(y,{transitionName:"capture"},n))),g))}});e.exports=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1270),a=r(i),o=n(1240),s=r(o),c=n(105),l=r(c),u=n(6),d=n(37),p=n(143),h=n(1233),f=n(1234),m=n(1268),g=n(1230),v=n(141),y=n(83),E=n(1236),b=n(1337),w=n(142),M=n(1239),C=n(1242),S=n(86),T=n(144),k=n(8),x=n(104),N=n(1292),P=n(14),O=n(1245),D=n(10),A=n(1229),I=n(1231),R=n(1348),L=n(1294),U=n(1275),F=n(1259),j=n(1232),B=n(1353),G=n(84),z=n(85),W=n(1249),H=W.GetRef,q=n(1137),V=n(44),Y=2,K=u.createClass({displayName:"ChatSearch",mixins:[v,y,q,E,b],propTypes:{chat:u.PropTypes.instanceOf(I).isRequired},getInitialState:function(){var e=this;return this.ftsMsgs=new R,this.fts=_.debounce(function(){e.pending=!1;var t=_.trim(e.state.searchText||"");N.multibyteLength(t)<Y||(e._ftsPromise&&e._ftsPromise.cancel(),e._ftsPromise=e.ftsMsgs.search(t,e.props.chat).checkpoint(e.rejectOnUnmount()).then(function(n){t===_.trim(e.state.searchText)&&e.setState({searching:!1},b.DD)})["catch"](P.Unmount,_.noop)["catch"](function(){e.pending||e.setState({searching:!1},b.DD)}))},750),this.selection=new O([],function(e){return e.id.toString()}),{searchText:"",searching:!1}},componentDidMount:function(){this.onFocusSearch(),this.addObserver(this.ftsMsgs,"reset"),this.addObserver(this.ftsMsgs,"search_more")},componentDidUpdate:function(){this.shouldFTSSearch(this.refs.panel)&&(this.fts(),this.pending=!0)},componentWillUnmount:function(){this.fts.cancel(),this.ftsMsgs["delete"](),this._ftsPromise&&this._ftsPromise.cancel()},fullTextSearch:function(e){var t=_.trim(e);N.multibyteLength(t)>=Y&&x.supportsFeature(x.F.FULL_TEXT_SEARCH)?(this.fts(),this.pending=!0,this.state.searching||this.setState({searching:!0},b.DD)):(this.fts.cancel(),this.ftsMsgs.resetSearch(),this.ftsMsgs["delete"](),this._ftsPromise&&this._ftsPromise.cancel(),this.pending=!1,this.state.searching&&this.setState({searching:!1},b.DD))},shouldFTSSearch:function(e){if(!this.ftsMsgs.hasMoreMsgs||this.pending)return!1;var t=_.last(e.children);return e.scrollHeight<e.clientHeight+t.scrollHeight},onSearch:function(e){if(this.isMounted()){if(!e)return void this.onStopSearch();var t=this.state.searchText;if(e!==t){var n={searchText:e};this.fullTextSearch(e),this.setState({searchText:e}),this.setState(n,b.DD)}}},onStopSearch:function(){this.fts.cancel(),this.ftsMsgs.resetSearch(),this.ftsMsgs["delete"](),this._ftsPromise&&this._ftsPromise.cancel(),this.pending=!1,this.setState({searchText:"",searching:!1})},onFocusList:function(e){e.repeat||this.refs.msglist&&this.search.isAtEnd()&&(e.preventDefault(),e.stopPropagation(),l["default"].flashFocus=Date.now(),this.refs.msglist.focusFirst())},onOpenFirst:function(e){e.preventDefault();var t=_.head(this.state.ftsResult);if(t){var n=t.chat,r=n.getSearchContext(t);k.focusChatTextInput(n),k.openChatAt(n,r)}},onFocusSearch:function(e){l["default"].flashFocus=Date.now(),G.focus(this.search)},onClose:function(){this.context.uim.uie.requestDismiss()},indicateFocus:function(e){if(!(Date.now()-(l["default"].flashFocus||0)>200)){var t=d.findDOMNode(this.refs.input_hotkey);Velocity(t,"stop"),Velocity(t,{backgroundColor:["#fbfbfb","#D9F3FF"]},{duration:1600,easing:[.19,.69,.01,.99]})}},onScroll:function(e){this.handleScroll(e.target)},handleScroll:_.throttle(function(e){e.scrollTop+D.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&this.ftsMsgs.hasMoreMsgs&&!this.pending&&(this.fts(),this.pending=!0)},100),getEmptyChatlistState:function(e){if(e.length)return null;var t=_.trim(this.state.searchText||"");return N.multibyteLength(t)>=Y?this.state.searching?u.createElement(M.SearchingMessages,null):u.createElement(M.SearchMessages,null):M.BeforeSearchMessages(this.props.chat.title())},render:function(){var e=this.ftsMsgs.models,t=this.getEmptyChatlistState(e);if(!t){var n=this.state.searchText?_.trim(this.state.searchText):null;t=u.createElement(X,{ref:"msglist",isSearching:!!this.state.searchText,searchText:n,ftsResult:e,selection:this.selection,onFocusSearch:this.onFocusSearch})}var r={down:this.onFocusList,enter:this.onOpenFirst},i=this.ftsMsgs.hasMoreMsgs&&e.length?u.createElement("div",{className:"more",style:{alignSelf:"center"}},u.createElement(T,{stroke:6,size:24})):null;return u.createElement(h,{key:"search-modal",id:"search",variant:"panel",onCancel:this.onClose},u.createElement("header",{className:"pane-header"},u.createElement("div",{className:"header-close"},u.createElement("button",{onClick:this.onClose},u.createElement("span",{className:"icon icon-x"}))),u.createElement("div",{className:"header-body"},u.createElement("div",{className:"header-main"},u.createElement("div",{className:"header-title"},l10n.t("search_msgs"))))),u.createElement(f,null,u.createElement(l["default"],{handlers:r,onFocus:this.indicateFocus,ref:"input_hotkey",className:"search-container"},u.createElement(a["default"],{ref:H("search",this),onSearch:this.onSearch,placeholder:l10n.t("search"),loading:this.state.searching})),u.createElement("div",{ref:"panel",className:"pane-body pane-list-body",onScroll:this.onScroll,id:"pane-side","data-list-scroll-container":!0},t,i)))}});K.contextTypes={uim:u.PropTypes.instanceOf(z)};var X=u.createClass({displayName:"MsgList",mixins:[v,y,w],propTypes:{isSearching:u.PropTypes.bool,searchText:u.PropTypes.string,ftsResult:u.PropTypes.array,onClick:u.PropTypes.func,selection:u.PropTypes.instanceOf(O),onFocusSearch:u.PropTypes.func},getDefaultProps:function(){return{chats:[]}},getInitialState:function(){return this._listPointerEvents=!0,{}},componentWillMount:function(){this.props.selection.init(this.getSelection())},onListPointerEventsOff:function(){this._listPointerEvents=!1},onListPointerEventsOn:function(){this._listPointerEvents=!0},onClick:function(e,t,n){var r=this;e.preventDefault(),e.stopPropagation(),Store.Chat.find(t.id).then(function(e){r.props.isSearching&&r.props.onClick&&r.props.onClick(),2===B.column&&r.context.uim.uie.requestDismiss(),k.focusChatTextInput(e),k.openChatAt(e,n)})},getSelection:function(){return this.props.ftsResult||[]},getList:function(){var e=this;return this.props.ftsResult.map(function(t){return u.createElement(Z,{msg:t,searchText:e.props.searchText,onClick:e.onClick,active:e.props.selection,key:t.id.toString()})})},restoreFocus:function(){this.props.selection.reset()},onFocusGain:function(e){e.target===d.findDOMNode(this)&&this._listPointerEvents&&(this.props.selection.index<0?this.focusFirst():this.props.selection.reset())},focusFirst:function(){this.props.selection.setFirst()},onNextChat:function(e,t,n){e&&(e.preventDefault(),e.stopPropagation());var r=this.props.selection.next();this.props.selection.index!==r&&this.props.selection.setNext()},onPrevChat:function(e,t,n){e&&(e.stopPropagation(),e.preventDefault());var r=this.props.selection.prev();r>-1?(this.props.selection.setPrev(),this.focusComposer=n):t||this.props.onFocusSearch()},render:function(){var e=this,t={down:function(t){return e.onNextChat(t)},up:function(t){return e.onPrevChat(t)}};return u.createElement(l["default"],{handlers:t,onFocus:this.onFocusGain,"data-tab":3},u.createElement(s["default"],{className:"chatlist",data:this.getList(),height:72,animate:!0,extraItems:4,onPointerEventsOff:this.onListPointerEventsOff,onPointerEventsOn:this.onListPointerEventsOn}))}});X.contextTypes={uim:u.PropTypes.instanceOf(z)};var Z=u.createClass({displayName:"Message",mixins:[g,v],propTypes:{msg:u.PropTypes.instanceOf(A).isRequired,searchText:u.PropTypes.string,mouseDownAsClick:u.PropTypes.bool,onClick:u.PropTypes.func,active:u.PropTypes.object},getInitialState:function(){var e=this.props,t=e.msg,n=e.active,r={formattedTitle:this.async("msg.chat.formattedTitle"),active:!!n&&n.value===t};return t.sender&&t.isGroupMsg&&!t.isNotification&&(t.isSentByMe?r.formattedShortName=t.senderObj.formattedShortName:r.formattedShortName=this.async("msg.senderObj.formattedShortName")),r},componentWillMount:function(){this.props.active&&this.addObserver(this.props.active,this.props.msg.id.toString(),this.onActiveChange)},onActiveChange:function(e,t){if("focus"===e){var n=d.findDOMNode(this);G.focus(n),t&&m.scrollIntoViewIfNeeded(n)}this.setState({active:!!e})},onClick:function(e){if(_.isFunction(this.props.onClick)){var t=this.props.msg,n=t.chat,r=n.getSearchContext(t);r.msg=t,this.props.onClick(e,n,r)}},onMouseDown:function(e){0===e.button&&this.onClick(e)},onEnter:function(e){e.preventDefault(),e.stopPropagation(),l["default"].flashFocus=Date.now(),this.onClick(e)},indicateFocus:function(e){if(!(Date.now()-(l["default"].flashFocus||0)>200)){var t=d.findDOMNode(this.refs.cell);Velocity(t,"stop"),Velocity(t,{backgroundColor:["#e9eaeb","#cbdde7"]},{duration:1300,easing:[.19,.69,.01,.99],complete:this.onBlur})}},onBlur:function(e){var t=d.findDOMNode(this.refs.cell);t&&(Velocity(t,"stop"),t.style.backgroundColor="")},contextEnabled:function(){return!1},render:function(){var e=this.props.msg,t=u.createElement("span",{className:"chat-time-title"},p.relativeStr(e.t)),n=[];e.isSentByMe&&n.push(u.createElement(L,{msg:e,key:"symbol"})),e.isSentByMe||!e.isGroupMsg||e.isNotification||(n.push(u.createElement(j,{text:this.state.formattedShortName,direction:"auto",className:{number:!e.senderObj.name,"chat-status-name":!0},key:"author"})),n.push(u.createElement("span",{className:"chat-status-divider",key:"divider"},":"))),e.hasSymbol()&&n.push(u.createElement(U,{msg:e,key:"msg-symbol"})),n.push(u.createElement(j,{direction:e.dir,ellipsify:!0,highlight:this.props.searchText?[this.props.searchText]:null,text:C.msgText(e),key:"status"}));var r="chat-status";S.isGecko&&(r+=" ellipsify");var i=l10n.embedDir(C.msgText(e),e.rtl),a=u.createElement("div",{className:r,title:i},n),o={enter:this.onEnter},s=V("message",{active:!!this.state.active}),c=this.props.mouseDownAsClick;return u.createElement(l["default"],{handlers:o,onFocus:this.indicateFocus,onBlur:this.onBlur,className:"chat-drag-cover"},u.createElement(F,{id:e.id+"",ref:"cell",contextEnabled:this.contextEnabled,className:s,primaryDetail:t,secondary:a,onClick:c?null:this.onClick,onMouseDown:c?this.onMouseDown:null,onContext:this.onMenu}))}});e.exports=K},function(e,t,n){"use strict";var r=n(6),i=n(44),a=r.createClass({displayName:"DrawerItem",propTypes:{title:r.PropTypes.node,icon:r.PropTypes.node,classes:r.PropTypes.string,onClick:r.PropTypes.func},render:function(){var e=this.props,t=e.onClick,n=e.title,a=e.icon,o=e.classes,s=e.children,c=i("drawer-button",o,{clickable:t}),l=i("contents",{"drawer-button-row":a}),u=i({"col-main":a}),d=i({"col-side":a});return r.createElement("div",{className:c,onClick:t},r.createElement("div",{className:l},r.createElement("div",{className:u},r.createElement("div",{className:"primary"},n),r.createElement("div",{className:"secondary"},s)),r.createElement("div",{className:d},a)))}});e.exports=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(1270),s=r(o),c=n(1240),l=r(c),u=n(6),d=n(1233),p=n(1235),h=n(1234),f=n(1265),m=n(1245),g=n(84),v=n(1249),y=v.GetRef,E=u.createClass({displayName:"ListModal",propTypes:{title:u.PropTypes.string.isRequired,selection:u.PropTypes.instanceOf(m),onSearch:u.PropTypes.func,searchPlaceholder:u.PropTypes.string,onCancel:u.PropTypes.func.isRequired,onSelect:u.PropTypes.func},onNext:function(e){e.preventDefault(),e.stopPropagation();var t=this.props.selection;t&&t.setNext()},onPrev:function(e){var t=this.props.selection;if(t){e.preventDefault(),e.stopPropagation();var n=t.prev();n>-1?t.setPrev():(t.unset(),a["default"].flashFocus=Date.now(),g.focus(this.search))}},onFocusList:function(e){this.list&&(e.preventDefault(),e.stopPropagation(),a["default"].flashFocus=Date.now(),this.props.selection.setFirst())},onSelectFirst:function(e){e.preventDefault(),e.stopPropagation();var t=_.head(this.props.children);t&&this.props.onSelect(e,t)},onSearch:function(e){this.props.onSearch(e)},render:function(){var e=this.props,t=e.title,n=e.onCancel,r=e.onSearch,i=e.searchPlaceholder,o=e.children,c={down:this.onFocusList,enter:this.onSelectFirst},m={down:this.onNext,up:this.onPrev},g=void 0;r&&(g=u.createElement(a["default"],{handlers:c},u.createElement(s["default"],{ref:y("search",this),onSearch:this.onSearch,placeholder:i||l10n.t("search")})));var v=void 0;return v=o&&o.length?u.createElement(a["default"],{handlers:m},u.createElement(l["default"],{className:"chatlist",ref:y("list",this),data:o,height:72,extraItems:4})):o,u.createElement(f,{type:f.TOWER},u.createElement(d,{key:"contact-modal",onCancel:n,position:"right"},u.createElement(p,{title:t,type:p.Type.POPUP,onCancel:n}),g,u.createElement(h,{"data-list-scroll-container":!0},v)))}});e.exports=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1253),a=r(i),o=n(6),s=n(1237),c=n(1232),l=n(1254),u=n(219),d=n(8),p=n(1230),h=n(44),f=n(218),m=500,g=o.createClass({displayName:"PhotoViewerModal",mixins:[p],propTypes:{contact:o.PropTypes.instanceOf(u),imgFull:o.PropTypes.string,animateBorderRadius:o.PropTypes.bool,getZoomNode:o.PropTypes.func.isRequired},getInitialState:function(){return{formattedUser:this.async("contact.formattedUser"),imgFull:this.props.imgFull||this.async("contact.profilePicThumb.imgFull"),style:{visibility:"hidden"}}},shouldComponentUpdate:function(e,t){return!!t.imgFull||(this.onClose(),!1)},onScroll:function(e){Math.abs(e.deltaY)>3&&this.onClose()},onClose:function(){if(!this.closing){this.closing=!0;var e=void 0;if(this.props.getZoomNode(function(t){e=t}),!e)return d.closeModalMedia();var t=this.refs.image,n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),i=r.top-n.top,a=r.left-n.left,o=e.clientWidth/t.clientWidth;Velocity(t,{translateX:[a,0],translateY:[i,0],scale:[o,1]},{duration:200,easing:[.1,.82,.25,1]}).then(function(){d.closeModalMedia()})}},onImageLoad:function(e){var t=this,n=e.target;this.setState({size:{width:n.naturalWidth,height:n.naturalHeight}},function(){t.props.getZoomNode(function(e){var r=n.getBoundingClientRect(),i=e.getBoundingClientRect(),a=i.top-r.top,o=i.left-r.left,s=e.clientWidth/n.clientWidth,c={visibility:"hidden",transform:"translateX("+o+"px) translateY("+a+"px) scale("+s+")",transition:"transform 0s"};t.props.animateBorderRadius&&(c.borderRadius="50%"),t.setState({style:c},function(){var e={transform:"translateX(0px) translateY(0px) scale(1)",transition:"transform "+m+"ms cubic-bezier(.1,.82,.25,1)"};t.props.animateBorderRadius&&(e={transform:"translateX(0px) translateY(0px) scale(1)",borderRadius:"0%",transition:"transform "+m+"ms cubic-bezier(.1,.82,.25,1),\n                                         border-radius "+m+"ms cubic-bezier(.1,.82,.25,1)"}),t.setState({style:e})})})})},render:function(){var e=this.props.contact,t=h("media-viewer","media-viewer-animate"),n=h("media-panel-header",{});return o.createElement(f,{displayName:"PhotoViewer",escapable:!0,requestDismiss:this.onClose},o.createElement("div",{className:t,onWheel:this.onScroll,onClick:this.onClose},o.createElement("div",{className:n},o.createElement("div",{className:"chat media-chat"},o.createElement("div",{className:"chat-avatar"},o.createElement(s,{id:e.id})),o.createElement("div",{className:"chat-body"},o.createElement("div",{className:"chat-main"},o.createElement(c,{text:this.state.formattedUser})))),o.createElement("div",{className:"menu menu-horizontal media-panel-tools"},o.createElement("div",{className:"menu-item"},o.createElement("button",{className:"icon icon-x-viewer",title:l10n.t("web_close"),onClick:this.onClose})))),o.createElement("div",{className:"media-content",dir:"ltr",ref:"container"},o.createElement("div",{className:"media"},o.createElement(l,{type:l.TYPES.SCALE_DOWN,size:this.state.size},o.createElement("div",{className:"profile-viewer",ref:"image",style:this.state.style},o.createElement(a["default"],{src:this.state.imgFull,hasPrivacyChecks:!0,onLoad:this.onImageLoad,className:"profile-viewer-img"})))))))}});e.exports=g},function(e,t,n){"use strict";var r=n(6),i=n(1233),a=n(1235),o=n(1256),s=n(1234),c=n(1295),l=n(432),u=n(8),d=n(1230),p=n(141),h=n(1236),f=n(1260),m=n(10),g=n(1242),v=n(85),y=n(14),E=r.createClass({displayName:"ProfileDrawer",mixins:[d,p,h],propTypes:{id:r.PropTypes.string.isRequired,onClose:r.PropTypes.func},getInitialState:function(){return this.asyncState({status:"id.Status.status",imgFull:"id.ProfilePicThumb.imgFull"},{pushname:Store.Conn.pushname,status:l10n.t("contact_status_loading"),pendingPushname:!1,pendingStatus:!1,pendingPhoto:!1})},componentWillMount:function(){var e=this;this.addObserver(Store.Conn,"change:pushname",function(){e.setState({pushname:Store.Conn.pushname})})},validateStatus:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return!!e.trim()},onSetStatusError:function(){u.openModal(r.createElement(l,{onOK:u.closeModal.bind(u),okText:l10n.t("web_ok")},l10n.t("action_status_empty")))},onSetStatus:function(e){var t=this;if(Store.Status.canSetMyStatus()){var n=Store.Status.get(this.props.id).status,r=g.emojify(this.state.status);if(r===n)return this.setState({status:r});this.setState({pendingStatus:!0}),Store.Status.setMyStatus(g.emojify(this.state.status)).checkpoint(this.rejectOnUnmount()).then(function(){t.setState({status:Store.Status.get(t.props.id).status,pendingStatus:!1})})["catch"](y.Unmount,_.noop)}},onBack:function(){this.props.onClose?this.props.onClose():this.context.uim.uie.requestDismiss()},onStatusChange:function(e){this.setState({status:e.target.value})},onCancelStatus:function(){this.setState({status:Store.Status.get(this.props.id).status})},validatePushname:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return!!e.trim()},onSetPushname:function(e){var t=this;if(Store.Conn.canSetMyPushname()){var n=Store.Conn.pushname,r=g.emojify(this.state.pushname);if(r===n)return this.setState({pushname:r});this.setState({pendingPushname:!0}),Store.Conn.updatePushname(g.emojify(this.state.pushname)).checkpoint(this.rejectOnUnmount()).then(function(){t.setState({pendingPushname:!1})})["catch"](y.Unmount,_.noop)}},onSetPushnameError:function(){u.openModal(r.createElement(l,{onOK:u.closeModal.bind(u),okText:l10n.t("web_ok")},l10n.t("action_pushname_empty")))},onPushnameChange:function(e){this.setState({pushname:e.target.value})},onCancelPushname:function(){this.setState({pushname:Store.Conn.pushname})},onImageSet:function(e,t){var n=this,r=Store.ProfilePicThumb.get(this.props.id);this.setState({pendingPhoto:!0});var i;i=e&&t?r.setPicture(e,t):r.deletePicture(),i.checkpoint(this.rejectOnUnmount()).then(function(){n.setState({pendingPhoto:!1})})["catch"](y.Unmount,_.noop)},render:function(){var e=Store.ProfilePicThumb.get(this.props.id),t=e.canSet()||e.canDelete()?c.Type.PROFILE:c.Type.NO_EDIT,n=r.createElement(c,{type:t,id:this.props.id,pending:this.state.pendingPhoto,startImage:this.state.imgFull,onImageSet:this.onImageSet});return r.createElement(i,{onCancel:this.onBack,id:"profile"},r.createElement(a,{a8n:"drawer-title-profile",title:l10n.t("menuitem_profile_status"),onBack:this.onBack,type:a.Type.LARGE}),r.createElement(s,null,r.createElement("div",{className:"drawer-section drawer-scale drawer-section-photo"},n),r.createElement(o,{a8n:"col-main-profile",title:l10n.t("pushname"),classes:"animate-enter1 well-input"},r.createElement(f,{value:this.state.pushname,editable:Store.Conn.canSetMyPushname(),pending:this.state.pendingPushname,showRemaining:!0,validate:this.validatePushname,maxLength:m.MAX_PUSHNAME_LENGTH,onChange:this.onPushnameChange,onSave:this.onSetPushname,onError:this.onSetPushnameError,onCancel:this.onCancelPushname,supportsEmoji:!0,lockable:!0,lowProfile:!0})),r.createElement("div",{className:"hint animate-enter1 well-transparent"},l10n.t("pushname_description")),r.createElement(o,{a8n:"col-main-profile",title:l10n.t("web_status"),classes:"animate-enter1 well-input"},r.createElement(f,{value:this.state.status,editable:Store.Status.canSetMyStatus(),pending:this.state.pendingStatus,showRemaining:!0,validate:this.validateStatus,maxLength:m.MAX_STATUS_LENGTH,onChange:this.onStatusChange,onSave:this.onSetStatus,onError:this.onSetStatusError,onCancel:this.onCancelStatus,supportsEmoji:!0,lockable:!0,lowProfile:!0}))))}});E.contextTypes={uim:r.PropTypes.instanceOf(v)},e.exports=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return e.scrollTop+l.SCROLL_FUDGE>e.scrollHeight-e.clientHeight}var a=n(105),o=r(a),s=n(6),c=n(37),l=n(10),u=n(8),d=n(1233),p=n(1239),h=n(1235),f=n(1234),m=n(141),g=n(1236),v=n(106),y=n(1301),E=n(1245),b=n(1362),w=n(144),M=n(14),C=n(104),S=n(1),T=n(1229),k=n(84),x=n(142),N=n(1231),P=n(1278),O=P.MenuBarItem,D=n(1238),A=n(442),I=n(1493),R=n(85),L=s.createClass({displayName:"StarredDrawer",mixins:[m,g,x],propTypes:{chat:s.PropTypes.instanceOf(N),onClose:s.PropTypes.func},getInitialState:function(){return this.handleScroll=_.throttle(this._handleScroll,100),this.starredMsg=this.props.chat?this.props.chat.starredMsg:Store.AllStarredMsgs,this.msgListInfo={visibleMsgs:{}},{cursor:new b(this.starredMsg,(void 0),l.RENDOR_CURSOR.STARRED_DRAWER).loadAfter(l.MSG_PRELOAD_THRESHOLD)}},componentWillMount:function(){this.currSelection=new E([],function(e){return e.id.toString()}),this.activeSelection=new E([],function(e){return e.id.toString()})},componentDidMount:function(){var e=this;this.focus(),this.regNativeListener(window,"resize",this.updateMsgListInfo),!this.starredMsg.isSynced&&this.starredMsg.length<l.PAGE_SIZE&&this.uiIdle(this.loadEarlierMsgs),this.initObservers(),this.addObserver(this.starredMsg,"reset",function(){e.setState(e.getInitialState()),e.loadEarlierMsgs()})},componentWillUnmount:function(){this._firstSyncComplete&&this._firstSyncComplete.cancel(),this.handleScroll.cancel()},componentDidUpdate:function(){this.updateMsgListInfo()},initObservers:function(){var e=this;this.addObserverAndRun(this.starredMsg,"reset sync",function(){e.initSelectionObjects(),e.setState({})}),this.addObserver(this.starredMsg,"add remove",this.handleStarChange),this.onFocusGain()},handleStarChange:function(e){this.initSelectionObjects(),this.setState({})},initSelectionObjects:function(){var e=this.starredMsg.models;this.currSelection.init(e,!0),this.activeSelection.init(e)},loadEarlierMsgs:function(){var e=this,t=this.state.cursor,n=this.props.chat&&this.props.chat.id,r=this.starredMsg.models;if(t.end<r.length)this.setState({cursor:t.loadAfter()});else{if(this.starredMsg.isSynced)return;this.starredMsg.sync(n).checkpoint(this.rejectOnUnmount()).then(function(){t.end<r.length&&e.setState({cursor:t.loadAfter()})})["catch"](M.Unmount,_.noop)["catch"](function(e){S.log("StarredDrawer:loadEarlierMsgs failed")(),S.log(e)()})}},onClose:function(){this.props.onClose?this.props.onClose():this.context.uim.uie.requestDismiss()},focus:function(){k.focus(c.findDOMNode(this.refs.body))},onFocusGain:function(e){var t=e?e.target:document.activeElement;t===c.findDOMNode(this.refs.body)&&(this.currSelection.index<0?this.currSelection.setFirst():this.currSelection.reset(!1))},onNextMsg:function(e){e&&(e.preventDefault(),e.stopPropagation());var t=this.currSelection.next();this.currSelection.index!==t&&this.currSelection.setNext()},onPrevMsg:function(e){e&&(e.stopPropagation(),e.preventDefault());var t=this.currSelection.prev();t>-1&&this.currSelection.setPrev()},onScroll:function(e){this.handleScroll(e.target)},_handleScroll:function(e){this.updateMsgListInfo(),i(e)&&this.loadEarlierMsgs()},selectMsg:function(e){this.currSelection.setVal(e),this.activeSelection.setVal(e),u.openChatAt(e.chat,e.chat.getSearchContext(e)),u.focusShowMsg(e.id)},getMsgList:function(){var e=this.state.cursor,t=this.starredMsg.models,n=this.starredMsg.isSynced?e.end:Math.min(e.end,t.length);return t=t.slice(e.start,n),this.length=t.length,t},getMsgVisibility:function(e){if(!e)return l.VISIBILITY.BELOW;var t=c.findDOMNode(this.refs.scrollContainer),n=t.previousSibling.clientHeight,r=t.scrollTop+n,i=r+t.clientHeight,a=c.findDOMNode(e);return a?a.offsetTop+a.clientHeight<=r?l.VISIBILITY.ABOVE:a.offsetTop>=i?l.VISIBILITY.BELOW:l.VISIBILITY.VISIBLE:l.VISIBILITY.BELOW},isMsgVisible:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return!!this.msgListInfo.visibleMsgs[e.toString()]&&(!!t||this.getMsgComponent(e))},getMsgComponent:function(e){var t=this.refs[e.toString()];if(t){var n=t.refs.wrapper;if(n)return n.refs.component&&n.refs.component.refs.msg}},updateMsgListInfo:_.throttle(function(){for(var e=this.getMsgList(),t={},n=0,r=this.length-1;n<r;){var i=Math.floor((n+r)/2),a=this.refs[e[i].id.toString()];this.getMsgVisibility(a)===l.VISIBILITY.ABOVE?n=i+1:r=i}for(var o=n;o<e.length;o++){var s=this.refs[e[o].id.toString()];if(this.getMsgVisibility(s)!==l.VISIBILITY.VISIBLE)break;t[e[o].id.toString()]=!0}this.pauseHiddenGifs(this.msgListInfo.visibleMsgs,t),this.msgListInfo.visibleMsgs=t},100),pauseHiddenGifs:function(e,t){for(var n in e)if(!t[n]){var r=this.starredMsg.get(n);if(r&&r.isGif){var i=this.getMsgComponent(n);i&&i.playCount&&i.pause()}}},render:function(){var e=this,t=this.getMsgList(),n=this.state.cursor,r=this.props.chat||null,i=void 0,a=void 0;if(a=this.starredMsg.isSynced&&n.end>=t.length?null:this.starredMsg.syncPromise?s.createElement("div",{className:"more"},s.createElement("div",{className:"btn-more",title:l10n.t("loading_messages")},s.createElement(w,{stroke:6,size:24}))):s.createElement("div",{className:"more"},s.createElement("div",{className:"btn-more",title:l10n.t("load_earlier_messages"),onClick:this.loadEarlierMsgs},s.createElement("span",{className:"icon icon-refresh"}))),t.length>0){var c=t.map(function(t){var n=t.type===T.TYPE.IMAGE||t.type===T.TYPE.VIDEO||t.type===T.TYPE.AUDIO;return s.createElement(y,{key:t.id,ref:t.id.toString(),msg:t,isMsgVisible:n?e.isMsgVisible:_.noop,currSelection:e.currSelection,activeSelection:e.activeSelection,onClickMsg:e.selectMsg})});i=s.createElement(v,{transitionName:"slide"},c)}else this.starredMsg.isSynced?i=s.createElement(p.StarredMsgs,null):(i=s.createElement(p.Loading,null),a=null);var l={down:this.onNextMsg,up:this.onPrevMsg},u=t.length||this.starredMsg.isSynced,m=C.supportsFeature(C.F.UNSTAR_ALL)?s.createElement(O,{a8n:"starred-menu",icon:"menu-white",title:l10n.t("menutitle_menu"),disabled:!u},s.createElement(U,{chat:r,msgs:t})):null;return s.createElement(d,{id:"starred",onCancel:this.onClose},s.createElement(o["default"],{className:"drawer",handlers:l,onFocus:this.onFocusGain,"data-tab":2,ref:"body"},s.createElement(h,{title:l10n.t("starred_flow_title"),onBack:this.onClose,type:h.Type.LARGE,menu:m}),s.createElement(f,{onScroll:this.onScroll,ref:"scrollContainer"},i,a)))}});L.contextTypes={uim:s.PropTypes.instanceOf(R)},e.exports=L;var U=s.createClass({displayName:"StarredHeaderDropdown",propTypes:{chat:s.PropTypes.instanceOf(N),msgs:s.PropTypes.array},sendUnstarAll:function(){u.openModal(s.createElement(I,{msgs:this.props.msgs,chat:this.props.chat}))},render:function(){return s.createElement(A,{type:A.Type.DROPDOWN_MENU,flipOnRTL:!0,key:"StarredDrawerHeader",direction:{x:A.Direction.X.LEFT}},s.createElement(D,{a8n:"mi-unstar-all menu-item",action:this.sendUnstarAll},l10n.t("unstar_all")))}})},function(e,t,n){"use strict";function r(e){var t=document.createElement("a");t.href=e,t.target="_blank",t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function i(e){return e.join(" ")}var a=n(6),o=n(8),s=n(24),c=n(1250),l=n(1282),u=n(1340),d=n(1259),p=a.createClass({displayName:"VCardModalDetails",propTypes:{className:a.PropTypes.string,parsedVCard:a.PropTypes.object.isRequired,thumbnail:a.PropTypes.string},defaultProps:{className:""},openChat:function(e){o.closeModal(),Store.Chat.find(s.numberToWid(e)).then(function(e){o.openChatFromUnread(e).then(function(t){t&&o.focusChatTextInput(e)})})},sendEmail:function(e){var t="mailto:"+e;r(t)},openLocation:function(e){var t=_.map(_.filter(e),encodeURIComponent).join(", "),n="https://maps.google.com/maps/search/"+t+"?hl="+l10n.getLocale();r(n)},getHeader:function(){var e=this.props.parsedVCard,t=c.vcardWAids(this.props.parsedVCard),n=null;if(_.first(e.FN))n=_.first(e.FN).value;else if(_.first(e.NICKNAME))n=_.first(e.NICKNAME).value;else if(_.first(e.TEL)){var r=_.first(e.TEL),i=_.first(r.properties.waid);n=i?s.formattedUser(i):r.value}var o=c.getOrganizationString(e),u=a.createElement("div",{className:"chat-avatar"},a.createElement(l,{thumb:this.props.thumbnail,waid:c.thumbnailWAid(t)}));return a.createElement("div",{className:"chatlist chatlist-plain"},a.createElement(d,{id:t[0],contextEnabled:function(){return!1},image:u,primary:n,secondary:o}))},render:function(){var e=this,t=this.props.parsedVCard,n=_.filter(t.TEL,function(e){return e.properties.waid}),r=_.filter(t.TEL,function(e){return!e.properties.waid}),o=_.map(n,function(t){var n=_.first(t.properties.waid),r=function(){return e.openChat(n)},i=a.createElement("span",{onClick:r,className:"icon icon-chat clickable"}),o=a.createElement("span",{className:"selectable-text"},s.formattedUser(n));return a.createElement(u,{title:o,icon:i,key:"vCard-"+t.index},c.getType(t))}),l=_.map(t.EMAIL,function(t){return a.createElement(u,{title:t.value,onClick:function(){return e.sendEmail(t.value)},key:"vCard-"+t.index},c.getType(t))}),d=_.map(t.ADR,function(t){var n=i(t.value);return a.createElement(u,{title:n,onClick:function(){return e.openLocation(t.value)},key:"vCard-"+t.index},c.getType(t))}),p=_.map(r,function(e){return a.createElement(u,{title:e.value,key:"vCard-"+e.index},c.getType(e))}),h=_.map(t.SERVICE,function(e){return a.createElement(u,{title:e.value,key:"vCard-"+e.index},c.getType(e))}),f=_.map(t.BDAY,function(e){return a.createElement(u,{title:c.getDate(e.value),key:"vCard-"+e.index},l10n.t("vcard_birthday"));
}),m=_.map(t.NICKNAME,function(e){return a.createElement(u,{title:e.value,key:"vCard-"+e.index},l10n.t("vcard_nickname"))}),g=this.getHeader();return a.createElement("div",{className:this.props.className},a.createElement("div",null,g,a.createElement("div",{className:"drawer-item-container-compact"},o,l,d,p,f,m,h)))}});e.exports=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(87),s=n(439),c=n(1273).prepRawMedia,l=n(1530),u=n(14),d={READY:"ready",PROCESSING:"processing",ERROR:"error"},p=o.extend({props:{id:"number",file:"object",uiProcessed:"boolean"},session:{state:{type:"string",values:_.values(d)},media:"object",mediaPrep:"object",url:"string",name:"string",preview:"string",processPromise:"object",exception:"object",chat:"object",caption:"string",original:"object",generatedPreview:"object"},initialize:function(){this.processFile(this.file)},processFile:function(e){var t=this;return this.state=d.PROCESSING,this.processPromise=a["default"].resolve(e).then(function(e){var n=void 0;n=e.isGifHackDoNotUse?{asGif:!0,gifAttribution:e.gifAttributionHackDoNotUse}:{};var r=c(e,n);return r.waitForPrep().then(function(e){return l.enrich(e)}).then(function(e){var n=e.media,i=e.documentPreview;t.set({media:n,mediaPrep:r,url:window.URL.createObjectURL(n.mediaBlob),name:n.filename,preview:n.preview,state:d.READY,generatedPreview:i})})})["catch"](u.MediaFileTooLarge,u.InvalidMediaFileType,u.MediaFileFailedLoad,function(e){return t.set({exception:e,state:d.ERROR}),t})["catch"](function(e){return t.set({exception:new u.InvalidMediaFileType,state:d.ERROR}),t})},getFileType:function(){return s.typeFromMimetype(this.file.type)},editImage:function(e){return this.getFileType()!==s.FILETYPE.IMAGE?null:(window.URL.revokeObjectURL(this.url),e.original=this.original||new p(this.toJSON()),this.set(e),void this.initialize())},revertImage:function(){if(this.getFileType()!==s.FILETYPE.IMAGE)return null;if(!this.original)return this;window.URL.revokeObjectURL(this.url);var e=this.original.toJSON();return e.original=null,this.set(e),this.initialize(),this}});p.STATE=d,e.exports=p},function(e,t,n){"use strict";var r=n(87),i=n(1267),a=n(1),o=r.extend({props:{pendingMsgs:"boolean"},session:{msgChunks:{type:"array","default":function(){return[]}},lastReceivedKey:"object",unreadMsgAnchor:"object",disableUnreadAnchor:"boolean",msgsLength:"number",msgsChanged:{type:"number","default":0}},collections:{msgs:i},initialize:function(){var e=this;_.isFunction(this.onEmptyMRM)||a.error("states that extend ChatMsgs need to define onEmptyMRM()")(),this.listenTo(this.msgs,"change:last",function(){e.msgsChanged++}),this.listenTo(this.msgs,"add remove bulk_add",function(){e.msgsChanged++,e.msgsLength=e.msgs.length})},"delete":function(e){r.prototype["delete"].call(this)},removeMsg:function(e){var t=e.msgChunk;if(t){var n=t.indexOf(e);n<0||(a.log("models:Chat:removeMsg "+e.get("id"))(),t.remove(e),0===t.length&&(t===this.msgs?this.onEmptyMRM():this.removeMsgsCollection(t)))}},getAllCMCs:function(){return this.msgChunks.concat([this.msgs])},getAllMsgs:function(){return _.flatten(this.getAllCMCs().map(function(e){return e.models}))},replaceMsgsCollection:function(e){a.info("model:Chat:replaceMsgsCollection:"+this.id)(),this.msgs.replace(e),this.notifyMsgCollectionMerge(e,this.msgs,this.msgs),this.msgChunks=_.without(this.msgChunks,e)},removeMsgsCollection:function(e){this.msgChunks=_.without(this.msgChunks,e)},notifyMsgCollectionMerge:function(e,t,n){this.trigger("change:cmc:merge",e,t,n)}});e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(433),s=n(1229),c=n(14),l=n(104),u=100,d=o.extend({model:s,initialize:function(){var e=this;o.prototype.initialize.call(this),this.hasMoreMsgs=!0,this.resultPage=0,this.listenTo(Store.Msg,"remove",function(t){e.remove(t)})},resetSearch:function(e){this.hasMoreMsgs=!0,this.resultPage=0,this.searchTerm=e,this.searchPromise&&this.searchPromise.cancel()},search:function(e,t){var n=this;if(this.searchTerm!==e&&(this.searchTerm&&0===e.indexOf(this.searchTerm)||(this.searchTerm=e,this["delete"]()),this.resultPage=0,this.hasMoreMsgs=!0),this.searchPromise){if(this.searchTerm===e)return this.searchPromise;this.searchPromise.cancel()}var r=void 0;return r=t?t.fts(e,++this.resultPage,u):Store.Msg.search(e,++this.resultPage,u),this.searchPromise=r.cancellable().then(function(t){l.supportsFeature(l.F.FTS_PAGINATION)&&!t.eof||(n.hasMoreMsgs=!1),n.searchTerm!==e&&n["delete"](),n.searchTerm=e,n.add(t.messages)})["catch"](c.WapDrop,a["default"].CancellationError,_.noop)["finally"](function(){n.searchPromise=null,n.trigger("search_more")}),this.trigger("search_more"),this.searchPromise}});e.exports=d},function(e,t,n){"use strict";var r=n(46),i={dataTypes:{msgKey:{set:function(e){if(e instanceof r)return{val:e,type:"msgKey"}},compare:function(e,t,n){return e instanceof r&&e.equals(t)}}}};e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(1),c=n(24),l=n(87),u=n(55),d=n(8),p=n(104),h=n(14),f=n(67).ActionToast,m=n(67).ActionType,g=n(0),v=n(148),y=l.extend({props:{id:"string",expiration:{type:"number","default":0}},session:{_unmuteTimer:"string",promises:{type:"object","default":function(){return{}}}},derived:{isMuted:{deps:["expiration"],fn:function(){return!!this.expiration}}},initialize:function(){this.expiration&&this.mute(this.expiration)},setMute:function(e,t){(e||this.expiration)&&e!==this.expiration&&(e?this.mute(e,t):this.unmute(t))},mute:function E(e,t,n){var r=this;if(!_.isNumber(e))return s.log("models:Mute:mute called with invalid expiration "+e)(),a["default"].reject(new h.ActionError);e=Math.round(e),e>2e9&&s.log("models:Mute:mute called with wrong units?"+this.id+" exp:"+e)();var E=function(){this.isMuted&&this._clearUnmuteTimer();var t=e-g().unix();s.log("models:Mute:mute "+this.id+" duration:"+t)(),this._unmuteTimer=v.setTimeout(this.unmute.bind(this),1e3*e),this.set({expiration:e})}.bind(this),i=c.isGroup(this.id);if(t){if(this.promises.mute)return this.promises.mute;this.promises.mute=u.sendConversationMute(this.id,e,this.expiration);var l=new m(i?l10n.t("action_group_muting"):l10n.t("action_chat_muting"));n=n||f.genId();var p=this.promises.mute["catch"](function(a){s.error("models:Mute:mute dropped")(a);var o=i?l10n.t("action_group_mute_failed"):l10n.t("action_chat_mute_failed");throw new m(o,l10n.t("action_try_again"),r.mute.bind(r,e,t,n))}).then(function(e){if(200===e.status){var a=i?l10n.t("action_group_muted"):l10n.t("action_chat_muted");return new m(a,l10n.t("action_undo"),r.unmute.bind(r,t,n))}if(e.status>=400)throw new m(i?l10n.t("action_group_mute_failed"):l10n.t("action_chat_mute_failed"))});return d.openToast(o.createElement(f,{id:n,initialAction:l,pendingAction:p})),this.promises.mute.then(function(e){200!==e.status||e._duplicate||E()})["finally"](function(){r.promises.mute=null})}return E(),a["default"].resolve()},canMute:function(){return p.supportsFeature(p.F.MUTE)&&c.isGroup(this.id)||p.supportsFeature(p.F.MUTE_1_1)&&c.isUser(this.id)},_clearUnmuteTimer:function(){v.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer"),this.expiration=0},unmute:function b(e,t){var n=this,b=function(){s.log("models:Mute:unmute "+this.id)(),this._clearUnmuteTimer()}.bind(this),r=c.isGroup(this.id);if(e){if(this.promises.unmute)return this.promises.unmute;this.promises.unmute=u.sendConversationMute(this.id,!1,this.expiration);var i=new m(r?l10n.t("action_group_unmuting"):l10n.t("action_chat_unmuting"));t=t||f.genId();var l=this.promises.unmute["catch"](function(i){s.error("models:Mute:unmute dropped")(i);var o=r?l10n.t("action_group_unmute_failed"):l10n.t("action_chat_unmute_failed");return a["default"].reject(new m(o,l10n.t("action_try_again"),n.unmute.bind(n,e,t)))}).then(function(e){if(200===e.status)return new m(r?l10n.t("action_group_unmuted"):l10n.t("action_chat_unmuted"));if(e.status>=400)throw new m(r?l10n.t("action_group_unmute_failed"):l10n.t("action_chat_unmute_failed"))});return d.openToast(o.createElement(f,{id:t,initialAction:i,pendingAction:l})),this.promises.unmute.then(function(e){200!==e.status||e._duplicate||b()})["finally"](function(){n.promises.unmute=null})}return b(),a["default"].resolve()},"delete":function(){l.prototype["delete"].call(this),this._clearUnmuteTimer()}});e.exports=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(433),s=n(1229),c=n(12),l=n(104),u=n(1),d=n(10),p=o.extend({model:s,initialize:function(){var e=this;o.prototype.initialize.call(this),this.isSynced=!1,this.syncPromise=null,this.listenTo(c,"change:stream",function(){c.stream===c.STREAM.DISCONNECTED?e.isSynced=!1:c.stream===c.STREAM.CONNECTED&&e["delete"]()})},comparator:function(e,t){return t.t-e.t},process:function(e,t,n,r){r?this["delete"]():this.update(e,t,n)},sync:function(e){if(this.isSynced)return a["default"].resolve();if(this.syncPromise)return this.syncPromise;if(!l.supportsFeature(l.F.FULL_TEXT_SEARCH))return a["default"].resolve();var t=this;if(l.supportsFeature(l.F.STARRED_PAGINATION)){var n=this.last()&&this.last().id;this.syncPromise=Store.Msg.getStarred(e,d.PAGE_SIZE,n).then(function(e){e.length&&t.add(e,{silent:!0}),e.length<d.PAGE_SIZE&&(t.isSynced=!0),t.trigger("sync")})["catch"](function(e){u.error("starred msg sync error: ",e)()})["finally"](function(){t.syncPromise=null})}else this.syncPromise=Store.Msg.getStarred().then(function(e){t.set(e),t.synced=!0,t.trigger("sync")})["catch"](function(e){u.error("starred msg sync error: ",e)()})["finally"](function(){t.syncPromise=null});return this.trigger("sync"),this.syncPromise},update:function(e,t,n){var r=this;if(this.isSynced){var i=this.syncPromise||a["default"].resolve();this.syncPromise=i.then(function(){if(e){var i=t.length>0?Store.Msg.incrementalStarredUpdate(t):a["default"].resolve([]);return i.then(function(e){r.add(e.concat(n),{silent:!0}),_.forEach(t,function(e){e.chat.starredMsg.add(e)}),r.trigger("sync")})["catch"](function(e){u.error("models:starred:update:error: ",e)()})}return r.filter(function(e){return!e.star}).forEach(function(e){r.remove(e.id),e.chat.starredMsg.remove(e.id)}),a["default"].resolve()})["finally"](function(){r.syncPromise=null})}},add:function(e,t){this.isModel(e)&&this.get(e)||(o.prototype.add.call(this,e,t),this.parent?Store.AllStarredMsgs.add(e,t):e&&(Array.isArray(e)?_.forEach(e,function(e){return e.chat.starredMsg.add(e)}):e.chat.starredMsg.add(e)))},remove:function(e,t){this.isModel(e)&&!this.get(e)||(o.prototype.remove.call(this,e,t),this.parent?Store.AllStarredMsgs.remove(e,t):e&&(Array.isArray(e)?_.forEach(e,function(e){return e.chat.starredMsg.remove(e)}):e.chat.starredMsg.remove(e)))},"delete":function(){this.synced=!1,o.prototype["delete"].call(this)}});e.exports=p},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(1231),o=n(8),s=n(432),c=n(1232),l=n(1274),u=n(1248),d=n(1284),p=n(104),h=n(141),f=n(86),m=r.createClass({displayName:"MultiselectBar",mixins:[h],propTypes:{chat:r.PropTypes.instanceOf(a).isRequired,selectedMessages:r.PropTypes.instanceOf(u).isRequired,onCancel:r.PropTypes.func.isRequired,noSortOnForward:r.PropTypes.bool},componentWillMount:function(){var e=this;_.forEach(this.props.selectedMessages.getSelected(),function(t){e.addObserver(t,"change:star")}),this.addObserver(this.props.selectedMessages,"all"),this.addObserver(Store.Msg,"change:star",this.onStarChanged)},onStarChanged:function(e){this.props.selectedMessages.isSelected(e)&&this.setState({})},onStarSelected:function(){this.props.chat.sendStarMsgs(this.props.selectedMessages.getSelected(),!0),this.props.onCancel()},onUnstarSelected:function(){this.props.chat.sendStarMsgs(this.props.selectedMessages.getSelected(),!1),this.props.onCancel()},onDownloadSelected:function(){var e=_.filter(this.props.selectedMessages.getSelected(),function(e){return e.mediaData.renderableUrl});e.length&&(l.initDownload(e),this.props.onCancel())},onDeleteSelected:function(){var e=this,t=this.props.selectedMessages.getSelected(),n=function(){o.closeModal(),e.props.chat.sendDeleteMsgs(t),e.props.onCancel()},i=_.size(t),a=l10n.t("delete_message_confirmation",{count:i,_plural:i});o.openModal(r.createElement(s,{onOK:n,okText:l10n.t("web_delete"),onCancel:o.closeModal.bind(o),cancelText:l10n.t("web_cancel")},r.createElement(c,{text:a})))},onForwardSelected:function(){var e=this,t=this.props.selectedMessages.getSelected();this.props.noSortOnForward||(t=this.props.chat.sortMsgs(t));var n=_.size(t),i=function(){e.props.onCancel()},a=_.filter(t,function(e){return e.canForward()});if(_.size(a))if(n!==_.size(a)){var c=function(){o.openModal(r.createElement(d,{msgs:a,onForward:i}),"modal-flow")};o.openModal(r.createElement(s,{title:l10n.t("confirm_forward_partial_messages_title"),onOK:c,okText:l10n.t("forward"),onCancel:o.closeModal.bind(o),cancelText:l10n.t("web_cancel")},l10n.t("confirm_forward_partial_messages_text")))}else o.openModal(r.createElement(d,{msgs:t,onForward:i}),"modal-flow");else o.openModal(r.createElement(s,{title:l10n.t("err_unsent_forward_title"),onOK:o.closeModal.bind(o),okText:l10n.t("web_ok")},l10n.t("err_unsent_forward_text",{count:n,_plural:n})))},render:function(){var e=this.props.selectedMessages.getSelected(),t=_.size(e),n=p.supportsFeature(p.F.ENC_DOC)||_.every(e,function(e){return e.type!==i.TYPE.DOCUMENT}),a=_.some(e,function(e){return e.canForward()}),o=_.some(e,function(e){return e.mediaData.renderableUrl}),s=r.createElement("button",{className:"btn-icon btn-forward",disabled:t&&n&&a?null:"disabled",title:l10n.t("forward_message",{count:t,_plural:t}),onClick:this.onForwardSelected},r.createElement("span",{className:"icon icon-forward"})),c=void 0;p.supportsFeature(p.F.MESSAGE_DELETE)&&(c=r.createElement("button",{className:"btn-icon btn-delete",disabled:t?null:"disabled",title:l10n.t("delete_message",{count:t,_plural:t}),onClick:this.onDeleteSelected},r.createElement("span",{className:"icon icon-delete"})));var l=void 0;if(p.supportsFeature(p.F.STARRED)){var u=void 0,d=void 0,h=void 0;t&&_.every(e,"star")?(u=this.onUnstarSelected,d=r.createElement("span",{className:"icon icon-unstar-btn"}),h=l10n.t("unstar_message",{count:t,_plural:t})):(u=this.onStarSelected,d=r.createElement("span",{className:"icon icon-star-btn"}),h=l10n.t("star_message",{count:t,_plural:t})),l=r.createElement("button",{className:"btn-icon btn-star",disabled:t?null:"disabled",title:h,onClick:u},d)}var m=f.isSafari?null:r.createElement("button",{className:"btn-icon",disabled:t&&o?null:"disabled",title:l10n.t("web_button_download"),onClick:this.onDownloadSelected},r.createElement("span",{className:"icon icon-download"}));return r.createElement("div",{className:"multi-controls"},r.createElement("button",{className:"btn-icon btn-cancel",onClick:this.props.onCancel},r.createElement("span",{className:"icon icon-x"})),r.createElement("span",{className:"multi-count"},l10n.t("selected_count",{count:t,_plural:t})),l,c,s,m)}});e.exports=m},function(e,t){"use strict";var n=window.matchMedia("\nonly screen and (max-width: 1024px)\n"),r={column:n.matches?2:3},i=function(e){var t=e.matches?2:3;if(r.column!==t){r.column=t;var n=document.createEvent("Event");n.initEvent("columnChange",!0,!0),window.dispatchEvent(n)}};n.addListener(i),e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1252),s=n(14),c={getFiles:function(e,t){var n=e.target.files||e.dataTransfer.files;if(n=_.map(n,function(e,t){return e}),n.length)return a["default"].resolve(n);if(e.dataTransfer.getData("text/uri-list"))return o.urlToFile(e.dataTransfer.getData("text/uri-list")).then(function(e){return[e]});if(e.dataTransfer.getData("text/html")){var r=new DOMParser,i=r.parseFromString(e.dataTransfer.getData("text/html"),"text/html");if(i.createNodeIterator(i.childNodes[0],NodeFilter.SHOW_TEXT).nextNode()){if(e.dataTransfer.getData("text/plain")&&!t)return a["default"].reject(new s.MediaDragDropError("dropped html has text nodes",e.dataTransfer.getData("text/plain")))}else{var c=i.getElementsByTagName("img");if(c.length)return o.urlToFile(c[0].src).then(function(e){return[e]})}}return a["default"].resolve(n)}};e.exports=c},function(e,t,n){"use strict";function r(e){return CryptoJS.lib.WordArray.create(new Uint8Array(e))}var i=n(222),a=n(13),o=n(14),s=n(32),c=n(1),l=n(1363),u=n(24),d={ackE2EMedia:function(e,t,n){if(t&&n&&e){var o=u.userToLegacy(Store.Conn.me),d=a.build(o).readBuffer(),p=CryptoJS.lib.WordArray.create(d),h=r(i.computeKeys(e,t).refKey),f=CryptoJS.HmacSHA256(p,h);f.sigBytes=20,f.clamp();var m=s.urlSafe(f.toString(CryptoJS.enc.Base64)),g=n+"?ack="+m;return c.log("crypto:ack:"+g)(),l.postRetry(g)}},computeRefs:function(e,t){if(!e||!t||t.filter(function(e){return!u.isUser}).length>0)throw new o.MediaEncryptionError("computeRefs error: "+!!e+","+(t&&t.join()));var n=r(e);return t.map(function(e){var t=CryptoJS.HmacSHA256(CryptoJS.enc.Utf8.parse(u.userToLegacy(e)),n);return t.sigBytes=20,t.clamp(),s.urlSafe(t.toString(CryptoJS.enc.Base64))})},newB64MediaKey:function(){var e=new Uint8Array(32);return window.crypto.getRandomValues(e),s.encode(e)}};e.exports=d},function(e,t){"use strict";var n={boundHeightWidth:function(e,t,n,r){return t=t||r,e=e||n,t>e?t>r&&(e*=r/t,t=r):e>n&&(t*=n/e,e=n),{width:Math.max(t,1),height:Math.max(e,1)}}};e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1],n=void 0;return new u["default"](function(r,i){n=new Image,t&&0!==e.indexOf("data:")&&n.setAttribute("crossOrigin","anonymous"),n.onload=r,n.onabort=function(){i(new Error("loadImage onabort"))},n.onerror=function(){i(new Error("loadImage onerror"))},n.src=e})["return"](n)}function a(e){return i(e).then(function(t){return t.naturalWidth>0?{img:t,fullWidth:t.naturalWidth,fullHeight:t.naturalHeight}:u["default"].reject(new d.MediaLoadError("image loaded with zero width",e))})["catch"](function(){return u["default"].reject(new d.MediaLoadError("unable to render image",e))})}function o(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=void 0,r=void 0,i=++E,a=new u["default"](function(a,o){m.log("MediaLoad:video called (#"+i+") for "+e.name)(),n=document.createElement("video"),n.volume=0,n.autoplay=!0,n.onloadedmetadata=function(){m.log("MediaLoad:video.onloadedmetadata #"+i)()},t?(n.onloadeddata=function(){m.log("MediaLoad:video.onloadeddata #"+i)()},n.onprogress=function(){m.log("MediaLoad:video.onprogress #"+i)()}):(n.onloadeddata=a,n.onprogress=a),n.onplay=a,n.onerror=function(){m.error("MediaLoad:video.onerror #"+i)(),o(new d.MediaLoadError("unable to play video",r))},n.src=r=window.URL.createObjectURL(e),n.load()});return setTimeout(function(){a.isPending()&&(m.error("unable to load video #"+i+" ("+e.size+" bytes)")(),0===_&&(b=e),3===++_&&(m.assert(!1,"dead-video","had "+_+" silent videos")(),f(b)))},8e3),a.delay(10).then(function(){if(m.log("MediaLoad:video #"+i+" successful")(),n.pause(),n.videoWidth>0)return{video:n,fullWidth:n.videoWidth,fullHeight:n.videoHeight};throw n.duration>0?new d.MediaUnsupportedError("video loaded with duration but no dims"):new d.MediaLoadError("video loaded with zero width",r)})["finally"](function(){n&&(n.onloadedmetadata=null,n.onloadeddata=null,n.onplay=null,n.onerror=null),r&&window.URL.revokeObjectURL(r)})}function s(e){var t=void 0;return new u["default"](function(n,r){t=document.createElement("audio"),t.volume=0,t.autoplay=!0,t.onplay=function(e){t.pause(),n({audio:t})},t.onerror=function(){r(new d.MediaLoadError("unable to play audio",e))},t.src=e})["finally"](function(){t&&(t.onplay=t.onerror=null)})}function c(e,t){var n=t.indexOf(p.MIMETYPE_OGG)>-1;if(n&&!y){if(e.size<=v){var r=new g(e);return r.generateBlob()}throw new d.MediaLoadError("media-load:transcode blob too large",e.size)}return u["default"].resolve(e)}var l=n(2),u=r(l),d=n(14),p=n(10),h=n(1336),f=h.reportFossil,m=n(1),g=n(1541),v=3e5,y=(new Audio).canPlayType("audio/ogg"),_=0,E=0,b=null;e.exports={loadImage:i,image:a,video:o,audio:s,transcode:c}},function(e,t){"use strict";var n={getNameString:function(e){var t=_.find(e,function(e){return!!e.displayName});if(0===e.length)return l10n.t("multi_vcard_display_text_none");if(!t)return l10n.t("multi_vcard_number_of_contacts",{count:e.length,_plural:e.length});var n=t.displayName;return 1===e.length?n:l10n.t("multi_vcard_display_text",{contactName:n,count:e.length-1,_plural:e.length-1})}};e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(436),m=n(1258),g=n(1257),v=g.matchAll,y=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"match",value:function(e){return v(f.emojiRegex(),e)}},{key:"alwaysApply",get:function(){return!0}}]),t}(m);e.exports=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1258),m=n(1257),g=m.matchAll,v=n(38),y=function(e){function t(e){var n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];(0,s["default"])(this,t);var r=(0,d["default"])(this,(0,a["default"])(t).call(this)),i=e.map(v.escapeRegExp),o=n?"(?:^|\\b)":"";return r._regex=new RegExp(o+"("+i.join("|")+")","ig"),r}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"match",value:function(e){return g(this._regex,e)}}]),t}(f);e.exports=y},function(e,t){"use strict";var n=0,r=1,i=2,a=function(e,t){for(var n=[],r=0;r<t.length;++r){var i=t[r],a=i.match(e);if(a&&a.length){for(var o=i.group,s=0;s<a.length;++s){var c=a[s],l=c[0],u=c.index;if(c.idx=r,c.end=u+l.length-1,o){var d=c[o];c.gindex=u+l.indexOf(d),c.gend=c.gindex+d.length-1}else c.gindex=u,c.gend=c.end}n.push(a)}}if(!n.length)return n;if(1===n.length)return n[0].reverse();for(var p=[],h=0;h<n.length;++h)p[h]=n[h].length-1;for(var f=[],m=0;n.length>1;){for(var g=0,v=-1;g<n.length;++g)n[g][p[g]].index>v&&(m=g,v=n[g][p[g]].index);f.push(n[m][p[m]]),--p[m]<0&&(n.splice(m,1),p.splice(m,1))}return f.push.apply(f,n[0].slice(0,p[0]+1).reverse()),f},o=function(e,t){if(1===e.length)return e;for(var n=[],r=void 0;r=e.pop();){var i=e.length;if(!i&&n.push(r))break;for(var a=r,o=a.end,s=a.gend,c=a.idx,l=t[c],u=l.alwaysApply,d=l.formatResult,p=l.mutates,h=!0,f=i-1;f>=0;--f){var m=e[f];if(m.index>o)break;if(m.end>s){if(c<m.idx&&e.splice(f,1))continue;h=!1;break}if(!p||!e.splice(f,1)){var g=t[m.idx];if(!u&&!g.formatResult){h=!1;break}d||g.alwaysApply||!e.splice(f,1)}}h&&n.push(r)}return n},s=function(e,t){for(var a=e[0].input,o={children:[]},s=0,l=o,u=void 0,d=0;d<e.length;++d){for(var p=e[d],h=p.index,f=p.gindex;l.parent&&h>(u=l.match.gend);){if(s<=u&&l.children.push({type:n,value:a.substring(s,u+1)}),s=l.match.end+1,l.mutator.isFragment){var m=l.parent.children;m.pop(),m.push.apply(m,l.children)}l.mutator.isFormatter&&u!==l.match.end&&l.parent.children.push({type:r,value:a.substring(u+1,s)}),l=l.parent}s<h&&l.children.push({type:n,value:a.substring(s,h)});var g=t[p.idx],v=g.mutates,y=g.isFormatter;s=f,y&&h!==f&&l.children.push({type:r,value:a.substring(h,f)});var _={children:[],match:p,mutator:g,parent:l,type:i};if(v){var E=p[g.group],b=g.mutate(E,p);if(E!==b){var w=c(b,t);_.children=w.children,s=p.gend+1}}l.children.push(_),l=_}do{var M=l.match,C=M.end,S=M.gend;if(s<=S&&l.children.push({type:n,value:a.substring(s,S+1)}),s=C+1,l.mutator.isFragment){var T=l.parent.children;T.pop(),T.push.apply(T,l.children)}l.mutator.isFormatter&&S!==C&&l.parent.children.push({type:r,value:a.substring(S+1,s)})}while((l=l.parent)&&l.parent);return s!==a.length&&l.children.push({type:n,value:a.substring(s)}),o},c=function(e,t){var r=a(e,t);return r.length?s(o(r,t),t):{children:[{type:n,value:e}]}},l=function u(e,t){var a=e.children,o=e.type,s=e.value;if(o===r)return t.onDelimiter(s);if(o===n)return t.onText(s);var c=a.map(function(e){return u(e,t)}).filter(function(e){return!!e});return o===i?t.onMutatorNode(e,c):t.onRoot(c)};e.exports={parse:c,serialize:l}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){var r=e.models;if(n===E.BEFORE){var i=function(){var e=0;return{v:{hasNext:function(){return t>=e},next:function(){return r[t--]}}}}();if("object"==typeof i)return i.v}else{if(n!==E.AFTER)throw new Error("RendorCursor:invalid direction");var a=function(){var e=r.length-1;return{v:{hasNext:function(){return t<=e},next:function(){return r[t++]}}}}();if("object"==typeof a)return a.v}}function a(e,t,n){for(var r=arguments.length<=3||void 0===arguments[3]?1:arguments[3],a=S*r,o=i(e,t,n),s=0,l=0,u=void 0;o.hasNext();){var d=o.next(),p=c(d),h=2*d.isNotification+d.isSentByMe,f=h&&h===u?b:w;if(s+=p+f,l++,s>a)break;u=h}return l}function o(e,t,n){for(var r=arguments.length<=3||void 0===arguments[3]?1:arguments[3],a=S*r,o=i(e,t,n),s=0,l=0,u=void 0;o.hasNext();){var d=o.next(),p=c(d),h=d.author||(d.isSentByMe?Store.Conn.me:void 0),f=h&&!d.isSentByMe&&h!==u?M:0,m=h&&h===u?b:w;if(s+=p+f+m,l++,s>a)break;u=h}return l}function s(e,t,n){for(var r=arguments.length<=3||void 0===arguments[3]?1:arguments[3],a=S*r,o=i(e,t,n),s=0,l=0;o.hasNext();){var u=o.next(),d=c(u);if(s+=d+C,l++,s>a)break}return l}function c(e){var t=0;switch(e.quotedMsg&&(t+=54),e.caption&&(t+=31),e.type){case m.TYPE.NOTIFICATION:case m.TYPE.GROUP_NOTIFICATION:case m.TYPE.GP2:case m.TYPE.BROADCAST_NOTIFICATION:case m.TYPE.E2E_NOTIFICATION:case m.TYPE.CALL_LOG:case m.TYPE.CIPHERTEXT:case m.TYPE.CHAT:e.linkPreview&&(t+=53);var n=y(e.body).length;return t+19*_.ceil(n/100)+13;case m.TYPE.IMAGE:return t+e.fullWidth&&e.fullHeight?Math.floor(Math.min(330/e.fullWidth*e.fullHeight,330)):330;case m.TYPE.VIDEO:case m.TYPE.AUDIO:return e.isGif?t+137:t+166;case m.TYPE.LOCATION:return t+v.previewHeight;case m.TYPE.PTT:return t+67;case m.TYPE.VCARD:return t+74;case m.TYPE.DOCUMENT:return t+188;case m.TYPE.UNKNOWN:default:return t}}function l(e){switch(e){case g.RENDOR_CURSOR.CONVERSATION:case g.RENDOR_CURSOR.GROUP_CONVERSATION:return g.RENDOR_CURSOR.RECENT_AT_BOTTOM;case g.RENDOR_CURSOR.STARRED_DRAWER:return g.RENDOR_CURSOR.RECENT_AT_TOP;default:return g.RENDOR_CURSOR.RECENT_AT_BOTTOM}}function u(e){switch(e){case g.RENDOR_CURSOR.CONVERSATION:return a;case g.RENDOR_CURSOR.GROUP_CONVERSATION:return o;case g.RENDOR_CURSOR.STARRED_DRAWER:return s;default:return a}}var d=n(23),p=r(d),h=n(26),f=r(h),m=n(1229),g=n(10),v=n(1330),y=n(1321),E={BEFORE:"before",AFTER:"after"},b=2,w=12,M=19,C=65,S=window.innerHeight,T=_.debounce(function(e){S=window.innerHeight},500);window.addEventListener("resize",T);var k=function(){function e(t,n,r){var i=this;(0,p["default"])(this,e);var a=u(r);this.msgCollection=t,this.type=r,this.dir=l(r),this.cursorSize=function(e,t){if(e===E.BEFORE)return a(i.msgCollection,i.start-1,e,t);if(e===E.AFTER)return a(i.msgCollection,i.end,e,t);throw new Error("RendorCursor:invalid direction")},this.init(n)}return(0,f["default"])(e,[{key:"init",value:function(e){return this.before=0,this.after=0,this.setKey(e),this.loadBefore(void 0,1),this.loadAfter(void 0,1),this}},{key:"setKey",value:function(e){return this.msgKey=e,this.updatePrev(),e||(this.before+=this.after),this}},{key:"onRemove",value:function(e){e.id===this.prevKey?this.updatePrev():e.id===this.msgKey&&this.focusBefore()}},{key:"updatePrev",value:function(){this.prevKey=this.index>0?this.msgCollection.models[this.index-1].id:void 0}},{key:"focusBefore",value:function(){this.msgKey=this.prevKey,this.updatePrev()}},{key:"loadBefore",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?2:arguments[1],n=e||this.cursorSize(E.BEFORE,t);return this.before+=n,this}},{key:"loadAfter",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?2:arguments[1],n=e||this.cursorSize(E.AFTER,t);return this.after+=n,this}},{key:"index",get:function(){if(this.msgKey){var e=this.msgCollection.get(this.msgKey),t=this.msgCollection.indexOf(e);if(t!==-1)return t}return this.dir===g.RENDOR_CURSOR.RECENT_AT_TOP?0:this.msgCollection.length-1}},{key:"start",get:function(){return Math.max(this.index-this.before,0)}},{key:"end",get:function(){return Math.min(this.index+this.after+1,this.msgCollection.length)}}]),e}();e.exports=k},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return s(function(){return h.get(e,t)})}function a(e){return s(function(){return h.head(e)})}function o(e,t){return s(function(){return h.post(e,t)})}function s(e){return u["default"].loop(function(t,n,r){var i=u["default"].delay(f.expBackoff(r,6e4,void 0,.1));return c().then(function(){return e()}).then(function(e){return e.status>=500&&e.status<600?i:void t(e)})["catch"](function(){return i})})}function c(){return d.state===d.STATE.CONNECTED?u["default"].resolve():p.waitForBBEvent(d,"change:state",_.matches({state:d.STATE.CONNECTED}))}var l=n(2),u=r(l),d=n(12),p=n(56),h=n(147),f=n(90);e.exports={headRetry:a,getRetry:i,postRetry:o}},function(e,t,n){e.exports=function(){return new Worker(n.p+"b25a5072816123111083.worker.js")}},,function(e,t,n){"use strict";var r=n(6),i=n(8),a=n(83),o=n(85),s=r.createClass({displayName:"ActionListener",mixins:[a],componentWillMount:function(){this.regCmd("mute_chat",this.onMute),this.regCmd("delete_or_exit_chat",this.onDeleteOrExit),this.regCmd("archive_chat",this.onArchive),this.regCmd("clear_chat_msgs",this.onClear),this.regCmd("mark_chat_unread",this.onMarkUnread)},onMute:function c(e,t){if(t){var a=n(1486),c=function(t){e.pendingAction++,e.mute.mute(t,!0)["finally"](function(){e.pendingAction--})};i.openModal(r.createElement(a,{chat:e,onMute:c}),"modal",this.context.uim)}else e.pendingAction++,e.mute.unmute(!0)["finally"](function(){e.pendingAction--})},onDeleteOrExit:function(e){var t=n(1471),a=function(t){e.pendingAction++,t["finally"](function(){e.pendingAction--})};i.openModal(r.createElement(t,{chat:e,onDeleteOrExit:a}),"modal",this.context.uim)},onClear:function(e){var t=n(1466);i.openModal(r.createElement(t,{chat:e}),"modal",this.context.uim)},onArchive:function(e,t){e.pendingAction++,e.setArchive(t)["catch"](_.noop)["finally"](function(){e.pendingAction--})},onMarkUnread:function(e,t){e.pendingAction++,e.markUnread(t)["finally"](function(){e.pendingAction--})},render:function(){return null}});s.contextTypes={uim:r.PropTypes.instanceOf(o)},e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(220).MIMETYPES,a=_.pickBy(i,function(e){return"audio"===e.msgType}),o=r.createClass({displayName:"AttachMediaTypeAudio",propTypes:{mimeType:r.PropTypes.oneOf(_.keys(a)).isRequired,url:r.PropTypes.string.isRequired},render:function(){var e=this.props,t=e.mimeType,n=e.url;return r.createElement("div",{className:"media-element-container"},r.createElement("div",{className:"media-element"},r.createElement("audio",{controls:!0,type:t,src:n})))}});e.exports=o},function(e,t,n){"use strict";var r=n(6),i=n(1254),a=n(1293),o=r.createClass({displayName:"AttachMediaTypeDoc",propTypes:{preview:r.PropTypes.object,mimeType:r.PropTypes.string,filename:r.PropTypes.string},render:function(){var e=this.props.preview;return e?r.createElement("div",{className:"media-element-pdf-container"},r.createElement("div",{className:"media-element-pdf-preview"},r.createElement(i,{type:i.TYPES.SCALE_DOWN,size:{width:e.width,height:e.height}},r.createElement("img",{src:e.url,className:"media-viewer-img"})))):r.createElement(a,{mimeType:this.props.mimeType,filename:this.props.filename})}});e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(6),s=n(1254),c=n(220).MIMETYPES,l=_.pickBy(c,function(e){return"image"===e.msgType||"video"===e.msgType;
}),u=o.createClass({displayName:"AttachMediaTypeMedia",propTypes:{mimeType:o.PropTypes.oneOf(_.keys(l)).isRequired,url:o.PropTypes.string.isRequired,isGif:o.PropTypes.bool,size:o.PropTypes.shape({width:o.PropTypes.number,height:o.PropTypes.number})},render:function(){var e=this.props,t=e.mimeType,n=e.url,r=e.size,i=void 0;if("image"===l[t].msgType)i=o.createElement("img",{src:n,className:"media-viewer-img"});else if("video"===l[t].msgType){var c=this.props.isGif?{loop:!0,autoPlay:!0,muted:!1,controls:!1}:{};i=o.createElement("video",(0,a["default"])({controls:!0,className:"media-viewer-img",type:t},c,{src:n}))}else"audio"===l[t].msgType&&(i=o.createElement("audio",{controls:!0,className:"media-viewer-audio",type:t,src:n}));return o.createElement("div",{className:"media-element-container"},o.createElement("div",{className:"media-element"},o.createElement(s,{type:s.TYPES.SCALE_DOWN,size:r},i)))}});e.exports=u},function(e,t,n){"use strict";var r=n(6),i=n(1254),a=n(1293),o=r.createClass({displayName:"AttachMediaTypePdf",propTypes:{preview:r.PropTypes.object,mimeType:r.PropTypes.string,filename:r.PropTypes.string},componentWillUnmount:function(){},render:function(){var e=this.props.preview;if(e){var t=l10n.t("attach_document_pdf_total_pages",{count:e.pdfPages,_plural:e.pdfPages});return r.createElement("div",{className:"media-element-pdf-container"},r.createElement("div",{className:"media-element-pdf-preview"},r.createElement(i,{type:i.TYPES.SCALE_DOWN,size:{width:e.width,height:e.height}},r.createElement("img",{src:e.url,className:"media-viewer-img"}))),r.createElement("div",{className:"media-element-pdf-caption"},t))}return r.createElement(a,{mimeType:this.props.mimeType,filename:this.props.filename})}});e.exports=o},function(e,t,n){"use strict";var r=n(6),i=n(1),a=n(86),o=n(232),s=n(12),c=n(149),l=n(107),u=n(446),d=n(57),p=n(89),h=n(0),f=n(56),m=n(141),g=n(83),v=n(145),y=n(10),E=n(8),b=n(44),w=n(106),M=n(1263),C=r.createClass({displayName:"ButterBar",mixins:[m,g],getInitialState:function(){var e=this;this._showNotifyTimer=new p(this.showPrompt),this._showBatteryTimer=new p(function(){return e.batteryUpdate()});var t=u.battery<y.BATTERY_LOW_THRESHOLD_1?u.battery<y.BATTERY_LOW_THRESHOLD_2?2:1:0;return{lowBatteryWarning:u.plugged?0:t,notifyPermission:window.Notification&&window.Notification.permission,showNotify:!1}},componentWillMount:function(){this.addObserver(l,"change:displayInfo"),this.addObserver(l,"change:needsUpdate"),this.addObserver(l,"change:needsManualDownload"),this.addObserver(u,"change:plugged",this.batteryUpdate),this.addObserver(u,"change:battery",this.batteryUpdate)},componentWillUnmount:function(){this._showNotifyTimer.cancel(),this._showBatteryTimer.cancel()},onReload:function(){o.restart()},onClickManualDownload:function(){},batteryUpdate:function(e){var t=this.state.lowBatteryWarning;u.plugged||u.battery>y.BATTERY_LOW_THRESHOLD_1?0!==t&&this.setState({lowBatteryWarning:0}):u.battery<=y.BATTERY_LOW_THRESHOLD_2?t!==-2&&(e?this._showBatteryTimer.onOrBefore(y.BATTERY_DELAY):2!==t&&this.setState({lowBatteryWarning:2})):t>-1&&u.battery<=y.BATTERY_LOW_THRESHOLD_1&&(e?this._showBatteryTimer.onOrBefore(y.BATTERY_DELAY):1!==t&&this.setState({lowBatteryWarning:1}))},dismissLowBatteryWarning:function(){var e=this.state.lowBatteryWarning;e>0&&this.setState({lowBatteryWarning:-e})},showPrompt:function(e){this.setState({showNotify:e})},guideConfirm:function(){E.closeModal()},guideLearnMore:function(){switch(a.browser){case y.BROWSER_TYPE.CHROME:return window.open("https://www.whatsapp.com/faq/web/28080004","_blank");case y.BROWSER_TYPE.FIREFOX:return window.open("https://www.whatsapp.com/faq/web/28080006","_blank");case y.BROWSER_TYPE.SAFARI:return window.open("https://www.whatsapp.com/faq/web/28080008","_blank");case y.BROWSER_TYPE.OPERA:return window.open("https://www.whatsapp.com/faq/web/28080007","_blank");default:return window.open("https://www.whatsapp.com/faq/web/28080004","_blank")}},requestPermissions:function(){E.openModal(r.createElement(M,{title:"guide_desktop_notifications_title",desc:"guide_desktop_notifications_description",onConfirm:this.guideConfirm,onCancel:this.guideLearnMore,type:M.TYPE.GUIDE_ALLOW}));var e=this;window.Notification.requestPermission(function(t){E.closeModal(),e.setState({notifyPermission:t})})},render:function(){var e=null;switch(l.displayInfo){case l.INFO.OFFLINE:e=r.createElement(k,{key:"bbar"});break;case l.INFO.OPENING:case l.INFO.CONNECTING:e=r.createElement(x,{key:"bbar"});break;case l.INFO.NORMAL:break;case l.INFO.RESUMING:case l.INFO.TIMEOUT:var t=function(){window.open("http://www.whatsapp.com/faq/web/28080002")},n=r.createElement("span",null,l10n.t("make_sure_phone_active_internet_connection")," ",r.createElement("span",{className:"action",onClick:t},l10n.t("learn_more")));e=r.createElement(S,{type:"phone",key:"bbar",title:l10n.t("phone_not_connected"),text:n})}if(!e&&this.state.lowBatteryWarning>0&&(e=r.createElement(S,{type:"battery",key:"bbar",title:l10n.t("phone_battery_low"),text:l10n.t("charge_phone_description"),dismissable:!0,onDismiss:this.dismissLowBatteryWarning})),!e&&l.needsUpdate&&(e=r.createElement(S,{type:"update",key:"bbar",title:l10n.t("update_available"),text:l10n.t("click_to_update_whatsapp_web"),action:this.onReload})),l.needsManualDownload&&(e=r.createElement(S,{type:"update",key:"bbar",title:l10n.t("desktop_client_update_available"),text:l10n.t("click_to_download_desktop_client"),action:this.onClickManualDownload})),e)this.state.showNotify&&this._showNotifyTimer.onOrBefore(0,!1);else if(this.state.showNotify){if(window.Notification&&this.state.notifyPermission===y.PERMISSION_DEFAULT){var i=r.createElement("span",{className:"action",onClick:this.requestPermissions},l10n.t("enable_desktop_notifications"));e=r.createElement(S,{type:"notification",key:"bbar",title:l10n.t("get_notified_of_new_messages"),text:i})}}else this._showNotifyTimer.onOrBefore(y.NOTIFICATION_PROMPT_DELAY,!0);return r.createElement("div",{className:"butterbar-container"},r.createElement(w,{transitionName:"butterbar"},e))}}),S=r.createClass({displayName:"BB",propTypes:{type:r.PropTypes.oneOf(["computer","phone","notification","battery","update"]),title:r.PropTypes.node.isRequired,text:r.PropTypes.node,dismissable:r.PropTypes.bool,onDismiss:r.PropTypes.func,action:r.PropTypes.func},onClick:function(){this.props.action&&this.props.action()},render:function(){var e,t;switch(this.props.type){case"computer":case"phone":case"notification":case"battery":case"update":e="butterbar-"+this.props.type,t="icon-alert-"+this.props.type;break;default:i.log("butterbar:render invalid type")()}var n=b("butterbar",e,{action:this.props.action}),a=b("icon","icon-alert",t),o=this.props.dismissable?r.createElement("div",{className:"butterbar-controls"},r.createElement("button",{className:"icon icon-x-light",onClick:this.props.onDismiss})):null,s=this.props.text?r.createElement("div",{className:"butterbar-text"},this.props.text):null;return r.createElement("div",{className:"butterbar-wrapper"},r.createElement("div",{className:n,onClick:this.onClick},r.createElement("div",{className:"butterbar-icon"},r.createElement("span",{className:a})),r.createElement("div",{className:"butterbar-body"},r.createElement("div",{className:"butterbar-title"},this.props.title),s),o))}}),T=3e3,k=r.createClass({displayName:"Offline",mixins:[v],getInitialState:function(){return{allowReconnect:!0}},reconnect:function(){var e=c.numSocketsAttempted+1;s.poke(),f.waitForBBEvent(l,"change:displayInfo",function(){return l.displayInfo===l.INFO.NORMAL}).then(function(){new d.WebcManualWebsocketAttempt({webcManualWebsocketAttemptSuccessful:c.numSocketsAttempted===e}).commit()}),this.setState({allowReconnect:!1}),this.reconnectTimeout=this.safeDelay(this.resetReconnectTimeout,T)},resetReconnectTimeout:function(){this.clearSafeTimeout(this.reconnectTimeout),delete this.reconnectTimeout,this.setState({allowReconnect:!0})},render:function(){var e,t;return this.state.allowReconnect?(e=r.createElement("span",null,l10n.t("make_sure_computer_active_internet_connection")+" ",r.createElement("span",{className:"action",onClick:this.reconnect},l10n.t("reconnect"))),t=l10n.t("computer_not_connected")):(e=null,t=l10n.t("connecting_to_whatsapp_or_phone")),r.createElement(S,{type:"computer",title:t,text:e})}}),x=r.createClass({displayName:"Resume",mixins:[m],getInitialState:function(){return{takingTooLong:!1,didShowSubtitle:!1}},componentWillMount:function(){this._timeoutTimer=new p(this.timedOut),this._intervalTimer=new p(this.onInterval),this.addObserver(s,"change:state",this.onProgress),this.addObserver(s,"change:retryTimestamp",this.onProgress)},componentDidMount:function(){this._timeoutTimer.onOrBefore(3e3)},componentWillUnmount:function(){this._timeoutTimer.cancel(),this._intervalTimer.cancel()},timedOut:function(){this._intervalTimer.onOrAfter(1e3),this.setState({takingTooLong:!0,didShowSubtitle:!0})},onProgress:function(){this._intervalTimer.cancel(),this._timeoutTimer.onOrBefore(3e3),this.setState({takingTooLong:!1})},onInterval:function(){this._intervalTimer.onOrAfter(1e3),this.setState({now:Date.now()})},retry:function(e){s.poke(),this.onProgress()},render:function(){var e,t;if(l.displayInfo===l.INFO.OPENING)e=l10n.t("connecting_to_whatsapp");else{if(l.displayInfo!==l.INFO.CONNECTING)return null;e=l10n.t("connecting_to_whatsapp_or_phone")}if(this.state.takingTooLong){var n=s.retryTimestamp-Date.now();if(n<1)n=l10n.t("retrying"),_.defer(function(){return s.poke()});else if(n<6e4){var i=Math.ceil(n/1e3);n=l10n.t("retrying_in_some_seconds",{number:i,_plural:i})}else n=l10n.t("retrying_in",{duration:h.duration(n).humanize()});t=r.createElement("span",null,n," ",r.createElement("span",{className:"action",onClick:this.retry},l10n.t("retry_now")))}else t=this.state.didShowSubtitle?r.createElement("span",null,l10n.t("retrying")):null;return r.createElement(S,{type:"computer",title:e,text:t})}});e.exports=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=(n(1231),n(1232)),g=n(1376),v=n(1255),y=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.chat,n=e.addListener;n(t,"change:previewMessage"),n(t.presence,"change:chatstate.id change:chatstate.type change:withholdDisplay")}},{key:"render",value:function(){var e=this.props.chat,t=e.presence;if(t.isActive()){var n=t.getFormattedString();if(n)return f.createElement("div",{className:"chat-status typing ellipsify",dir:"auto"},f.createElement(m,{ellipsify:!0,titlify:!0,text:n}))}var r=e.previewMessage;return r?f.createElement(g,{key:r.id,msg:r}):f.createElement("div",{className:"chat-status"})}}]),t}(f.Component);e.exports=v(y)},function(e,t,n){"use strict";var r=n(6),i=n(143),a=r.createClass({displayName:"ContactMsgInfoCell",propTypes:{title:r.PropTypes.string.isRequired,icon:r.PropTypes.node.isRequired,t:r.PropTypes.number},render:function(){var e=this.props,t=e.title,n=e.t,a=e.icon,o=n?i.relativeDateAndTimeStr(n):"-",s={cursor:"auto"};return r.createElement("div",{className:"contact chat",style:s},r.createElement("div",{className:"chat-body"},r.createElement("div",{className:"chat-main"},r.createElement("div",{className:"chat-title"},r.createElement("span",{className:"ellipsify",dir:"auto"},a,t))),r.createElement("div",{className:"chat-secondary"},r.createElement("div",{className:"chat-status ellipsify"},r.createElement("span",{className:"ellipsify",dir:"auto"},o)))))}});e.exports=a},function(e,t,n){"use strict";var r=n(6),i=n(1259),a=n(1237),o=n(143),s=n(1230),c=r.createClass({displayName:"GroupMsgInfoCell",mixins:[s],propTypes:{participant:r.PropTypes.instanceOf(Object).isRequired},getInitialState:function(){return{formattedName:this.async("participant.contact.formattedName")}},render:function(){var e=this.props.participant,t=r.createElement("div",{className:"chat-avatar"},r.createElement(a,{id:e.id})),n={cursor:"auto"};return r.createElement(i,{id:e.id,contextEnabled:function(){return!1},image:t,primary:this.state.formattedName,secondary:o.relativeDateAndTimeStr(e.t),style:n})}});e.exports=c},function(e,t,n){"use strict";var r=n(6),i=n(1230),a=n(106),o=r.createClass({displayName:"Icons",mixins:[i],propTypes:{chat:r.PropTypes.object.isRequired},getInitialState:function(){return{isMuted:this.async("chat.mute.isMuted"),unreadCount:this.async("chat.unreadCount"),archive:this.async("chat.archive")}},render:function(){var e=this.props.chat,t=this.state.isMuted?r.createElement("span",{className:"icon icon-meta icon-muted",key:"icon-muted"}):null,n=0!==e.unreadCount?r.createElement("span",{className:"icon-meta unread-count",key:"icon-unread"},e.unreadCount>0?l10n.n(this.state.unreadCount):r.createElement("span",null," ")):null,i=this.state.archive?r.createElement("span",{className:"icon-meta chat-marker chat-marker-archived",key:"icon-archived"},l10n.t("chat_archived")):null;return r.createElement(a,{transitionName:"pop"},t,i,n)}});e.exports=o},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(86),o=n(1242),s=n(1294),c=n(1275),l=n(1232),u=n(1230),d=r.createClass({displayName:"LastMsg",mixins:[u],propTypes:{msg:r.PropTypes.instanceOf(i).isRequired},getInitialState:function(){var e=this.props.msg,t={};return e.sender&&(t.formattedShortName=this.async("msg.senderObj.formattedShortName")),e.type===i.TYPE.PTT&&(t.duration=this.async("msg.duration")),e.typeCanChange()&&(t.type=this.async("msg.type")),t},render:function(){var e=this.props.msg,t=[];e.isSentByMe&&t.push(r.createElement(s,{msg:e,key:"symbol"})),e.isSentByMe||!e.isGroupMsg||e.isNotification||(t.push(r.createElement(l,{text:this.state.formattedShortName,direction:"auto",className:{number:!e.senderObj.name,"chat-status-name":!0},key:"author"})),t.push(r.createElement("span",{className:"chat-status-divider",key:"divider"},":"))),e.hasSymbol()&&t.push(r.createElement(c,{msg:e,key:"msg-symbol"})),t.push(r.createElement(l,{direction:e.dir,ellipsify:!0,text:o.msgText(e,!1),format:!0,dirMismatch:e.dir&&e.rtl!==l10n.isRTL(),mention:e.mentionMap(),key:"status"}));var n="chat-status";a.isGecko&&(n+=" ellipsify");var i=l10n.embedDir(o.msgText(e),e.rtl);return r.createElement("div",{className:n,title:i},t)}});e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(37),c=n(1230),l=n(1259),u=n(1232),d=n(1313),p=n(1275),h=n(1229),f=n(44),m=n(1268),g=n(141),v=n(86),y=n(1242),E=n(1294),b=n(84),w=o.createClass({displayName:"Message",mixins:[c,g],propTypes:{msg:o.PropTypes.instanceOf(h).isRequired,searchText:o.PropTypes.string,mouseDownAsClick:o.PropTypes.bool,onClick:o.PropTypes.func,active:o.PropTypes.object},getInitialState:function(){var e=this.props,t=e.msg,n=e.active,r={formattedTitle:this.async("msg.chat.formattedTitle"),active:!!n&&n.value===t};return t.sender&&t.isGroupMsg&&!t.isNotification&&(t.isSentByMe?r.formattedShortName=t.senderObj.formattedShortName:r.formattedShortName=this.async("msg.senderObj.formattedShortName")),r},componentWillMount:function(){this.props.active&&this.addObserver(this.props.active,this.props.msg.id.toString(),this.onActiveChange)},onActiveChange:function(e){if("focus"===e){var t=s.findDOMNode(this);b.focus(t),m.scrollIntoViewIfNeeded(t)}this.setState({active:!!e})},onClick:function(e){if(_.isFunction(this.props.onClick)){var t=this.props.msg,n=t.chat,r=n.getSearchContext(t);r.msg=t,this.props.onClick(e,n,r)}},onMouseDown:function(e){0===e.button&&this.onClick(e)},onEnter:function(e){e.preventDefault(),e.stopPropagation(),a["default"].flashFocus=Date.now(),this.onClick(e)},indicateFocus:function(e){if(!(Date.now()-(a["default"].flashFocus||0)>200)){var t=s.findDOMNode(this.refs.cell);Velocity(t,"stop"),Velocity(t,{backgroundColor:["#e9eaeb","#cbdde7"]},{duration:1300,easing:[.19,.69,.01,.99],complete:this.onBlur})}},onBlur:function(e){var t=s.findDOMNode(this.refs.cell);t&&(Velocity(t,"stop"),t.style.backgroundColor="")},contextEnabled:function(){return!1},render:function(){var e=this.props.msg,t=o.createElement(d,{msg:e}),n=[];e.isSentByMe&&n.push(o.createElement(E,{msg:e,key:"symbol"})),e.isSentByMe||!e.isGroupMsg||e.isNotification||(n.push(o.createElement(u,{text:this.state.formattedShortName,direction:"auto",className:{"chat-status-name":!0,number:!e.senderObj.name},key:"author"})),n.push(o.createElement("span",{className:"chat-status-divider",key:"divider"},":"))),e.hasSymbol()&&n.push(o.createElement(p,{msg:e,key:"msg-symbol"}));var r=this.props.searchText?_.uniq(_.compact(_.split(_.toLower(this.props.searchText)," "))):null;n.push(o.createElement(u,{direction:e.dir,ellipsify:!0,highlight:r,text:y.msgText(e),key:"status"}));var i="chat-status";v.isGecko&&(i+=" ellipsify");var s=l10n.embedDir(y.msgText(e),e.rtl),c=o.createElement("div",{className:i,title:s},n),h={enter:this.onEnter},m=f("message",{active:!!this.state.active}),g=this.props.mouseDownAsClick;return o.createElement(a["default"],{handlers:h,onFocus:this.indicateFocus,onBlur:this.onBlur,className:"chat-drag-cover"},o.createElement(l,{id:e.id+"",ref:"cell",contextEnabled:this.contextEnabled,className:m,primary:e.chat.title(),primaryDetail:t,secondary:c,onClick:g?null:this.onClick,onMouseDown:g?this.onMouseDown:null,onContext:this.onMenu}))}});e.exports=w},function(e,t,n){"use strict";var r=n(6),i=n(444),a=n(1232),o=n(1230),s=r.createClass({displayName:"Status",mixins:[o],propTypes:{status:r.PropTypes.instanceOf(i)},getInitialState:function(){return{status:this.async("status.status")}},render:function(){return _.isUndefined(this.state.status)?r.createElement("div",{className:"muted"},l10n.t("contact_status_loading")):r.createElement("div",{className:"chat-status ellipsify",title:this.state.status},r.createElement(a,{direction:"auto",ellipsify:!0,text:this.state.status}))}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(8),a=n(83),o=n(1231),s=n(85),c=r.createClass({displayName:"ChatActionListener",mixins:[a],componentWillMount:function(){this.regCmd("chat_info_drawer",this.onChatInfoDrawer),this.regCmd("msg_info_drawer",this.onMsgInfoDrawer),this.regCmd("chat_search",this.onChatSearch),this.regCmd("attach_media_drawer",this.onAttachMediaDrawer),this.regCmd("verification_drawer",this.onVerificationDrawer),this.regCmd("media_viewer_modal",this.onMediaViewer)},onChatInfoDrawer:function(e){var t=n(1335);i.openDrawerRight(r.createElement(t,{chat:e}),"slide-left",this.context.uim)},onVerificationDrawer:function(e){var t=n(1495);i.openDrawerRight(r.createElement(t,{contact:Store.Contact.get(e),isFirstLevel:!0}),"slide-left",this.context.uim)},onMsgInfoDrawer:function(e){if(e.chat.kind===o.KIND.CHAT){var t=n(1469);i.openDrawerRight(r.createElement(t,{msg:e}),"slide-left",this.context.uim)}else{var a=n(1479);i.openDrawerRight(r.createElement(a,{msg:e}),"slide-left",this.context.uim)}},onAttachMediaDrawer:function(e,t){var a=n(1447),o={drawerId:"DrawerManagermidAttachMedia",noFocus:!0};i.openDrawerMid(r.createElement(a,{chat:e,files:t}),"slide-up",this.context.uim,o)},onChatSearch:function(e){var t=n(1339);i.openDrawerRight(r.createElement(t,{chat:e}),"slide-left",this.context.uim)},onMediaViewer:function(e,t){if(Store.Msg.get(e.id)){var a=n(1450);i.openModalMedia(r.createElement(a,{msg:e,getZoomNode:t}),"media-viewer",this.context.uim)}else{var o=n(1264);i.openModal(r.createElement(o,{msg:e}))}},render:function(){return null}});c.contextTypes={uim:r.PropTypes.instanceOf(s)},e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(441),a=r(i),o=n(1240),s=r(o),c=n(105),l=r(c),u=n(6),d=n(37),p=n(8),h=n(1281),f=n(141),m=n(83),g=n(142),v=n(1245),y=n(218),E=n(10),b=n(1269),w=n(1231),M=n(1251),C=n(1377),S=n(104),T=u.createClass({displayName:"Chatlist",mixins:[f,m,g],propTypes:{isSearching:u.PropTypes.bool,searchText:u.PropTypes.string,chats:u.PropTypes.array,contacts:u.PropTypes.array,ftsResult:u.PropTypes.array,onClick:u.PropTypes.func,selection:u.PropTypes.instanceOf(v),onFocusSearch:u.PropTypes.func},getDefaultProps:function(){return{chats:[]}},getInitialState:function(){var e=this;this._listPointerEvents=!0,this.debouncedOpenSelected=_.debounce(function(){e.openSelected(e.focusComposer),e.focusComposer=!1},200);var t;return t=0,{textsize:t}},componentWillMount:function(){this.props.selection.init(this.getSelection())},componentWillUnmount:function(){var e=this.getSelection(),t=this.props.selection.getVal();t&&t.isState&&!this.props.isSearching&&!e.length&&p.clearChat(t)},componentDidMount:function(){var e=this;this.regCmd("focus_chat_list",this.restoreFocus),this.regCmd("focus_next_chat",this.onNextChat.bind(this,null,!0)),this.regCmd("focus_prev_chat",this.onPrevChat.bind(this,null,!0)),this.regCmd("update_chatlist_selection",this.updateSelected),this.regCmd("textsize_change",function(t){e.setState({textsize:t})})},componentDidUpdate:function(){var e=this.props.selection.getVal();this.props.selection.init(this.getSelection(),!this.props.isSearching),e!==this.props.selection.getVal()&&(this.focusComposer=!0,this.debouncedOpenSelected())},onListPointerEventsOff:function(){this._listPointerEvents=!1},onListPointerEventsOn:function(){this._listPointerEvents=!0},updateSelected:function(e){this.debouncedOpenSelected.cancel(),this.props.selection.setVal(e,!1)},openSelected:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=this.props.selection.getVal();t&&(t instanceof w&&t!==this.getActiveChat()?p.openChatFromUnread(t).then(function(n){n&&e&&p.focusChatTextInput(t)}):e&&p.focusChatTextInput(t))},onClick:function(e,t,n){var r=this;e.preventDefault(),e.stopPropagation(),Store.Chat.find(t.id).then(function(e){r.props.isSearching&&r.props.onClick&&r.props.onClick(),n?p.openChatAt(e,n).then(function(t){t&&p.focusChatTextInput(e)}):e!==r.getActiveChat()?p.openChatFromUnread(e).then(function(t){t&&p.focusChatTextInput(e)}):p.focusChatTextInput(e)})},getSelection:function(){return[].concat((0,a["default"])(this.props.chats),(0,a["default"])(this.props.contacts),(0,a["default"])(this.getFTSStarred()),(0,a["default"])(this.getFTSMessages()))},getFTSStarred:function(){return _.filter(this.props.ftsResult,{star:!0})},getFTSMessages:function(){return _.filter(this.props.ftsResult,{star:!1})},getList:function(){for(var e=this.props,t=e.chats,n=e.contacts,r=[],i=0;i<t.length;i++){var a=t[i];a&&(this.props.isSearching&&0===i&&r.push(u.createElement(h,{key:"chat-header",header:l10n.t("web_chats")})),r.push(u.createElement(b,{chat:a,mode:b.Mode.LAST,searchText:this.props.searchText,onClick:this.onClick,mouseDownAsClick:!0,active:this.props.selection,key:a.id})))}for(var o=0;o<n.length;o++){var s=n[o];s&&(0===o&&r.push(u.createElement(h,{key:"contact-header",header:l10n.t("web_contacts")})),r.push(u.createElement(M,{contact:s,active:this.props.selection,searchText:this.props.searchText,onClick:this.onClick,mouseDownAsClick:!0,key:s.id})))}if(S.supportsFeature(S.F.FULL_TEXT_SEARCH)){for(var c=this.getFTSStarred(),l=0;l<c.length;l++){var d=c[l];0===l&&r.push(u.createElement(h,{key:"fts-header-starred",header:l10n.t("web_starred_messages")})),r.push(u.createElement(C,{msg:d,searchText:this.props.searchText,onClick:this.onClick,active:this.props.selection,key:d.id.toString()}))}for(var p=this.getFTSMessages(),f=0;f<p.length;f++){var m=p[f];0===f&&r.push(u.createElement(h,{key:"fts-header-messages",header:l10n.t("web_messages")})),r.push(u.createElement(C,{msg:m,searchText:this.props.searchText,onClick:this.onClick,active:this.props.selection,key:m.id.toString()}))}}return r},restoreFocus:function(){this.props.selection.reset()},onFocusGain:function(e){var t=this.refs.uie;t&&t.activate(),e.target===d.findDOMNode(this)&&this._listPointerEvents&&(this.props.selection.index<0?this.focusFirst():this.props.selection.reset())},focusFirst:function(){this.props.selection.setFirst(),this.debouncedOpenSelected()},onNextChat:function(e,t,n){e&&(e.preventDefault(),e.stopPropagation());var r=this.props.selection.next();this.props.selection.index!==r&&(this.props.selection.setNext(),this.focusComposer=n,this.debouncedOpenSelected())},onPrevChat:function(e,t,n){e&&(e.stopPropagation(),e.preventDefault());var r=this.props.selection.prev();r>-1?(this.props.selection.setPrev(),this.focusComposer=n,this.debouncedOpenSelected()):t||(this.debouncedOpenSelected.cancel(),this.openSelected(),this.props.onFocusSearch())},render:function(){var e=this,t={down:function(t){return e.onNextChat(t)},up:function(t){return e.onPrevChat(t)}},n=72,r=_.find(E.LIST_HEIGHT_TEXTSIZE_MAP,function(t){return t.scale===e.state.textsize});return r&&(n=r.height),u.createElement(y,{displayName:"Chatlist",ref:"uie",state:y.State.PASSIVE,requestFocus:function(){return e.props.selection.reset(!1)}},u.createElement(l["default"],{handlers:t,onFocus:this.onFocusGain,"data-tab":3},u.createElement(s["default"],{className:"chatlist",data:this.getList(),height:n,animate:!0,extraItems:4,onPointerEventsOff:this.onListPointerEventsOff,onPointerEventsOn:this.onListPointerEventsOn})))},getActiveChat:function(){return _.find(Store.Chat.toArray(),{active:!0})}});e.exports=T},function(e,t,n){"use strict";var r=n(6),i=n(12),a=n(1343),o=n(432),s=n(1451),c=n(1452),l=n(1453),u=n(1460),d=n(1344),p=n(15),h=n(442),f=n(1238),m=n(1237),g=n(8),v=n(1230),y=n(145),_=n(1278),E=_.MenuBarItem,b=_.MenuBar,w=n(104),M=n(435),C=n(44),S=n(106),T="global_mute",k=r.createClass({displayName:"ChatlistHeader",mixins:[v,y],getDefaultProps:function(){return{muteId:T}},getInitialState:function(){return Store.Mute.globalMute(),{isMuted:this.async("muteId.Mute.isMuted")}},componentWillMount:function(){},onWindowFocus:function(){var e=this;this.setState({newlyFocused:!0}),this.safeDelay(function(){return e.setState({newlyFocused:!1})},100)},onMouseDown:function(){},onDrag:function(e){this.didDrag=!0},onClickCapture:function(e){},onNewChat:function(e){e.preventDefault(),g.openDrawerLeft(r.createElement(s,null))},onProfile:function(){g.openDrawerLeft(r.createElement(a,{id:Store.Conn.me}))},onUnmute:function(){Store.Mute.globalMute().unmute(),g.openToast(r.createElement(M,{msg:l10n.t("global_unmuted"),id:M.genId()}))},render:function(){var e=null;this.state.isMuted&&(e=r.createElement(E,{a8n:"menu-bar-unmute",icon:"dnd",title:l10n.t("global_unmute"),onClick:this.onUnmute,key:"btn-dnd"}));var t=C("pane-list-user",{});return r.createElement("header",{className:"pane-header pane-list-header",onMouseDown:this.onMouseDown,onClickCapture:this.onClickCapture},r.createElement("div",{className:t},r.createElement(m,{id:Store.Conn.me,size:40,onClick:this.onProfile})),r.createElement("div",{className:"pane-list-controls"},r.createElement(b,{key:"chatlist-header"},r.createElement(S,{transitionName:"btn"},e,r.createElement(E,{a8n:"menu-bar-chat",icon:"chat",title:l10n.t("web_menuitem_new"),onClick:this.onNewChat}),r.createElement(E,{a8n:"menu-bar-menu",icon:"menu",title:l10n.t("menutitle_menu")},r.createElement(x,null))))))}});e.exports=k;var x=r.createClass({displayName:"ChatlistHeaderDropdown",getInitialState:function(){return{rememberMe:p.getRememberMe()}},onCreateGroup:function(){g.openDrawerLeft(r.createElement(c,null))},onProfile:function(){g.openDrawerLeft(r.createElement(a,{id:Store.Conn.me}))},onDisconnect:function(){var e=Store.Msg.some(function(e){return 0===e.ack&&e.local&&e.isSentByMe});return e?void g.openModal(r.createElement(o,{title:l10n.t("confirm_logout"),onOK:function(){return i.logout()},okText:l10n.t("menuitem_logout"),onCancel:function(){return g.closeModal()},cancelText:l10n.t("web_cancel")},l10n.t("some_of_your_messages_are_still_sending"))):i.logout()},onArchived:function(){g.openDrawerLeft(r.createElement(u,null))},onSettings:function(){g.openDrawerLeft(r.createElement(l,null))},onStarred:function(){g.openDrawerLeft(r.createElement(d,null))},render:function(){var e=w.supportsFeature(w.F.GROUP_CREATE)?r.createElement(f,{a8n:"mi-new-group menu-item",action:this.onCreateGroup,shortcut:"g"},l10n.t("web_menuitem_groupchat")):null,t=w.supportsFeature(w.F.STARRED)&&w.supportsFeature(w.F.FULL_TEXT_SEARCH)?r.createElement(f,{a8n:"mi-starred menu-item",action:this.onStarred},l10n.t("menuitem_starred")):null;return r.createElement(h,{type:h.Type.DROPDOWN_MENU,flipOnRTL:!0,key:"ChatlistHeader",direction:{x:h.Direction.X.LEFT}},e,r.createElement(f,{a8n:"mi-profile-status menu-item",action:this.onProfile},l10n.t("menuitem_profile_status")),r.createElement(f,{a8n:"mi-archived menu-item",action:this.onArchived},l10n.t("menuitem_archived")),t,r.createElement(f,{a8n:"mi-setting menu-item",action:this.onSettings},l10n.t("menuitem_settings")),r.createElement(f,{a8n:"mi-logout menu-item",action:this.onDisconnect,shortcut:"q"},l10n.t("menuitem_logout")))}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(1251),c=n(1245),l=o.createClass({displayName:"ParticipantList",propTypes:{contacts:o.PropTypes.array.isRequired,onDelete:o.PropTypes.func.isRequired,onFocusSearch:o.PropTypes.func.isRequired},getInitialState:function(){return this.selection=new c(this.props.contacts,function(e){return e.id}),null},componentWillReceiveProps:function(e){this.selection.init(e.contacts,!0)},focusLast:function(){_.size(this.props.contacts)&&this.selection.setLast()},focusPrev:function(e){e.preventDefault(),e.stopPropagation();var t=this.selection.prev();t>-1&&this.selection.setPrev()},focusNext:function(e){e.preventDefault(),e.stopPropagation();var t=this.selection.next();this.selection.index===t?(this.selection.unset(),this.props.onFocusSearch(e)):this.selection.setNext()},deleteContact:function(e){e.preventDefault(),e.stopPropagation();var t=_.find(this.props.contacts,this.selection.getVal());this.props.onDelete(e,t)},onParticipantClick:function(e,t){this.selection.setVal(t)},render:function(){var e=this,t=this.props.contacts;if(!t)return null;var n=_.size(this.props.contacts)?_.map(this.props.contacts,function(t){return o.createElement(s,{contact:t,active:e.selection,onDelete:e.props.onDelete,onClick:e.onParticipantClick,type:s.Type.SMALL,key:t.id})}):null,r={up:this.focusPrev,down:this.focusNext,backspace:this.deleteContact};r[l10n.LR("left","right")]=this.focusPrev,r[l10n.LR("right","left")]=this.focusNext;var i=o.createElement("ul",{ref:"list"},n);return o.createElement(a["default"],{handlers:r},i)}});e.exports=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1270),a=r(i),o=n(105),s=r(o),c=n(6),l=n(37),u=n(141),d=n(83),p=n(1236),h=n(1337),f=n(1381),m=n(1380),g=n(1239),v=n(144),y=n(1371),E=n(8),b=n(104),w=n(1292),M=n(14),C=n(1245),S=n(10),T=n(84),k=n(1348),x=n(44),N=n(1249),P=N.GetRef,O=n(1137),D=2,A=c.createClass({displayName:"ChatlistPanel",mixins:[u,d,O,p,h],getInitialState:function(){var e=this;this.ftsMsgs=new k,this.fts=_.debounce(function(){e.pending=!1;var t=_.trim(e.searchText||"");w.multibyteLength(t)<D||(e._ftsPromise&&e._ftsPromise.cancel(),e._ftsPromise=e.ftsMsgs.search(t).checkpoint(e.rejectOnUnmount()).then(function(n){t===_.trim(e.searchText)&&e.setState({searching:!1},h.DD)})["catch"](M.Unmount,_.noop)["catch"](function(){e.pending||e.setState({searching:!1},h.DD)}))},750),this.selection=new C([],function(e){return e.id.toString()}),this.throttledFilteredChats=_.throttle(function(t){var n=e.getFilteredChats(t);e.setState({chats:n},h.DD,h.CD)},450,{leading:!1,trailing:!0}),this.throttledFilteredContacts=_.throttle(function(t){var n=e.getFilteredContacts(t);e.setState({contacts:n},h.DD,h.CD)},450,{leading:!1,trailing:!0}),this.searchText="";var t;return t=0,{searching:!1,chats:this.getFilteredChats(),contacts:this.getFilteredContacts(),textsize:t}},componentWillMount:function(){var e=this;this.addObserver(Store.Chat,"sort remove change:archive",function(){
e.searchText||(e.throttledFilteredChats.cancel(),e.throttledFilteredContacts.cancel(),e.setState({chats:e.getFilteredChats(),contacts:e.getFilteredContacts()}))})},componentDidMount:function(){var e=this;this.addObserver(this.ftsMsgs,"reset"),this.addObserver(this.ftsMsgs,"search_more"),this.regCmd("focus_chat_search",this.onFocusSearch),this.regCmd("textsize_change",function(t){e.setState({textsize:t})})},componentDidUpdate:function(){this.shouldFTSSearch(this.refs.panel)&&(this.fts(),this.pending=!0)},componentWillUnmount:function(){this.fts.cancel(),this.ftsMsgs["delete"](),this._ftsPromise&&this._ftsPromise.cancel(),this.throttledFilteredChats.cancel(),this.throttledFilteredContacts.cancel()},getFilteredContacts:function(e,t){if(!e)return[];e=l10n.accentFold(_.trim(e));var n=Store.Contact.getFilteredContacts();return n.filter(function(n){var r=n.searchMatch(e);if(!r)return!1;var i=Store.Chat.get(n.id);return!(!t&&i&&i.isVisible)})},getFilteredChats:function(e){return e=_.trim(e),e?(e=l10n.accentFold(e),Store.Chat.filter(function(t){return t.contact.searchMatch(e)&&t.isVisible})):Store.Chat.filter(function(e){return!e.archive&&e.isVisible})},fullTextSearch:function(e){var t=_.trim(e);w.multibyteLength(t)>=D&&b.supportsFeature(b.F.FULL_TEXT_SEARCH)?(this.fts(),this.pending=!0,this.state.searching||this.setState({searching:!0},h.DD)):(this.fts.cancel(),this.ftsMsgs.resetSearch(),this.ftsMsgs["delete"](),this._ftsPromise&&this._ftsPromise.cancel(),this.pending=!1,this.state.searching&&this.setState({searching:!1},h.DD))},shouldFTSSearch:function(e){if(!this.ftsMsgs.hasMoreMsgs||this.pending)return!1;var t=_.last(e.children);return e.scrollHeight<e.clientHeight+t.scrollHeight},onSearch:function(e){if(!e)return void this.onStopSearch();var t=this.searchText;if(e!==t){var n={searchText:e};this.fullTextSearch(e),this.throttledFilteredChats(e),this.throttledFilteredContacts(e),this.searchText=e,this.setState(n,h.DD)}},onStopSearch:function(){this.fts.cancel(),this.ftsMsgs.resetSearch(),this.ftsMsgs["delete"](),this._ftsPromise&&this._ftsPromise.cancel(),this.searchText="",this.search&&this.search.setState({searchText:this.searchText}),this.throttledFilteredChats.cancel(),this.throttledFilteredContacts.cancel(),this.pending=!1,this.setState({chats:this.getFilteredChats(),contacts:this.getFilteredContacts(),searching:!1})},onFocusList:function(e){e.repeat||this.refs.chatlist&&this.search.isAtEnd()&&(e.preventDefault(),e.stopPropagation(),s["default"].flashFocus=Date.now(),this.refs.chatlist.focusFirst())},onOpenFirst:function(e){var t=this;e.preventDefault();var n=_.head(this.getFilteredChats(this.searchText))||_.head(this.getFilteredContacts(this.searchText));n&&Store.Chat.find(n.id).then(function(e){t.onStopSearch(),s["default"].flashFocus=Date.now(),E.openChatFromUnread(e).then(function(t){t&&E.focusChatTextInput(e)})})},onFocusSearch:function(e){var t=this;E.existsDrawerLeft(function(e){e||(s["default"].flashFocus=Date.now(),T.focus(t.search))})},indicateFocus:function(e){if(!(Date.now()-(s["default"].flashFocus||0)>200)){var t=l.findDOMNode(this.refs.input_hotkey);Velocity(t,"stop"),Velocity(t,{backgroundColor:["#fbfbfb","#D9F3FF"]},{duration:1600,easing:[.19,.69,.01,.99]})}},onScroll:function(e){this.handleScroll(e.target)},handleScroll:_.throttle(function(e){e.scrollTop+S.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&this.ftsMsgs.hasMoreMsgs&&!this.pending&&(this.fts(),this.pending=!0)},100),getEmptyChatlistState:function(e,t,n){return e.length||t.length||n.length?null:this.searchText?this.state.searching?c.createElement(g.Searching,null):c.createElement(g.Search,null):Store.Chat.some(function(e){return e.isVisible})?c.createElement(g.AllArchived,null):c.createElement(g.ListChats,null)},render:function(){var e=this,t=this.state,n=t.chats,r=t.contacts,i=this.ftsMsgs.models,o=this.getEmptyChatlistState(n,r,i);if(!o){var l=this.searchText?_.trim(this.searchText):null;o=c.createElement(m,{ref:"chatlist",chats:n,contacts:r,isSearching:!!this.searchText,searchText:l,ftsResult:i,selection:this.selection,onFocusSearch:this.onFocusSearch,onClick:this.onStopSearch})}var u,d={down:this.onFocusList,enter:this.onOpenFirst},p=this.ftsMsgs.hasMoreMsgs&&i.length?c.createElement("div",{className:"more",style:{alignSelf:"center"}},c.createElement(v,{stroke:6,size:24})):null,h=_.find(S.TEXTSIZE_CLASS_MAP,function(t){return t.scale===e.state.textsize});h&&(u=h.classname);var g=x("pane pane-list pane-one",u);return c.createElement("div",{id:"side",className:g},c.createElement(f,{key:"ChatHeader"}),c.createElement(y,{key:"ButterBar"}),c.createElement(s["default"],{handlers:d,onFocus:this.indicateFocus,ref:"input_hotkey",className:"search-container"},c.createElement(a["default"],{ref:P("search",this),onSearch:this.onSearch,loading:this.state.searching})),c.createElement("div",{ref:"panel",className:"pane-body pane-list-body",onScroll:this.onScroll,id:"pane-side","data-list-scroll-container":!0},o,p))}});e.exports=A},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(441),a=r(i),o=n(2),s=r(o),c=n(36),l=r(c),u=n(23),d=r(u),p=n(26),h=r(p),f=n(82),m=r(f),g=n(81),v=r(g),y=n(146),_=r(y),E=n(6),b=n(37),w=n(450),M={duration:300,easing:[.1,.82,.25,1]},C=function(e,t){return e.map(function(e,n){return[t[n]===e,n]}).filter(function(e){var t=(0,_["default"])(e,1),n=t[0];return!n}).map(function(e){var t=(0,_["default"])(e,2),n=t[1];return n})},S=function(e,t){return C(e,t).filter(function(n){return e[n]&&!t[n]})},T=function(e,t){return C(e,t).filter(function(n){return!e[n]&&t[n]})},k=function(e){function t(){var e,n,r,i;(0,d["default"])(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=r=(0,m["default"])(this,(e=(0,l["default"])(t)).call.apply(e,[this].concat(o))),r.containerHeight=0,r.childAnimations=[],r.state={children:r.props.children},r.pendingRemoval=[],i=n,(0,m["default"])(r,i)}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"getHeightChange",value:function(e,t){var n=this;return e.reduce(function(e,r){if(r<t)return e;var i=n.refs["animation-child-"+r];return i?e+b.findDOMNode(i).clientHeight:e},0)}},{key:"animateElement",value:function(e,t,n,r){var i=this;this.childAnimations[e]||(this.childAnimations[e]=s["default"].resolve()),this.childAnimations[e].cancel();var a=n>0?[0,n]:[-n,0];return this.childAnimations[e]=this.childAnimations[e].then(function(){return w(t,{translateY:a},M)}).then(function(){return i.childAnimations[e]=s["default"].resolve()}).cancellable()["catch"](s["default"].CancellationError,function(){w(t,"finish",!0),t.style.transform=""}).then(function(){n>=0||(r.indexOf(e)===-1?t.style.transform="":t.style.opacity="0")}),this.childAnimations[e]}},{key:"transitionAffected",value:function(e,t){if(!e)return s["default"].resolve();for(var n=[],r=e.slice(-1),i=(0,_["default"])(r,1),a=i[0],o=0;o<=a;++o){var c=this.refs["animation-child-"+o];c&&n.push(this.animateElement(o,b.findDOMNode(c),(t?1:-1)*this.getHeightChange(e,o),e))}return s["default"].all(n)}},{key:"notifyHeightChange",value:function(e,t){e.length&&this.props.onHeightChange&&this.props.onHeightChange((t?1:-1)*this.getHeightChange(e,0))}},{key:"componentWillReceiveProps",value:function(e){var t,n=this,r=e.children,i=S(this.state.children,r);if(!i.length)return this.setState({children:r});var o=i.filter(function(e){return n.pendingRemoval.indexOf(e)===-1});o.length&&((t=this.pendingRemoval).push.apply(t,(0,a["default"])(o)),this.notifyHeightChange(i,!1),this.transitionAffected(i,!1).then(function(){n.pendingRemoval=n.pendingRemoval.filter(function(e){return o.indexOf(e)===-1}),n.setState({children:r})}))}},{key:"componentDidUpdate",value:function(e,t){var n=t.children,r=T(n,this.state.children);r.length&&(this.notifyHeightChange(r,!0),this.transitionAffected(r,!0))}},{key:"componentDidMount",value:function(){var e=this,t=this.state.children.reduce(function(t,n,r){var i=e.refs["animation-child-"+r];if(!i)return t;var a=b.findDOMNode(i);return a.style.transform="translateY(0)",t+a.clientHeight},0);this.props.onHeightChange(t,!0)}},{key:"render",value:function(){var e=this.state.children,t=E.Children.map(e,function(e,t){return e?E.cloneElement(e,{ref:"animation-child-"+t}):e});return E.createElement("div",null,t)}}]),t}(E.Component);e.exports=k},function(e,t,n){"use strict";var r=n(6),i=n(1231),a=n(1230),o=n(1238),s=r.createClass({displayName:"ArchiveMenuItem",mixins:[a],propTypes:{chat:r.PropTypes.instanceOf(i).isRequired,onArchive:r.PropTypes.func.isRequired},getInitialState:function(){return{archive:this.async("chat.archive")}},render:function(){var e=this.props.onArchive.bind(null,!this.state.archive);return r.createElement(o,{a8n:"mi-archive",action:e,shortcut:"a",key:"ArchiveMenuItem"},this.state.archive?l10n.t("unarchive_chat"):l10n.t("archive_chat"))}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(10),g=n(1255),v=n(38),y=(n(1231),n(1229),n(8)),_=n(1301),E=n(144),b=n(1239),w=(n(1248),function(e){function t(){(0,s["default"])(this,t);var e=(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments));return e.onScroll=function(t){e.handleScroll(t.target)},e.handleScroll=v.throttle(function(t){var n=e.props.chat.docMsgs;n.hasDocBefore&&t.scrollTop+m.SCROLL_FUDGE>t.scrollHeight-t.clientHeight&&e.queryDocs(n.head())},100),e.onClickMsg=function(t,n){e.props.selectable&&void 0!==n?e.props.onMessageSelect(t,n):y.openChatAt(t.chat,t.chat.getSearchContext(t))},e}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillMount",value:function(){this.props.chat.docMsgs.hasDocBefore&&this.queryDocs()}},{key:"componentDidMount",value:function(){this.props.addListener(this.props.chat.docMsgs,"add remove reset"),this.props.addListener(this.props.chat.docMsgs,"query_doc_before")}},{key:"queryDocs",value:function(e){var t=this,n=this.props.chat.docMsgs;n.hasDocBefore&&this.props.uiIdle(function(){n.queryDocs(t.props.chat,e)})}},{key:"render",value:function(){var e=this,t=this.props.chat.docMsgs,n=this.props.selectedMessages,r=t.map(function(t){return f.createElement(_,{key:t.id,ref:t.id.toString(),msg:t,multiMedia:!0,selectable:e.props.selectable,selectedMessages:n,onMessageSelect:e.props.onMessageSelect,onClickMsg:e.onClickMsg})});if(r.reverse(),t.queryDocBefore){if(0===r.length)return f.createElement(b.Loading,null);r.push(f.createElement("div",{className:"more",key:"spinner"},f.createElement(E,{stroke:6,size:24})))}return 0!==t.length||t.queryDocBefore||t.hasDocBefore?f.createElement("div",{onScroll:this.onScroll,className:"doc-gallery"},r):f.createElement(b.DocMsgs,null)}}]),t}(f.Component));e.exports=g(w)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(438),s=r(o),c=n(6),l=n(144),u=n(44),d=function(e){var t=e.className,n=e.children,r=(0,s["default"])(e,["className","children"]),i=u("doc-state",t);return c.createElement("div",(0,a["default"])({className:i},r),n)},p=function(e){var t=e.onClick;return c.createElement(d,{onClick:t||_.noop},c.createElement("span",{className:"icon doc-state-icon icon-audio-download"}))},h=function(){return c.createElement(d,null,c.createElement(l,{stroke:3,size:32}))},f=function(){return c.createElement(d,null,c.createElement("span",{className:"icon doc-state-icon icon-audio-cancel-noborder"},c.createElement(l,{stroke:3,size:32})))},m=function(){return c.createElement(d,null,c.createElement("span",{className:"icon doc-state-icon icon-audio-upload"}))};e.exports={Download:p,Pending:h,PendingCancel:f,Upload:m}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(6),s=n(37),c=n(142),l=n(221),u=o.createClass({displayName:"Draggable",mixins:[c],propTypes:{children:o.PropTypes.node.isRequired,start:o.PropTypes.shape({x:o.PropTypes.number,y:o.PropTypes.number}),scale:o.PropTypes.number,container:o.PropTypes.shape({width:o.PropTypes.number.isRequired,height:o.PropTypes.number.isRequired}),onStart:o.PropTypes.func,onDrag:o.PropTypes.func,onStop:o.PropTypes.func},getInitialState:function(){return{dragging:!1,x:0,y:0,offsetX:0,offsetY:0}},componentDidMount:function(){this.updateContainer()},componentWillReceiveProps:function(e){e.scale!==this.props.scale||e.container.width!==this.props.container.width||e.container.height!==this.props.container.height?this.updateContainer(e,!0):this.updateContainer(e)},updateContainer:function(e,t){e=e||this.props;var n=e.container;if(n&&this.refs.draggable){var r,i=s.findDOMNode(this.refs.draggable),a=this.state.x,o=this.state.y,c=i.width*e.scale,l=i.height*e.scale;this.props.scale!==e.scale&&this.state.center?(r=this.state.center,a=n.width/2-r.x*c,o=n.height/2-r.y*l):r={x:(n.width/2-a)/c,y:(n.height/2-o)/l},a>0?a=0:a+c<n.width&&(a=n.width-c),o>0?o=0:o+l<n.height&&(o=n.height-l),this.setState({width:c,height:l,x:a,y:o,center:r}),this.props.onStop&&t&&e.onStop(a,o)}},handleMouseDown:function(e){e.preventDefault(),this.setState({dragging:!0,offsetX:e.clientX-this.state.x,offsetY:e.clientY-this.state.y}),this.regNativeListener(window,"mousemove",this.handleMouseMove),this.regNativeListener(window,"mouseup",this.handleMouseUp),this.props.onStart&&this.props.onStart()},handleMouseUp:function(e){this.unregisterListeners(),this.setState({dragging:!1}),this.props.onStop&&this.props.onStop(this.state.x,this.state.y)},handleMouseMove:function(e){if(this.state.dragging){var t=e.clientX-this.state.offsetX,n=e.clientY-this.state.offsetY,r=this.props.container;r&&((t>0||t+this.state.width<r.width)&&(t=this.state.x),(n>0||n+this.state.height<r.height)&&(n=this.state.y)),this.setState({x:t,y:n}),this.props.onDrag&&this.props.onDrag(t,n)}},render:function(){var e=this.props.scale?" scale("+this.props.scale+")":"",t=(0,a["default"])({},l.prefix("transform"),"translate("+this.state.x+"px, "+this.state.y+"px)"+e);this.state.dragging||(t[l.prefix("transition")]="transform 200ms");var n="draggable";return this.state.dragging&&(n+=" dragging"),o.cloneElement(o.Children.only(this.props.children),{style:t,draggable:!0,ref:"draggable",className:n,onMouseDown:this.handleMouseDown})}});e.exports=u},function(e,t,n){"use strict";var r=n(6),i=n(10),a=i.ONE_BY_ONE_TRANS_GIF,o=n(436),s=o.emojiMap,c=n(44);e.exports=function(e){var t=e.emoji,n=e.size,i=void 0===n?"small":n,o=e.className,l=s[t];if(!l)return null;var u="small"===i?"emoji":"emojik";return r.createElement("img",{alt:t,draggable:!1,src:a,className:c(u,"emoji"+l,o)})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(438),a=r(i),o=n(6),s=o.createClass({displayName:"IsolatedBlock",propTypes:{Component:o.PropTypes.string.isRequired},getDefaultProps:function(){return{Component:"span"}},render:function(){var e=this.props,t=e.Component,n=e.children,r=(0,a["default"])(e,["Component","children"]);return o.createElement(t,r,"​⁠​",n,"​⁠​")}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(10),g=n(1255),v=n(38),y=(n(1231),n(1229),n(8)),_=n(1301),E=n(144),b=n(1239),w=(n(1248),function(e){function t(){(0,s["default"])(this,t);var e=(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments));return e.onScroll=function(t){e.handleScroll(t.target)},e.handleScroll=v.throttle(function(t){var n=e.props.chat.linkMsgs;n.hasLinkBefore&&t.scrollTop+m.SCROLL_FUDGE>t.scrollHeight-t.clientHeight&&e.queryLinks(n.head())},100),e.onClickMsg=function(t,n){e.props.selectable&&void 0!==n?e.props.onMessageSelect(t,n):y.openChatAt(t.chat,t.chat.getSearchContext(t))},e}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillMount",value:function(){this.props.chat.linkMsgs.hasLinkBefore&&this.queryLinks()}},{key:"componentDidMount",value:function(){this.props.addListener(this.props.chat.linkMsgs,"add remove reset"),this.props.addListener(this.props.chat.linkMsgs,"query_link_before")}},{key:"queryLinks",value:function(e){var t=this,n=this.props.chat.linkMsgs;n.hasLinkBefore&&this.props.uiIdle(function(){n.queryLinks(t.props.chat,e)})}},{key:"render",value:function(){var e=this,t=this.props.chat.linkMsgs,n=this.props.selectedMessages,r=t.map(function(t){return f.createElement(_,{key:t.id,ref:t.id.toString(),msg:t,multiMedia:!0,selectable:e.props.selectable,selectedMessages:n,onMessageSelect:e.props.onMessageSelect,onClickMsg:e.onClickMsg})});if(r.reverse(),t.queryLinkBefore){if(0===r.length)return f.createElement(b.Loading,null);r.push(f.createElement("div",{className:"more",key:"spinner"},f.createElement(E,{stroke:6,size:24})))}return 0!==t.length||t.queryLinkBefore||t.hasLinkBefore?f.createElement("div",{onScroll:this.onScroll,className:"link-gallery"},r):f.createElement(b.LinkMsgs,null)}}]),t}(f.Component));e.exports=g(w)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(36),s=r(o),c=n(23),l=r(c),u=n(26),d=r(u),p=n(82),h=r(p),f=n(81),m=r(f),g=n(6),v=n(221),y=n(44),_=function(e){function t(e){(0,l["default"])(this,t);var n=(0,h["default"])(this,(0,s["default"])(t).call(this,e));return n.state={rendered:!1},n}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.setState({rendered:!0})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.rowNumber,r=e.rowHeight,i=e.zIndex,o=e.className,s=(0,a["default"])({zIndex:i,height:r},v.prefix("transform"),"translate3d(0, "+r*n+"px, 0)");return o=y(o,{"infinite-list-item":!0,"infinite-list-item-keyframe":!this.state.rendered,"infinite-list-item-transition":!0}),g.createElement("div",{className:o,style:s},t)}}]),t}(g.Component);e.exports=_},function(e,t,n){"use strict";var r=n(6),i=n(1231),a=n(1230),o=n(1238),s=r.createClass({displayName:"MarkUnreadMenuItem",mixins:[a],propTypes:{chat:r.PropTypes.instanceOf(i).isRequired,onMarkUnread:r.PropTypes.func.isRequired},getInitialState:function(){return{unreadCount:this.async("chat.unreadCount")}},render:function(){var e=this.props.onMarkUnread.bind(null,!this.state.unreadCount);return r.createElement(o,{a8n:"mi-mark-as",action:e,shortcut:"r",key:"MarkUnreadMenuItem"},this.state.unreadCount?l10n.t("mark_read_chat"):l10n.t("mark_unread_chat"))}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return function(n){e.some(function(e){var r=(0,o["default"])(e,2),i=r[0],a=r[1],s=a.call(i,n,t);return!!n.defaultPrevented||s===!0&&(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),!0)})}}var a=n(146),o=r(a),s=n(45),c=r(s);e.exports=function(e,t){var n=e.reduce(function(e,t){var n=t.handlers;return n?((0,c["default"])(n).forEach(function(r){e[r]||(e[r]=[]),e[r].push([t,n[r]])}),e):e},{});return(0,c["default"])(n).reduce(function(e,r){return e[r]=i(n[r],t),e},{})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];e.forEach(function(e){var n=(0,o["default"])(e,2),i=n[0],a=n[1];return a.call.apply(a,[i].concat(r,[t]))})}}var a=n(146),o=r(a),s=n(45),c=r(s);e.exports=function(e,t){var n=e.reduce(function(e,t){var n=t.hooks;return n?((0,c["default"])(n).forEach(function(r){e[r]||(e[r]=[]),e[r].push([t,n[r]])}),e):e},{});return(0,c["default"])(n).reduce(function(e,r){return e[r]=i(n[r],t),e},{})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return function(n){e.some(function(e){var r=(0,o["default"])(e,2),i=r[0],a=r[1],s=a.call(i,n,t);return!!n.defaultPrevented||s===!0&&(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),!0)})}}var a=n(146),o=r(a),s=n(45),c=r(s);e.exports=function(e,t){var n=e.reduce(function(e,t){var n=t.hotkeys;return n?((0,c["default"])(n).forEach(function(r){e[r]||(e[r]=[]),e[r].push([t,n[r]])}),e):e},{});return(0,c["default"])(n).reduce(function(e,r){return e[r]=i(n[r],t),e},{})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return e.msMatchesSelector?e.msMatchesSelector(t):e.webkitMatchesSelector?e.webkitMatchesSelector(t):e.matches(t)}function a(e,t){for(var n=0;n<t.length;++n){var r=t[n].serializers;if(r)for(var a=0;a<r.length;++a){var o=(0,c["default"])(r[a],2),s=o[0],l=o[1];if(i(e,s))return l}}return null}function o(e,t){for(var n=[],r=e.cloneNode(!0),i=r.firstChild;i;){switch(i.nodeType){case 1:var o=a(i,t);if(o){n.push(o(i));break}switch(i.tagName){case"P":case"BR":case"PRE":case"DIV":n.push("\n")}case 3:n.push(i.nodeValue)}if(i.hasChildNodes())i=i.firstChild;else{for(;i&&!i.nextSibling;)if(i=i.parentNode,i===e){i=null;break}i&&(i=i.nextSibling)}}return n.join("")}var s=n(146),c=r(s);e.exports=o},function(e,t,n){"use strict";function r(e,t){return t.reduce(function(e,t){var n=t.parsers;return n?n.reduce(function(e,t){return t(e)},e):e},i.escape(e))}var i=n(38);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(36),s=r(o),c=n(23),l=r(c),u=n(26),d=r(u),p=n(82),h=r(p),f=n(81),m=r(f),g=n(6),v=function(e,t){var n,r;return r=n=function(n){function r(){return(0,l["default"])(this,r),(0,h["default"])(this,(0,s["default"])(r).apply(this,arguments))}return(0,m["default"])(r,n),(0,d["default"])(r,[{key:"render",value:function(){return g.createElement(e,(0,a["default"])({},this.props,t))}}]),r}(g.Component),n.displayName="Wrapper("+(e.displayName||e.name)+")",r};e.exports=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(82),l=r(c),u=n(81),d=r(u),p=n(1402),h=r(p),f=n(1407),m=r(f),g=n(1401),v=r(g),y=n(1410),_=r(y),E=n(1409),b=r(E),w=n(1399),M=r(w),C=function(e){function t(){return(0,s["default"])(this,t),(0,l["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,d["default"])(t,e),t}((0,v["default"])([h["default"],m["default"],_["default"]]));C.Suggestions=(0,M["default"])(b["default"],{plugin:m["default"]}),e.exports=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return{handlers:a(e,j)}}function a(e,t){return t.reduce(function(t,n){return Array.isArray(n)?t[n[0]]=e[n[1]]:t[n]=e[n],t},{})}function o(e){return e.which===L&&(e.getModifierState("Shift")||e.getModifierState("Alt")||e.getModifierState("Control"))}function s(e,t,n){var r={};return n.forEach(function(n){return r[n]=e[n]!==t[n]}),r}var c=n(441),l=r(c),u=n(434),d=r(u),p=n(36),h=r(p),f=n(23),m=r(f),g=n(26),v=r(g),y=n(82),_=r(y),E=n(81),b=r(E),w=n(105),M=r(w),C=n(1296),S=n(1139),T=n(84),k=n(1322),x=n(6),N=n(1394),P=n(1395),O=n(1396),D=n(44),A=n(1397),I=n(1321),R=n(1398),L=13,U=function(e){function t(){var e,n,r,i;(0,m["default"])(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=r=(0,_["default"])(this,(e=(0,h["default"])(t)).call.apply(e,[this].concat(o))),F.call(r),i=n,(0,_["default"])(r,i)}return(0,b["default"])(t,e),(0,v["default"])(t,[{key:"replaceSelection",value:function(e){if(!this.props.readOnly){var t=this.refs.input;this._hasFocus(t)||(T.focus(t),this.selection&&this.restoreSelection(this.selection));var n=this.trimToFit(e);if(n.length){this.props.multiline||(n=n.replace(/\r?\n/g,"")),window.getSelection().getRangeAt(0).deleteContents();var r=t.scrollTop,i=t.scrollHeight;document.execCommand("insertHTML",!1,R(n,this.plugins)),this.onSelect();var a=t.scrollHeight,o=t.clientHeight;a<=o||(t.scrollTop=(r||0)+(a-i))}}}},{key:"restoreSelection",value:function(e){var t=this.refs.input;if(t){var n=e.anchorIndex,r=e.anchorOffset,i=e.focusIndex,a=e.focusOffset,o=t.childNodes,s=n===-1?t:o[n],c=i===-1?t:o[i];if(s&&c)try{var l=document.createRange();l.setStart(s,r),l.setEnd(c,a);var u=window.getSelection();u.removeAllRanges(),u.addRange(l)}catch(d){this.focus(!0)}}}},{key:"getSelection",value:function(){var e=this.refs.input;if(!e||document.activeElement!==e)return null;for(var t=window.getSelection(),n=t.anchorNode,r=t.anchorOffset,i=t.focusNode,a=t.focusOffset,o=e.childNodes,s=-1,c=-1,l=0,u=void 0;(s<0||c<0)&&(u=o[l++]);)n===u&&(s=l-1),i===u&&(c=l-1);return{anchorIndex:s,anchorOffset:r,focusIndex:c,focusOffset:a}}},{key:"trimToFit",value:function(e){var t=this.props.maxLength;if(!t)return e;var n=this.selectionLength,r=this.length,i=t+n-r;if(i<=0)return"";var a=I(String(e));return a.slice(0,i).join("")}},{key:"render",value:function(){var e=this.props.placeholder,t=this.state.value,n=t.length?"hidden":"visible",r=R(t,this.plugins);return x.createElement(M["default"],{className:"input-emoji",handlers:this.hotKeyMap},x.createElement("div",{className:"input-placeholder",ref:"placeholder",style:{visibility:n}},e),x.createElement("div",(0,d["default"])({},this.handlerMap,{className:D(this.props.className),contentEditable:!this.props.readOnly,dangerouslySetInnerHTML:{__html:r},"data-tab":this.props.readOnly?null:1,dir:"auto",ref:"input",spellCheck:this.props.spellCheck})))}},{key:"value",get:function(){return this.state.value}},{key:"selectionLength",get:function(){if(this.props.readOnly)return 0;var e=this.refs.input;this._hasFocus(e)||T.focus(e);var t=window.getSelection();return t.rangeCount?I(A(t.getRangeAt(0).cloneContents(),this.plugins)).length:0}},{key:"length",get:function(){return I(this.state.value).length}},{key:"isComposing",get:function(){return this.__isComposing}}]),t}(x.Component),F=function(){var e=this;this.__changeDueToReset=!1,this.__isMounted=!0,this.__isComposing=!1,this.selection=this.props.initialSelection,this.state={value:this.props.initialValue||""},this.trigger=function(t){var n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],r=e.hookMap[t];r&&r.apply(void 0,(0,l["default"])(n))},this.serializeNode=function(t){return A(t,e.plugins)},this._hasFocus=function(){var t=arguments.length<=0||void 0===arguments[0]?e.refs.input:arguments[0];if(!t)return!1;var n=document,r=n.activeElement;return!!r&&(r===t||t.contains(r))},this.focus=function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];return setTimeout(function(){if(!e.props.readOnly&&e.__isMounted){var n=e.refs.input;if(n){var r=e._hasFocus(n);if(!r||t)if(r||T.focus(n),!t&&e.selection)e.restoreSelection(e.selection);else{var i=window.getSelection();i&&i.rangeCount&&(i.selectAllChildren(n),i.collapseToEnd())}}}},0)},this.reset=function(){e.__changeDueToReset=!0,e.selection=null,e.setState({value:""})},this.onSelect=function(){e.selection=e.getSelection(),e.props.onSelect&&e.props.onSelect(e.selection)},this.shouldComponentUpdate=function(t,n){var r=n.value,i=!r.length&&!!e.state.value.length,a=!!r.length&&!e.state.value.length;if(!a&&!i)return!1;var o=a?"hidden":"visible";return e.refs.placeholder&&e.refs.placeholder.setAttribute("style","visibility: "+o),i&&(e.refs.input.innerHTML=""),e.__changeDueToReset&&(e.__changeDueToReset=!1,e.refs.input&&(e.refs.input.innerHTML=R(r,e.plugins))),!1},this.componentWillReceiveProps=function(t){var n=s(e.props,t,["readOnly"]);n.readOnly&&e.refs.input.setAttribute("contentEditable",String(!t.readOnly))},this.componentWillUnmount=function(){return(e.__isMounted=!1)||void 0},this.onInput=function(t){var n=A(e.refs.input,e.plugins),r="\n"===n?"":n,i=e.props.maxLength;if(i>0&&I(r).length>i){var a=e.selection;return e.refs.input.innerHTML=R(e.state.value,e.plugins),void(a&&e.restoreSelection(a))}e.setState({value:r},function(){e.trigger(k.CHANGE,[r]),e.props.onChange&&e.props.onChange(r)})},this.onPaste=function(t){t.preventDefault();var n=new S(t.clipboardData);if(n.hasFiles())return e.props.onFiles&&e.props.onFiles(n);var r=n.getText();if(!r)return!0;if(I(r).length>e.props.maxLength){var i=e.props.onMaxPasteExceeded;return i&&i()}e.replaceSelection(r)},this.onBeforeInput=function(t){if(e.props.readOnly)return!0;var n=e.props.maxLength;if(!n)return!1;var r=t.data.charCodeAt(0);if(8===r||127===r)return!1;var i=e.selectionLength,a=e.length,o=n+i-a;return I(t.data).length>o},this.onKeyDown=function(t){return!(!e.props.onKeyDown||!e.props.onKeyDown(t))||t.which===L&&((!e.props.multiline||!o(t))&&(e.props.onEnter&&e.props.onEnter(t),!0))},this.componentDidMount=function(){e.refs.input.restoreFocus=e.focus,e.trigger(k.MOUNT)},this.onBlur=function(t){return e.props.onBlur&&e.props.onBlur(t)},this.onFocus=function(t){e.props.onFocus&&e.props.onFocus(t)},this.onCompositionStart=function(t){return!(e.__isComposing=!0)},this.onCompositionEnd=function(){return e.__isComposing=!1}};e.exports=function(e){var t=function(t){function n(){var t,r,a,o;(0,m["default"])(this,n);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return r=a=(0,_["default"])(this,(t=(0,h["default"])(n)).call.apply(t,[this].concat(c))),a.plugins=[].concat((0,l["default"])(e.map(function(e){return e instanceof C&&e.initialize(a),e})),[i(a)]),a.handlerMap=N(a.plugins,a),a.hookMap=P(a.plugins,a),a.hotKeyMap=O(a.plugins,a),o=r,(0,_["default"])(a,o)}return(0,b["default"])(n,t),n}(U);return t};var j=["onBeforeInput","onBlur","onCompositionEnd","onCompositionStart","onFocus","onInput","onKeyDown","onPaste","onSelect"]},function(e,t,n){"use strict";var r=n(44),i=n(436),a=i.emojiRegex,o=i.emojiMap,s=n(10),c=s.ONE_BY_ONE_TRANS_GIF,l=a(),u={serializers:[["img.emoji",function(e){return e.getAttribute("alt")}]],parsers:[function(e){return e.replace("️","")},function(e){return e.replace(l,function(e,t){var n=o[t];if(!n)return"";var i=document.createElement("img");return i.setAttribute("alt",t),i.setAttribute("draggable","false"),i.setAttribute("class",r("emoji","emoji"+n)),i.setAttribute("src",c),i.outerHTML})}],handlers:{onBeforeInput:function(e,t){var n=e.data,r=l.exec(n);return!!r&&(t.replaceSelection(r[0]),!0)}}};e.exports=u},function(e,t,n){"use strict";var r=n(1279),i=n(1280),a=n(1272),o=i.Direction;e.exports=function(e,t){if(!a(e))return!1;var n=i(t,o.BACKWARD);if(!n||!n.getAttribute("data-mention-jid"))return!1;var s=r(t,n),c=window.getSelection();c.removeAllRanges();var l=document.createRange();return l.setStart(t,s),l.setEnd(t,s),c.addRange(l),!0}},function(e,t,n){"use strict";var r=n(1279),i=n(1280),a=n(1272),o=i.Direction;e.exports=function(e,t){if(!a(e))return!1;var n=i(t,o.FORWARD);if(!n||!n.getAttribute("data-mention-jid"))return!1;var s=r(t,n),c=window.getSelection();c.removeAllRanges();var l=document.createRange();return l.setStart(t,s+1),l.setEnd(t,s+1),c.addRange(l),!0}},function(e,t,n){"use strict";var r=n(1279),i=n(1280),a=n(1272),o=i.Direction,s=n(86),c=s.isGecko;e.exports=function(e,t){if(!c||!a(e))return!1;var n=i(t,o.BACKWARD);if(!n||!n.getAttribute("data-mention-jid"))return!1;var s=r(t,n),l=window.getSelection();l.removeAllRanges();var u=document.createRange();return u.setStart(t,s),u.setEnd(t,s+1),l.addRange(u),!0}},function(e,t,n){"use strict";var r=n(1279),i=n(1280),a=n(1272),o=i.Direction;e.exports=function(e,t){if(!a(e))return!1;var n=i(t,o.FORWARD);if(!n||!n.getAttribute("data-mention-jid"))return!1;var s=r(t,n),c=window.getSelection();c.removeAllRanges();var l=document.createRange();return l.setStart(t,s),l.setEnd(t,s+1),c.addRange(l),!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e.hasChildNodes())for(;e.childNodes.length;)e.removeChild(e.childNodes[0])}function a(e,t){if(!e.rangeCount)return null;var n=e.getRangeAt(0);if(!n.collapsed)return null;for(var r=0;r<5;++r)e.modify("extend","backward","word");var i=e.getRangeAt(0).cloneContents(),a=t.serializeNode(i),c=O(U,a).pop();if(!c)return o(e,n);o(e,n);for(var l=c[0].length;l--;)e.modify("extend","backward","character");var u=C.findDOMNode(t.refs.input),d=u.querySelectorAll("span[data-mention-jid]");return s(e,d)?o(e,n):{original:n,range:e.getRangeAt(0),match:c}}function o(e,t){e.removeAllRanges(),e.addRange(t)}
function s(e,t){var n=t.length;if(!n)return 0;for(var r=0,i=0;i<n;++i)e.containsNode(t[i],!0)&&++r;return r}var c=n(1136),l=r(c),u=n(36),d=r(u),p=n(23),h=r(p),f=n(26),m=r(f),g=n(82),v=r(g),y=n(81),_=r(y),E=n(1296),b=n(1323),w=n(104),M=n(1322),C=n(37),S=n(1287),T=S.dir,k=n(86),x=k.isGecko,N=k.isTrident,P=n(1257),O=P.matchAll,D=n(1405),A=n(1406),I=n(1404),R=n(1403),L=/\u200B((\d+)@c\.us)\u200B/g,U=/(?:\B|^)@((?:[^\s@]+ ?){1,3}(?:[^\s@]+)?)?$/g,F={Enter:b.ENTER,Tab:b.TAB,ArrowUp:b.UP,ArrowDown:b.DOWN},j=function(e){function t(){var e,n,r,s,c;(0,h["default"])(this,t);for(var u=arguments.length,p=Array(u),f=0;f<u;f++)p[f]=arguments[f];return r=s=(0,v["default"])(this,(e=(0,d["default"])(t)).call.apply(e,[this].concat(p))),s.serializers=[["span[data-mention-jid]",function(e){return i(e),"​"+e.getAttribute("data-mention-jid")+"​"}]],s.parsers=[function(e){return e.replace(L,function(e,t,n){var r=window.Store.Contact.get(t);if(!r)return t;var i=!r.isMyContact&&r.notifyName?r.notifyName:r.formattedName,a=document.createElement("span");a.setAttribute("data-mention-jid",r.id);var o=document.createElement("span");o.setAttribute("class","at-symbol"),o.appendChild(document.createTextNode("@"));var s=document.createElement("span");return s.setAttribute("dir",T(i)||"auto"),s.appendChild(document.createTextNode(i)),a.appendChild(o),a.appendChild(s),a.outerHTML})}],s.hooks=(n={},(0,l["default"])(n,M.CHANGE,function(e,t){var n=t.refs.input;if(x)for(var r=n.querySelectorAll("[data-mention-jid]"),i=0;i<r.length;++i){var a=r[i].nextSibling;a&&a instanceof Element&&"BR"===a.tagName&&"_moz"===a.getAttribute("type")&&a.remove()}}),(0,l["default"])(n,M.MOUNT,function(e){for(var t=e.refs.input,n=t.querySelectorAll("[data-mention-jid]"),r=0;r<n.length;++r)n[r].setAttribute("contenteditable","false")}),n),s.handlers={onKeyDown:function(e,t){if(!this.ctx.isComposing){var n=t.refs.input,r=e.key;if("Backspace"===r&&D(e,n)||"Delete"===r&&A(e,n))return!1;if("ArrowRight"===r&&I(e,n)||"ArrowLeft"===r&&R(e,n))return!0}var i=F[e.key];return!!i&&this.handle(i,[e,t])},onBlur:function(){return this.handle(b.INACTIVE),!1},onSelect:function(e,t){var n=w.supportsFeature(w.F.MENTIONS_OUT);if(N||this.ctx.isComposing||!n)return!1;if(t.value.indexOf("@")<0)return this.handle(b.INACTIVE);var r=window.getSelection(),i=a(r,t);if(!i)return this.handle(b.INACTIVE);var s=i.original,c=i.match;return this.handle(b.SEARCH,[c[1]||""]),o(r,s),!1}},c=r,(0,v["default"])(s,c)}return(0,_["default"])(t,e),(0,m["default"])(t,[{key:"handleSelect",value:function(e,t){if(a(window.getSelection(),this.ctx)){this.ctx.replaceSelection("​"+e.id+"​ "),this.handle(b.INACTIVE);for(var n=this.ctx.refs.input,r=n.querySelectorAll("[data-mention-jid]"),i=0;i<r.length;++i)r[i].setAttribute("contenteditable","false")}}}]),t}(E);e.exports=new j},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1237),m=n(1232),g=n(6),v=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.className!==e.className||this.props.contact!==e.contact||this.props.term!==e.term}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.contact,r=n.id,i=n.formattedName,a=n.isMyContact,o=n.notifyName,s=e.onMouseDown,c=e.onMouseOver,l=e.onMouseUp,u=e.term;return g.createElement("div",{className:t,onMouseDown:s,onMouseUp:l,onMouseOver:c},g.createElement(f,{id:r,size:32,className:"mentions-result-image"}),g.createElement("div",{className:"mentions-result-text-contact",dir:"auto"},g.createElement(m,{text:i,highlight:u?[u]:null,highlightBounary:!0})),g.createElement("div",{className:"mentions-result-text-pushname",dir:"auto"},!a&&o?g.createElement(m,{text:o,highlight:u?[u]:null,highlightBounary:!0,className:"emoji-text"}):null))}}]),t}(g.Component);e.exports=v},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return function(n,r){return!(!t.state.active||!t.state.results.length)&&(e.call(t,n,r),!0)}}function a(e,t){if(t.isMe)return!1;var n=[t.searchName||t.formattedName];return!t.isMyContact&&t.notifyName&&n.push(t.notifyName.toLowerCase()),n.some(function(t){return o(e,t)})}function o(e,t){var n=-1;do if(t.indexOf(e,n+1)===n+1)return!0;while((n=t.indexOf(" ",n+1))!==-1);return!1}var s=n(36),c=r(s),l=n(23),u=r(l),d=n(26),p=r(d),h=n(82),f=r(h),m=n(81),g=r(m),v=n(1240),y=r(v),_=n(1323),E=n(6),b=n(37),w=n(1408),M=n(218),C=n(106),S=n(44),T={active:!1,offset:0,omitted:"",query:"",results:[],scrollTop:0},k=52,x=function(e){function t(){var e,n,r,a;(0,u["default"])(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=r=(0,f["default"])(this,(e=(0,c["default"])(t)).call.apply(e,[this].concat(s))),r.state=T,r.onEnter=i(function(){return r.handleSelect(r.state.offset)},r),r.onInactive=i(function(){return r.setState(T)},r),r.onSearch=function(e){var t=r,n=t.state.omitted;n&&e.startsWith(n)||r.setState({active:!0,offset:0,omitted:null,query:e,results:r.getResults(e)})},r.onEscape=function(){r.setState({active:!1,offset:0,omitted:r.state.query,query:"",results:[]})},r.onUp=i(function(){var e=Math.max(r.state.offset-1,0);r.setOffset(e)},r),r.onDown=i(function(){var e=r.state.results.length-1,t=Math.min(r.state.offset+1,e);r.setOffset(t)},r),a=n,(0,f["default"])(r,a)}return(0,g["default"])(t,e),(0,p["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.plugin;e.registerHandler(_.ENTER,this.onEnter),e.registerHandler(_.TAB,this.onEnter),e.registerHandler(_.SEARCH,this.onSearch),e.registerHandler(_.INACTIVE,this.onInactive),e.registerHandler(_.UP,this.onUp),e.registerHandler(_.DOWN,this.onDown)}},{key:"componentWillUnmount",value:function(){var e=this.props.plugin;e.unregisterHandler(_.ENTER),e.unregisterHandler(_.TAB),e.unregisterHandler(_.SEARCH),e.unregisterHandler(_.INACTIVE),e.unregisterHandler(_.UP),e.unregisterHandler(_.DOWN)}},{key:"handleSelect",value:function(e){var t=this.state.results[e];if(t&&t.id){var n=this.props.chat.assignedColor(t.id);this.props.plugin.handleSelect(t,n)}}},{key:"getResults",value:function(e){var t=this.props.chat.groupMetadata.participants,n=t.models.map(function(e){var t=e.contact;return t}),r=(e||"").toLowerCase(),i=n.filter(function(e){return a(r,e)});return i}},{key:"setOffset",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=e*k,r=n+k,i=b.findDOMNode(this.refs.overflow),a=i.scrollTop,o=a+i.clientHeight,s={offset:e,scrollTop:a};t||(a>n?s.scrollTop=n:o<r&&(s.scrollTop+=r-o)),this.setState(s)}},{key:"renderList",value:function(e,t,n){var r=this;if(!e||!t.length)return null;var i=t.map(function(e,t){return E.createElement(w,{key:e.id,contact:e,term:n,ref:"mention-result-"+t,className:S("mentions-result",{selected:t===r.state.offset}),onMouseDown:function(e){return e.preventDefault()},onMouseUp:function(){return r.handleSelect(t)},onMouseOver:function(){return r.setOffset(t,!0)}})});return E.createElement(M,{displayName:"MentionSuggestions",escapable:!0,requestDismiss:this.onEscape},E.createElement("div",{className:"mentions-overlay-container"},E.createElement("div",{className:"mentions-results-container","data-list-scroll-container":"true",ref:"overflow"},E.createElement(y["default"],{data:i,height:k,scrollTop:this.state.scrollTop,animate:!1}))))}},{key:"render",value:function(){var e=this.state,t=e.query,n=e.results,r=e.active;return E.createElement(C,{component:"div",className:"mentions-positioning-container",transitionName:"slide-up"},this.renderList(r,n,t))}}]),t}(E.Component);e.exports=x},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(36),a=r(i),o=n(23),s=r(o),c=n(82),l=r(c),u=n(81),d=r(u),p=n(1296),h=r(p),f=n(8),m=r(f),g=n(1272),v=r(g),y=function(e){function t(){var e,n,r,i;(0,s["default"])(this,t);for(var o=arguments.length,c=Array(o),u=0;u<o;u++)c[u]=arguments[u];return n=r=(0,l["default"])(this,(e=(0,a["default"])(t)).call.apply(e,[this].concat(c))),r.handlers={onKeyDown:function(e){return!this.ctx.isComposing&&(!(" "!==e.key||!(0,v["default"])(e))&&(!this.ctx.value.length&&(m["default"].scrollMessages(),!0)))}},i=n,(0,l["default"])(r,i)}return(0,d["default"])(t,e),t}(h["default"]);t["default"]=new y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(14),c=n(8),l=n(1238),u=n(1464),d=n(1263),p=o.createClass({displayName:"TakePhotoMenuItem",propTypes:{onImageTake:o.PropTypes.func.isRequired},onCapture:function(){var e=this,t=new a["default"](function(n,r){navigator.getUserMedia({video:!0},function(r){c.closeModal(),n(r),t.isPending()||c.openModal(o.createElement(u,{stream:r,onSend:e.props.onImageTake}))},function(e){var n=_.isString(e)?e:e.name,i=s.GUM[n]||s.GUM.GUMError;r(new i),t&&!t.isPending()&&c.closeModal()})}).bind(this).timeout(1500,"waitForGUMTakePhotoTimeout").then(function(e){c.openModal(o.createElement(u,{stream:e,onSend:this.props.onImageTake}))})["catch"](a["default"].TimeoutError,function(e){c.openModal(o.createElement(d,{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_description",type:d.TYPE.GUIDE_ALLOW}))})["catch"](s.GUM.PermissionDeniedError,function(){c.openModal(o.createElement(d,{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_fail_description",type:d.TYPE.GUIDE_UNBLOCK}))})["catch"](s.GUM.GUMError,function(){c.openModal(o.createElement(d,{title:"guide_desktop_camera_missing_title",desc:"guide_desktop_camera_missing_description",type:d.TYPE.GUIDE_NONE}))})},render:function(){return o.createElement(l,{action:this.onCapture,a8n:"mi-take-photo"},l10n.t("take_photo"))}});e.exports=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(438),s=r(o),c=n(6),l=n(8),u=n(85),d=c.createClass({displayName:"UIETooltip",propTypes:{tooltip:c.PropTypes.object.isRequired},componentDidMount:function(){var e=this,t=this.props.tooltip,n=t.menu,r=(0,s["default"])(t,["menu"]);l.openTooltip(n,(0,a["default"])({},r),this.context.uim,function(t){return e.element=t})},componentWillUnmount:function(){l.closeTooltip(this.context.uim)},getElement:function(){return this.element},render:function(){return null}});d.contextTypes={uim:c.PropTypes.instanceOf(u)},e.exports=d},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(83),o=n(142),s=n(141),c=n(145),l=n(1442),u=n(1457),d=n(14),p=n(10),h=n(107),f=n(8),m=void 0,g=r.createClass({displayName:"Conversation",mixins:[a,o,s,c],getInitialState:function(){return{chat:void 0,msgCollection:void 0,focusCtx:void 0}},componentWillMount:function(){this.regCmd("open_chat",this.handleOpenChat),this.regCmd("clear_chat",this.handleClearChat),this.regNativeListener(window,"focus",this.windowGainedFocus),this.regNativeListener(window,"blur",this.windowLostFocus)},componentDidMount:function(){var e=this.safeDebounce(this.windowResized,100);this.regNativeListener(window,"resize",e),e()},windowResized:function(){m=i.findDOMNode(this).clientHeight},shouldComponentUpdate:function(e,t){return t!==this.state||e.animate!==this.props.animate},componentDidUpdate:function(e,t){var n=this.state.chat,r=t.chat;n&&r!==n&&(this.addObserver(n,"change:cmc:merge",this.msgCollectionChanged),r&&this.removeObserver(r,"change:cmc:merge"))},msgCollectionChanged:function(e,t,n){var r=this.state.msgCollection;r!==e&&r!==t||this.setState({msgCollection:n})},windowGainedFocus:function(){h.markAvailable();var e=this.state.chat;e&&e.isUser&&e.presence.subscribe()["catch"](d.WapDrop,_.noop)},windowLostFocus:function(){h.markUnavailable(p.SEND_UNAVAILABLE_WAIT)},handleClearChat:function(e){this.state.chat===e&&this.setState({chat:void 0,msgCollection:void 0,focusCtx:void 0})},handleOpenChat:function(e,t,n){var r=this;f.updateChatlistSelection(e);var i=this.openedChatInfo,a={},o=function(e){_.assign(a,e)};this.state.chat!==e?this.setState({chat:e,msgCollection:t?t.collection:e.msgs,focusCtx:t,notifyChatRendered:function(){return n(r.newChatScrollInfo(i,t))},updateOpenedChatInfo:o}):this.setState({msgCollection:t?t.collection:e.msgs,focusCtx:t,notifyChatRendered:function(){return n(r.newChatScrollInfo(i,t))},updateOpenedChatInfo:o}),this.openedChatInfo=a},newChatScrollInfo:function(e,t){var n=t?t.msg||Store.Msg.get(t.key):void 0;if(t&&n&&e&&e.chat&&e.renderedMsgsInfo&&e.visibleMsgOrder&&!_.isEmpty(e.renderedMsgsInfo)&&!_.isEmpty(e.visibleMsgOrder)){var r=e.renderedMsgsInfo[_.head(e.visibleMsgOrder)],i=_.find(e.renderedMsgsInfo,function(e,t){return t===n.id.toString()});return i?{wasVisible:!0,offset:i.offset}:e.chat===n.chat?n.t<r.t?{wasVisible:!1,alignAt:"top"}:{wasVisible:!1,alignAt:"bottom"}:{wasVisibble:!1,alignAt:"center"}}return{wasVisible:!1,alignAt:"center"}},render:function(){var e=this.state,t=e.chat,n=e.msgCollection,i=e.focusCtx;return t?r.createElement(l,{key:t.id,chat:t,msgCollection:n,height:m,focusCtx:i,notifyChatRendered:this.state.notifyChatRendered,updateOpenedChatInfo:this.state.updateOpenedChatInfo}):r.createElement(u,{animate:this.props.animate})}});e.exports=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(10),c=n(220),l=n(1230),u=n(1236),d=n(145),p=n(1328),h=n(1231),f=n(1317),m=n(1299),g=n(1237),v=n(1232),y=n(1448),E=n(1335),b=n(1339),w=n(8),M=n(1263),C=n(432),S=n(14),T=n(104),k=n(1278),x=k.MenuBar,N=k.MenuBarItem,P=n(442),O=n(1238),D=n(1324),A=n(1289),I=n(1304),R=n(85),L=o.createClass({displayName:"ConversationHeader",mixins:[l,u,d],propTypes:{chat:o.PropTypes.instanceOf(h).isRequired,onSelectMessages:o.PropTypes.func.isRequired,canAttach:o.PropTypes.bool.isRequired},statics:{ATTACH_MEDIA_ACTIVE:"attach_media_active",GROUP_CHAT_ACTIVE:"group_chat_active"},getInitialState:function(){return this.asyncState({img:"chat.ProfilePicThumb.img",formattedTitle:"chat.formattedTitle"},{activeDropdown:void 0})},componentWillMount:function(){},onWindowFocus:function(){var e=this;this.setState({newlyFocused:!0}),this.safeDelay(function(){return e.setState({newlyFocused:!1})},100)},onMouseDown:function(e){},onDrag:function(e){this.didDrag=!0},onClickCapture:function(e){},onClick:function(){var e=this.props.chat;!e.isPSA&&(e.isUser||e.isBroadcast||e.isGroup)&&w.openDrawerRight(o.createElement(E,{chat:e}),"slide-left",this.context.uim)},checkForDrawerMid:function(e){w.existsDrawerMid(function(t){t&&e.preventDefault()})},onChatSearch:function(e){e.preventDefault(),w.openDrawerRight(o.createElement(b,{chat:this.props.chat}),"slide-left",this.context.uim)},onCaptureClick:function(){var e=this,t=this.props.chat,n=A.start("camera");a["default"].race([n,this.rejectOnUnmount()]).bind(this).checkpoint(this.rejectOnUnmount()).then(function(n){w.openDrawerMid(o.createElement(y,{chat:t,stream:n}),"slide-up",e.context.uim)})["catch"](S.Unmount,function(){n.then(function(e){return A.stop(e)})["catch"](_.noop)})["catch"](S.GUM.PermissionDeniedError,function(){w.openModal(o.createElement(M,{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_fail_description",type:M.TYPE.GUIDE_UNBLOCK}))})["catch"](S.GUM.GUMError,function(){w.openModal(o.createElement(M,{title:"guide_desktop_camera_missing_title",desc:"guide_desktop_camera_missing_description",type:M.TYPE.GUIDE_NONE}))})},render:function(){var e,t,r=this.props.chat;r.isUser?(e=o.createElement(B,{chat:r,onSelectMessages:this.props.onSelectMessages}),t=o.createElement(m,{presence:r.presence,placeholder:l10n.t("click_here_for_user_info"),location:"title"})):r.isBroadcast?(e=o.createElement(j,{chat:r,onSelectMessages:this.props.onSelectMessages}),t=null):r.isGroup&&(e=o.createElement(F,{chat:r,onSelectMessages:this.props.onSelectMessages}),t=o.createElement(f,{presence:r.presence,groupMetadata:r.groupMetadata,placeholder:l10n.t("click_here_for_group_info"),location:"title"}));var i=n(104),a=i.supportsFeature(i.F.FTS_IN_CONV)?o.createElement(N,{a8n:"search-button",icon:"search-alt",title:l10n.t("search"),onClick:this.onChatSearch}):null,s=this.props.canAttach?o.createElement(N,{a8n:"conversation-clip",icon:"clip",title:l10n.t("menutitle_attach"),transitionName:"menu",onClick:this.checkForDrawerMid},o.createElement(U,{chat:r,onCaptureClick:this.onCaptureClick})):null,c="chat-avatar",l="chat-body",u="chat-title",d=null;return r.isPSA&&(c+=" chat-psa",l+=" chat-psa",u+=" chat-title-psa",d=o.createElement("span",{className:"icon-psa-verified"}),t=null),o.createElement("header",{className:"pane-header pane-chat-header",onClickCapture:this.onClickCapture,onMouseDown:this.onMouseDown},o.createElement("div",{className:c,onClick:this.onClick},o.createElement(g,{id:r.id,size:40})),o.createElement("div",{className:l,onClick:this.onClick},o.createElement("div",{className:"chat-main"},o.createElement("h2",{className:u,dir:"auto"},o.createElement(v,{text:r.title(),titlify:!0,ellipsify:!0}),d)),t),o.createElement("div",{className:"pane-chat-controls"},o.createElement(x,{key:"conversation-header"},a,s,o.createElement(N,{a8n:"conversation-menu",icon:"menu",title:l10n.t("menutitle_menu"),onClick:this.checkForDrawerMid},e))))}});L.contextTypes={uim:o.PropTypes.instanceOf(R)};var U=o.createClass({displayName:"AttachMenuDropdown",mixins:[u],propTypes:{chat:o.PropTypes.instanceOf(h).isRequired},canSendDocument:function(){return T.supportsFeature(T.F.ENC_DOC)},onDocumentPick:function(e){if(e){e.stopPropagation();var t=_.toArray(e.target.files);t.length&&(e.target.value="",this.canSendDocument()?w.attachMediaDrawer(this.props.chat,t):this.showCantSendDocument())}},onMediaPick:function(e){if(e){e.stopPropagation();var t=_.toArray(e.target.files);t.length&&(e.target.value="",w.attachMediaDrawer(this.props.chat,t))}},onMediaClick:function(e){e.preventDefault(),this.refs.mediaPicker.triggerInput()},onDocumentClick:function(e){e.preventDefault(),this.canSendDocument()?this.refs.docPicker.triggerInput():this.showCantSendDocument()},confirmContactSend:function(e){var t=this,n=void 0;n=this.props.chat.isUser?l10n.t("confirm_contact_send_chat",{name:e.formattedName,chat:this.props.chat.title()}):this.props.chat.isGroup?l10n.t("confirm_contact_send_group",{name:e.formattedName,chat:this.props.chat.title()}):l10n.t("confirm_contact_send_broadcast",{name:e.formattedName}),w.openModal(o.createElement(C,{key:"contact_confirm",onOK:function(){return t.sendContact(e)},onCancel:function(){return w.closeModal()}},n))},sendContact:function(e){this.props.chat.sendContact(e),w.closeModal()},onContactClick:function(e){e.preventDefault(),w.openModal(o.createElement(I,{key:"contacts",title:l10n.t("send_contact"),filter:Store.Contact.isFilteredContact,onCancel:function(){return w.closeModal()},onSelect:this.confirmContactSend}))},showCantSendDocument:function(e){var t;if(e instanceof S.InvalidMediaFileType)t=l10n.t("cannot_send_document_type_unsupported");else if(e instanceof S.MediaFileTooLarge)t=l10n.t("document_too_big",{maxSize:s.MAX_MEDIA_UPLOAD_SIZE/1024/1024+"MB"});else{var n=this.props.chat;t=n.isUser?l10n.t("cannot_send_document_to_contact_unsupported",{contact:n.title()}):l10n.t("cannot_send_document_to_group_unsupported",{group:n.title()})}w.openModal(o.createElement(C,{key:"doc_cant_send",onOK:w.closeModal.bind(w)},o.createElement(v,{text:t})))},onCaptureClick:function(){this.props.onCaptureClick()},render:function(){var e=o.createElement(D,{direction:"left",className:"tooltip-menu",body:l10n.t("attach_capture")}),t=navigator.getUserMedia?o.createElement(O,{tooltip:e,a8n:"mi-attach-camera",action:this.onCaptureClick},o.createElement("button",{className:"menu-icons-item"},o.createElement("div",{className:"icon-xl icon-camera"}))):null,n=void 0;if(T.supportsFeature(T.F.ENC_DOC)){var r=o.createElement(D,{direction:"left",className:"tooltip-menu",body:l10n.t("attach_document")});n=o.createElement(O,{tooltip:r,ref:"docPicker",a8n:"mi-attach-document",action:this.onDocumentClick,filePickerMimes:c.DOC_MIMES,onFilePick:this.onDocumentPick},o.createElement("button",{className:"menu-icons-item"},o.createElement("div",{className:"icon-xl icon-document"})))}var i=o.createElement(D,{direction:"left",className:"tooltip-menu",body:l10n.t("attach_media")}),a=o.createElement(O,{tooltip:i,ref:"mediaPicker",a8n:"mi-attach-media",filePickerMimes:[s.IMAGE_MIMES,s.VIDEO_MIMES].join(","),action:this.onMediaClick,onFilePick:this.onMediaPick},o.createElement("button",{className:"menu-icons-item"},o.createElement("div",{className:"icon-xl icon-image"}))),l=o.createElement(D,{direction:"left",className:"tooltip-menu",body:l10n.t("attach_vcard")}),u=o.createElement(O,{tooltip:l,a8n:"mi-attach-contact",action:this.onContactClick},o.createElement("button",{className:"menu-icons-item"},o.createElement("div",{className:"icon-xl icon-contact"})));return o.createElement("div",null,o.createElement(P,{type:P.Type.MENU,key:"AttachMenuDropdown"},a,t,n,u))}}),F=o.createClass({displayName:"GroupMenuDropdown",mixins:[l],propTypes:{chat:o.PropTypes.instanceOf(h).isRequired,onSelectMessages:o.PropTypes.func.isRequired},getInitialState:function(){return{isReadOnly:this.async("chat.isReadOnly")}},render:function(){var e=p.group(this.props.chat,this.props.onSelectMessages);return o.createElement(P,{type:P.Type.DROPDOWN_MENU,key:"GroupMenuDropdown",flipOnRTL:!0,direction:{x:P.Direction.X.LEFT}},e)}}),j=o.createClass({displayName:"BroadcastMenuDropdown",propTypes:{chat:o.PropTypes.instanceOf(h).isRequired,onSelectMessages:o.PropTypes.func.isRequired},render:function(){var e=p.broadcast(this.props.chat,this.props.onSelectMessages);return o.createElement(P,{type:P.Type.DROPDOWN_MENU,key:"BroadcastMenuDropdown",flipOnRTL:!0,direction:{x:P.Direction.X.LEFT}},e)}}),B=o.createClass({displayName:"ContactMenuDropdown",propTypes:{chat:o.PropTypes.instanceOf(h).isRequired,onSelectMessages:o.PropTypes.func.isRequired},render:function(){var e=p.contact(this.props.chat,this.props.onSelectMessages);return o.createElement(P,{type:P.Type.DROPDOWN_MENU,key:"ContactMenuDropdown",flipOnRTL:!0,direction:{x:P.Direction.X.LEFT}},e)}});e.exports=L},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(6),s=n(37),c=n(1139),l=n(10),u=n(1230),d=n(141),p=n(83),h=n(145),f=n(1236),m=n(1439),g=n(1417),v=n(8),y=n(1231),E=n(1267),b=n(142),w=n(439),M=n(44),C=n(1328),S=n(89),T=n(1362),k=n(1248),x=n(1229),N=n(1434),P=n(106),O=n(1),D=n(143),A=n(1261),I=n(218),R=n(440),L=n(84),U=n(435),F=n(14),j=3e3,B=8.5,G=300,z=m.UpdateTypes,W=m.UpdateTypePriority,H=o.createClass({displayName:"ConversationMsgs",mixins:[u,p,d,b,h,f],propTypes:{chat:o.PropTypes.instanceOf(y).isRequired,msgCollection:o.PropTypes.instanceOf(E).isRequired,selectable:o.PropTypes.bool,onMessageSelect:o.PropTypes.func.isRequired,onSelectMessages:o.PropTypes.func.isRequired,focusCtx:o.PropTypes.object,selectedMessages:o.PropTypes.instanceOf(k),notifyChatRendered:o.PropTypes.func,updateOpenedChatInfo:o.PropTypes.func.isRequired},getInitialState:function(){return this.rerender=this.safeDebounce(this._rerender,100),this.handleScroll=_.throttle(this._handleScroll,100),this.initialState(this.props)},componentWillMount:function(){var e=this;this._hideStickyDateMarkerTimer=new S(function(){return e.hideFloatingMarker()})},componentDidMount:function(){var e=this,t=this.props,n=t.chat,r=t.msgCollection;if(this.regCmd("compose_height_change",this.composeHeightChange),this.regCmd("scroll_chat_to_bottom",this.scrollToBottom),this.regCmd("scroll_to_focused_msg",function(){e.chatOpenScrollTimestamp=Date.now()}),this.attachMsgCollectionObservers(this.props,void 0),this.regNativeListener(window,"focus",this.windowGainedFocus),this.regNativeListener(window,"blur",this.windowLostFocus),this.handleResize=_.throttle(function(){e.updateMsgListInfo(),e.updateFloatingDateMarker()},100),this.updateNearBottomOnResize=this.safeDebounce(this.updateNearBottom,100),this.regNativeListener(window,"resize",this.handleResize),this.regNativeListener(window,"resize",this.updateNearBottomOnResize),this.addObserver(n,"change:trusted"),this.regCmd("textsize_change",function(t){e.setState({textsize:t})}),n.isGroup?this.addObserver(n.groupMetadata.participants,"change:contact.name change:contact.isMyContact change:contact.notifyName",this.rerender):n.isUser&&this.addObserver(n.contact,"change:isMyContact",this.rerender),this.addObserver(r,"change:star",this.rerender),this.addObserver(n,"change:quotedMsg",this.onQuotedMsgChange),!this.props.focusCtx){var i=s.findDOMNode(this.refs.scrollContainer);0===i.scrollTop&&this.loadEarlierMsgs()}this.updateMsgListInfo(),this.updateFloatingDateMarker(),this.props.updateOpenedChatInfo({chat:n}),n.sendSeen();var a=void 0,o=void 0,c=void 0;this.regCmd("panes_will_change",function(t){if(e.msgListInfo&&e.msgListInfo.visibleMsgOrder&&e.msgListInfo.visibleMsgOrder.length&&e.refs.messageList){var n=_.last(e.msgListInfo.visibleMsgOrder).toString();c=s.findDOMNode(e.refs.messageList.refs[n]),o=s.findDOMNode(e.refs.scrollContainer),a=e.getMsgBottom(o,c)}}),this.regCmd("panes_did_change",function(t){o&&c&&!_.isUndefined(a)&&(e.setMsgBottom(o,c,a),c=void 0,o=void 0,a=void 0)})},getMsgBottom:function(e,t){var n=e.scrollTop,r=e.scrollHeight,i=e.clientHeight,a=r-(n+i);return r-(t.offsetTop+t.clientHeight+a)},setMsgBottom:function(e,t,n){var r=t.offsetTop,i=t.clientHeight,a=r+i+n-e.clientHeight;this.setScrollTop(e,a)},_rerender:function(){var e=this,t=s.findDOMNode(this.refs.scrollContainer),n=t.scrollTop;this.setState({msgListKey:this.state.msgListKey+1},function(){e.setScrollTop(t,n)})},componentDidUpdate:function(e,t){if(this.updateType=z.DEFAULT,this.updateMsgListInfo(),t.msgListKey===this.state.msgListKey){var n=e.chat===this.props.chat;this.updateFloatingDateMarker(n),this.props.updateOpenedChatInfo({chat:this.props.chat})}},initialState:function(e){var t=e.focusCtx,n=e.chat,r=e.msgCollection;this.updateType=z.DEFAULT,this.msgListInfo={visibleMsgs:{},dateMarker:void 0};var i,a=t||this.getUnreadFocusCtx(e),o=a&&a.msg,s=o&&o.id;return i=0,{msgListKey:0,cursor:new T(r,s,n.isGroup?l.RENDOR_CURSOR.GROUP_CONVERSATION:l.RENDOR_CURSOR.CONVERSATION),unreadCount:n.pendingSeenCount?0:n.unreadCount,isNearBottom:!0,newUnread:0,focusCtx:a,contextMenu:!1,textsize:i}},attachMsgCollectionObservers:function(e,t){var n=this,r=e.chat,i=e.msgCollection,a=e.focusCtx;this.props.msgCollection&&(this.removeObserver(this.props.chat,"change:unreadCount"),this.removeObserver(this.props.msgCollection,"change:last"),this.removeObserver(this.props.msgCollection,"remove",this.onMsgDelete),this.removeObserver(this.props.chat.msgs,"change:last")),i===r.msgs&&this.addObserver(r,"change:unreadCount",this.onUnreadCount),this.addObserver(r.msgs,"change:last",this.onLastMsgChanged),this.addObserver(i,"remove",this.onMsgDelete),this.state.cursor.msgCollection=i;var s=a,c=function(){return s.key&&(s.msg=Store.Msg.get(s.key)),s.msg?(n.setUpdateType(z.KEEP_SCROLL_BOTTOM),void n.setState({cursor:n.state.cursor.init(s.msg.id)})):v.openChatBottom(n.props.chat)};s&&i.loadAroundPromise?i.loadAroundPromise.checkpoint(this.rejectOnUnmount()).then(c)["catch"](F.Unmount,_.noop)["catch"](F.E404,function(){v.openToast(o.createElement(U,{msg:R.t("message_query_404"),id:U.genId()})),c()})["catch"](c):s&&c()},isMostRecentCMC:function(){return this.props.chat.msgs===this.props.msgCollection},componentWillReceiveProps:function(e){var t=this;this.attachMsgCollectionObservers(e,this.props.focusCtx);var n=_.clone(e);n.selectable=!e.selectable,_.isEqual(n,this.props)||this.setState(this.initialState(e),function(){t.props.chat.sendSeen()})},componentWillUnmount:function(){this._hideStickyDateMarkerTimer.cancel(),this.handleScroll.cancel(),this.handleResize.cancel(),this.maybeSendSeen()&&(this.props.chat.markedUnread=!1)},loadEarlierMsgs:function(){var e=this,t=this.props,n=t.chat,r=t.msgCollection,i=this.state.cursor;if(i.start>0)this.setUpdateType(z.KEEP_SCROLL_BOTTOM),this.setState({cursor:i.loadBefore()});else{if(r.msgLoadState.noEarlierMsgs||r.msgLoadState.isLoadingEarlierMsgs||r.msgLoadState.isLoadingAroundMsgs)return;n.loadEarlierMsgs(r).checkpoint(this.rejectOnUnmount()).then(function(){e.setUpdateType(z.KEEP_SCROLL_BOTTOM),e.setState({cursor:i.loadBefore()})})["catch"](F.Unmount,_.noop)["catch"](function(e){O.log("ConversationMsgs:loadEarlierMsgs failed")(),O.log(e)()})}},loadRecentMsgs:function(){var e=this,t=this.props,n=t.chat,r=t.msgCollection,i=this.state.cursor;if(i.end<r.length)this.setUpdateType(z.KEEP_SCROLL_TOP),this.setState({cursor:i.loadAfter()});else{if(r.msgLoadState.isLoadingRecentMsgs||r.msgLoadState.isLoadingAroundMsgs)return;n.loadRecentMsgs(r).checkpoint(this.rejectOnUnmount()).then(function(){e.setUpdateType(z.KEEP_SCROLL_TOP),e.setState({cursor:i.loadAfter()})})["catch"](F.Unmount,_.noop)["catch"](function(e){O.log("ConversationMsgs:loadRecentMsgs failed")(),O.log(e)()})}},composeHeightChange:function(e){var t=this,n=s.findDOMNode(this.refs.scrollContainer);if(e){if(e<0&&n.scrollTop===n.scrollHeight-n.clientHeight)return;this.setScrollTop(n,n.scrollTop+e)}else!function(){var e=n.scrollHeight-(n.scrollTop+n.clientHeight);Velocity(n,{tween:18},{progress:function(){t.setScrollTop(n,n.scrollHeight-e-n.clientHeight)},duration:300},[.1,.82,.25,1])}()},getScrollBottom:function(){var e=s.findDOMNode(this.refs.scrollContainer);return e.scrollHeight-(e.scrollTop+e.clientHeight)},setScrollBottom:function(e){var t=s.findDOMNode(this.refs.scrollContainer);this.setScrollTop(t,t.scrollHeight-e-t.clientHeight)},onStickyDateMarkerUpdated:function(e){var t=this.refs.stickyDateMarker;t&&t.updateDateMarkerText(e)},hideFloatingMarker:function(){var e=this.refs.stickyDateMarker;e&&e.hideStickyDateMarker(!0)},setScrollTop:function(e,t){this.programmaticScroll=Date.now(),e.scrollTop=t},updateFloatingDateMarker:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=this.msgListInfo.dateMarker;if(this.isMounted()&&void 0!==t){var n=e||Date.now()-(this.programmaticScroll||0)<200;if(!n){var r=this.refs.stickyDateMarker;r&&r.hideStickyDateMarker(!1)}if(this.refs.messageList){var i=this.refs.messageList.refs;if(t===-1)this.onStickyDateMarkerUpdated();else if(i){var a=i["dateMarker_"+t];if(a){var o=a.props.timestamp,s=D.relativeDateStr(o).toUpperCase();this.onStickyDateMarkerUpdated(s)}}if(i&&t!==this.dateMarkerIdx){var c=i["dateMarker_"+this.dateMarkerIdx],l=i["dateMarker_"+t];c&&c.hide(!1),l&&l.hide(!0),this.dateMarkerIdx=t}n||this._hideStickyDateMarkerTimer.debounce(j)}}},setUpdateType:function(e){W[e]>=W[this.updateType]&&(this.updateType=e)},nearBottom:function(e){return e=e||s.findDOMNode(this.refs.scrollContainer),e.scrollTop+l.SCROLL_FUDGE>e.scrollHeight-e.clientHeight},updateNearBottom:function(){var e=this.nearBottom();this.nearBottom!==e&&(this.setUpdateType(z.NONE),this.setState({isNearBottom:e}))},getUnreadFocusCtx:function(e){var t,n=e||this.props,r=n.chat,i=n.msgCollection,o=n.focusCtx;if((!o||this.isMostRecentCMC())&&r.unreadCount){var s=(t={},(0,a["default"])(t,x.TYPE.CHAT,x.TYPE.CHAT),(0,a["default"])(t,x.TYPE.IMAGE,x.TYPE.IMAGE),(0,a["default"])(t,x.TYPE.VIDEO,x.TYPE.VIDEO),(0,a["default"])(t,x.TYPE.AUDIO,x.TYPE.AUDIO),(0,a["default"])(t,x.TYPE.VCARD,x.TYPE.VCARD),(0,a["default"])(t,x.TYPE.LOCATION,x.TYPE.LOCATION),(0,a["default"])(t,x.TYPE.PTT,x.TYPE.PTT),t),c=_(i.toArray()).filter(function(e){return!!s[e.type]}).reverse().take(r.unreadCount).value();if(c.length===r.unreadCount)return c=_.last(c),{msg:c,isUnreadDivider:!0,highlightMsg:!1}}},getMsgs:function(){var e=this.props.msgCollection,t=this.state.cursor;return e.toArray().slice(t.start,t.end)},updateMsgListInfo:function(){var e=this.refs.messageList;if(e){for(var t=e.props.msgs,n=e.refs,r={},i=[],a=0,o=t.length-1;a<o;){var c=Math.floor((a+o)/2),u=n[t[c].id.toString()],d=s.findDOMNode(u);
d||(O.error("invalid ref lookup for ref: "+t[c].id.toString()+" msg index: "+c)(),O.error("all refs: "+_.keys(n))()),e.getMsgVisibility(u).visibility===l.VISIBILITY.ABOVE?a=c+1:o=c}for(var p=a;p<t.length;p++){var h=n[t[p].id.toString()],f=e.getMsgVisibility(h);if(f.visibility!==l.VISIBILITY.VISIBLE)break;r[t[p].id.toString()]={offset:f.offset,t:t[p].t},i.push(t[p].id)}var m=_.pickBy(n,function(e,t){return _.startsWith(t,"dateMarker_")}),g=s.findDOMNode(this.refs.scrollContainer),v=g.scrollTop,y=n.dateMarker_0?s.findDOMNode(n.dateMarker_0).offsetTop:void 0;if(a=0,o=_.size(m)-1,_.size(m)&&y<=v+B)for(;a<o;){var E=Math.ceil((a+o)/2),b=s.findDOMNode(n["dateMarker_"+E]);if(!b)return;b.offsetTop>v+B?o=E-1:a=E}else a=-1;this.msgListInfo.dateMarker=a,this.pauseHiddenGifs(this.msgListInfo.visibleMsgs,r),this.msgListInfo.visibleMsgs=r,this.msgListInfo.visibleMsgOrder=i,this.props.updateOpenedChatInfo({renderedMsgsInfo:r,visibleMsgOrder:i,clientHeight:g.clientHeight})}},isMsgVisible:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return!!this.msgListInfo.visibleMsgs[e.toString()]&&(!!t||this.getMsgComponent(e))},getMsgComponent:function(e){var t=this.refs.messageList;if(t){var n=t.refs[e.toString()];if(n)return n.refs.component&&n.refs.component.refs.msg}},pauseHiddenGifs:function(e,t){for(var n in e)if(!t[n]){var r=this.props.msgCollection.get(n);if(r&&r.isGif){var i=this.getMsgComponent(n);i&&i.playCount&&i.pause()}}},onScroll:function(e){this.handleScroll(e.target,this.props.chat,this.nearBottom,this)},_handleScroll:function(e,t,n){this.updateMsgListInfo(),e.scrollTop<G&&Date.now()-(this.chatOpenScrollTimestamp||0)>l.MSG_FOCUS_SCROLL_ANIMATION_DURATION+50&&this.loadEarlierMsgs();var r=this.state,i=r.isNearBottom,a=r.cursor,o=n(e);o?(this.maybeSendSeen(!0),this.isMostRecentCMC()&&i!==o&&(this.setUpdateType(z.NONE),this.setState({isNearBottom:o,newUnread:0})),(a.end<this.props.msgCollection.length||!this.isMostRecentCMC())&&this.loadRecentMsgs()):i!==o&&(this.setUpdateType(z.NONE),this.setState({isNearBottom:o})),this.updateFloatingDateMarker()},windowGainedFocus:function(){var e=this.props.chat;!this.clearUnreadTimer&&e.isDirty()&&(this.clearUnreadTimer=this.safeDelay(function(){delete this.clearUnreadTimer,this.maybeSendSeen()},l.CLEAR_CHAT_DIRTY_WAIT))},windowLostFocus:function(){if(this.state.unreadCount&&this.isMostRecentCMC()){var e=this.props.chat;0===e.unreadCount&&(this.setUpdateType(z.KEEP_SCROLL_BOTTOM),this.setState({unreadCount:0,focusCtx:void 0,cursor:this.state.cursor.setKey()})),e.markedUnread=!1}},maybeSendSeen:function(e,t){var n=this.props,r=n.chat,i=n.msgCollection,a=this.state.cursor;if(r.isDirty()&&this.isMostRecentCMC()&&a.end>=i.length&&(_.isUndefined(t)&&(t=document.hasFocus()),t&&(_.isUndefined(e)&&(e=this.nearBottom()),e)))return r.sendSeen(),!0},jumpToBottom:function(){var e=this;this.isMostRecentCMC()&&this.state.cursor.end>=this.props.msgCollection.length?this.scrollToBottom():v.openChatBottom(this.props.chat).then(function(t){t&&v.focusChatTextInput(e.props.chat)})},scrollToBottom:function(e){var t=s.findDOMNode(this.refs.scrollContainer);t&&this.setScrollTop(t,t.scrollHeight),e&&e()},onLastMsgChanged:function(){var e=this.props.msgCollection,t=this.state,n=t.cursor,r=t.focusCtx,i=e.last();if(!this.isMostRecentCMC())return void(i&&i.isSentByMe&&this.jumpToBottom());var a={},o=document.hasFocus(),s=this.nearBottom();this.setUpdateType(s?z.SCROLL_BOTTOM:z.KEEP_SCROLL_TOP),o&&s?(this.setUpdateType(z.SCROLL_BOTTOM),a.unreadCount=0,a.focusCtx=void 0,a.cursor=n.setKey()):i&&i.isSentByMe&&(this.setUpdateType(z.SCROLL_BOTTOM),this.state.unreadCount&&(a.unreadCount=0,a.focusCtx=void 0,a.cursor=n.setKey()),this.jumpToBottom()),this.isMostRecentCMC()&&(r&&!a.hasOwnProperty("focusCtx")?a.cursor=n.loadAfter(1):a.cursor=n.loadBefore(1)),_.isEmpty(a)||this.setState(a)},onUnreadCount:function(){var e=this.props.chat,t=this.nearBottom(),n=document.hasFocus();this.maybeSendSeen(t,n);var r={};if(e.unreadCount&&!e.pendingSeenCount){r.unreadCount=e.unreadCount;var i=this.getUnreadFocusCtx();i&&(r.focusCtx=i)}t&&1===r.unreadCount&&0===this.state.unreadCount&&this.setUpdateType(z.SCROLL_BOTTOM),(!t&&this.isMostRecentCMC()||!e.pendingSeenCount&&this.state.newUnread!==e.unreadCount)&&(r.newUnread=e.unreadCount),_.isEmpty(r)||this.setState(r)},onMsgDelete:function(e,t,n){this.state.cursor.onRemove(e),this.setState({})},onPageUpDown:function(e){L.focus(s.findDOMNode(this.refs.scrollContainer))},onKeyPress:function(e){e.metaKey||e.ctrlKey||(e.preventDefault(),"Enter"!==e.key||e.shiftKey?v.pasteChatTextInput(this.props.chat,String.fromCharCode(e.charCode)):v.enterChatTextInput(this.props.chat))},onContextMenu:function(e){var t,n=this.props.chat,r=this.props.onSelectMessages;if(n.isUser)t=C.contact(n,r);else if(n.isGroup)t=C.group(n,r);else{if(!n.isBroadcast)return;t=C.broadcast(n,r)}e.preventDefault(),e.stopPropagation(),e.persist(),this.setState({contextMenu:{menu:t,event:e}})},contextClose:function(){this.setState({contextMenu:!1})},onPaste:function(e){e.preventDefault();var t=new c(e.clipboardData);if(!t.hasFiles())return void v.pasteChatTextInput(this.props.chat,t.getText());var n=_.filter(t.getFiles(),function(e){var t=w.typeFromMimetype(e.type);return"image"===t||"video"===t});n.length&&v.attachMediaDrawer(this.props.chat,n)},render:function(){var e,t=this,n=this.props,r=n.chat,i=n.msgCollection,a=n.selectable,s=n.onMessageSelect,c=this.state.focusCtx,u=M("pane-chat-msgs pane-chat-body lastTabIndex",{selectable:a}),d=this.isMostRecentCMC(),p=!!c,h=_.find(l.TEXTSIZE_CLASS_MAP,function(e){return e.scale===t.state.textsize});h&&(e=h.classname);var f=o.createElement(m,{key:"ml-"+r.id+"-"+this.state.msgListKey,ref:"messageList",updateType:this.updateType,unreadCount:this.state.unreadCount,selectable:a,onMessageSelect:s,msgs:this.getMsgs(),focusedMsgCtx:c,selectedMessages:this.props.selectedMessages,isMsgVisible:this.isMsgVisible,notifyChatRendered:this.props.notifyChatRendered}),v=o.createElement(g,{direction:"around",isMostRecentCMC:d,loadMoreMsgs:_.noop,msgCollection:i}),y=void 0;(this.state.cursor.start>0||!i.msgLoadState.noEarlierMsgs)&&(y=o.createElement(g,{direction:"earlier",isMostRecentCMC:d,loadMoreMsgs:this.loadEarlierMsgs,msgCollection:i}));var E=void 0;(this.state.cursor.end<i.length||!d)&&(E=o.createElement(g,{direction:"recent",isMostRecentCMC:d,loadMoreMsgs:this.loadRecentMsgs,msgCollection:i})),p&&i.msgLoadState.isLoadingAroundMsgs?(E=void 0,y=void 0,f=void 0):v=void 0;var b=void 0,w=void 0,C=this.state,S=C.isNearBottom,T=C.newUnread;S&&(i.msgLoadState.isLoadingAroundMsgs||d)||(T&&r.unreadCount&&(w=o.createElement("span",{className:"icon-meta unread-count",key:"icon-unread"},R.n(this.state.newUnread))),b=o.createElement("div",{className:"incoming-msgs",onClick:this.jumpToBottom},o.createElement(P,{transitionName:"pop"},w),o.createElement("span",{className:"icon icon-down"})));var k=void 0;return this.state.contextMenu&&(k=o.createElement(I,{displayName:"ConversationContextMenu",escapable:!0,popable:!0,requestDismiss:this.contextClose},o.createElement(A,{contextMenu:this.state.contextMenu}))),o.createElement("div",{className:e},o.createElement(N,{ref:"stickyDateMarker"}),o.createElement(P,{transitionName:"pop"},b),o.createElement("div",{className:u,ref:"scrollContainer",onScroll:this.onScroll,onKeyPress:this.onKeyPress,onContextMenu:a?null:this.onContextMenu,onPaste:this.onPaste,tabIndex:"0"},o.createElement("div",{className:"pane-chat-empty"}),v,y,f,E),k)}});e.exports=H},function(e,t,n){"use strict";var r=n(6),i=r.createClass({displayName:"LinkPreview",propTypes:{title:r.PropTypes.string,description:r.PropTypes.string,canonicalUrl:r.PropTypes.string,thumbnail:r.PropTypes.string,onOmit:r.PropTypes.func},render:function(){var e=this.props,t=e.title,n=e.description,i=e.canonicalUrl,a=e.thumbnail,o=a?r.createElement("img",{className:"link-preview-media",src:"data:image/jpeg;base64,"+a}):null,s=this.props.onOmit?r.createElement("div",{className:"btn-background"},r.createElement("button",{className:"icon icon-x",onClick:this.props.onOmit})):null;return r.createElement("div",{className:"message-in link-preview-compose"},r.createElement("div",{className:"link-preview-container"},o,r.createElement("div",{className:"link-preview-body"},r.createElement("div",{className:"link-preview-title",title:t},t),r.createElement("div",{className:"link-preview-description",title:n},n),r.createElement("div",{className:"link-preview-source ellipsify"},i))),s)}});e.exports=i},function(e,t,n){"use strict";var r=n(6),i=n(144),a=n(141),o=n(1267),s=r.createClass({displayName:"LoadMoreMessages",mixins:[a],propTypes:{direction:r.PropTypes.oneOf(["recent","earlier","around"]).isRequired,isMostRecentCMC:r.PropTypes.bool.isRequired,loadMoreMsgs:r.PropTypes.func.isRequired,msgCollection:r.PropTypes.instanceOf(o).isRequired},getInitialState:function(){return this.props.msgCollection.msgLoadState.toJSON()},componentWillMount:function(){this.attachObservers()},componentWillReceiveProps:function(e){this.attachObservers(e)},attachObservers:function(e){var t=this,n=this.props.msgCollection.msgLoadState;e&&(this.removeObserver(n,"change"),n=e.msgCollection.msgLoadState),this.addObserver(n,"change",function(){t.setState(n.toJSON())})},loadMoreMsgs:function(e){"earlier"===this.props.direction&&this.state.isLoadingEarlierMsgs||"recent"===this.props.direction&&this.state.isLoadingRecentMsgs||"around"===this.props.direction&&this.state.isLoadingAroundMsgs||this.props.loadMoreMsgs()},render:function(){var e=this.props.direction;if("earlier"===e&&this.state.isLoadingEarlierMsgs||"recent"===e&&this.state.isLoadingRecentMsgs||"around"===e&&this.state.isLoadingAroundMsgs)return r.createElement("div",{className:"more"},r.createElement("div",{className:"btn-more",title:l10n.t("loading_messages")},r.createElement(i,{stroke:6,size:24})));var t;return t="earlier"===e?l10n.t("load_earlier_messages"):"recent"===e?l10n.t("load_recent_messages"):l10n.t("loading_messages"),r.createElement("div",{className:"more"},r.createElement("div",{className:"btn-more",title:t,onClick:this.loadMoreMsgs},r.createElement("span",{className:"icon icon-refresh"})))}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(1230),o=n(142),s=n(1244),c=n(1277),l=n(1300),u=n(1243),d=n(1241),p=n(8),h=n(1264),f=n(1266),m=n(104),g=n(143),v=n(1274),y=n(432),E=r.createClass({displayName:"AudioVideo",mixins:[a,o],propTypes:{msg:r.PropTypes.instanceOf(i).isRequired,quotedMsg:r.PropTypes.element,isMsgVisible:r.PropTypes.func,displayAuthor:r.PropTypes.bool},getInitialState:function(){return{mediaStage:this.async("msg.mediaData.mediaStage")}},showMediaMissing:function(){p.openModal(r.createElement(h,{msg:this.props.msg}))},downloadMedia:function(){this.props.msg.forceDownloadMedia()},cancelDownload:function(){this.props.msg.cancelDownload()},cancelUpload:function(){this.props.msg.cancelUpload()},resumeUpload:function(){this.props.msg.resumeUpload()},resumeRemoteUpload:function(){m.supportsFeature(m.F.MEDIA_RETRY)?this.props.msg.resumeRemoteUpload():p.openModal(r.createElement(f,{msg:this.props.msg}))},getZoomNode:function(e){var t=this.props.isMsgVisible(e);if(t&&t.getImgNode)return t.getImgNode()},downloadUnsupportedToDesktop:function(e){var t=this;e&&e.stopPropagation(),p.openModal(r.createElement(y,{onCancel:p.closeModal.bind(p),onOK:function(){p.closeModal(),v.initDownload(t.props.msg)},okText:l10n.t("web_button_download"),cancelText:l10n.t("web_cancel"),title:l10n.t("download_unsupported_media_title")},l10n.t("download_unsupported_media_prompt")))},launchMediaViewer:function(e){var t=this.props,n=t.msg,r=t.isMsgVisible;n.downloadMedia(),e&&e.stopPropagation(),p.mediaViewerModal(n,r?this.getZoomNode:_.noop)},stopEvent:function(e){e.stopPropagation()},render:function(){var e=this.props.msg,t=e.type===s.TYPE.VIDEO,n=null,i=null;switch(e.mediaData.mediaStage){case s.STAGE.RESOLVED:case s.STAGE.INIT:n=r.createElement(c.Play,null),i=this.launchMediaViewer;break;case s.STAGE.NEED_POKE:n=r.createElement(c.Download,{filesize:e.size}),i=this.downloadMedia;break;case s.STAGE.UPLOADING:n=r.createElement(c.PendingCancel,null),i=this.cancelUpload;break;case s.STAGE.NEED_UPLOAD:n=r.createElement(c.Upload,{filesize:e.size}),i=this.resumeUpload;break;case s.STAGE.REMOTE_NEED_UPLOAD:n=r.createElement(c.Upload,{filesize:e.size}),i=this.resumeRemoteUpload;break;case s.STAGE.ERROR_MISSING:i=this.showMediaMissing;break;case s.STAGE.ERROR_UNSUPPORTED:e.isUnsentMedia||(n=r.createElement(c.Download,{filesize:e.size}),i=this.downloadUnsupportedToDesktop);break;default:n=r.createElement(c.Pending,null)}var a=null,o=g.durationStr(e.duration);o&&(a=r.createElement("span",{className:"message-duration"},t?r.createElement("span",{className:"icon-s icon-msg-video-light"}):r.createElement("span",{className:"icon-s icon-msg-audio-light"}),o));var p=void 0;if(t){var h={backgroundImage:'url("data:image/jpeg;base64,'+e.body+'")'};p=r.createElement("div",{className:"image-thumb-body",style:h})}else p=r.createElement("div",{className:"image-audio"});var f=this.props.displayAuthor&&d.shouldRender(e)?r.createElement(d,{msg:e}):null,m=t?r.createElement("div",{className:"shade"}):null,v=e.caption?r.createElement(l,{msg:e}):null,y=v?"bubble-image bubble-video bubble-image-caption":"bubble-image bubble-video";return r.createElement("div",{onClick:this.stopEvent},r.createElement("div",{className:y},f,this.props.quotedMsg,r.createElement("div",{className:"image-thumb",onClick:i},n,p,m,a),v,r.createElement(u,{msg:this.props.msg})))}});e.exports=E},function(e,t,n){"use strict";var r=n(1229),i=n(6),a=n(1243),o=n(1241),s=n(88),c=n(44),l=i.createClass({displayName:"Ciphertext",propTypes:{msg:i.PropTypes.instanceOf(r).isRequired,displayAuthor:i.PropTypes.bool},onLearnMore:function(){var e="https://www.whatsapp.com/faq/general/26000015/";e=s.build(e,{lg:l10n.getLocale()}),window.open(e,"_blank")},render:function(){var e=this.props.msg,t=this.props.displayAuthor&&o.shouldRender(e),n=t?i.createElement(o,{msg:e}):null,r=c("bubble bubble-placeholder",{"has-author":t}),s="message-text";return i.createElement("div",{className:r},n,i.createElement("div",{className:"icon icon-ciphertext placeholder-icon"}),i.createElement("div",{className:s},i.createElement("span",null,i.createElement("span",{className:"placeholder-msg"},l10n.t("placeholder_msg")),i.createElement("span",{className:"placeholder-learn-more",onClick:this.onLearnMore},l10n.t("learn_more")))),i.createElement(a,{msg:e}))}});e.exports=l},function(e,t,n){"use strict";var r=n(6),i=n(1246),a=n(1232),o=n(83),s=n(44),c=n(143),l=n(0),u=r.createClass({displayName:"DateMarker",mixins:[o],propTypes:{timestamp:r.PropTypes.number.isRequired},getInitialState:function(){return{hide:!1}},componentDidMount:function(){this.maybeRegMidnight()},componentDidUpdate:function(){this.maybeRegMidnight()},hide:function(e){this.state.hide!==e&&this.setState({hide:e})},rerender:function(){this.forceUpdate()},maybeRegMidnight:function(){this.unregCmd("midnight",this.rerender);var e=l().startOf("day").subtract(7,"day");this.props.timestamp>=e.unix()&&this.regCmd("midnight",this.rerender)},render:function(){var e=c.relativeDateStr(this.props.timestamp).toUpperCase(),t=s("message-system-body",{"date-marker-floating":this.state.hide});return r.createElement("div",{className:"msg"},r.createElement("div",{className:"message message-system"},r.createElement("span",{className:t},r.createElement(i,null,r.createElement(a,{direction:"auto",text:e})))))}});e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(1230),c=n(1241),l=n(1244),u=n(1243),d=n(1229),p=n(1232),h=n(44),f=n(1264),m=n(1266),g=n(1387),v=n(104),y=n(8),E=n(220).MIMETYPES,b=n(1274),w=n(435),M=_.pickBy(E,function(e){return"document"===e.msgType}),C=o.createClass({displayName:"Doc",mixins:[s],propTypes:{msg:o.PropTypes.instanceOf(d).isRequired,quotedMsg:o.PropTypes.element,displayAuthor:o.PropTypes.bool},getInitialState:function(){return{mediaStage:this.async("msg.mediaData.mediaStage")}},showMediaMissing:function(){y.openModal(o.createElement(f,{msg:this.props.msg}))},downloadMedia:function(e){var t=this;e&&e.stopPropagation(),this.downloadToBlob().then(function(){b.initDownload(t.props.msg)})},downloadToBlob:function(){return this.props.msg.mediaData.mediaStage===l.STAGE.RESOLVED?a["default"].resolve():this.props.msg.forceDownloadMedia().then(this.displayToast)["catch"](_.noop)},displayToast:function(){if(this.props.msg.mediaData.mediaStage!==l.STAGE.RESOLVED)return a["default"].reject(this.props.msg.mediaData.mediaStage);var e=this.props.msg,t=e.mediaData,n=e.caption||t.filename||l10n.t("untitled_document"),r={actionText:l10n.t("open_downloaded_document"),onAction:this.openDownloadedFile};return y.openToast(o.createElement(w,{msg:l10n.t("document_downloaded",{name:n}),id:w.genId(),action:r})),a["default"].resolve()},cancelDownload:function(){this.props.msg.cancelDownload()},cancelUpload:function(){this.props.msg.cancelUpload()},resumeUpload:function(){this.props.msg.resumeUpload()},resumeRemoteUpload:function(){v.supportsFeature(v.F.MEDIA_RETRY)?this.props.msg.resumeRemoteUpload():y.openModal(o.createElement(m,{msg:this.props.msg}))},openDownloadedFile:function(){var e=this.props.msg.mediaData.renderableUrl;e&&window.open(e,"_blank")},render:function(){var e,t=this.props,n=t.msg,r=t.displayAuthor,i=n.mediaData,a=h("bubble","bubble-doc",{"bubble-broadcast":n.broadcast,"bubble-star":n.star}),s=r&&c.shouldRender(n)?o.createElement(c,{msg:n}):null;i.pageCount>0&&(e=o.createElement("span",{className:"document-meta-value"},l10n.t("web_conversations_most_recent_document",{count:i.pageCount,_plural:i.pageCount})));var d,f=i.size>0?o.createElement("span",{className:"document-meta-value"},l10n.filesize(i.size)):null,m="icon-doc";_.has(M,i.mimetype)&&(d=o.createElement("span",{className:"document-meta-value"},M[i.mimetype].ext),m=h(m,M[i.mimetype].icon));var v=i.preview?o.createElement("div",{className:"document-thumb",style:{backgroundImage:'url("data:image/jpeg;base64,'+i.preview+'")'}}):null,y=n.caption||i.filename||l10n.t("untitled_document"),E=null,b=null;switch(i.mediaStage){case l.STAGE.RESOLVED:case l.STAGE.ERROR_UNSUPPORTED:E=o.createElement(g.Download,{onClick:this.downloadMedia}),b=this.openDownloadedFile;break;case l.STAGE.FETCHING:E=o.createElement(g.PendingCancel,null),b=this.cancelDownload;break;case l.STAGE.NEED_POKE:case l.STAGE.INIT:E=o.createElement(g.Download,{onClick:this.downloadMedia}),b=this.downloadToBlob;break;case l.STAGE.UPLOADING:E=o.createElement(g.PendingCancel,null),b=this.cancelUpload;break;case l.STAGE.NEED_UPLOAD:E=o.createElement(g.Upload,null),b=this.resumeUpload;break;case l.STAGE.REMOTE_NEED_UPLOAD:E=o.createElement(g.Upload,null),b=this.resumeRemoteUpload;break;case l.STAGE.ERROR_MISSING:b=this.showMediaMissing;break;default:E=o.createElement(g.Pending,null)}return o.createElement("div",{className:a},s,this.props.quotedMsg,o.createElement("div",{className:"document-container",onClick:b,title:l10n.t("web_download_document",{name:y})},v,o.createElement("div",{className:"document-body"},o.createElement("div",{className:"document-icon"},o.createElement("div",{className:m})),o.createElement("div",{className:"document-text"},o.createElement(p,{text:y,ellipsify:!0,selectable:!1,dirMismatch:n.rtl!==l10n.isRTL(),direction:"auto"})),E)),o.createElement("div",{className:"document-meta"},e,d,f),o.createElement(u,{msg:n}))}});e.exports=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(1324),c=o.createClass({displayName:"FailedMsgIcon",propTypes:{onResend:o.PropTypes.func.isRequired,errMsg:o.PropTypes.string.isRequired},getInitialState:function(){return{hover:!1}},onMouseEnter:function(){this.setState({hover:!0})},onMouseLeave:function(){this.setState({hover:!1})},render:function(){var e=o.createElement("span",null,this.props.errMsg),t=this.state.hover?o.createElement(s,{direction:"left",className:"tooltip-error",body:e}):null;return o.createElement(a["default"],{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,className:"icon-error-container"},t,o.createElement("button",{className:"error",onClick:this.props.onResend},o.createElement("span",{className:"icon icon-error"})))}});e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(37),c=n(1230),l=n(145),u=n(1241),d=n(1300),p=n(44),h=n(8),f=n(432),m=n(1266),g=n(1244),v=n(1277),y=n(1243),E=n(1229),b=n(1326),w=n(104),M=n(10),C=n(1236),S=n(14),T=2.4,k=336,x=k/T,N=3,P=6,O=o.createClass({displayName:"Gif",mixins:[c,l,C],propTypes:{msg:o.PropTypes.instanceOf(E).isRequired,quotedMsg:o.PropTypes.element,isMsgVisible:o.PropTypes.func,displayType:o.PropTypes.oneOf(_.values(M.DISP_TYPE)),displayAuthor:o.PropTypes.bool},getInitialState:function(){return this.playCount=0,{mediaStage:this.async("msg.mediaData.mediaStage"),playing:!1}},componentDidMount:function(){this.props.msg.downloadMedia()},pause:function(){this.playCount=0,this._pause()},play:function(e){var t=this;this.props.msg.mediaData.mediaStage===g.STAGE.RESOLVED&&this.refs.player&&(e&&e.stopPropagation(),new a["default"](function(e){if(_.isUndefined(t.duration)){var n=s.findDOMNode(t.refs.player);n.readyState>0?(t.duration=n.duration,e(n.duration)):n.addEventListener("canplay",function(){t.duration=n.duration,e(n.duration)})}else e(t.duration)}).checkpoint(this.rejectOnUnmount()).then(function(e){t.setState({playing:!0});var n=Math.ceil(P/e);t.playCount=Math.max(n,N),t._play()})["catch"](S.Unmount,_.noop))},_pause:function(){if(this.setState({playing:!1}),this.refs.player){var e=s.findDOMNode(this.refs.player);e&&(e.currentTime=0,e.paused||e.pause())}},_play:function(){if(this.refs.player){if(!this.playCount)return this.pause();this.playCount-=1;var e=s.findDOMNode(this.refs.player);e&&e.paused&&e.play()}},getStyle:function(){var e=this.props.msg.mediaData,t=e.thumbWidth||1,n=e.thumbHeight||1,r=void 0,i=void 0,a=this.aspect(t,n);a?a<1/T?(i=k,r=x):a<1?(i=k,r=t*i/n):a<T?(r=k,i=n*r/t):(r=k,i=x):(i="100%",r=k);var o=e.renderableUrl?e.fullWidth||t:t,s=e.renderableUrl?e.fullHeight||n:n;return a?o/s>r/i?(o=o*i/s,s=i):(s=s*r/o,o=r):(o=k,s="100%"),{bubbleWidth:r,bubbleHeight:i,contentWidth:o,contentHeight:s}},aspect:function(e,t){if(e&&t)return e/t},showMediaMissing:function(){h.openModal(o.createElement(f,{title:l10n.t("missing_photo_title"),onOK:h.closeModal.bind(h),okText:l10n.t("web_ok")},l10n.t("missing_photo_text")))},getZoomNode:function(e){var t=this.props.isMsgVisible(e);if(t&&t.getImgNode)return t.getImgNode()},launchMediaViewer:function(e){e&&e.stopPropagation();var t=this.props,n=t.msg,r=t.isMsgVisible;h.mediaViewerModal(n,r?this.getZoomNode:_.noop)},downloadMedia:function(){this.props.msg.forceDownloadMedia()},cancelDownload:function(){this.props.msg.cancelDownload()},cancelUpload:function(){this.props.msg.cancelUpload()},resumeUpload:function(){this.props.msg.resumeUpload()},resumeRemoteUpload:function(){w.supportsFeature(w.F.MEDIA_RETRY)?this.props.msg.resumeRemoteUpload():h.openModal(o.createElement(m,{msg:this.props.msg}))},onDragStart:function(e){e.nativeEvent.dataTransfer.setData(M.DRAG_TYPE_LOCAL_IMAGE,!0)},stopEvent:function(e){e.stopPropagation()},getImgNode:function(){if(this.refs.player)return s.findDOMNode(this.refs.player)},render:function(){var e=this.props.msg,t=e.mediaData,n=e.caption?o.createElement(d,{msg:e}):null,r=n?null:o.createElement("div",{className:"shade"}),i="data:image/jpeg;base64,"+t.preview,a=null,s=null,c=null,l=null,h=this.getStyle(),f=h.bubbleWidth,m=h.bubbleHeight,_=h.contentWidth,w=h.contentHeight,M={width:f,height:m};switch(t.mediaStage){case g.STAGE.RESOLVED:this.state.playing||(l=o.createElement("span",{className:"image-gif-control",onClick:this.play},o.createElement("button",{className:"icon icon-media-gif"}))),c=o.createElement(b,{msg:e,poster:i,ref:"player",className:"image-thumb-body",width:_,height:w,onEnded:this._play,muted:!0},l10n.t("video_playback_not_supported")),s=this.launchMediaViewer;break;case g.STAGE.INIT:s=this.launchMediaViewer;break;case g.STAGE.FETCHING:a=o.createElement(v.PendingCancel,null),s=this.cancelDownload;break;case g.STAGE.NEED_POKE:a=o.createElement(v.Download,{filesize:t.size}),s=this.downloadMedia;break;case g.STAGE.UPLOADING:a=o.createElement(v.PendingCancel,null),s=this.cancelUpload;break;case g.STAGE.NEED_UPLOAD:a=o.createElement(v.Upload,{filesize:t.size}),s=this.resumeUpload;break;case g.STAGE.REMOTE_NEED_UPLOAD:a=o.createElement(v.Upload,{filesize:t.size}),s=this.resumeRemoteUpload;break;case g.STAGE.ERROR_MISSING:s=this.showMediaMissing;break;default:a=o.createElement(v.Pending,null)}c||(c=o.createElement("div",{className:"image-thumb-body image-thumb-gif",style:{backgroundImage:"url("+i+")"}}));var C=p("bubble-image",{"bubble-image-caption":e.caption,"bubble-broadcast":e.caption&&e.broadcast,"bubble-star":e.caption&&e.star}),S=this.props.displayAuthor&&u.shouldRender(e)?o.createElement(u,{msg:e}):null,T=void 0;switch(e.gifAttribution){case E.GIF_ATTRIBUTION.GIPHY:T=o.createElement("span",{className:"icon-gif-vendor icon icon-giphy"});break;case E.GIF_ATTRIBUTION.TENOR:T=o.createElement("span",{className:"icon-gif-vendor icon icon-tenor"});break;default:T=null}return o.createElement("div",{className:C,onClick:this.stopEvent,style:{width:M.width}},S,this.props.quotedMsg,o.createElement("div",{className:"image-thumb",onClick:s,style:M},l,a,c,r,T),n,o.createElement(y,{msg:this.props.msg}))}});e.exports=O},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1253),a=r(i),o=n(6),s=n(447),c=n(1288),l=n(436),u=l.emojiMap,d=l.getEmojiPath,p=n(141),h=n(10),f=h.ONE_BY_ONE_TRANS_GIF,m=n(44),g={LARGE:"large",XLARGE:"xlarge"},v=o.createClass({displayName:"LargeEmoji",mixins:[p],propTypes:{emoji:o.PropTypes.string.isRequired,emojiSize:o.PropTypes.oneOf(_.values(g)),animation:o.PropTypes.bool},statics:{EMOJI_SIZE:g},getInitialState:function(){return{assetLoaded:!1}},onAssetLoaded:function(){this.setState({assetLoaded:!0})},getDefaultProps:function(){return{emojiSize:g.LARGE,animation:!1}},onCopy:function(e){if(e.clipboardData){var t=window.getSelection();e.clipboardData.setData("text/plain",c.asPlainText(t))}e.stopPropagation(),e.preventDefault()},render:function(){var e=u[this.props.emoji];if(!e)return null;var t=d(e,this.props.emojiSize)[s.currentRes],n=void 0;return n=this.state.assetLoaded?m("large-emoji","selectable-text",{"heart-animation":this.props.animation}):m("emoji","emoji"+e,"selectable-text"),this.props.animation&&this.state.assetLoaded?o.createElement("div",{className:"large-emoji-container",onCopy:this.onCopy},o.createElement("img",{className:"large-emoji selectable-text image",src:f,alt:this.props.emoji}),o.createElement(a["default"],{className:"large-emoji heart-animation container",draggable:!1,src:t})):o.createElement("div",{className:"large-emoji-container",onCopy:this.onCopy},o.createElement(a["default"],{draggable:!1,onLoad:this.onAssetLoaded,alt:this.props.emoji,src:t,className:n}))}});e.exports=v},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(88),o=n(1137),s=n(44),c={LINK:"link",GROUP_INVITE:"group_invite"},l=r.createClass({displayName:"LinkPreview",mixins:[o],propTypes:{msg:r.PropTypes.instanceOf(i).isRequired,type:r.PropTypes.oneOf(_.values(c)).isRequired},getDefaultProps:function(){return{type:c.LINK}},render:function(){var e=this.props,t=e.msg,n=e.type,i=void 0;if(t.thumbnail){var o=s({"link-preview-media":n===c.LINK,"group-invite-preview":n===c.GROUP_INVITE});i=r.createElement("img",{className:o,src:"data:image/jpeg;base64,"+t.thumbnail})}var l=t.title?r.createElement("div",{className:"link-preview-title",title:t.title},t.title):null,u=t.description?r.createElement("div",{className:"link-preview-description",title:t.description},t.description):null,d=s("link-preview-body",{nothumb:!i}),p=n===c.LINK?r.createElement("div",{className:"link-preview-source ellipsify"},a.hostname(t.canonicalUrl||t.matchedText)):null,h=function(e){var n=document.createElement("a");n.href=t.matchedText,n.target="_blank",document.body.appendChild(n),n.click(),document.body.removeChild(n)};return r.createElement("div",{className:"link-preview-container",onClick:h},i,r.createElement("div",{className:d},l,u,p))}});l.Type=c,e.exports=l},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(44),o={FRONT:"front",MID:"mid",END:"end",SINGLE:"single"},s=r.createClass({displayName:"Menu",propTypes:{msg:r.PropTypes.instanceOf(i).isRequired,position:r.PropTypes.oneOf(_.values(o)).isRequired,onClick:r.PropTypes.func,isFocusedMsg:r.PropTypes.bool},click:function(){this.refs.context.click()},render:function(){var e=this.props,t=e.msg,n=e.position,s=e.onClick,c=t.isMedia,l=t.isSentByMe,u=t.isGroupMsg,d=t.type,p=!!t.quotedMsg,h=l?"context-out":"context-in",f=t.type===i.TYPE.DOCUMENT&&!t.body,m=t.type===i.TYPE.DOCUMENT&&t.body,g=d===i.TYPE.LOCATION;c=c||m||g||p;var v;u&&(v=!l&&(n===o.FRONT||n===o.SINGLE),c=c&&!v);var y=d===i.TYPE.CHAT&&t.matchedText&&t.matchedText.length&&t.body.indexOf(t.matchedText)>-1&&!v&&t.isTrusted(),_=a("js-context-icon",c?"context-icon-media":"context-icon"),E=a(h,{context:!(c||y),"context-media":c,"context-media-document":m,"context-ptt":d===i.TYPE.PTT&&!p,"context-ptt-author":d===i.TYPE.PTT&&v&&!p,"context-special":(y||f)&&!v&&!p,"context-doc":f&&!v&&!p});return r.createElement("div",{className:E},r.createElement("div",{className:_,ref:"context",onClick:s}))}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1424),a=r.createClass({displayName:"MultiEmoji",propTypes:{emojis:r.PropTypes.array.isRequired,animation:r.PropTypes.bool},getDefaultProps:function(){return{animation:!1}},render:function(){var e=this,t=this.props.emojis,n=_.size(t);if(0===n)return null;var a=1===n?i.EMOJI_SIZE.XLARGE:i.EMOJI_SIZE.LARGE,o=t.map(function(t,n){return r.createElement(i,{animation:e.props.animation,emoji:t,key:t+n,emojiSize:a})});return r.createElement("span",{className:"large-emoji-wrapper"},o)}});e.exports=a},function(e,t,n){"use strict";var r=n(6),i=n(44),a=n(1241),o=n(1358),s=n(1250),c=n(1282),l=n(1243),u=n(1232),d=n(1229),p=n(8),h=n(1485),f=r.createClass({displayName:"VCardList",propTypes:{msg:r.PropTypes.instanceOf(d).isRequired,quotedMsg:r.PropTypes.node,displayAuthor:r.PropTypes.bool},getDefaultProps:function(){return{quotedMsg:null,displayAuthor:!1}},_showContactsModal:function(){p.openModal(r.createElement(h,{msg:this.props.msg}))},_renderProfilePics:function(){for(var e=_(this.props.msg.vcardList).map(function(e,t){var n=s.thumbnailWAid(s.vcardWAids(s.parse(e.vcard))),i=s.thumbnail(e.vcard);if(n||i)return r.createElement(c,{key:t,waid:n,thumb:i,className:"preview-vcard-multi preview-vcard",size:c.Size.NONE})}).filter().take(3).value(),t=Math.min(3-e.length,this.props.msg.vcardList.length-e.length),n=0;n<t;n++)e.push(r.createElement(c,{key:"default-"+n,className:"preview-vcard-multi preview-vcard",size:c.Size.NONE}));return e},render:function(){var e=this.props.msg,t=this.props.quotedMsg,n=i(["bubble","bubble-vcard"],{"bubble-attach-caption":!!e.caption}),s="vcard-avatar";t&&(s=i(s,"quoted-msg-bubble-vcard"));var d=this.props.displayAuthor&&a.shouldRender(e)?r.createElement(a,{msg:e}):null,p=null,h=o.getNameString(e.vcardList),f=t?r.createElement(c,{className:"preview-vcard",size:c.Size.NONE}):this._renderProfilePics();return r.createElement("div",{className:n},d,t,r.createElement("div",{className:"wrapper wrapper-vcard wrapper-vcard-multi",title:h,onClick:this._showContactsModal},r.createElement("div",{className:"vcard"},r.createElement("div",{className:s},f),r.createElement("div",{className:"vcard-body"},r.createElement(u,{text:h,element:"div",className:"vcard-name vcard-name-multi",dirMismatch:e.rtl!==l10n.isRTL(),direction:e.dir,wbr:15})))),p,r.createElement(l,{
msg:e,contextMenu:this.contextMenu}))}});e.exports=f},function(e,t,n){"use strict";var r=n(6),i=n(1246),a=n(1232),o=n(1137),s=n(8),c=n(1474),l=n(1229),u=r.createClass({displayName:"Notification",mixins:[o],propTypes:{text:r.PropTypes.string.isRequired,e2eSubtype:r.PropTypes.string,participantJid:r.PropTypes.string,chatId:r.PropTypes.string},onSecurityClick:function(){s.openModal(r.createElement(c,{e2eSubtype:this.props.e2eSubtype,jid:this.props.participantJid,chatId:this.props.chatId}))},render:function(){var e=this.props.type===l.TYPE.CALL_LOG?r.createElement("span",{className:"icon icon-missed"}):null,t=r.createElement(i,null,e,r.createElement(a,{direction:"auto",text:this.props.text})),n=!!this.props.e2eSubtype,o=n?r.createElement("button",{className:"message-system-e2e",onClick:this.onSecurityClick},t):r.createElement("span",{className:"message-system-body"},t);return o}});e.exports=u},function(e,t,n){"use strict";function r(e,t){if(!e||!t)return b;var n=e/t,r=void 0;return r=n<=1?b:n<=2.4?t*(E/e):E/2.4,Math.round(r)}function i(e,t,n,r){return e&&t&&n&&r?t/e>r/n?{height:"100%"}:{width:"100%"}:{height:"100%",width:"100%"}}var a=n(6),o=n(1230),s=n(1241),c=n(1300),l=n(44),u=n(8),d=n(1264),p=n(1266),h=n(1244),f=n(1277),m=n(1243),g=n(1229),v=n(104),y=n(10),E=330,b=330,w=a.createClass({displayName:"Picture",mixins:[o],propTypes:{msg:a.PropTypes.instanceOf(g).isRequired,quotedMsg:a.PropTypes.element,isMsgVisible:a.PropTypes.func,displayAuthor:a.PropTypes.bool},getInitialState:function(){return{mediaStage:this.async("msg.mediaData.mediaStage")}},componentDidMount:function(){this.props.msg.downloadMedia()},showMediaMissing:function(){u.openModal(a.createElement(d,{msg:this.props.msg}))},getZoomNode:function(e){var t=this.props.isMsgVisible(e);if(t&&t.getImgNode)return t.getImgNode()},launchMediaViewer:function(e){e&&e.stopPropagation();var t=this.props,n=t.msg,r=t.isMsgVisible;u.mediaViewerModal(n,r?this.getZoomNode:_.noop)},downloadMedia:function(){this.props.msg.forceDownloadMedia()},cancelDownload:function(){this.props.msg.cancelDownload()},cancelUpload:function(){this.props.msg.cancelUpload()},resumeUpload:function(){this.props.msg.resumeUpload()},resumeRemoteUpload:function(){v.supportsFeature(v.F.MEDIA_RETRY)?this.props.msg.resumeRemoteUpload():u.openModal(a.createElement(p,{msg:this.props.msg}))},onDragStart:function(e){e.nativeEvent.dataTransfer.setData(y.DRAG_TYPE_LOCAL_IMAGE,!0)},stopEvent:function(e){e.stopPropagation()},getImgNode:function(){return this.refs.img},render:function(){var e=this.props.msg,t=e.mediaData,n=e.caption?null:a.createElement("div",{className:"shade"}),o=e.caption?a.createElement(c,{msg:e}):null,u=t.renderableUrl||"data:image/jpeg;base64,"+t.preview,d=null,p=null;switch(t.mediaStage){case h.STAGE.RESOLVED:p=this.launchMediaViewer;break;case h.STAGE.FETCHING:d=a.createElement(f.PendingCancel,null),p=this.cancelDownload;break;case h.STAGE.NEED_POKE:d=a.createElement(f.Download,{filesize:t.size}),p=this.downloadMedia;break;case h.STAGE.UPLOADING:d=a.createElement(f.PendingCancel,null),p=this.cancelUpload;break;case h.STAGE.NEED_UPLOAD:d=a.createElement(f.Upload,{filesize:t.size}),p=this.resumeUpload;break;case h.STAGE.REMOTE_NEED_UPLOAD:d=a.createElement(f.Upload,{filesize:t.size}),p=this.resumeRemoteUpload;break;case h.STAGE.ERROR_MISSING:p=this.showMediaMissing;break;case h.STAGE.ERROR_UNSUPPORTED:d=a.createElement(f.Download,{filesize:t.size}),p=this.launchMediaViewer;break;default:d=a.createElement(f.Pending,null)}var g=l("bubble-image",{"bubble-image-caption":e.caption,"bubble-broadcast":e.caption&&e.broadcast,"bubble-star":e.caption&&e.star}),v=l("image-thumb-body",{"image-thumb-lores":!t.renderableUrl}),y=this.props.displayAuthor&&s.shouldRender(e)?a.createElement(s,{msg:e}):null,_=E,b=r(t.thumbWidth,t.thumbHeight),w={width:_,height:b},M=t.fullHeight||t.thumbHeight,C=t.fullWidth||t.thumbWidth,S=i(M,C,b,_);return a.createElement("div",{className:g,onClick:this.stopEvent},y,this.props.quotedMsg,a.createElement("div",{className:"image-thumb",onClick:p,style:w},d,a.createElement("img",{src:u,onDragStart:this.onDragStart,className:v,style:S,ref:"img"}),n),o,a.createElement(m,{msg:e}))}});e.exports=w},function(e,t,n){"use strict";var r=n(6),i=n(10),a=n(1229),o=n(1230),s=n(1243),c=n(1241),l=n(1332),u=n(1432),d=n(1266),p=n(8),h=n(104),f=n(1244),m=n(1264),g=n(144),v=r.createClass({displayName:"PTT",mixins:[o],propTypes:{msg:r.PropTypes.instanceOf(a).isRequired,quotedMsg:r.PropTypes.element,displayAuthor:r.PropTypes.bool},getInitialState:function(){return this.asyncState({mediaStage:"msg.mediaData.mediaStage",img:"msg.sender.ProfilePicThumb.img",ack:"msg.ack"},{currentTime:0,playing:!1,autoPlay:!1})},componentDidMount:function(){this.props.msg.downloadMedia()},showMediaMissing:function(){p.openModal(r.createElement(m,{msg:this.props.msg}))},downloadMedia:function(){this.props.msg.forceDownloadMedia()},cancelDownload:function(){this.props.msg.cancelDownload()},cancelUpload:function(){this.props.msg.cancelUpload()},resumeUpload:function(){this.props.msg.resumeUpload()},resumeRemoteUpload:function(){h.supportsFeature(h.F.MEDIA_RETRY)?this.props.msg.resumeRemoteUpload():p.openModal(r.createElement(d,{msg:this.props.msg}))},handleTimeUpdate:function(e){this.setState({currentTime:e})},handlePlayingUpdate:function(e){this.setState({autoPlay:!1,playing:e})},loader:function(e,t,n){return n=n?r.createElement(g,{stroke:3,size:38}):null,r.createElement("div",{className:"audio"},r.createElement("div",{className:"audio-controls"},r.createElement("button",{className:"btn-audio "+(t?"icon "+t:""),onClick:e},n)),r.createElement("div",{className:"audio-body"},r.createElement("input",{type:"range",className:"audio-track",min:0,max:100,value:0,disabled:"disabled"})))},getStatusClass:function(e){return e+=" audio-state-default",this.state.ack===i.ACK_PLAYED&&(e+=" audio-state-played"),e},render:function(){var e=this.props.msg,t=e.mediaData,n=this.getStatusClass("bubble bubble-attach bubble-audio"),a="audio-status icon ";a+=this.state.ack===i.ACK_PLAYED?e.isSentByMe?"icon-ptt-out-blue":"icon-ptt-in-blue":e.isSentByMe?"icon-ptt-out-gray":"icon-ptt-in-green";var o,d=r.createElement("span",{className:a,key:"status"}),p=this.state.playing?this.state.currentTime:t.duration,h=r.createElement(l,{key:"image",className:this.props.quotedMsg?"quoted-msg-bubble-ptt":null,thumb:this.state.img,type:t.type,shade:!1,duration:p}),m=e.isSentByMe?[h,d]:null,g=e.isSentByMe?null:[h,d],v=e.isSentByMe?"text no-author":"text";switch(t.mediaStage){case f.STAGE.RESOLVED:o=r.createElement(u,{msg:e,autoPlay:this.state.autoPlay,onPlayingUpdate:this.handlePlayingUpdate,onTimeUpdate:this.handleTimeUpdate});break;case f.STAGE.NEED_POKE:o=this.loader(this.downloadMedia,"icon-audio-download");break;case f.STAGE.NEED_UPLOAD:o=this.loader(this.resumeUpload,"icon-audio-upload");break;case f.STAGE.REMOTE_NEED_UPLOAD:o=this.loader(this.resumeRemoteUpload,"icon-audio-upload");break;case f.STAGE.ERROR_MISSING:o=this.loader(this.showMediaMissing,"icon-audio-play");break;default:o=this.loader(null,null,!0)}var y=this.props.displayAuthor&&c.shouldRender(e)?r.createElement(c,{msg:e,className:this.props.quotedMsg?"quoted-msg-bubble-ptt-author":null}):null;return r.createElement("div",{className:n},this.props.quotedMsg?y:null,this.props.quotedMsg,r.createElement("div",{className:"wrapper"},m,r.createElement("div",{className:"contents"},this.props.quotedMsg?null:y,r.createElement("div",{className:v},o)),g,r.createElement(s,{msg:e})))}});e.exports=v},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(10),o=n(1229),s=n(142),c=n(1315),l=r.createClass({displayName:"PTTPlayer",mixins:[s],propTypes:{msg:r.PropTypes.instanceOf(o).isRequired,autoPlay:r.PropTypes.bool.isRequired,onPlayingUpdate:r.PropTypes.func.isRequired,onTimeUpdate:r.PropTypes.func.isRequired},playing:!1,dragging:!1,getInitialState:function(){return{progress:0}},onPlayClick:function(){var e=i.findDOMNode(this.refs.audio);this.playing?e.pause():e.play()},onPlaying:function(){this.playing=!0;var e=this.props.msg;!e.get("isSentByMe")&&e.get("ack")<a.ACK_PLAYED&&e.sendPlayed(),this.props.onPlayingUpdate&&this.props.onPlayingUpdate(this.playing)},onPause:function(){this.playing=!1,this.props.onPlayingUpdate&&this.props.onPlayingUpdate(this.playing)},onEnded:function(){var e=i.findDOMNode(this.refs.audio);e.currentTime=0,e.load()},onTimeUpdate:function(){var e=i.findDOMNode(this.refs.audio),t=0;_.isFinite(e.duration)&&(t=Math.round(100*Math.min(1,e.currentTime/e.duration)),this.props.onTimeUpdate&&this.props.onTimeUpdate(e.currentTime)),this.setState({progress:t})},componentDidMount:function(){var e=i.findDOMNode(this.refs.audio);this.regNativeListener(e,"playing",this.onPlaying),this.regNativeListener(e,"pause",this.onPause),this.regNativeListener(e,"ended",this.onEnded),this.regNativeListener(e,"timeupdate",this.onTimeUpdate),this.regNativeListener(e,"durationchange",this.onTimeUpdate),this.regNativeListener(e,"progress",this.onTimeUpdate)},onDrag:function(e){var t=i.findDOMNode(this.refs.audio),n=e.target.value;this.setState({progress:n}),t.duration&&(t.currentTime=t.duration/100*n)},onPlayerError:function(e){},render:function(){var e="btn-audio icon ";e+=this.playing?"icon-audio-pause":"icon-audio-play";var t={width:this.state.progress-this.state.progress/100*3+"%"};return r.createElement("div",{className:"audio"},r.createElement("div",{className:"audio-controls"},r.createElement("button",{ref:"play_pause",className:e,onClick:this.onPlayClick})),r.createElement("div",{className:"audio-body"},r.createElement("div",{className:"audio-track-container"},r.createElement("span",{className:"audio-progress",style:t}),r.createElement("input",{type:"range",className:"audio-track",value:this.state.progress,onChange:this.onDrag,min:"0",max:"100"}))),r.createElement(c,{ref:"audio",msg:this.props.msg,preload:"auto",onError:this.onPlayerError,autoPlay:this.props.autoPlay}))}});e.exports=l},function(e,t,n){"use strict";var r=n(6),i=n(1229),a=n(1230),o=r.createClass({displayName:"Status",mixins:[a],propTypes:{msg:r.PropTypes.instanceOf(i).isRequired},getInitialState:function(){var e=this.props.msg;return{ack:e.ack<3?this.async("msg.ack"):e.ack}},getStatus:function(){var e=this.props.msg,t="icon",n=e.ack;return t+=n<1?" icon-msg-time":1===n?" icon-msg-check":2===n?" icon-msg-dblcheck":" icon-msg-dblcheck-ack",(e.isMedia&&!e.caption||e.type===i.TYPE.LOCATION&&!e.get("loc"))&&(t+="-light"),t},render:function(){return r.createElement("span",{onClick:this.openInfoDrawer,className:this.getStatus()})}});e.exports=o},function(e,t,n){"use strict";var r=n(6),i=n(1246),a=n(1232),o=n(106),s=r.createClass({displayName:"StickyDateMarker",proptypes:{},getInitialState:function(){return{date:null,hide:!1}},updateDateMarkerText:function(e){this.setState({date:e})},hideStickyDateMarker:function(e){this.state.hide!==e&&this.setState({hide:e})},render:function(){var e=void 0;return this.state.date&&!this.state.hide&&(e=r.createElement("div",{className:"msg sticky-date-marker-floating-container"},r.createElement("div",{className:"sticky-date-marker-floating-wrapper"},r.createElement("span",{className:"message-system-body"},r.createElement(i,null,r.createElement(a,{direction:"auto",text:this.state.date})))))),r.createElement(o,{transitionName:"slide-down-date"},e)}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1241),a=n(1243),o=n(1425),s=n(1329),c=n(1229),l=n(1232),u=n(44),d=n(1137),p=n(223),h=n(440),f=n(1427),m=n(436),g=r.createClass({displayName:"Text",mixins:[d],propTypes:{msg:r.PropTypes.instanceOf(c).isRequired,quotedMsg:r.PropTypes.element,senderName:r.PropTypes.string,displayAuthor:r.PropTypes.bool,trusted:r.PropTypes.bool},render:function(){var e=this.props,t=e.msg,n=e.displayAuthor,c=e.trusted,d=n&&i.shouldRender(t),g=u("bubble","bubble-text",{"bubble-broadcast":t.broadcast,"bubble-star":t.star,"has-author":d}),v=d?r.createElement(i,{msg:t,className:this.props.quotedMsg?"text-author-quoted-msg":null}):null,y=void 0,_=void 0;if(c&&t.linkPreview){var E=p.parseInviteLink(t.matchedText);if(E){y=r.createElement(o,{msg:t,type:o.Type.GROUP_INVITE});var b=function(e){var n=document.createElement("a");n.href=t.matchedText,n.target="_blank",document.body.appendChild(n),n.click(),document.body.removeChild(n)},w=t.isSentByMe?h.t("group_invite_view"):h.t("group_invite_join");_=r.createElement("div",{className:"bubble-actions"},r.createElement("div",{className:"bubble-btn",onClick:b,title:w},w))}else y=r.createElement(o,{msg:t})}var M=void 0,C=void 0,S=t.mentionMap(),T=m.getMatchedEmojis(t.body);if(T){M=u("message-text","large-emoji-text",{"one-emoji-text":1===T.length,"two-emoji-text":2===T.length,"three-emoji-text":3===T.length});var k="❤"===T[0];C=r.createElement(f,{animation:k,emojis:T})}else M=u("message-text"),C=r.createElement(l,{text:t.body,selectable:!0,dirMismatch:t.rtl!==h.isRTL(),direction:t.dir,linkify:c,mention:S,format:!0,wbr:15});return r.createElement("div",{className:g},v,this.props.quotedMsg,r.createElement("div",{className:M,"data-id":t.id},y,r.createElement(s,{msg:t}),C),r.createElement(a,{msg:t}),_)}});e.exports=g},function(e,t,n){"use strict";var r=n(6),i=n(1246),a=r.createClass({displayName:"Unread",propTypes:{count:r.PropTypes.number.isRequired},render:function(){var e=l10n.t("unread_message_count",{count:l10n.n(this.props.count),_plural:this.props.count});return r.createElement("span",{className:"msg-unread-body"},r.createElement(i,null,e))}});e.exports=a},function(e,t,n){"use strict";var r=n(1229),i=n(6),a=n(1243),o=n(1241),s=n(44),c=i.createClass({displayName:"UnsupportedMsg",propTypes:{msg:i.PropTypes.instanceOf(r).isRequired,displayAuthor:i.PropTypes.bool},render:function(){var e=this.props.msg,t=this.props.displayAuthor&&o.shouldRender(e),n=t?i.createElement(o,{msg:e}):null,r=s("bubble bubble-placeholder",{"has-author":t}),c="message-text";return i.createElement("div",{className:r},n,i.createElement("div",{className:"icon icon-unknown placeholder-icon"}),i.createElement("div",{className:c},i.createElement("span",null,i.createElement("span",{className:"placeholder-msg"},e.isSentByMe?l10n.t("unsupported_msg_send"):l10n.t("unsupported_msg")))),i.createElement(a,{msg:e}))}});e.exports=c},function(e,t,n){"use strict";var r=n(6),i=n(44),a=n(1241),o=n(1243),s=n(1229),c=n(8),l=n(1250),u=n(1232),d=n(1282),p=n(141),h=n(1494),f=n(1445),m=n(1470),g=r.createClass({displayName:"Vcard",mixins:[p],propTypes:{msg:r.PropTypes.instanceOf(s).isRequired,quotedMsg:r.PropTypes.element,displayAuthor:r.PropTypes.bool},onMessageClick:function(){var e=this.props.msg.getWAids();e.length>1?c.openModal(r.createElement(h,{vCard:this.props.msg.vcard,onCancel:c.closeModal.bind(c),onSelect:this.openContactChat})):this.openContactChat(_.first(e))},openContactChat:function(e){Store.Chat.find(e).then(function(e){c.closeModal(),c.openChatFromUnread(e).then(function(t){t&&c.focusChatTextInput(e)})})},viewContact:function(){c.openModal(r.createElement(m,{msg:this.props.msg}))},onAddToGroupClick:function(){var e=this.props.msg.getWAids();e.length>1?c.openModal(r.createElement(h,{vCard:this.props.msg.vcard,onCancel:c.closeModal.bind(c),onSelect:this.addContactToGroup,iconClass:"icon icon-add-user"})):this.addContactToGroup(_.first(e))},addContactToGroup:function(e){Store.Contact.find(e).then(function(e){c.openModal(r.createElement(f,{contact:e}),"modal-flow")})},render:function(){var e=this.props.msg,t=e.getWAids(),n="vcard-avatar";this.props.quotedMsg&&(n=i(n,"quoted-msg-bubble-vcard"));var s=i(["bubble","bubble-vcard"],{"bubble-attach-caption":!!e.caption}),c=void 0;t.length>0&&(c=r.createElement("div",{className:"bubble-actions"},r.createElement("div",{className:"bubble-btn",onClick:this.onMessageClick,title:l10n.t("message_author",{author:e.subtype})},l10n.t("message")),r.createElement("div",{className:"bubble-btn",onClick:this.onAddToGroupClick,title:l10n.t("add_contact_to_group")},l10n.t("add_contact_to_group"))));var p=this.props.displayAuthor&&a.shouldRender(e)?r.createElement(a,{msg:e}):null;return r.createElement("div",{className:s},p,this.props.quotedMsg,r.createElement("div",{className:"wrapper wrapper-vcard",onClick:this.viewContact},r.createElement("div",{className:"vcard"},r.createElement(d,{className:n,thumb:l.thumbnail(e.body),waid:e.getVCardThumbnailWAid()}),r.createElement("div",{className:"vcard-body"},r.createElement(u,{text:e.subtype,element:"div",className:"vcard-name vcard-name-single",selectable:!0,dirMismatch:e.rtl!==l10n.isRTL(),direction:e.dir,wbr:15})))),c,r.createElement(o,{msg:e,contextMenu:this.contextMenu}))}});e.exports=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(37),g=n(1229),v=n(1420),y=n(1436),E=n(1283),b=n(44),w=n(143),M=n(1288),C=(n(1248),n(10)),S={KEEP_SCROLL_BOTTOM:"KEEP_SCROLL_BOTTOM",KEEP_SCROLL_TOP:"KEEP_SCROLL_TOP",SCROLL_BOTTOM:"SCROLL_BOTTOM",NONE:"NONE",DEFAULT:"DEFAULT"},T={};T[S.KEEP_SCROLL_BOTTOM]=2,T[S.KEEP_SCROLL_TOP]=2,T[S.SCROLL_BOTTOM]=2,T[S.NONE]=1,T[S.DEFAULT]=0;var k=function(e){function t(e){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).call(this,e))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"shouldComponentUpdate",value:function(e){return e.updateType!==S.NONE}},{key:"componentWillUpdate",value:function(e){var t=m.findDOMNode(this).parentNode,n=e.updateType;n===S.KEEP_SCROLL_BOTTOM?this.shouldRestoreScroll=t.scrollHeight-t.scrollTop-t.clientHeight:n===S.KEEP_SCROLL_TOP&&(this.shouldRestoreScroll=t.scrollTop)}},{key:"componentDidMount",value:function(){this.maybeNotifyChatRendered()}},{key:"componentDidUpdate",value:function(e){var t=m.findDOMNode(this).parentNode;this.props.updateType===S.SCROLL_BOTTOM?t.scrollTop=t.scrollHeight:void 0!==this.shouldRestoreScroll&&(this.props.updateType===S.KEEP_SCROLL_BOTTOM?t.scrollTop=t.scrollHeight-this.shouldRestoreScroll-t.clientHeight:t.scrollTop=this.shouldRestoreScroll,this.shouldRestoreScroll=void 0),this.maybeNotifyChatRendered()}},{key:"maybeNotifyChatRendered",value:function(){this.props.notifyChatRendered&&(this.props.focusedMsgCtx&&this.props.focusedMsgCtx.msg&&!_.includes(this.props.msgs,this.props.focusedMsgCtx.msg)||this.props.notifyChatRendered())}},{key:"onCopy",value:function(e){var t=window.getSelection();e.clipboardData.setData("text/plain",M.asPlainText(t)),e.stopPropagation(),e.preventDefault()}},{key:"getMsgVisibility",value:function(e){var t=m.findDOMNode(this).parentNode,n=t.scrollTop,r=n+t.clientHeight,i=m.findDOMNode(e);return i.offsetTop+i.clientHeight<=n?{visibility:C.VISIBILITY.ABOVE,offset:i.offsetTop-n}:i.offsetTop>=r?{visibility:C.VISIBILITY.BELOW,offset:i.offsetTop-n}:{visibility:C.VISIBILITY.VISIBLE,offset:i.offsetTop-n}}},{key:"render",value:function(){var e,t,n=[],r=this.props.msgs,i=this.props,a=i.focusedMsgCtx,o=i.unreadCount,s=i.selectedMessages,c=!1,l=void 0,u=0;for(t=0;t<r.length;t++)if(e=r[t]){var d=w.dayOfMsg(e);0!==t&&l===d||(n.push(f.createElement(v,{ref:"dateMarker_"+u,key:"msg-"+e.id+"-date",timestamp:e.t})),c=!1,u+=1),l=d,o>0&&a&&a.isUnreadDivider&&a.msg===e&&(n.push(f.createElement("div",{className:"msg-unread",key:"msg-unread"},f.createElement(y,{count:o}))),c=!1);var p=_.matches({from:e.from,startOfDay:e.startOfDay}),h=_.matches({author:e.author,startOfDay:e.startOfDay}),m=e.isGroupMsg?h:p,M=E.Position.SINGLE,S=r[t+1];(S&&o&&a&&a.isUnreadDivider&&a.msg===S||S&&S.isNotification||S&&d!==w.dayOfMsg(S))&&(S=!1),e.isNotification?M=E.Position.SINGLE:m(S)&&!m(c)?M=E.Position.FRONT:m(c)&&m(S)?M=E.Position.MID:m(c)&&!m(S)&&(M=E.Position.END);var T=a&&a.msg===e,k=e.type===g.TYPE.IMAGE||e.type===g.TYPE.VIDEO||e.type===g.TYPE.AUDIO;n.push(f.createElement(E,{key:"msg-"+e.id,ref:e.id.toString(),msg:e,displayType:C.DISP_TYPE.CONVERSATION,isMsgVisible:k?this.props.isMsgVisible:_.noop,selectable:this.props.selectable,selectedMessages:s,onMessageSelect:this.props.onMessageSelect,position:M,isFocusedMsg:T})),c=!e.isNotification&&e}var x=b("message-list",{selectable:this.props.selectable});return f.createElement("div",{className:x,onCopy:this.onCopy.bind(this)},n)}}]),t}(f.Component);k.UpdateTypes=S,k.UpdateTypePriority=T,e.exports=k},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1273),s=n(6),c=n(1),l=n(8),u=n(1231),d=n(1236),p=n(142),h=n(145),f=n(14),m=n(1263),g=n(1289),v=n(1542),y=n(0),E=n(218),b=n(106),w=s.createClass({displayName:"PTT",mixins:[h,p,d],propTypes:{chat:s.PropTypes.instanceOf(u),onStateChange:s.PropTypes.func.isRequired},statics:{READY:"ready",DELAY:"delay",REC:"recording",PROCESSSING:"processsing",GUM_TIMEOUT:"ptt_gum_timeout",PERMISSION_DENIED:"permission_denied",NOT_SUPPORTED_ERROR:"not_supported_error",MANDATORY_UNSATISFIED_ERROR:"mandatory_unsatisfied_error",CANCEL:"cancel",SEND:"send"},getInitialState:function(){return{state:w.READY,active:void 0,elapsedTime:0,startTime:0}},componentDidMount:function(){this.regNativeListener(window,"blur",this.cancelRecording)},isRecording:function(){var e=this.state.state;return e===w.REC||e===w.DELAY||e===w.PROCESSSING},cancelRecording:function(){this.isRecording()&&(this.state.state!==w.READY&&this.props.onStateChange(w.READY),this.safeIsMounted()&&this.setState({state:w.READY,active:void 0,elapsedTime:0,startTime:0}),this.clearSafeInterval(this.elapsedTimeInterval),delete this.elapsedTimeInterval,this.recorder&&this.recorder.stop(),this.props.chat.markPaused())},startInterval:function(){var e=this;this.elapsedTimeInterval=this.safeInterval(function(){e.setState({elapsedTime:e.state.elapsedTime+1})},1e3),this.setState({elapsedTime:0,startTime:Date.now()})},cancelPTTTimer:function(){this.pttTimer&&(this.clearSafeTimeout(this.pttTimer),delete this.pttTimer)},onPTTReady:function(){delete this.pttTimer,this.state.state===w.DELAY&&this.setState({state:w.REC})},onMouseOverSend:function(){this.setState({active:w.SEND})},onMouseOutSend:function(){this.setState({active:void 0})},onMouseOverCancel:function(){this.setState({active:w.CANCEL})},onMouseOutCancel:function(){this.setState({active:void 0})},onMouseUpCancel:function(){this.state.elapsedTime<1||(this.cancelPTTTimer(),this.cancelRecording())},onMouseUpSend:function(){var e=this;if(!(this.state.elapsedTime<1)){this.cancelPTTTimer();var t=this.props.chat;if(this.state.state===w.REC){this.setState({state:w.PROCESSSING}),this.props.onStateChange(w.READY);var n=t.regCancellablePromise(new a["default"](function(t,n){e.recorder.addEventListener("dataAvailable",function(e){t(e.detail)})}));(0,o.prepRawMedia)(n,{isPtt:!0,precomputedDuration:~~this.recorder.duration}).sendToChat(t,{quotedMsg:t.composeQuotedMsg||void 0,addEvenWhilePreparing:!0}),t.composeQuotedMsg=null,n["catch"](a["default"].CancellationError,_.noop)["finally"](function(){e.recorder.removeEventListener("dataAvailable"),e.cancelRecording()}),this.recorder.stop()}else this.cancelRecording(),c.log("ptt:onMouseUpSend duration too short")()}},onMouseDown:function(){var e=this;if(this.state.state===w.READY){var t=g.start("microphone");a["default"].race([t,this.rejectOnUnmount()]).checkpoint(this.rejectOnUnmount()).then(function(t){e.recorder=new v({bitRate:16e3,encoderSampleRate:16e3,encoderApplication:2048}),e.recorder.initStream(t),e.recorder.start(),e.props.chat.presence.update()["catch"](f.WapDrop,_.noop),e.props.chat.markRecording(),e.setState({state:w.DELAY}),e.props.onStateChange(w.REC),e.pttTimer=e.safeDelay(e.onPTTReady,1500),e.startInterval()})["catch"](f.Unmount,function(){t.then(function(e){return g.stop(e)})["catch"](_.noop)})["catch"](f.GUM.PermissionDeniedError,function(){l.openModal(s.createElement(m,{title:"guide_desktop_mic_title",desc:"guide_desktop_mic_fail_description",type:m.TYPE.GUIDE_UNBLOCK}))})["catch"](f.GUM.GUMError,function(){l.openModal(s.createElement(m,{title:"guide_desktop_mic_missing_title",desc:"guide_desktop_mic_missing_description",type:m.TYPE.GUIDE_NONE}))})["catch"](function(t){e.recorder&&e.recorder.stop(),c.error("PTT Recording Error")(t)})}},render:function(){var e="btn-close btn-border ptt-close";this.state.active===w.CANCEL&&(e+=" is-hover");var t="btn-border ptt-send";this.state.active===w.SEND&&(t+=" is-hover");var n=void 0;this.state.state!==w.DELAY&&this.state.state!==w.REC||(n=s.createElement(E,{displayName:"PTT",popable:!0,escapable:!0,requestDismiss:this.cancelRecording},s.createElement("div",{className:"ptt-recording",key:"recording"},s.createElement("button",{className:e,onMouseOver:this.onMouseOverCancel,onMouseOut:this.onMouseOutCancel,onMouseUp:this.onMouseUpCancel},s.createElement("span",{className:"icon icon-round-x btn-state-default"}),s.createElement("span",{className:"icon icon-round-x-inv btn-state-hover"})),s.createElement("div",{className:"ptt-counter"},y.unix(this.state.elapsedTime).format("m:ss")),s.createElement("button",{className:t,onMouseOver:this.onMouseOverSend,onMouseOut:this.onMouseOutSend,onMouseUp:this.onMouseUpSend},s.createElement("span",{className:"icon icon-round-send btn-state-default"}),s.createElement("span",{className:"icon icon-round-send-inv btn-state-hover"})))));var r=this.state.state===w.READY||this.state.state===w.PROCESSSING?s.createElement("button",{className:"icon btn-icon icon-ptt",onMouseDown:this.onMouseDown,disabled:this.state.state===w.PROCESSSING,key:"button"}):null,i="ptt-container";return n&&(i+=" active"),s.createElement("div",{className:i},s.createElement(b,{transitionName:"ptt"},n||r))}});e.exports=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(1231),c=n(432),l=n(8),u=n(141),d=n(56),p=o.createClass({displayName:"Spam",mixins:[u],propTypes:{chat:o.PropTypes.instanceOf(s).isRequired},componentWillMount:function(){this.addObserver(Store.Blocklist,"add remove reset"),this.addObserver(this.props.chat,"change:trusted")},confirmReportGroupSpam:function(){l.openModal(o.createElement(c,{onOK:this.reportGroupSpam,okText:l10n.t("report_group_spam"),onCancel:l.closeModal.bind(l),cancelText:l10n.t("web_cancel")},l10n.t("report_group_spam_ack")))},reportGroupSpam:function(){var e=this.props.chat,t=e.sendSpamReport(!0);if(!e.isReadOnly){var n=e.sendExit(),r=d.waitForBBEvent(e.msgs,"change:last",function(e){return e.isGroupLeave()});t=a["default"].all([t,n,r])}t.then(function(){return e.sendDelete()})["catch"](_.noop),l.closeModal()},confirmReportSpam:function(){l.openModal(o.createElement(c,{onOK:this.reportSpam,okText:l10n.t("report_spam"),onCancel:l.closeModal.bind(l),cancelText:l10n.t("web_cancel")},l10n.t("report_spam_ack")))},reportSpam:function(){var e=this.props.chat;e.sendSpamReport().then(function(){return e.contact.setBlock(!0)}).then(function(){return e.sendDelete()})["catch"](_.noop),l.closeModal()},notSpam:function(){this.props.chat.sendNotSpam(!0)["catch"](_.noop)},confirmBlock:function(){l.openModal(o.createElement(c,{onOK:this.block,okText:l10n.t("block"),onCancel:l.closeModal.bind(l),cancelText:l10n.t("web_cancel")},l10n.t("block_ack")))},block:function(){this.props.chat.contact.setBlock(!0)["catch"](_.noop),l.closeModal()},confirmUnblock:function(){l.openModal(o.createElement(c,{okText:l10n.t("unblock_button"),onOK:this.unblock,cancelText:l10n.t("web_cancel"),onCancel:l.closeModal.bind(l)},l10n.t("unblock_confirmation",{contact:this.props.chat.contact.formattedName})))},unblock:function(){this.props.chat.contact.setBlock(!1)["catch"](_.noop),l.closeModal()},render:function(){var e=this.props.chat;if(e.isPSA||!e.isVisible||e.trusted)return null;var t,n=[];if(e.isGroup)t=l10n.t("group_admin_not_a_contact"),n.push(o.createElement("button",{className:"spam-button btn-plain",key:"report_spam",onClick:this.confirmReportGroupSpam},l10n.t("report_group_spam")));else{t=l10n.t("sender_not_a_contact"),n.push(o.createElement("button",{className:"spam-button btn-plain",key:"report_spam",onClick:this.confirmReportSpam},l10n.t("report_spam")));var r=Store.Blocklist.get(e.id);r?n.push(o.createElement("button",{onClick:this.confirmUnblock,key:"unblock",className:"spam-button btn-plain"},l10n.t("unblock_button"))):n.push(o.createElement("button",{onClick:this.confirmBlock,key:"block",className:"spam-button btn-plain"},l10n.t("block")))}return n.push(o.createElement("button",{onClick:this.notSpam,key:"not_spam",className:"spam-button btn-plain"},l10n.t("not_spam"))),o.createElement("div",{className:"spam"},o.createElement("div",{className:"spam-text"},t),o.createElement("div",{className:"spam-controls"},n))}});e.exports=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(105),s=r(o),c=n(6),l=n(37),u=n(141),d=n(83),p=n(1231),h=n(1267),f=n(1414),m=n(1415),g=n(1327),v=n(1352),y=n(8),E=n(57),b=n(106),w=n(1248),M=n(1230),C=n(10),S=n(1379),T=n(218),k=c.createClass({displayName:"ConversationPanel",mixins:[u,M,d],propTypes:{chat:c.PropTypes.instanceOf(p).isRequired,msgCollection:c.PropTypes.instanceOf(h).isRequired,focusCtx:c.PropTypes.object,notifyChatRendered:c.PropTypes.func,updateOpenedChatInfo:c.PropTypes.func.isRequired},getInitialState:function(){var e=this.props.chat;return this.fillerHeight=e.fillerHeight||0,this.selectedMessages=new w([],function(e){return e.id.toString()}),{canCompose:e.canSend,selectable:!1,wallpaperColor:this.async("chat.ChatPreference.wallpaperColor")}},componentWillMount:function(){var e=this.props.chat;e.fillerHeight=null,this.addObserver(e,"change:canSend",this.onComposeState),this.openEvent=new E.WebcChatOpen({webcUnreadCount:e.unreadCount})},componentDidMount:function(){var e=this.props.chat;e.set({active:!0,viewed:!0}),this.openEvent&&(this.openEvent.markWebcChatOpenT(),this.openEvent.commit(),delete this.openEvent),this.addObserver(Store.ChatPreference,"wallpaper_color_preview",this.onWallpaperColorPreview),this.regCmd("scroll_messages",this.scrollMessages)},componentWillUnmount:function(){this.props.chat.set("active",!1)},onComposeState:function(){var e=this.props.chat.canSend;this.state.canCompose!==e&&this.setState({canCompose:e})},onComposeHeightChange:function(e,t){var n=this,r=e.input,i=e.overlay,o=l.findDOMNode(this.refs.msgPanel);if(o&&this.refs.msgs){var s=this.refs.msgs.getScrollBottom();if(_.isNumber(r))return void this.refs.msgs.composeHeightChange(r);if(t)return this.fillerHeight=i,void(this.refs.filler&&(this.refs.filler.style.height=this.fillerHeight+"px",this.refs.msgs.setScrollBottom(s)));this.fillerHeight+=i,i<0&&(this.refs.filler&&(this.refs.filler.style.height=this.fillerHeight+"px"),this.refs.msgs&&this.refs.msgs.setScrollBottom(s)),this.msgPanelAnimation||(this.msgPanelAnimation=a["default"].resolve()),this.msgPanelAnimation.cancel(),this.msgPanelAnimation=this.msgPanelAnimation.then(function(){return Velocity(o,{translateY:i>0?[-i,0]:[0,i]},{duration:300,easing:[.1,.82,.25,1]})}).then(function(){return n.msgPanelAnimation=null}).cancellable()["catch"](a["default"].CancellationError,function(){Velocity(o,"finish",!0),o.style.transform=""}).then(function(){n.isMounted()&&(i>0&&n.refs.filler&&(n.refs.filler.style.height=n.fillerHeight+"px"),o.style.transform="",n.refs.msgs&&i>0&&n.refs.msgs.setScrollBottom(s))})}},onWallpaperColorPreview:function(e){e?this.state.wallpaperColor!==e&&this.setState({wallpaperColor:e}):this.setState({wallpaperColor:Store.ChatPreference.get("defaultPreference").wallpaperColor})},onSelectMessages:function(){this.state.selectable||this.setState({selectable:!0})},onCancelSelection:function(){this.state.selectable&&(this.selectedMessages.unsetAll(),this.setState({selectable:!1}))},onMessageSelect:function(e,t){this.onSelectMessages(),this.selectedMessages.setVal(e,t)},onPageUpDown:function(e){this.refs.msgs.onPageUpDown(e)},scrollMessages:function(){var e=this.refs.msgs,t=e&&e.refs.scrollContainer;if(t){var n=_.last(e.msgListInfo.visibleMsgOrder);if(n){var r=l.findDOMNode(e.refs.messageList.refs[n.toString()]);if(r){var i=0;
1===e.msgListInfo.visibleMsgOrder.length&&(i=r.clientHeight),Velocity(r,"stop"),Velocity(t,"stop"),Velocity(r,"scroll",{duration:300,container:t,offset:i})}}}},onDragStart:function(e){this.state.canCompose&&(this.blockDrop=!0)},onDragEnd:function(e){this.state.canCompose&&(this.blockDrop=!1)},onDragEnter:function(e){this.state.canCompose&&!this.blockDrop&&(_.includes(e.dataTransfer.types,"Files")||_.includes(e.dataTransfer.types,"text/uri-list")||_.includes(e.dataTransfer.types,"text/html"))&&(y.attachMediaDrawer(this.props.chat),e.stopPropagation(),e.preventDefault())},render:function(){var e,t,n,r=this.props,i=r.chat,a=r.msgCollection,o=r.focusCtx;if(this.state.selectable)t=c.createElement(T,{displayName:"MultiSelect",escapable:!0,requestDismiss:this.onCancelSelection},c.createElement(v,{chat:i,selectedMessages:this.selectedMessages,onCancel:this.onCancelSelection})),e=c.createElement("footer",{className:"pane-footer pane-chat-footer"}),n=c.createElement("div",{ref:"filler",className:"compose-filler"});else if(this.state.canCompose)e=c.createElement(g,{chat:i,ref:"composeBox",onComposeHeightChange:this.onComposeHeightChange,onPageUpDown:this.onPageUpDown}),n=c.createElement("div",{ref:"filler",style:{height:this.fillerHeight+"px"},className:"compose-filler"});else{var l;l=i.isGroup?l10n.t("web_cannot_send_not_a_group_participant"):i.isPSA?l10n.t("web_psa_title"):l10n.t("web_cannot_send_to_blocked_contact_1",{contact:i.contact.formattedName}),e=c.createElement("footer",{className:"pane-footer pane-chat-footer"},c.createElement("div",{className:"block-message"},l))}var u={},d={};return this.state.wallpaperColor!==C.DEFAULT_CHAT_WALLPAPER&&(u.background=this.state.wallpaperColor,u.transition="background 0.3s ease",d.display="none"),c.createElement(T,{displayName:"ConversationPanel",state:T.State.INACTIVE,requestFocus:this.requestFocus},c.createElement(s["default"],{id:"main",className:"pane pane-chat pane-two",onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDragOver:this.onDragOver,onDragEnter:this.onDragEnter},c.createElement("div",{className:"pane-chat-tile",style:d}),c.createElement(f,{chat:i,canAttach:this.state.canCompose,onSelectMessages:this.onSelectMessages}),c.createElement("div",{className:"pane-body pane-chat-tile-container",ref:"msgPanel",style:u},c.createElement(m,{ref:"msgs",chat:i,selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,msgCollection:a,onSelectMessages:this.onSelectMessages,focusCtx:o,selectedMessages:this.selectedMessages,notifyChatRendered:this.props.notifyChatRendered,updateOpenedChatInfo:this.props.updateOpenedChatInfo})),n,e,c.createElement(b,{transitionName:"slide-up"},t),c.createElement(S,null)))}});e.exports=k},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(106),o=n(83),s=n(218),c=n(452),l=n(44),u=n(1142),d=n(38),p=n(84),h=n(85),f={LEFT:"drawer-left",MID:"slide-up",RIGHT:"slide-left",NONE:"none"},m={LEFT:"left",MID:"mid",RIGHT:"right"},g=function(e){return f[e.toUpperCase()]},v=r.createClass({displayName:"DrawerManager",mixins:[o],propTypes:{direction:r.PropTypes.oneOf(d.values(m)),onDrawerIn:r.PropTypes.func,onDrawerOut:r.PropTypes.func,onDrawerAnimationComplete:r.PropTypes.func},getChildContext:function(){var e=this.state.uim||this.context.uim;return{uim:e}},getInitialState:function(){return{drawer:void 0,drawerId:0,transition:g(this.props.direction),uim:void 0}},componentWillMount:function(){this.regCmd("open_drawer_"+this.props.direction,this.openFlow),this.regCmd("exists_drawer_"+this.props.direction,this.existsFlow),this.regCmd("close_drawer_"+this.props.direction,this.closeFlow)},shouldComponentUpdate:function(e,t){return u(this,e,t)},openFlow:function(e){var t=arguments.length<=1||void 0===arguments[1]?g(this.props.direction):arguments[1],n=arguments[2],r=arguments[3];this.state.drawer?t=f.NONE:this.props.onDrawerIn&&this.props.onDrawerIn();var i=r&&r.drawerId||d.uniqueId("DrawerManager"+this.props.direction);this.setState({drawer:e,drawerId:i,transition:t,uim:n,option:r})},existsFlow:function(e){e(!!this.state.drawer)},closeFlow:function(e){e&&this.state.drawerId!==e||this.state.drawer&&(this.props.onDrawerOut&&this.props.onDrawerOut(),this.setState({drawer:void 0}))},requestFocus:function(e){var t=i.findDOMNode(this.refs.UIE);t&&!t.contains(document.activeElement)&&p.focus(t)},render:function(){var e=this.props,t=e.onDrawerAnimationComplete,n=e.direction,i=this.state,o=i.drawer,u=i.drawerId,p=i.transition,h=i.option,f=h&&h.noFocus?null:this.requestFocus;o&&(o=r.createElement(s,{displayName:"Drawer"+d.upperFirst(n),escapable:!0,key:u,ref:"UIE",requestFocus:f,requestDismiss:this.closeFlow.bind(null,u)},r.createElement(c,{style:{height:"100%"}},o)));var g=l("pane",{"pane-one":n===m.LEFT,"pane-two":n===m.MID,"pane-three":n===m.RIGHT});return r.createElement(a,{transitionName:p,className:g,onAnimationComplete:t},o)}});v.contextTypes={uim:r.PropTypes.instanceOf(h)},v.childContextTypes={uim:r.PropTypes.instanceOf(h)},v.Dir=m,v.Transition=f,e.exports=v},function(e,t,n){"use strict";var r=n(6),i=n(83),a=n(142),o=n(145),s=n(436),c=n(1292),l=n(86),u=n(449),d=n(84),p=n(1139),h=r.createClass({displayName:"EmojiInput",mixins:[i,a,o],propTypes:{focusOnMount:r.PropTypes.bool,editable:r.PropTypes.bool,format:r.PropTypes.bool,value:r.PropTypes.string,selection:r.PropTypes.object,className:r.PropTypes.string,placeholder:r.PropTypes.string,onKeyPress:r.PropTypes.func,onEnter:r.PropTypes.func,onChange:r.PropTypes.func,onFocus:r.PropTypes.func,onBlur:r.PropTypes.func,onFiles:r.PropTypes.func,onMouseDown:r.PropTypes.func,onSelectionChange:r.PropTypes.func,maxLength:r.PropTypes.number,multiline:r.PropTypes.bool,spellCheck:r.PropTypes.bool,focusOnChange:r.PropTypes.bool},getDefaultProps:function(){return{editable:!0,format:!1,value:"",focusOnChange:!0}},getInitialState:function(){return this.value=this.props.value||"",this.selection=this.props.selection,null},componentWillMount:function(){this.debouncedSaveSelection=this.safeDebounce(this._saveSelection,0)},componentWillReceiveProps:function(e){if(e.value!==this.value&&(this.setNewValue(e.value||"",!1),this.updateDOM(),this.props.focusOnChange&&this.safeDefer(this.restoreFocus.bind(this,!0))),this.props.editable!==e.editable){var t=this.refs.input;t.contentEditable=e.editable,e.editable&&this._disableObjectResize()}},restoreFocus:function(e){if(this.props.editable){var t=this.refs.input;document.activeElement!==t&&(d.focus(t),this.selection&&!e?this.restoreSelection(this.selection):this._moveCursorToEnd(t),this.debouncedSaveSelection())}},_moveCursorToEnd:function(e){if(e){var t=window.getSelection();t&&(t.selectAllChildren(e),t=window.getSelection(),t&&t.rangeCount&&t.collapseToEnd())}},componentDidMount:function(){this.props.focusOnMount&&this.safeDefer(this.restoreFocus),this.props.editable&&this._disableObjectResize(),this.refs.input.restoreFocus=this.restoreFocus,this.refs.input.pasteText=this.pasteText},componentWillUnmount:function(){this.refs.input.restoreFocus=null},_disableObjectResize:function(){l.isGecko&&document.execCommand("enableObjectResizing",!1,!1)},limitLength:function(e){var t=this.props.maxLength;if(!t)return e;e=e||"";var n=this.selectionLength(),r=n+t-c.multibyteLength(this.value);return r>0?c.multibyteSubstr(e,0,r):""},onMouseDown:function(e){e.stopPropagation(),this.regNativeListener(window,"mouseup",this.onWindowMouseUp),this.props.onMouseDown&&this.props.onMouseDown(e)},onWindowMouseUp:function(){this.unregNativeListener(window,"mouseup",this.onWindowMouseUp),this.debouncedSaveSelection()},onContextMenu:function(e){e.stopPropagation()},onKeyUp:function(e){if(l.isTrident&&this.onInput(e),"Backspace"===e.key||"Delete"===e.key){var t=this.refs.input;switch(t.innerHTML){case"\n":case"\r\n":case"<br>":t.innerHTML="",this.setNewValue("",!0,!0)}}this.debouncedSaveSelection()},onKeyPress:function(e){if(l.isTrident&&this.onInput(e),!this.props.onKeyPress||(this.props.onKeyPress(e),!e.defaultPrevented)){var t=e.ctrlKey||e.shiftKey||e.altKey;if(!this.props.multiline&&"Enter"===e.key||this.props.multiline&&"Enter"===e.key&&!t)return e.preventDefault(),void(this.props.onEnter&&this.props.onEnter(e));var n=this.limitLength(u.ucs2.encode([e.charCode]));this.props.multiline&&"Enter"===e.key&&t&&(this.replaceSelection("\n",!0),e.preventDefault()),n.length||e.preventDefault()}},onInput:function(e){var t=this.refs.input;e=_.isBoolean(e)?e:void 0,this.setNewValue(s.NodeToEmoji(t),!0,e)},setNewValue:function(e,t,n){if(e!==this.value||n){if(e&&!this.value){var r=this.refs.placeholder;r&&(r.style.display="none")}else if(this.value&&!e){var i=this.refs.placeholder;i&&(i.style.display="")}this.value=e,t&&this.props.onChange&&this.props.onChange({target:{value:e}}),this.debouncedSaveSelection()}},updateDOM:function(){var e=s.emojiToHTML(_.escape(this.value)),t=this.refs.input;t.innerHTML!==e&&(t.innerHTML=e)},selectionLength:function(){if(!this.props.editable)return 0;var e=this.refs.input;d.focus(e);var t=window.getSelection();if(t.rangeCount){var n=t.getRangeAt(0);return c.multibyteLength(s.NodeToEmoji(n.cloneContents()))}return 0},_saveSelection:function(){var e=this.getSelection();_.isEqual(e,this.prevSelection)||(this.props.onSelectionChange&&this.props.onSelectionChange(e),this.prevSelection=this.selection,this.selection=e)},isCollapsed:function(){if(this.isMounted()){var e=this.refs.input;if(document.activeElement!==e)return null;var t=window.getSelection();return t.isCollapsed}},getCursor:function(){if(!this.isMounted())return-1;var e=this.refs.input;if(document.activeElement!==e)return null;var t=window.getSelection(),n=t.anchorNode,r=t.anchorOffset,i=e.childNodes,a=0;e===n&&(n=i[r]);for(var o=0;o<i.length;o++){var s=i[o];if(s===n)return a+r;s.nodeType===window.Node.ELEMENT_NODE&&s.alt?a+=s.alt.length:s.nodeType===window.Node.TEXT_NODE&&(a+=s.length)}return a},isAtBeginning:function(){return this.isCollapsed()&&0===this.getCursor()},isAtEnd:function(){return this.isCollapsed()&&this.getCursor()===this.value.length},getSelection:function(){if(!this.isMounted())return null;var e=this.refs.input;if(document.activeElement!==e)return null;for(var t=window.getSelection(),n=t.anchorNode,r=t.anchorOffset,i=t.focusNode,a=t.focusOffset,o=e.childNodes,s=-1,c=-1,l=!1,u=!1,d=0;d<o.length;d++){var p=o[d];if(p===n&&(s=d,l=!0),p===i&&(c=d,u=!0),l&&u)break}return{anchor:{index:s,offset:r},focus:{index:c,offset:a}}},restoreSelection:function(e){var t,n,r,i,a,o,s=this.refs.input,c=s.childNodes;e.anchor.index===-1?(t=s,r=e.anchor.offset,a=0):(t=c[e.anchor.index],r=e.anchor.index,a=e.anchor.offset),e.focus.index===-1?(n=s,i=e.focus.offset,o=0):(n=c[e.focus.index],i=e.focus.index,o=e.focus.offset);var u;u=r===i?o>=a?"forward":"reverse":r>i?"reverse":"forward";var d=window.getSelection();if(t&&n)try{var p=document.createRange();return void(l.isTrident?("forward"===u?(p.setStart(t,e.anchor.offset),p.setEnd(n,e.focus.offset)):(p.setStart(n,e.focus.offset),p.setEnd(t,e.anchor.offset)),d.removeAllRanges(),d.addRange(p)):(p.setStart(t,e.anchor.offset),d.removeAllRanges(),d.addRange(p),d.extend(n,e.focus.offset)))}catch(h){this._moveCursorToEnd(s)}else this._moveCursorToEnd(s)},onCut:function(e){l.isTrident&&this.onInput(e)},onPaste:function(e){if(!e.defaultPrevented){e.preventDefault();var t=new p(e.clipboardData);if(t.hasFiles())return e.stopPropagation(),this.props.onFiles&&this.props.onFiles(t);var n=l.isTrident?"text":"text/plain",r=e.clipboardData.getData(n);this.pasteText(r)}},pasteText:function(e){e&&(this.props.maxPaste&&e.length>this.props.maxPaste?this.props.onMaxPasteExceeded():this.replaceSelection(e))},replaceSelection:function(e,t){if(this.props.editable&&(d.focus(this.refs.input),e=this.limitLength(e),0!==e.length)){this.props.multiline||(e=e.replace(/\n+/g," ").replace(/(\r\n)+/g," "));var n=window.getSelection(),r=null;n.getRangeAt&&n.rangeCount&&(r=n.getRangeAt(0),r.deleteContents());var i=this.refs.input,a=i.scrollTop,o=i.scrollHeight,c=s.emojiToHTML(_.escape(e));l.isTrident?r&&this.replaceSelectionTrident(c,n,r):t?document.execCommand("insertText",!1,c):document.execCommand("insertHTML",!1,c),this.onInput(!0),this.debouncedSaveSelection(),this.scrollToCursor(a,o)}},scrollToCursor:function(e,t){var n=this.refs.input,r=n.scrollHeight,i=n.clientHeight;if(!(r<=i)){var a=r-t;this.refs.input.scrollTop=(e||0)+a}},replaceSelectionTrident:function(e,t,n){var r=document.createElement("div");r.innerHTML=e;for(var i,a,o=document.createDocumentFragment();i=r.firstChild;)a=o.appendChild(i);n.insertNode(o),a&&(n=n.cloneRange(),n.setStartAfter(a),n.collapse(!0),t.removeAllRanges(),t.addRange(n))},shouldComponentUpdate:function(){return!1},render:function(){var e=s.emojiToHTML(_.escape(this.value)),t=this.props.className?"input "+this.props.className:"input",n="input-emoji",i=this.props.placeholder&&!this.props.value?r.createElement("div",{className:"input-placeholder",ref:"placeholder"},this.props.placeholder):null;return r.createElement("div",{className:n},i,r.createElement("div",{dangerouslySetInnerHTML:{__html:e},dir:"auto",ref:"input",spellCheck:this.props.spellCheck,"data-tab":this.props.editable?1:null,contentEditable:this.props.editable,className:t,onInput:this.onInput,onPaste:this.onPaste,onCut:this.onCut,onKeyUp:this.onKeyUp,onKeyPress:this.onKeyPress,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu,onFocus:this.props.onFocus,onBlur:this.props.onBlur}))}});e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(6),s=n(1247),c=n(432),l=n(219),u=n(1232),d=n(8),p=n(1480),h=o.createClass({displayName:"AddContactToGroupFlow",mixins:[s],propTypes:{contact:o.PropTypes.instanceOf(l).isRequired},getDefaultTransition:function(){var e;return e={},(0,a["default"])(e,s.Dir.PUSH,s.Transition.NONE),(0,a["default"])(e,s.Dir.POP,s.Transition.NONE),e},filter:function(e){var t=e.groupMetadata;return!(!e.isGroup||e.isGroup&&!t.participants.iAmMember())&&(t.participants.get(this.props.contact.id)?l10n.t("already_added_to_group"):!!t.participants.iAmAdmin()||l10n.t("chat_not_an_admin"))},componentWillMount:function(){this.push(o.createElement(p,{chats:Store.Chat.filter(function(e){return e.isGroup}),filter:this.filter,onCancel:this.pop,onGroup:this.confirmAddToGroup}))},confirmAddToGroup:function(e){this.push(o.createElement(c,{onOK:this.addToGroup.bind(null,e),okText:l10n.t("add_group_participant"),onCancel:this.pop,cancelText:l10n.t("web_cancel")},o.createElement(u,{text:l10n.t("confirm_add_group_participant",{participant:this.props.contact.formattedName,subject:e.contact.name})})))},addToGroup:function(e){e.groupMetadata.participants.addParticipant(this.props.contact).then(function(){d.openChatFromUnread(e).then(function(t){t&&d.focusChatTextInput(e)})})["catch"](_.noop),this.endFlow()}});e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(6),s=n(1247),c=n(432),l=n(1304),u=n(1231),d=n(8),p=n(1232),h=o.createClass({displayName:"AddGroupParticipantFlow",mixins:[s],propTypes:{chat:o.PropTypes.instanceOf(u).isRequired},getDefaultTransition:function(){var e;return e={},(0,a["default"])(e,s.Dir.PUSH,s.Transition.NONE),(0,a["default"])(e,s.Dir.POP,s.Transition.NONE),e},componentWillMount:function(){this.push(o.createElement(l,{title:l10n.t("add_group_participant"),filter:this.contactFilter,onCancel:this._pop,onSelect:this.confirmAddParticipant}))},contactFilter:function(e){var t=this.props.chat.groupMetadata;return!!Store.Contact.isFilteredContact(e)&&(!t.participants.get(e.id)||l10n.t("already_added_to_group"))},confirmAddParticipant:function(e){var t=this.onAddParticipant.bind(this,e),n=l10n.t("confirm_add_group_participant",{participant:e.formattedName,subject:this.props.chat.contact.name});this.push(o.createElement(c,{onOK:t,okText:l10n.t("add_group_participant"),onCancel:this._pop,cancelText:l10n.t("web_cancel")},o.createElement(p,{text:n})))},_pop:function(){this.pop()},onAddParticipant:function(e){this.props.chat.groupMetadata.participants.addParticipant(e)["catch"](_.noop),d.closeModal()}});e.exports=h},function(e,t,n){"use strict";var r=n(6),i=n(1247),a=n(141),o=n(1461),s=n(1231),c=n(8),l=n(86),u=n(1497),d=r.createClass({displayName:"AttachMediaFlow",mixins:[i,a],propTypes:{files:r.PropTypes.array,chat:r.PropTypes.instanceOf(s).isRequired},getInitialState:function(){this.mediaCollection=new u},componentWillMount:function(){c.closeContextMenu(),c.closeTooltip(),this.push(r.createElement(o,{chat:this.props.chat,files:this.props.files,onBack:this.endFlow,onSendMedia:_.once(this.sendMedia),onDropText:_.once(this.setText),mediaCollection:this.mediaCollection}))},componentDidMount:function(){var e=this;this.uiIdle(function(){e.initializeFiles()})},componentWillUnmount:function(){var e=this;l.isGecko?_.defer(function(){return c.focusChatTextInput(e.props.chat)}):c.focusChatTextInput(this.props.chat),this.mediaCollection&&this.mediaCollection["delete"]()},initializeFiles:function(){var e=this.props.files;e&&this.mediaCollection.processFiles(e,this.props.chat)},sendMedia:function(e){var t=this.props.chat;_.delay(function(){e.forEach(function(e,n){var r={};0===n&&(r.quotedMsg=t.composeQuotedMsg,t.composeQuotedMsg=null),r.caption=e.caption,e.mediaPrep.sendToChat(t,r)})},300),this.endFlow()},setText:function(e){var t=this.props.chat;_.delay(function(){c.pasteChatTextInput(t,e)},300),this.endFlow()}});e.exports=d},function(e,t,n){"use strict";var r=n(1273),i=n(6),a=n(1247),o=n(1338),s=n(1231),c=i.createClass({displayName:"CaptureFlow",mixins:[a],propTypes:{chat:i.PropTypes.instanceOf(s).isRequired,stream:i.PropTypes.object.isRequired},componentWillMount:function(){this.push(i.createElement(o,{onBack:this.endFlow,caption:!0,onSend:this.sendMedia,stream:this.props.stream}))},sendMedia:function(e){var t=e.file,n=e.caption,i=this.props.chat,a=i.composeQuotedMsg;i.composeQuotedMsg=null,(0,r.prepRawMedia)(t,{}).sendToChat(i,{caption:n||void 0,quotedMsg:a||void 0}),this.endFlow()}});e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1136),a=r(i),o=n(6),s=n(1478),c=n(1247),l=n(1231),u=o.createClass({displayName:"GroupInviteRevokeFlow",mixins:[c],propTypes:{chat:o.PropTypes.instanceOf(l).isRequired,onConfirm:o.PropTypes.func.isRequired},getDefaultTransition:function(){var e;return e={},(0,a["default"])(e,c.Dir.PUSH,c.Transition.NONE),(0,a["default"])(e,c.Dir.POP,c.Transition.NONE),e},componentWillMount:function(){this.push(o.createElement(s,{chat:this.props.chat,onConfirm:this.props.onConfirm}))}});e.exports=u},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(10),o=n(1229),s=n(8),c=n(142),l=n(1236),u=n(141),d=n(1484),p=n(1318),h=n(144),f=n(1),m=n(104),g=n(14),v=n(44),y=n(106),E=r.createClass({displayName:"MediaViewerFlow",mixins:[c,l,u],propTypes:{msg:r.PropTypes.instanceOf(o).isRequired,getZoomNode:r.PropTypes.func},getInitialState:function(){this.zoomIn=!0;var e=this.props.msg;return this.mediaMsgs=e.chat.getMediaMsgs(e),{activeMsg:e,imgZoomed:!1}},componentWillMount:function(){this.regNativeListener(window,"keydown",this.onKeyDown)},componentDidMount:function(){var e=this;this.zoomIn=!1,m.supportsFeature(m.F.MEDIA_GALLERY)&&this.uiIdle(function(){e.mediaMsgs.loadMoreAroundIfNeeded(e.state.activeMsg)}),this.addObserver(this.mediaMsgs,"remove reset",function(t,n,r){if(e.mediaMsgs.indexOf(t)>-1||e.state.activeMsg!==t)return void e.forceUpdate();var i=r.index;0===e.mediaMsgs.length?e.endFlow():e.mediaMsgs.length===i?e.onSelectThumb(e.mediaMsgs.at(i-1)):e.onSelectThumb(e.mediaMsgs.at(i))}),this.addObserver(this.mediaMsgs,"query_media_after"),this.addObserver(this.mediaMsgs,"query_media_before",function(){var t=i.findDOMNode(e.refs.thumbs);t&&(e.prevScrollWidth=t.scrollWidth,e.forceUpdate())}),this.scrollToActive(),Velocity(this.refs.thumbsContainer,{opacity:[1,0],translateY:["0%","100%"]},{duration:300,delay:100,easing:[.1,.82,.25,1]})},componentDidUpdate:function(e,t){if(t.activeMsg!==this.state.activeMsg)this.scrollToActive(!0);else{var n=i.findDOMNode(this.refs.thumbs);if(!n||!this.prevScrollWidth)return;n.scrollLeft+=n.scrollWidth-this.prevScrollWidth,this.prevScrollWidth=null}},onKeyDown:function(e){37===e.keyCode?this.onPrev():39===e.keyCode&&this.onNext()},onScroll:function(e){this.handleScroll(e.target)},handleScroll:_.throttle(function(e){var t=this;this.mediaMsgs.hasMediaBefore&&e.scrollLeft<e.clientWidth&&!function(){var e=t.mediaMsgs.head();t.uiIdle(function(){t.mediaMsgs.queryMedia(e.chat,e),t.forceUpdate()})}(),this.mediaMsgs.hasMediaAfter&&e.scrollLeft+a.SCROLL_FUDGE>e.scrollWidth-2*e.clientWidth&&!function(){var e=t.mediaMsgs.last();t.uiIdle(function(){t.mediaMsgs.queryMedia(e.chat,e,"after"),t.forceUpdate()})}()},100),onNext:function(e){var t=this;if(e&&e.stopPropagation(),!this.state.imgZoomed){var n=this.state.activeMsg,r=this.mediaMsgs.getAfter(n);return r?void this.onSelectThumb(r):void(m.supportsFeature(m.F.MEDIA_GALLERY)&&this.mediaMsgs.hasMediaAfter&&(this._queryMediaAfter||(this._queryMediaAfter=this.mediaMsgs.queryMedia(n.chat,n,"after").checkpoint(this.rejectOnUnmount()).then(function(e){e.length>0&&t.state.activeMsg===n&&t.onNext()})["catch"](g.Unmount,_.noop)["catch"](function(e){f.error("query media msgs error: ",e)})["finally"](function(){t._queryMediaAfter=null}))))}},onPrev:function(e){var t=this;if(e&&e.stopPropagation(),!this.state.imgZoomed){var n=this.state.activeMsg,r=this.mediaMsgs.getBefore(n);return r?void this.onSelectThumb(r):void(m.supportsFeature(m.F.MEDIA_GALLERY)&&this.mediaMsgs.hasMediaBefore&&(this._queryMediaBefore||(this._queryMediaBefore=this.mediaMsgs.queryMedia(n.chat,n,"before").checkpoint(this.rejectOnUnmount()).then(function(e){e.length>0&&t.state.activeMsg===n&&t.onPrev()})["catch"](g.Unmount,_.noop)["catch"](function(e){f.error("query media msgs error: ",e)})["finally"](function(){t._queryMediaBefore=null}))))}},onImgZoomIn:function(e){this.setState({imgZoomed:e})},endFlow:function(){s.closeModalMedia()},willEndFlow:function(){Velocity(this.refs.thumbsContainer,{opacity:[0,1],translateY:["100%","0%"]},{duration:300,easing:[.1,.82,.25,1]})},onSelectThumb:function(e,t){var n=this;m.supportsFeature(m.F.MEDIA_GALLERY)&&this.uiIdle(function(){n.mediaMsgs.loadMoreAroundIfNeeded(e)}),this.setState({activeMsg:e})},scrollToActive:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=this.refs.thumbsContainer,n=i.findDOMNode(this.refs.thumbs),r=i.findDOMNode(this.refs.activeThumb);if(t&&n&&r){var a=r.clientWidth/2-t.clientWidth/2;Velocity(n,"stop");var o=0;e&&(o=300),Velocity(r,"scroll",{duration:o,container:n,offset:a,axis:"x",easing:[.1,.82,.25,1]})}},getThumbs:function(){var e=this,t=this.mediaMsgs.map(function(t){var n=v("media-thumb",{active:t===e.state.activeMsg});return r.createElement(p,{classes:n,msg:t,ref:t===e.state.activeMsg?"activeThumb":null,key:"media-"+t.id.id,onClick:e.onSelectThumb.bind(e,t)})});return t.push(r.createElement("div",{className:"media-thumb-spinner media-thumb",key:"spinner-right"},this.mediaMsgs.queryMediaAfter?r.createElement(h,{stroke:6,size:24}):null)),t.unshift(r.createElement("div",{className:"media-thumb-spinner media-thumb",key:"spinner-left"},this.mediaMsgs.queryMediaBefore?r.createElement(h,{stroke:6,size:24}):null)),t.push(r.createElement("div",{className:"media-thumb-padding",key:"padding-right"})),t.unshift(r.createElement("div",{className:"media-thumb-padding",key:"padding-left"})),t},render:function(){var e=this.mediaMsgs.last(),t=this.mediaMsgs.hasMediaAfter||this.state.activeMsg!==e?this.onNext:null,n=this.mediaMsgs.head(),i=this.mediaMsgs.hasMediaBefore||this.state.activeMsg!==n?this.onPrev:null,a=this.getThumbs(),o=m.supportsFeature(m.F.MEDIA_GALLERY)?this.onScroll:null;return r.createElement("div",{className:this.state.imgZoomed?"img-zoomed-in":null},r.createElement("div",{className:"media-collection media-viewer-thumbs-container",ref:"thumbsContainer"},r.createElement("div",{onScroll:o,style:{width:"100%"},dir:"ltr"},r.createElement(y,{className:"media-viewer-thumbs",ref:"thumbs",transitionName:"thumb-scale"},a))),r.createElement(d,{msg:this.state.activeMsg,onBack:this.endFlow,onExitAnimation:this.willEndFlow,onNext:t,onPrev:i,onImgZoomIn:this.onImgZoomIn,getZoomNode:this.props.getZoomNode,zoomIn:this.zoomIn}))}});e.exports=E},function(e,t,n){"use strict";var r=n(6),i=n(1247),a=n(1467),o=n(8),s=r.createClass({displayName:"NewChatFlow",mixins:[i],componentWillMount:function(){this.push(r.createElement(a,{title:l10n.t("new_chat_flow_title"),onBack:this.endFlow,onClick:this.onClick}))},onClick:function(e,t){Store.Chat.find(t.id).then(o.openChatFromUnread.bind(o)),this.endFlow()}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1247),a=n(1487),o=n(1488),s=r.createClass({displayName:"NewGroupFlow",mixins:[i],componentWillMount:function(){this.push(r.createElement(a,{onBack:this.endFlow,onContinue:this.groupParticipants}))},groupParticipants:function(e,t,n){this.push(r.createElement(o,{subject:e,thumb:t,full:n,onBack:this.participantsBack,onContinue:_.once(this.createGroup)}))},createGroup:function(e,t,n,r){Store.Chat.createGroup(e,t,n,r),this.endFlow()},participantsBack:function(e,t,n){this.pop()}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1491),a=r(i),o=n(6),s=n(1247),c=n(1462),l=n(1343),u=n(1489),d=n(1481),p=n(1496),h=n(27),f=o.createClass({displayName:"SettingsFlow",mixins:[s],componentWillMount:function(){this.push(o.createElement(a["default"],{profileId:Store.Conn.me,onWallpaper:this.showWallpaperDrawer,onBlocked:this.showBlockedDrawer,onProfile:this.showProfileDrawer,onNotifications:this.showNotifications,onHelp:this.showHelp,onClose:this._pop}))},showWallpaperDrawer:function(){this.push(o.createElement(p,{onClose:this._pop}))},showBlockedDrawer:function(){this.push(o.createElement(c,{onClose:this._pop}))},showProfileDrawer:function(){this.push(o.createElement(l,{id:Store.Conn.me,onClose:this._pop}))},showNotifications:function(){this.push(o.createElement(u,{onClose:this._pop}))},showHelp:function(){h.upload("help-page-opened"),this.push(o.createElement(d,{onClose:this._pop}))},_pop:function(){this.pop()}});e.exports=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n,r,i,a,o){this.rank=e,this.gifId=++j,this.url=t,this.previewUrl=n||t,this.nonVideoUrl=r,this.width=i,this.widthStr=i+"px",this.ratioStr=Math.ceil(100*D/i)+"%",this.attribution=a,this.trending=o}function a(e){switch(d()){case"giphy":return o(e);case"tenor":return c(e);default:throw new Error("Unrecognized provider "+d())}}function o(e){var t=!e,n=void 0;return n=t?x.request("https://api.giphy.com/v1/gifs/trending","GET",{api_key:N,limit:100,rating:"pg-13"},"json"):x.request("https://api.giphy.com/v1/gifs/search","GET",{q:e,api_key:N,limit:100,rating:"pg-13"},"json"),n["catch"](function(){return null}).then(function(e){return e&&e.status<300&&s(e.response,t)})}function s(e,t){if(!e||!_.isArray(e.data))return[];for(var n=e.data,r=[],a=0;a<n.length;a++){var o=n[a];if(o&&o.images){var s=o.images.downsizedSmall,c=o.images.fixed_height,l=o.images.fixed_width,u=void 0,d=void 0;if(l&&l.mp4){var p=parseInt(l.height,10);p===p&&p<O&&(u=l,d=O*D/p)}if(c&&c.mp4){var h=parseInt(l.width,10);h===h&&h<O&&(u=c,d=h*D/O)}u&&r.push(new i(r.length,s&&s.url||u.mp4,u.mp4,u.webp||u.gif||void 0,Math.round(d),I,t))}}return r}function c(e){var t=!e,n=l10n.lng().replace("-","_"),r=void 0;return r=t?x.request("https://api.tenor.co/v1/trending","GET",{key:P,limit:50,safesearch:"moderate",locale:n},"json"):x.request("https://api.tenor.co/v1/search","GET",{tag:e,key:P,limit:50,safesearch:"moderate",locale:n},"json"),r["catch"](function(){return null}).then(function(e){return e&&e.status<300&&l(e.response)})}function l(e,t){if(!e||!_.isArray(e.results))return[];for(var n=e.results,r=[],a=0;a<n.length;a++){var o=n[a];if(o&&o.media&&o.media[0]){var s=o.media[0],c=s.tinymp4,l=s.nanomp4,u=s.tinygif;if(c){var d=(0,h["default"])(c.dims,2),p=d[0],f=d[1];r.push(new i(r.length,c.url,l&&l.url||void 0,u&&u.url||void 0,Math.round(p*D/f),R,t))}}}return r}function u(e,t){for(var n=[],r=.9*t,i=e,a=null,o=.05;o<1&&i.length;o+=.05){i.sort(function(e,t){var n=e.rank-t.rank;return Math.abs(n)>8?n:t.width-e.width});for(var s=(1+o)*t,c=[],l=[],u=0;u<i.length;u++){for(var d=i[u],p=!1,h=Math.min(s-d.width,r),f=0;!p&&f<c.length;f++)c[f]<h&&(c[f]+=d.width+A,l[f].push(d),p=!0);p||(c.push(d.width),l.push([d]))}if(1===l.length){i=[];var m=t-c[0]-A;a={gifs:l[0],blankStr:m>0?m+"px":void 0}}else{i=[];for(var g=0;g<l.length;g++)c[g]>r?n.push(l[g]):i.push.apply(i,l[g])}}n.forEach(function(e){return e.sort(function(e,t){return e.rank-t.rank})}),n.sort(function(e,t){return e[0].rank-t[0].rank});var v=n.map(function(e){return{gifs:e,blankStr:void 0}});return a&&v.push(a),v}function d(){switch(v.SHOW_GIF_SEARCH){case"giphy":return I;case"tenor":default:return R}}var p=n(146),h=r(p),f=n(2),m=r(f),g=n(6),v=n(10),y=n(14),E=n(57),b=n(1229),w=n(108),M=n(89),C=n(1236),S=n(56),T=n(1544),k=n(86),x=n(147),N="3o85xmWDYKgihhIKSA",P="DLAQBEYLJJIM",O=200,D=150,A=6,I="giphy",R="tenor",L={giphy:"GIPHY",tenor:"Tenor"},U={giphy:E.GIF_SEARCH_PROVIDER.GIPHY,tenor:E.GIF_SEARCH_PROVIDER.TENOR},F={giphy:b.GIF_ATTRIBUTION.GIPHY,tenor:b.GIF_ATTRIBUTION.TENOR},j=0,B=new T(a,{maxCached:6,maxAge:36e4,shouldCache:function(e){return!(!e||!e.length)}}),G=g.createClass({displayName:"GifPreview",mixins:[C],propTypes:{gif:g.PropTypes.instanceOf(i).isRequired,onSend:g.PropTypes.func.isRequired},getInitialState:function(){return this._videoRef=null,{animate:!1,show:!1}},setVideoRef:function(e){this._videoRef=e,this.synchronizeVideo()},synchronizeVideo:function(){var e=this._videoRef;null!==e&&(this.state.animate?e.paused&&e.play():e.paused||(e.pause(),e.currentTime=0))},setShouldAnimate:function(e){this.state.animate===e&&this.state.show||this.setState({animate:e,show:!0},this.synchronizeVideo)},handleClick:function(){this.props.onSend(this.props.gif)},render:function(){var e=this.props.gif,t=null;return this.state.show&&(t=k.troublesWithLotsOfVideos&&e.nonVideoUrl?g.createElement("img",{className:"gif-search-gif",onClick:this.handleClick,src:e.nonVideoUrl}):g.createElement("video",{className:"gif-search-gif",onClick:this.handleClick,controls:!1,autoPlay:this.state.animate,loop:!0,muted:!0,ref:this.setVideoRef,src:e.previewUrl})),g.createElement("div",{className:"gif-search-gif-wrapper",style:{flexBasis:e.widthStr}},g.createElement("div",{style:{width:e.widthStr}},g.createElement("div",{style:{paddingBottom:e.ratioStr}},t)))}}),z=g.createClass({displayName:"GifSearch",mixins:[C],propTypes:{onGif:g.PropTypes.func.isRequired},getInitialState:function(){return this._scrollTop=0,this._animatingRow=null,this._containerDom=null,this._didSendGif=!1,{searchText:"",gifRows:[],width:0}},shouldComponentUpdate:function(e,t){return e.onGif!==this.props.onGif||t.gifRows!==this.state.gifRows},componentWillMount:function(){var e=this;this._searchTimer=new M(this.searchForAndSetGifs),this._animateTimer=new M(this.animateGif),this._onlineRestarter=m["default"].loop(function(){return S.waitForBBEvent(w,"change:online",function(){return w.online}).then(function(){return e.scheduleQuery()})}).cancellable(),this._onlineRestarter["catch"](m["default"].CancellationError,_.noop),this.searchForAndSetGifs(),new E.GifSearchSessionStarted({gifSearchProvider:U[d()]}).commit()},componentWillUnmount:function(){this._animateTimer.cancel(),this._searchTimer.cancel(),this._onlineRestarter.cancel(),this._didSendGif||new E.GifSearchCancelled({gifSearchProvider:U[d()]}).commit()},scheduleQuery:function(){this._searchTimer.debounceAndCap(200,2e3)},onSearchInput:function(e){this._searchText=e.target.value.trim(),this.scheduleQuery()},onScroll:function(e){this._scrollTop=e.currentTarget.scrollTop,this._animateTimer.debounce(200)},onSend:function(e){var t=U[e.attribution];
new E.GifFromProviderSent({gifSearchProvider:t}).commit(),e.trending||new E.GifSearchResultTapped({gifSearchProvider:t,rank:e.rank}).commit(),this._didSendGif=!0,this.props.onGif(e.url,F[e.attribution])},setGifAnimating:function(e,t){var n=this.refs[e];n&&n.setShouldAnimate(t)},animateGif:function(){var e=this,t=this._animatingRow,n=Math.round(this._scrollTop/(D+A)),r=this.state.gifRows[n];if(r&&r.gifs.length&&r!==t){if(this._animatingRow=r,t)for(var i=0;i<t.gifs.length;i++)this.setGifAnimating(t.gifs[i].gifId,!1);for(var a=0;a<r.gifs.length;a++)this.setGifAnimating(r.gifs[a].gifId,!0)}[n+1,n-1].forEach(function(t){if(e.state.gifRows[t])for(var n=e.state.gifRows[t].gifs,r=0;r<n.length;r++)e.setGifAnimating(n[r].gifId,!1)})},searchForAndSetGifs:function(){var e=this,t=U[d()],n=this._searchText,r=B.getOrRun(n);r=r.then(),this._pendingQuery=r,r.checkpoint(this.rejectOnUnmount()).then(function(i){if(i&&0===i.length&&new E.GifSearchNoResults({gifSearchProvider:t}).commit(),r===e._pendingQuery&&(e._pendingQuery=null,i)){n||new E.GifTrendingViewed({gifSearchProvider:t}).commit();var a=e._containerDom.clientWidth;a-=2*A,e._resetScroll=!0,e._animateTimer.debounce(0),e.setState({gifRows:u(i,a),width:a})}})["catch"](y.Unmount,m["default"].CancellationError,_.noop),n&&setTimeout(function(){e.rejectOnUnmount().isPending()&&n===e._searchText&&new E.GifSearchPerformed({gifSearchProvider:t}).commit()},500)},render:function(){function e(e){s=e,null!==e&&e.focus()}function t(e){e.target!==s&&(e.preventDefault(),s.focus()),e.stopPropagation()}var n=this,r=this.state.gifRows;this._gifPreviews={};var i=r.map(function(e,t){var r=e.gifs.map(function(e,t){return g.createElement(G,{key:e.gifId,ref:e.gifId,gif:e,display:!0,onSend:n.onSend})}),i=null;return e.blankStr&&(i=g.createElement("div",{className:"gif-search-blank",style:{flexBasis:e.blankStr}})),g.createElement("div",{key:t,className:"gif-search-row"},r,i)}),a=!!this._resetScroll,o=function(e){n._containerDom=e,null!==e&&a&&(a=!1,e.scrollTop=0)},s=null,c=l10n.t("search_gifs",{service:L[d()]});return g.createElement("div",{className:"gif-search-container",ref:o,onScroll:this.onScroll,onMouseDown:t,onContextMenu:t},g.createElement("div",{className:"gif-search-row"},g.createElement("label",{className:"gif-search-row-input"},g.createElement("div",{className:"input-container"},g.createElement("input",{className:"input input-search",type:"text",dir:"auto",title:c,placeholder:c,ref:e,onMouseDown:function(e){e.stopPropagation()},onChange:this.onSearchInput})))),i)}});e.exports=z},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(434),a=r(i),o=n(2),s=r(o),c=n(36),l=r(c),u=n(23),d=r(u),p=n(26),h=r(p),f=n(82),m=r(f),g=n(81),v=r(g),y=n(6),_=r(y),E=n(1249),b=r(E),w=n(14),M=r(w),C=n(38),S=r(C);t["default"]=function(e){return function(t){function n(){var e,t,r,i;(0,d["default"])(this,n);for(var a=arguments.length,o=Array(a),c=0;c<a;c++)o[c]=arguments[c];return t=r=(0,m["default"])(this,(e=(0,l["default"])(n)).call.apply(e,[this].concat(o))),r.isUnmounted=!1,r.rejectOnUnmount=function(){return r.rejectPromise?r.rejectPromise:(r.rejectPromise=new s["default"](function(e,t){r.rejector=t}),r.rejectPromise["catch"](S["default"].noop),r.isUnmounted&&r.rejector(new M["default"].Unmount),r.rejectPromise)},i=t,(0,m["default"])(r,i)}return(0,v["default"])(n,t),(0,h["default"])(n,[{key:"componentWillUnmount",value:function(){this.isUnmounted=!0,this.rejectPromise&&this.rejector(new M["default"].Unmount)}},{key:"render",value:function(){return _["default"].createElement(e,(0,a["default"])({ref:E.HOCRef,rejectOnUnmount:this.rejectOnUnmount},this.props))}}]),n}(b["default"])}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(434),a=r(i),o=n(1138),s=r(o),c=n(36),l=r(c),u=n(23),d=r(u),p=n(26),h=r(p),f=n(82),m=r(f),g=n(81),v=r(g),y=n(6),_=r(y),E=n(38),b=r(E),w=n(1249),M=r(w);e.exports=function(e){return function(t){function n(){var e,t,r,i;(0,d["default"])(this,n);for(var a=arguments.length,o=Array(a),c=0;c<a;c++)o[c]=arguments[c];return t=r=(0,m["default"])(this,(e=(0,l["default"])(n)).call.apply(e,[this].concat(o))),r.timers=new s["default"],r.timerId=0,r.setInterval=function(e,t){var n=setInterval(e,t);return r.reg(function(){return clearInterval(n)})},r.clearInterval=function(e){var t=r.timers.get(e);t&&t()},r.setTimeout=function(e,t){var n=setTimeout(e,t);return r.reg(function(){return clearTimeout(n)})},r.clearTimeout=function(e){var t=r.timers.get(e);t&&t()},r.debounce=function(e,t,n){var i=++r.timerId,a=b["default"].debounce(function(){r.timers["delete"](i),e()},t,n),o=a.cancel.bind(a);return a.cancel=function(){r.timers["delete"](i),o()},r.timers.set(i,a.cancel),a},r.reg=function(e){var t=++r.timerId;return r.timers.set(t,function(){r.timers["delete"](t),e()}),t},i=t,(0,m["default"])(r,i)}return(0,v["default"])(n,t),(0,h["default"])(n,[{key:"componentWillUnmount",value:function(){this.timers.forEach(function(e){return e()})}},{key:"render",value:function(){return _["default"].createElement(e,(0,a["default"])({ref:w.HOCRef,setInterval:this.setInterval,clearInterval:this.clearInterval,setTimeout:this.setTimeout,clearTimeout:this.clearTimeout,debounce:this.debounce},this.props))}}]),n}(M["default"])}},function(e,t,n){"use strict";var r=n(6),i=n(437),a=r.createClass({displayName:"IntroPanel",componentDidMount:function(){var e=this.refs.image,t=this.refs.text;this.props.animate?(Velocity(e,{scale:[1,0],opacity:[1,0]},{delay:1340,duration:180,easing:[.05,1.02,0,1.01]}),Velocity(t,{translateY:[0,80],opacity:[1,0]},{delay:1300,duration:140,easing:[.05,1.02,0,1.01]})):(e.style.opacity=1,t.style.opacity=1)},render:function(){return r.createElement("div",{className:"pane pane-intro pane-two"},r.createElement("div",{className:"intro-body"},r.createElement("div",{ref:"image",className:"intro-image"}),r.createElement("div",{ref:"text",className:"intro-text-container"},r.createElement("h1",{"data-a8n":i.key("intro-title"),className:"intro-title"},l10n.t("intro_title")),r.createElement("div",{"data-a8n":i.key("intro-text"),className:"intro-text"},l10n.t("intro_connection")))))}});e.exports=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){e.mustDownloadMedia=!1;var t=e.downloadPromise;t&&t.control.waitForPoke()}function a(e,t){if(!e.filehash)return M["default"].resolve();t&&(e.mustDownloadMedia=!0);var n=e.downloadPromise;if(n)return n.control.poke(),n;if(e.downloadStage===ce.DOWNLOAD_STAGE.ERROR_MISSING)return M["default"].reject(new de);if(e.downloadStage===ce.DOWNLOAD_STAGE.PREPARING)return M["default"].resolve();var r=M["default"].loop(function(t){if(e.mediaBlob)return R["default"].validateBlob(e.mediaBlob).then(function(n){return n?void t():(e.consolidate({mediaBlob:null}),!1)});var n=e.entries.getDownloadEntry(),r=void 0;if(n)r=s(e,n);else{if(!e.mustDownloadMedia)return e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.NEED_POKE}),M["default"].sit("poke");e.mustDownloadMedia=!1,r=o(e)}return r["catch"](O["default"].MediaNeedsReupload,function(){})["catch"](pe,ue,O["default"].MediaLoadError,function(t){return G["default"].error("msg:processMedia:"+t)(),e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.NEED_POKE}),M["default"].sit("poke")})}).then(function(){return e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.RESOLVED}),e.downloadPromise=null,e.resolveWhenConsolidated()}).endWithControls("poke","waitForPoke");return r["catch"](de,function(t){e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.ERROR_MISSING})})["catch"](O["default"].MediaUnsupportedError,function(){e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.ERROR_UNSUPPORTED})})["catch"](O["default"].LogoutDrop,function(){}),e.downloadPromise=r}function o(e){return e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.REUPLOADING}),e.rmr()["catch"](function(e){return!(e instanceof O["default"].LogoutDrop)},function(){return M["default"].reject(new O["default"].MediaNeedsReupload)}).then(function(e){switch(e.status){case 200:return;case 404:return M["default"].reject(new de);default:return M["default"].reject(new O["default"].MediaNeedsReupload)}})}function s(e,t){return e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.FETCHING}),M["default"].loop(function(n,r){var i=Q["default"].expDelaySec(r,60,void 0,.1);return Y["default"].waitForOnline.then(function(){return X["default"].getResponseIfOnline(t.mmsUrlOrBackup(),"GET",null,ae["default"].RESP_TYPE.ARRAY_BUFFER)}).addRejectControl("waitForPoke",function(){return new pe}).then(function(a){if(!(a&&a.status<500))return r>3?M["default"].reject(new O["default"].MediaNeedsReupload):Y["default"].online&&!t.useBackupUrl?(t.useBackupUrl=!0,0):(e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.NEED_POKE}),i["return"](r+1).addResolveControl("poke",function(){return 0}));if(a.status>=400)throw t.markWhetherOnServer(!1),new O["default"].MediaNeedsReupload;t.markWhetherOnServer(!0),n(a.response)})},0).then(function(n){if(!e.specifics)throw G["default"].assert(!1,"media-fault","object-without-type")(),new Error("downloaded object without type");var r=e.specifics.type;return e.entries.downloadedLocally(r),e.consolidate({downloadStage:ce.DOWNLOAD_STAGE.PROCESSING}),k["default"].decryptE2EMedia(r,n,t.encryptionKey,e.mimetype)["catch"](O["default"].MediaEncryptionError,function(e){return G["default"].assert(!1,"decryption-error","msg:processEncryptedMedia "+e)(),M["default"].reject(new de)})}).then(function(t){switch(e.type()){case le.TYPE.IMAGE:var n=window.URL.createObjectURL(t);return q["default"].image(n).then(function(e){return{mediaBlob:t,renderableUrl:n,fullWidth:e.fullWidth,fullHeight:e.fullHeight}});case le.TYPE.VIDEO:return q["default"].video(t).then(function(e){return{mediaBlob:t,renderableUrl:window.URL.createObjectURL(t),fullWidth:e.fullWidth,fullHeight:e.fullHeight}});case le.TYPE.AUDIO:return q["default"].transcode(t,e.mimetype).then(function(e){var n=window.URL.createObjectURL(e);return q["default"].audio(n)["return"]({mediaBlob:t,renderableUrl:n})});case le.TYPE.DOCUMENT:return{mediaBlob:t,renderableUrl:window.URL.createObjectURL(t)}}}).then(function(t){e.consolidate(t)})}function c(e,t){return M["default"].resolve(e).then(function(e){var n=t.asDocument?I.FILETYPE.DOCUMENT:R["default"].typeFromMimetype(e.type);if(e.size>N["default"].MAX_MEDIA_UPLOAD_SIZE||n===I.FILETYPE.IMAGE&&e.size>he)return M["default"].reject(new O["default"].MediaFileTooLarge(e));switch(n){case I.FILETYPE.IMAGE:return l(e);case I.FILETYPE.VIDEO:case I.FILETYPE.AUDIO:return u(e,!!t.isPtt,t.precomputedDuration,t.asGif,t.gifAttribution||(t.asGif?0:void 0));case I.FILETYPE.DOCUMENT:return d(e);default:return M["default"].reject(new Error("unrecognized media type "+n))}})}function l(e){return j["default"].rotateAndResize(e,N["default"].IMG_MAX_EDGE,N["default"].IMG_MAX_EDGE,j["default"].BLOB|j["default"].CANVAS).then(function(e){var t=e.width,n=e.height,r=e.images,i=r.blob,a=r.canvas;return j["default"].rotateAndResize(a,N["default"].IMG_THUMB_MAX_EDGE,N["default"].IMG_THUMB_MAX_EDGE,j["default"].DATA_URL).then(function(e){var r=e.width,a=e.height,o=e.images.dataUrl;return{type:ce.OUTWARD_TYPES.IMAGE,mediaBlob:i,mimetype:"image/jpeg",thumbWidth:r,thumbHeight:a,fullWidth:t,fullHeight:n,preview:$["default"].parseDataURL(o).data}})})}function u(e,t,n,r,i){return se["default"].checkAndRepair(e,!!r).then(function(a){if(!a)return G["default"].error("processRawAudioVideo bad video file "+e.type)(e),M["default"].reject(new O["default"].InvalidMediaFileType);var o=a.type,s=a.file,c=r||a.isGif;switch(R["default"].typeFromMimetype(o)){case I.FILETYPE.VIDEO:return t?(G["default"].assert(!1,"media-fault","ptt became video")(),M["default"].reject(new O["default"].InvalidMediaFileType)):j["default"].generateVideoThumbAndDuration(s,N["default"].IMG_THUMB_MAX_EDGE,N["default"].IMG_THUMB_MAX_EDGE).then(function(e){var t=e.thumb,n=e.duration;return{type:ce.OUTWARD_TYPES.VIDEO,mediaBlob:s,mimetype:o,thumbWidth:t.width,thumbHeight:t.height,fullWidth:t.fullWidth,fullHeight:t.fullHeight,preview:$["default"].parseDataURL(t.url).data,duration:n.toString(),isGif:c,gifAttribution:c?i||0:void 0}});case I.FILETYPE.AUDIO:return(void 0!==n?M["default"].resolve(n):R["default"].getAudioDuration(s)).then(function(e){return{type:t?ce.OUTWARD_TYPES.PTT:ce.OUTWARD_TYPES.AUDIO,mediaBlob:s,mimetype:o,duration:e.toString()}});default:throw G["default"].assert(!1,"media-fault","audio/video became other")(),new Error("audio/video became "+o)}})}function d(e){var t=e.type,n=e.name||void 0,r=void 0;if(t){if(!("*"===W["default"].DOC_MIMES||W["default"].DOC_MIMES.indexOf(t)>-1))return M["default"].reject(new O["default"].InvalidMediaFileType("disallowed mimetype "+t));r=M["default"].resolve(t)}else r=R["default"].blobToArrayBuffer(e).then(function(t){var r=(0,U["default"])(new Uint8Array(t,0,Math.min(262,t.byteLength)));if(r&&r.mime){var i=W["default"].DOC_MIMES?r.mime:W["default"].isAllowedDocumentMimetype(r.mime,n,!0);if(i)return i}else if(n){var a="",o=n.split(".");if(o.length>1&&(a=o[o.length-1]),a){var s="*"===W["default"].DOC_MIMES?W["default"].EXT_TO_MIME[a]||"application/octet-stream":W["default"].isAllowedDocumentMimetype(W["default"].EXT_TO_MIME[a],n,!1);if(s)return s}}return M["default"].reject(new O["default"].InvalidMediaFileType("type: "+e.type+" name: "+n))});return r.then(function(t){return{type:ce.OUTWARD_TYPES.DOCUMENT,mediaBlob:e,mimetype:t,filename:n||void 0}})}function p(e){e.uploadPromise&&e.uploadPromise.control.cancel()}function h(e,t){if(e.addUploadTargets([t]),e.uploadPromise)return e.uploadPromise.then(function(n){return e.hasUploadTarget(t)?h(e,t):n});e.consolidate({uploadStage:ce.UPLOAD_STAGE.UPLOADING});var n=g(e).then(function(t){return t?t:e.mediaBlob?f(e,e.mediaBlob):a(e,!0).addRawControl("cancel",function(e,t,n){t(new M["default"].CancellationError),n.control.waitForPoke()}).then(function(){var t=e.mediaBlob;if(!t)throw new Error("upload has no media blob after download");return f(e,t)})}).endWithControls("cancel");return n["finally"](function(){e.uploadPromise=null}).tap(function(){e.consolidate({uploadStage:ce.UPLOAD_STAGE.UPLOADED})})["catch"](O["default"].GaveUpRetry,M["default"].CancellationError,O["default"].Server5xxDrop,function(n){G["default"].error("MediaAlgo failed to upload to "+t+", "+n)(),e.consolidate({uploadStage:ce.UPLOAD_STAGE.NEED_UPLOAD})})["catch"](O["default"].LogoutDrop,function(){})["catch"](function(e){G["default"].assert(!1,"upload-uncaught-error",""+e)()}),e.uploadPromise=n}function f(e,t){var n=e.entries.getUploadEntry(),r=n&&n.encryptionKey||A["default"].newB64MediaKey();return R["default"].blobToArrayBuffer(t).addCancelControl().then(function(t){return k["default"].encryptE2EMedia(e.type(),t,r)}).addCancelControl().then(function(t){return R["default"].getHash(t).addCancelControl().then(function(n){var i=n.hash;return m(e,i,r,t)})})}function m(e,t,n,r){return M["default"].loop(function(i,a,o){if(o>4)throw new O["default"].GaveUpRetry("gave up mms upload after "+o+" tries");var s=Q["default"].expDelaySec(o+1,60);return M["default"].all([te["default"].requestEncryptedMediaUpload(e.uploadType(),t),v(e,n)]).addCancelControl().spread(function(a,c){var l=a.data,u=c.chatIds,d=c.refs,p=new FormData;return p.append("hash",t),p.append("refs",d.join("\r\n")),p.append("file",r),G["default"].log("MediaUpload attempt #"+o+" for hash: "+t)(),X["default"].getResponseIfOnline(l+"?f=j","POST",p).timeout(3e5*(o+1))["catch"](M["default"].TimeoutError,function(){return null}).addCancelControl().then(function(r){if(r&&200===r.status){G["default"].log("MediaUpload success: 200")(r.response);var a=JSON.parse(r.response);return void i(a.url?e.entries.addEntry(a.url,n,t,!1):null)}return G["default"].log("MediaUpload error: "+(r?r.status:"offline"))(),e.addUploadTargets(u),s.addCancelControl().then(function(){return Y["default"].waitForOnline})})})})}function g(e){return M["default"].loop(function(t,n,r){if(r>4)throw new O["default"].GaveUpRetry("gave up adding refs after "+r+" tries");var i=e.entries.getUploadEntry();if(!i)return t(null);var a=Q["default"].expDelaySec(r+1,60);return i.getUploadHash().then(function(t){return M["default"].all([t,te["default"].requestEncryptedMediaUpload(e.uploadType(),t),v(e,i.encryptionKey)])}).spread(function(n,o,s){var c=o.data,l=s.chatIds,u=s.refs,d=new FormData;return d.append("hash",n),d.append("refs",u.join("\r\n")),X["default"].getResponseIfOnline(c+"?f=j","POST",d).timeout(3e5*(r+1))["catch"](M["default"].TimeoutError,function(){return null}).then(function(r){if(r&&200===r.status){var o=JSON.parse(r.response);return void t(o.url?e.entries.addEntry(o.url,i.encryptionKey,n,!1):null)}return G["default"].log("addRefsToMedia error: "+(r?r.status:"offline"))(),e.addUploadTargets(l),a.then(function(){return Y["default"].waitForOnline})})})})["catch"](O["default"].MediaNeedsReupload,O["default"].GaveUpRetry,function(){return null})}function v(e,t){var n=e.claimUploadTargets();return M["default"].map(n,function(e){return re["default"].isUser(e)?[e]:window.Store.GroupMetadata.find(e).then(function(e){return e.participants.map(function(e){return e.id})})}).then(function(n){var r=(0,b["default"])({},window.Store.Conn.me,!0);return n.forEach(function(e){e.forEach(function(e){r[e]=!0})}),A["default"].computeRefs(S["default"].computeKeys(e.type(),t).refKey,(0,_["default"])(r))}).then(function(e){return{chatIds:n,refs:e}})}Object.defineProperty(t,"__esModule",{value:!0}),t.uploadMediaForChat=t.downloadMedia=void 0;var y=n(45),_=r(y),E=n(1136),b=r(E),w=n(2),M=r(w);t.cancelDownloadMedia=i,t.processRawMedia=c,t.cancelUploadMedia=p;var C=n(222),S=r(C),T=n(1529),k=r(T),x=n(10),N=r(x),P=n(14),O=r(P),D=n(1355),A=r(D),I=n(439),R=r(I),L=n(458),U=r(L),F=n(1252),j=r(F),B=n(1),G=r(B),z=n(220),W=r(z),H=n(1357),q=r(H),V=n(108),Y=r(V),K=n(56),X=r(K),Z=n(90),Q=r(Z),J=n(88),$=r(J),ee=n(55),te=r(ee),ne=n(24),re=r(ne),ie=n(147),ae=r(ie),oe=n(1336),se=r(oe),ce=n(1302),le=(r(ce),n(1303)),ue=O["default"].define("WapBlockedMedia"),de=O["default"].define("MediaNotOnPhone"),pe=O["default"].define("WaitForPoke"),he=26214400,fe=M["default"].wrap(a);t.downloadMedia=fe;var me=M["default"].wrapSync(h);t.uploadMediaForChat=me},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){e.entries.sort(function(e,t){return a(t)-a(e)})}function a(e){var t=0;switch(e.encrypted&&(t+=1e4),e.needsMediaAck&&(t+=1e3),e.serverStatus){case E.PROBABLY_ON_SERVER:t+=200;break;case E.PROBABLY_OFF_SERVER:break;case E.UNKNOWN:t+=100}return e.uploadHash?t+=20:e._uploadHashPromise&&(t+=10),t}Object.defineProperty(t,"__esModule",{value:!0}),t.MediaEntryList=t.MediaEntry=void 0;var o=n(2),s=r(o),c=n(23),l=r(c),u=n(26),d=r(u),p=n(14),h=r(p),f=n(1355),m=r(f),g=n(1),v=r(g),y=n(1363),_=r(y),E=(n(1303),{PROBABLY_ON_SERVER:"PROBABLY_ON_SERVER",PROBABLY_OFF_SERVER:"PROBABLY_OFF_SERVER",UNKNOWN:"UNKNOWN"}),b=t.MediaEntry=function(){function e(t,n,r){(0,l["default"])(this,e),this.needsMediaAck=!1,this.useBackupUrl=!1,this._uploadHashPromise=null,this.mmsUrl=t,this.encryptionKey=n,this.uploadHash=r,this.serverStatus=E.UNKNOWN,this.encrypted&&!this.encryptionKey&&v["default"].assert(!1,"media-fault","No encryption key for "+t)()}return(0,d["default"])(e,[{key:"getUploadHash",value:function(){var e=this;if(this._uploadHashPromise)return this._uploadHashPromise;if(this.uploadHash)return this._uploadHashPromise=s["default"].resolve(this.uploadHash);var t=_["default"].headRetry(this.mmsUrl).then(function(t){if(200!==t.status)throw e.serverStatus=E.PROBABLY_OFF_SERVER,new h["default"].MediaNeedsReupload;var n=t.getResponseHeader("X-WA-Metadata"),r=/\bfilehash=([A-Za-z0-9+\/]+=?=?)(?:;|$)/.exec(n||"");if(r)return e.serverStatus=E.PROBABLY_ON_SERVER,e.uploadHash=r[1];throw v["default"].assert(!1,"wa-metadata-header-missing","HEAD "+e.mmsUrl+" got "+t.status+" (header="+n+")")(),e.serverStatus=E.PROBABLY_OFF_SERVER,new h["default"].MediaNeedsReupload});return t["catch"](function(){e._uploadHashPromise=null}),this._uploadHashPromise=t}},{key:"mmsUrlOrBackup",value:function(){return this.useBackupUrl?this.mmsUrl.replace(/^https:\/\/[^\/]+\//,"https://mms.whatsapp.net/"):this.mmsUrl}},{key:"markWhetherOnServer",value:function(e){this.serverStatus=e?E.PROBABLY_ON_SERVER:E.PROBABLY_OFF_SERVER}}]),e}();t.MediaEntryList=function(){function e(){(0,l["default"])(this,e),this.entries=[]}return(0,d["default"])(e,[{key:"addEntry",value:function(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];if(!/\.enc$/.test(e))return null;for(var i=this.entries,a=void 0,o=0;!a&&o<i.length;o++)i[o].mmsUrl===e&&(a=i[o]);var s=void 0;if(a)t&&t!==a.encryptionKey&&v["default"].assert(!1,"media-fault","mismatch decryption key for "+e)(),n&&(v["default"].assert(!a.uploadHash||a.uploadHash===n,"media-fault","same entry has multiple upload hashes")(),a.uploadHash=n),s=a;else{if(!t)return null;s=new b(e,t,n),i.push(s)}return r&&(s.needsMediaAck=!0,s.serverStatus=E.PROBABLY_ON_SERVER),s}},{key:"knowsUrl",value:function(e){for(var t=this.entries,n=0;n<t.length;n++)if(t[n].mmsUrl===e)return!0;return!1}},{key:"getUploadEntry",value:function(){i(this);for(var e=this.entries,t=0;t<e.length;t++)if(e[t].encrypted)return e[t];return null}},{key:"getDownloadEntry",value:function(){i(this);var e=this.entries[0];return e&&e.serverStatus!==E.PROBABLY_OFF_SERVER?e:null}},{key:"downloadedLocally",value:function(e){this.entries.forEach(function(t){t.needsMediaAck&&(t.needsMediaAck=!1,t.serverStatus=E.UNKNOWN,m["default"].ackE2EMedia(e,t.encryptionKey,t.mmsUrl))})}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1240),a=r(i),o=n(105),s=r(o),c=n(6),l=n(37),u=n(8),d=n(1233),p=n(1235),h=n(1234),f=n(1239),m=n(1269),g=n(141),v=n(1245),y=n(84),_=n(85),E=c.createClass({displayName:"ArchivedDrawer",mixins:[g],getInitialState:function(){this.selection=new v([],function(e){return e.id})},componentDidMount:function(){this.addObserver(Store.Chat,"change:archive add remove"),this.refs.list&&y.focus(l.findDOMNode(this.refs.list))},onClick:function(e,t){u.openChatFromUnread(t).then(function(e){e&&u.focusChatTextInput(t)}),this.onClose()},onClose:function(){this.context.uim.uie.requestDismiss()},getList:function(){return Store.Chat.filter("archive")},onNextChat:function(e){e.preventDefault(),e.stopPropagation(),this.selection.setNext()},onPrevChat:function(e){e.preventDefault(),e.stopPropagation(),this.selection.setPrev()},render:function(){var e=this,t=void 0,n=this.getList();if(this.selection.init(n,!0),n.length>0){var r=n.map(function(t){return c.createElement(m,{chat:t,mode:m.Mode.LAST,key:t.id,active:e.selection,onClick:e.onClick})}),i={down:this.onNextChat,up:this.onPrevChat};t=c.createElement(s["default"],{handlers:i,ref:"list",className:"drawer-section-main chatlist","data-list-scroll-container":!0},c.createElement(a["default"],{data:r,height:a["default"].DEFAULT_HEIGHT,extraItems:4}))}else t=c.createElement(f.Archived,null);return c.createElement(d,{id:"blocked",onCancel:this.onClose},c.createElement(p,{title:l10n.t("archived_flow_title"),onBack:this.onClose,type:p.Type.LARGE}),c.createElement(h,null,t))}});E.contextTypes={uim:c.PropTypes.instanceOf(_)},e.exports=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(37),c=n(14),l=n(1229),u=n(1346),d=n(142),p=n(145),h=n(1236),f=n(141),m=n(10),g=n(8),v=n(1354),y=n(44),E=n(1260),b=n(1139),w=n(1233),M=n(1235),C=n(1234),S=n(1293),T=n(1369),k=n(1367),x=n(1370),N=n(1368),P=n(1231),O=n(84),D=n(439),A=n(144),I=n(435),R=n(106),L=n(1242),U=l.TYPE,F=U.IMAGE,j=U.VIDEO,B=U.DOCUMENT,G=U.AUDIO,z=n(220),W=_.pickBy(z.MIMETYPES,function(e){return e.msgType===B}),H=function(e){return 150+15*e},q=400,V=u.STATE.PROCESSING,Y=o.createClass({displayName:"AttachMediaDrawer",mixins:[d,p,h,f],propTypes:{chat:o.PropTypes.instanceOf(P),files:o.PropTypes.array,mediaCollection:o.PropTypes.object.isRequired,onBack:o.PropTypes.func.isRequired,onSendMedia:o.PropTypes.func.isRequired,onDropText:o.PropTypes.func.isRequired},getDefaultProps:function(){return{isDragging:!1}},getInitialState:function(){return this.transition="media-scale",{activeMedia:null}},componentWillMount:function(){this.regNativeListener(window,"keydown",this.onKeyDown),this.regNativeListener(window,"drop",this.onWindowDrop)},componentDidMount:function(){this.addObserver(this.props.mediaCollection,"add remove reset"),this.addObserver(this.props.mediaCollection,"change:state",this.onProcessComplete),this.addObserver(this.props.mediaCollection,"max_upload_limit",this.showIgnoredToast)},componentWillUpdate:function(e,t){var n=t.activeMedia,r=this.state.activeMedia;return r&&n&&r!==n?void(this.props.mediaCollection.indexOf(n)>this.props.mediaCollection.indexOf(r)?this.transition="media-slide-forward":this.transition="media-slide-back"):void(this.transition="media-scale")},componentDidUpdate:function(e,t){!t.activeMedia&&this.state.activeMedia&&this.refs.emojiInput?this.refs.emojiInput.restoreFocus():!s.findDOMNode(this).contains(document.activeElement)&&this.refs.sendButton&&O.focus(this.refs.sendButton)},onProcessComplete:function(){if(!this.props.mediaCollection.some({state:V})){var e=this.props.mediaCollection.getValidMedias(),t=this.props.mediaCollection.uiProcessMsgs(),n=t.activeMedia,r=t.errorMsgs;r&&e.length>0&&g.openToast(o.createElement(I,{msg:r,id:I.genId()})),n?this.setState({activeMedia:n}):this.forceUpdate()}},showIgnoredToast:function(e){if(e>0){var t=l10n.t("too_many_files_uploaded",{number:e,_plural:e,max:m.MAX_FILES});g.openToast(o.createElement(I,{msg:t,id:I.genId()}))}},onDragStart:function(e){this.blockDrop=!0},onDragEnd:function(e){this.blockDrop=!1},onDragOver:function(e){this.state.isDragging||this.blockDrop||this.setState({isDragging:!0})},onWindowDrop:function(e){_.isEmpty(this.props.files)&&_.isEmpty(this.props.mediaCollection)&&this.props.onBack()},onDrop:function(e){this.blockDrop||(this.setState({isDragging:!1}),this.onFilePick(e))},onDragLeave:function(e){this.props.mediaCollection.length||this.props.onBack(),this.setState({isDragging:!1})},onKeyDown:function(e){if(this.state.activeMedia&&!e.repeat)if(37===e.keyCode){var t=this.state.activeMedia,n=this.refs.emojiInput&&this.refs.emojiInput.refs.inputLine;(t&&!t.caption||n&&(n.isAtBeginning()||!n.getCursor()))&&this.onPrev()}else if(39===e.keyCode){var r=this.state.activeMedia,i=this.refs.emojiInput&&this.refs.emojiInput.refs.inputLine;(r&&!r.caption||i&&(i.isAtEnd()||!i.getCursor()))&&this.onNext()}else 13===e.keyCode&&this.onSend()},onNext:function(){var e=this.props.mediaCollection.getAfter(this.state.activeMedia);e&&this.setState({activeMedia:e})},onPrev:function(){var e=this.props.mediaCollection.getBefore(this.state.activeMedia);e&&this.setState({activeMedia:e})},onSelectThumb:function(e,t){e!==this.state.activeMedia&&this.setState({activeMedia:e})},onSend:function(e){this.props.onSendMedia(_.map(this.props.mediaCollection.getValidMedias(),function(e){var t=e.caption;return t&&(t=_.trim(e.caption)),t&&(t=L.emojify(t)),t&&(e.caption=t),e})),e&&e.preventDefault()},onAddFileClick:function(e){var t=this.refs.input;t.click()},onFilePick:function(e){var t=this;v.getFiles(e).then(function(e){return t.props.mediaCollection.processFiles(e,t.props.chat)}).checkpoint(this.rejectOnUnmount())["catch"](c.Unmount,_.noop)["catch"](c.MediaDragDropError,function(e){if(t.props.mediaCollection.length)throw e;t.props.onDropText(e.src)}),e.target.value=""},onRemoveThumb:function(e,t){t.stopPropagation(),t.preventDefault();var n=this.props.mediaCollection.getBefore(e)||this.props.mediaCollection.getAfter(e);this.props.mediaCollection.remove(e),this.setState({activeMedia:n})},onCaptionChange:function(e){var t=this.state.activeMedia;t.caption=e.target.value,this.setState({media:t})},onPaste:function(e){e.preventDefault(),e.stopPropagation();var t=new b(e.clipboardData);t.hasFiles()&&this.onFiles(t)},onFiles:function(e){var t=_.filter(e.getFiles(),function(e){var t=D.typeFromMimetype(e.type);return"image"===t||"video"===t});this.props.mediaCollection.processFiles(t,this.props.chat)},getMedia:function(){var e=void 0,t=void 0,n=this.state.activeMedia;switch(n.media.type){case F:case j:var r=void 0;n.media.fullWidth&&n.media.fullHeight&&(r={width:n.media.fullWidth,height:n.media.fullHeight}),e=o.createElement(T,{mimeType:n.media.mimetype,url:n.url,isGif:!!n.media.isGif,size:r}),t=o.createElement("div",{className:"media-caption"},o.createElement(E,{ref:"emojiInput",editable:!0,value:n.caption,placeholder:l10n.t("add_a_caption"),maxLength:m.MAX_CAPTION_LENGTH,showRemaining:!0,onEnter:this.onSend,onChange:this.onCaptionChange,onFiles:this.onFiles,supportsEmoji:!0}));break;case G:e=o.createElement(k,{mimeType:n.media.mimetype,url:n.url});break;case B:switch(z.previewType(n.media.mimetype)){case"pdf":e=o.createElement(x,{preview:n.generatedPreview,mimeType:n.media.mimetype,filename:n.media.filename});break;case"msoffice":e=o.createElement(N,{preview:n.generatedPreview,mimeType:n.media.mimetype,filename:n.media.filename});break;default:e=o.createElement(S,{mimeType:n.media.mimetype,filename:n.media.filename})}}return o.createElement("div",{className:"media-body-container",key:n.id},e,t)},getThumbs:function(e){var t=this;return e.map(function(e,n){var r=y("media-thumb","stagger-delay",{active:e===t.state.activeMedia}),i=t.props.mediaCollection.indexOf(t.state.activeMedia),a=Math.max(t.props.mediaCollection.length-i-1,1),s=H(n)/a*Math.max(0,n-i)+"ms";return o.createElement(K,{className:r,key:"media-"+e.id,media:e,onClick:t.onSelectThumb.bind(null,e),onClose:t.onRemoveThumb.bind(null,e),staggerDelay:s})})},render:function(){var e=void 0,t=void 0,n=void 0,r=0,i=this.props.mediaCollection.getValidMedias();i.length>m.MAX_FILES&&(i=i.slice(0,m.MAX_FILES)),this.props.mediaCollection.some({state:V})?e=o.createElement(A,{key:"processing"}):this.state.activeMedia?e=this.getMedia():0===i.length&&this.props.mediaCollection.errorMsgs&&(e=o.createElement("div",{className:"invalid-media-container",key:"pending"},o.createElement("div",{className:"invalid-media"},this.props.mediaCollection.errorMsgs))),i.length>0&&(t=this.getThumbs(i),r=1===i.length?q:q+H(i.length),n=o.createElement("div",{className:"drawer-controls",tabIndex:"-1",ref:"sendButton",onKeyPress:function(e){return e.preventDefault()}},o.createElement("button",{className:"btn btn-round btn-l",onClick:this.onSend},o.createElement("span",{className:"icon icon-send-light"}))));var s=this.state.isDragging?o.createElement("div",{key:"container",className:"drag-drop"},o.createElement("div",{className:"stitching"},l10n.t("drag_media_here"))):null,c=i.length<m.MAX_FILES?o.createElement("div",{key:"media-more",className:"media-thumb btn-add-media",onClick:this.onAddFileClick},o.createElement("button",{className:"btn-fill"},o.createElement("span",{className:"icon icon-add-alt"}),l10n.t("add_media"))):null,l={enter:this.onSend};return o.createElement(w,{key:"attach-image-modal",ref:"container",position:"right",id:"media",variant:"noheader",onDrop:this.onDrop,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave},o.createElement(M,{title:l10n.t("web_preview_msg"),type:M.Type.OFFSET,onCancel:this.props.onBack}),o.createElement(C,{onDragStart:this.onDragStart,onPaste:this.onPaste,onDragEnd:this.onDragEnd},s,o.createElement("div",{className:"media-body"},o.createElement(R,{transitionName:this.transition},e)),o.createElement(R,{transitionName:"thumb-scale",className:"media-collection"},t,c),o.createElement(a["default"],{handlers:l},o.createElement(R,{transitionName:"btn",delay:r},n)),o.createElement("input",{ref:"input",type:"file",accept:m.IMAGE_MIMES+","+m.VIDEO_MIMES,style:{display:"none"},onChange:this.onFilePick,multiple:!0})))}}),K=o.createClass({displayName:"AttachMediaThumb",propTypes:{media:o.PropTypes.instanceOf(u).isRequired,className:o.PropTypes.string,
onClick:o.PropTypes.func,onClose:o.PropTypes.func},render:function(){var e=this.props,t=e.media,r=e.className,i=e.onClick,a=e.onClose,s=void 0,c=void 0,l=void 0;switch(t.media.type){case F:l={backgroundImage:"url("+t.url+")"},s=o.createElement("div",{className:"media-thumb-body",style:l});break;case j:l={backgroundImage:"url(data:image/jpeg;base64,"+t.preview+")"},s=o.createElement("div",{className:"media-thumb-body",style:l});break;case G:s=o.createElement("div",{className:"attach-media-audio-thumb"});break;case B:var u=n(1);if(u.log("media is",t)(),t.media.documentPreview&&t.media.documentPreview.thumbUrl){var d={backgroundImage:"url("+t.media.documentPreview.thumbUrl+")"};W[t.media.mimetype]&&(c=W[t.media.mimetype].icon),c=y(c,"icon-doc","icon-doc-thumb-filetype"),s=o.createElement("div",{className:"media-thumb-body",style:d},o.createElement("div",{className:c}));break}W[t.media.mimetype]&&(c=W[t.media.mimetype].icon);default:c=y(c,"icon-doc"),s=o.createElement("div",{className:"media-thumb-body"},o.createElement("div",{className:c}))}return o.createElement("div",{className:r,onClick:i},o.createElement("span",{className:"btn-delete icon icon-x-alt-light",onClick:a}),s)}});e.exports=Y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1240),a=r(i),o=n(6),s=n(8),c=n(1233),l=n(1235),u=n(1234),d=n(1239),p=n(1251),h=n(432),f=n(141),m=n(1304),g=o.createClass({displayName:"BlockedDrawer",mixins:[f],propTypes:{onClose:o.PropTypes.func},componentWillMount:function(){this.addObserver(Store.Blocklist,"add remove")},onBlockConfirm:function(e){e.setBlock(!0)["catch"](_.noop),s.closeModal()},onBlock:function(e){var t=function(e){return!!Store.Contact.isFilteredContact(e)&&(!Store.Blocklist.get(e.id)||l10n.t("participant_already_blocked"))};s.openModal(o.createElement(m,{title:l10n.t("add_blocked_title"),filter:t,onCancel:s.closeModal.bind(s),onSelect:_.once(this.onBlockConfirm)}))},onUnblockConfirm:function(e){e.setBlock(!1)["catch"](_.noop),s.closeModal()},onUnblockCancel:function(){s.closeModal()},onUnblock:function(e,t){s.openModal(o.createElement(h,{okText:l10n.t("unblock_button"),onOK:this.onUnblockConfirm.bind(this,t),cancelText:l10n.t("web_cancel"),onCancel:this.onUnblockCancel},l10n.t("unblock_confirmation",{contact:t.formattedName})))},render:function(){var e=this,t=void 0,n=void 0;if(Store.Blocklist.length>0){var r=Store.Blocklist.map(function(t){return o.createElement(p,{contact:t.contact,key:t.contact.id,onClick:e.onUnblock,onDelete:e.onUnblock})});t=o.createElement("div",{className:"drawer-section-main chatlist","data-list-scroll-container":!0},o.createElement(a["default"],{data:r,height:a["default"].DEFAULT_HEIGHT,extraItems:4})),n=o.createElement("div",{className:"hint"},l10n.t("add_blocked_description"))}else t=o.createElement(d.Blocked,null);return o.createElement(c,{id:"blocked",onCancel:this.props.onClose},o.createElement(l,{title:l10n.t("blocked_flow_title"),onBack:this.props.onClose,type:l.Type.LARGE}),o.createElement(u,null,o.createElement("div",{className:"list-action",onClick:this.onBlock},o.createElement("div",{className:"list-action-icon"},o.createElement("span",{className:"icon icon-add-user"})),o.createElement("div",{className:"list-action-body"},l10n.t("add_blocked_title"))),t,n))}});e.exports=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1240),a=r(i),o=n(6),s=n(1230),c=n(141),l=n(8),u=n(1231),d=n(143),p=n(1251),h=n(1233),f=n(1234),m=n(1256),g=n(1262),v=n(1237),y=n(1276),_=n(85),E=n(104),b=o.createClass({displayName:"BroadcastInfoDrawer",mixins:[s,c],propTypes:{chat:o.PropTypes.instanceOf(u).isRequired},getInitialState:function(){return{everyoneEncrypted:this.async("chat.contact.plaintextDisabled")}},componentWillMount:function(){var e=this.props.chat.groupMetadata;this.addObserver(e.participants,"add remove sort reset")},onParticipantClick:function(e,t){Store.Conn.me!==t.id&&Store.Chat.find(t.id).then(function(e){l.openChatFromUnread(e).then(function(t){t&&l.focusChatTextInput(e)})})},onClose:function(){this.props.onClose?this.props.onClose():this.context.uim.uie.requestDismiss()},onDelete:function(){l.deleteOrExitChat(this.props.chat)},render:function(){var e=this.props.chat,t=e.groupMetadata,n=this.onParticipantClick,r=t.participants.map(function(e){var t=Store.Contact.get(e.id)||Store.Contact.add({id:e.id});return o.createElement(p,{contact:t,admin:!!e.isAdmin,onClick:n,key:e.id})}),i=null;if(this.props.onMediaGallery){var s=o.createElement("span",{className:"icon icon-chevron-right-alt"}),c=E.supportsFeature(E.F.LINK_DOC_GALLERY)?l10n.t("media_links_docs"):l10n.t("media");i=o.createElement(m,{title:c,titleOnClick:this.props.onMediaGallery,subtitle:s,classes:"animate-enter2",noContainer:!0},o.createElement(y,{chat:e}))}var l,u=null,_=r.length?o.createElement(m,{classes:"animate-enter1 well-simple-body",title:l10n.t("web_recipients_title"),subtitle:l10n.n(r.length),"data-list-scroll-offset":!0},o.createElement("div",{className:"drawer-section-body chatlist"},o.createElement(a["default"],{data:r,height:72,extraItems:4}))):null;e.canDelete()&&(l=o.createElement("div",{className:"drawer-section chatlist list-icons animate-enter2 well-simple"},o.createElement(g,{iconClass:"icon-delete-danger",a8n:"li-delete-broadcast",className:"danger first",onClick:this.onDelete},l10n.t("web_delete_list"))));var b;e.groupMetadata.creation?(b=d.timeStr(e.groupMetadata.creation),b=o.createElement("div",{className:"header-secondary"},l10n.t("web_group_creation_time",{when:b}))):b=null;var w=null,M=null;return(u||w)&&(M=o.createElement(m,{classes:"well-simple animate-enter2"},u,w)),o.createElement(h,{key:"contact-info-modal",id:"info",variant:"panel",onCancel:this.onClose},o.createElement("header",{className:"pane-header"},o.createElement("div",{className:"header-close"},o.createElement("button",{onClick:this.onClose},o.createElement("span",{className:"icon icon-x"}))),o.createElement("div",{className:"header-body"},o.createElement("div",{className:"header-main"},o.createElement("div",{className:"header-title"},l10n.t("broadcast_list_info")),b))),o.createElement(f,{expands:!!r.length,"data-list-scroll-container":!0},o.createElement(m,{classes:"drawer-scale drawer-section-photo"},o.createElement(v,{id:e.id,size:v.Size.LARGE})),i,M,_,l))}});b.contextTypes={uim:o.PropTypes.instanceOf(_)},e.exports=b},function(e,t,n){"use strict";var r=n(6),i=n(1265),a=n(1338),o=n(8),s=r.createClass({displayName:"CaptureModal",propTypes:{onSend:r.PropTypes.func.isRequired,stream:r.PropTypes.object.isRequired},onCancel:function(){o.closeModal()},onSend:function(e){this.props.onSend(e.file),this.onCancel()},render:function(){return r.createElement(i,{type:i.BOX},r.createElement(a,{onBack:this.onCancel,caption:!1,onSend:this.onSend,stream:this.props.stream,noContainer:!0}))}});e.exports=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1270),m=r(f),g=n(1240),v=r(g),y=n(105),_=r(y),E=n(6),b=n(37),w=n(450),M=n(38),C=window.Store,S=n(1265),T=n(8),k=n(1233),x=n(1235),N=n(1234),P=n(1269),O=(n(1231),n(1251)),D=(n(219),n(1239)),A=n(1281),I=n(1245),R=n(84),L=n(440),U=n(104),F=n(1249),j=F.GetRef,B=function(e){function t(){(0,s["default"])(this,t);var e=(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments));return e.state={searchText:""},e.filteredData=null,e}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillMount",value:function(){this.selection=new I(this.getData(),function(e){return e.id})}},{key:"getFrequentContacts",value:function(){var e=this.state.searchText;return e||!U.supportsFeature(U.F.FREQUENT_CONTACTS)?[]:C.Contact.frequentContacts(null,this.props.excludeChat)}},{key:"getFilteredChats",value:function(){var e=this.state.searchText;return e?(e=L.accentFold(e),C.Chat.filter(function(t){return t.canSend&&t.isVisible&&t.contact.searchMatch(e)})):C.Chat.filter(function(e){return e.canSend&&e.isVisible})}},{key:"getFilteredContacts",value:function(){var e=C.Contact.getFilteredContacts(),t=this.state.searchText;return t?(t=L.accentFold(t),e.filter(function(e){return e.searchMatch(t)})):e}},{key:"getFilteredData",value:function(){if(this.filteredData)return this.filteredData;var e={},t=this.getFrequentContacts();M.forEach(t,function(t){e[t.id]=!0});var n=[],r=this.getFilteredChats();M.forEach(r,function(t){e[t.id]||(e[t.id]=!0,n.push(t))});var i=[],a=this.getFilteredContacts();return M.forEach(a,function(t){e[t.id]||i.push(t)}),this.filteredData={frequentContactsData:t,chatsData:n,contactsData:i}}},{key:"getFilteredItems",value:function(){var e=this,t=[],n=this.getFilteredData(),r=n.frequentContactsData,i=n.chatsData,a=n.contactsData;return r.length&&t.push(E.createElement(A,{key:"frequent-contacts-header",header:L.t("web_frequent_contacts")})),M.forEach(r,function(n){t.push(n.isGroup?E.createElement(P,{active:e.selection,chat:C.Chat.get(n.id),mode:P.Mode.INFO,noContext:!0,onClick:e.forwardToChat.bind(e),key:n.id}):E.createElement(O,{active:e.selection,contact:n,onClick:e.forwardToContact.bind(e),secondary:n.isBlocked()?L.t("confirm_unblock_contact_and_forward_text"):null,key:n.id}))}),i.length&&t.push(E.createElement(A,{key:"chat-header",header:L.t("web_recent_chats")})),M.forEach(i,function(n){t.push(n.isGroup?E.createElement(P,{active:e.selection,chat:n,mode:P.Mode.INFO,noContext:!0,onClick:e.forwardToChat.bind(e),key:n.id}):E.createElement(O,{active:e.selection,contact:n.contact,onClick:e.forwardToContact.bind(e),secondary:n.contact.isBlocked()?L.t("confirm_unblock_contact_and_forward_text"):null,key:n.id}))}),a.length&&t.length&&t.push(E.createElement(A,{key:"contact-header",header:L.t("web_other_contacts")})),M.forEach(a,function(n){t.push(E.createElement(O,{active:e.selection,contact:n,onClick:e.forwardToContact.bind(e),secondary:n.isBlocked()?L.t("confirm_unblock_contact_and_forward_text"):null,key:n.id}))}),t}},{key:"getData",value:function(){var e=this.getFilteredData(),t=e.frequentContactsData,n=e.chatsData,r=e.contactsData;return M.concat(t,n,r)}},{key:"getList",value:function(){var e=this.getFilteredItems();return 0===e.length?null:E.createElement(v["default"],{data:e,ref:j("list",this),height:72,extraItems:4})}},{key:"forwardToContact",value:function(e,t){C.Chat.find(t.id).then(this.forwardToChat.bind(this,e))}},{key:"forwardToChat",value:function(e,t){this.props.onChat(t)}},{key:"onSearch",value:function(e){this.filteredData=null,this.setState({searchText:e})}},{key:"onStopSearch",value:function(){this.filteredData=null,this.setState({searchText:""})}},{key:"onCancel",value:function(){T.closeModal()}},{key:"onSelectFirst",value:function(e){e.preventDefault(),e.stopPropagation();var t=M.head(this.getData());t&&this.forwardToContact(e,t)}},{key:"onFocusList",value:function(e){e.preventDefault(),e.stopPropagation(),_["default"].flashFocus=Date.now(),this.selection.setFirst()}},{key:"indicateSearchFocus",value:function(e){if(this.selection.unset(),!(Date.now()-(_["default"].flashFocus||0)>200)&&this.search){var t=b.findDOMNode(this.search);w(t,"stop"),w(t,{backgroundColor:["#fbfbfb","#D9F3FF"]},{duration:1600,easing:[.19,.69,.01,.99]})}}},{key:"onListFocus",value:function(e){this.list&&e.target!==b.findDOMNode(this.list)||(this.selection.index<0?this.selection.setFirst():this.selection.reset())}},{key:"onNext",value:function(e){e.preventDefault(),e.stopPropagation(),this.selection.setNext()}},{key:"onPrev",value:function(e){e.stopPropagation(),e.preventDefault();var t=this.selection.prev();t>-1?this.selection.setPrev():(this.selection.unset(),_["default"].flashFocus=Date.now(),R.focus(this.search))}},{key:"render",value:function(){var e=this.getList();this.selection.init(this.getData()),e||(e=this.state.searchText?E.createElement(D.Search,null):E.createElement(D.ListChats,null));var t={down:this.onFocusList.bind(this),enter:this.onSelectFirst.bind(this)},n={down:this.onNext.bind(this),up:this.onPrev.bind(this)};return E.createElement(S,{type:S.TOWER},E.createElement(k,{key:"chat-modal",onCancel:this.onCancel},E.createElement(x,{title:this.props.title,type:x.Type.POPUP,onCancel:this.onCancel}),E.createElement(_["default"],{handlers:t,onFocus:this.indicateSearchFocus.bind(this)},E.createElement(m["default"],{ref:j("search",this),onSearch:this.onSearch.bind(this),placeholder:L.t("search")})),E.createElement(N,{"data-list-scroll-container":!0},E.createElement(_["default"],{handlers:n,onFocus:this.onListFocus.bind(this),className:"column",ref:"list"},E.createElement("div",{className:"chatlist column"},e)))))}}]),t}(E.Component);e.exports=B},function(e,t,n){"use strict";var r=n(6),i=n(437),a=n(1231),o=n(8),s=n(104),c=n(1271),l=n(1232),u=n(432),d=r.createClass({displayName:"ClearChatPopup",propTypes:{onCancel:r.PropTypes.func,onDeleteOrExit:r.PropTypes.func,chat:r.PropTypes.instanceOf(a).isRequired},getInitialState:function(){return{keepStarred:!0}},getText:function(){var e=this.props.chat;switch(e.kind){case a.KIND.GROUP:return l10n.t("clear_chat_group",{name:e.title()});case a.KIND.CHAT:return l10n.t("clear_chat_chat",{name:e.title()});case a.KIND.BROADCAST:return l10n.t("clear_chat_broadcast");default:return""}},onCancel:function(){o.closeModal()},onClear:function(){var e=this.props.chat;e.pendingAction++,e.sendClear(s.supportsFeature(s.F.STARRED)&&s.supportsFeature(s.F.CHAT_CLEAR_STARRED)&&this.state.keepStarred)["finally"](function(){e.pendingAction--}),o.closeModal()},onToggleStarred:function(){this.setState({keepStarred:!this.state.keepStarred})},render:function(){var e=void 0;return s.supportsFeature(s.F.STARRED)&&s.supportsFeature(s.F.CHAT_CLEAR_STARRED)&&(e=r.createElement("div",{className:"controls-section",onClick:this.onToggleStarred},r.createElement("div",{"data-a8n":i.key("menu-icon-clear-chat"),className:"control"},r.createElement(c,{onChange:this.onToggleStarred,checked:this.state.keepStarred})),r.createElement("div",{className:"label"},l10n.t("keep_starred")))),r.createElement(u,{title:l10n.t("are_you_sure"),onOK:this.onClear,okText:l10n.t("clear_button"),onCancel:this.onCancel},r.createElement("div",null,r.createElement(l,{text:this.getText()}),e))}});e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1270),a=r(i),o=n(105),s=r(o),c=n(6),l=n(1233),u=n(1235),d=n(1234),p=n(1314),h=n(1239),f=n(145),m=n(84),g=n(1249),v=g.GetRef,y=c.createClass({displayName:"ContactDrawer",mixins:[f],propTypes:{onBack:c.PropTypes.func.isRequired,onClick:c.PropTypes.func.isRequired},getInitialState:function(){return{searchText:"",active:!1}},componentDidMount:function(){var e=this;this.safeDefer(function(){e.setState({active:!0})})},getFilteredContacts:function(){var e=Store.Contact.getFilteredContacts(),t=this.state.searchText;return t?(t=l10n.accentFold(t),e.filter(function(e){return e.searchMatch(t)})):e},onSearch:function(e){this.setState({searchText:e})},onFocusList:function(e){this.refs.list&&(e.preventDefault(),e.stopPropagation(),s["default"].flashFocus=Date.now(),this.refs.list.focusFirst())},onSelectFirst:function(e){e.preventDefault(),e.stopPropagation();var t=_.head(this.getFilteredContacts());t&&(s["default"].flashFocus=Date.now(),this.props.onClick(e,t))},onFocusSearch:function(e){s["default"].flashFocus=Date.now(),m.focus(this.search)},render:function(){var e=void 0;if(this.state.active){var t=this.getFilteredContacts();e=0===t.length?c.createElement(h.SearchContacts,null):c.createElement(p,{ref:"list",contacts:t,onFocusSearch:this.onFocusSearch,onClick:this.props.onClick})}else e=null;var n={down:this.onFocusList,enter:this.onSelectFirst};return c.createElement(l,{key:"contact-modal",onCancel:this.props.onBack},c.createElement(u,{title:this.props.title,type:u.Type.LARGE,onBack:this.props.onBack}),c.createElement(s["default"],{handlers:n},c.createElement(a["default"],{ref:v("search",this),onSearch:this.onSearch,placeholder:l10n.t("search_contacts")})),c.createElement(d,{"data-list-scroll-container":!0},e))}});e.exports=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1240),a=r(i),o=n(6),s=n(1230),c=n(145),l=n(1236),u=n(141),d=n(1288),p=n(8),h=n(1),f=n(1342),m=n(432),g=n(1269),v=n(1276),y=n(1233),E=n(1234),b=n(1262),w=n(1256),M=n(1237),C=n(1390),S=n(1232),T=n(1298),k=n(14),x=n(1299),N=n(219),P=n(104),O=n(85),D=n(1320),A=o.createClass({displayName:"ContactInfoDrawer",mixins:[s,c,l,u],propTypes:{contact:o.PropTypes.instanceOf(N).isRequired,onVerification:o.PropTypes.func},getInitialState:function(){return this.asyncState({status:"contact.Status.status",encryptionStatus:"contact.plaintextDisabled"},{commonGroups:void 0,contactIsBlocked:!!Store.Blocklist.get(this.props.contact.id)})},componentDidMount:function(){this.addObserver(Store.Blocklist,"add remove reset sync",this.onBlocklistChange),this.uiIdle(this._init)},_init:function(){var e=this;this.props.contact.findCommonGroups().checkpoint(this.rejectOnUnmount()).then(function(t){e.setState({commonGroups:t}),e.addObserver(Store.GroupMetadata,"group_participant_change",e.commonGroupsUpdate)})["catch"](k.Unmount,_.noop)["catch"](k.WapDrop,_.noop)["catch"](_.noop),P.supportsFeature(P.F.QUERY_IDENTITY)&&this.props.contact.queryIdentity()["catch"](function(e){h.error("contactInfoDrawer:queryIdentity error: "+e)()})},onBlocklistChange:function(e){this.state.contactIsBlocked!==!!Store.Blocklist.get(this.props.contact.id)&&this.setState({contactIsBlocked:!!Store.Blocklist.get(this.props.contact.id)})},commonGroupsUpdate:function(e){var t=this.state.commonGroups,n=this.props.contact.updateCommonGroups(t,e);n&&this.setState({commonGroups:n})},onDeleteChat:function(){var e=Store.Chat.get(this.props.contact.id);p.deleteOrExitChat(e)},onBlockContact:function(){p.openModal(o.createElement(m,{title:l10n.t("block"),onOK:this.blockContact,okText:l10n.t("block"),onCancel:p.closeModal.bind(p),cancelText:l10n.t("web_cancel")},l10n.t("block_confirmation",{contact:this.props.contact.formattedName})))},onUnblockContact:function(){p.openModal(o.createElement(m,{okText:l10n.t("unblock_button"),onOK:this.unblockContact,cancelText:l10n.t("web_cancel"),onCancel:p.closeModal.bind(p)},l10n.t("unblock_confirmation",{contact:this.props.contact.formattedName})))},blockContact:function(){this.props.contact.setBlock(!0),p.closeModal()},unblockContact:function(){this.props.contact.setBlock(!1),p.closeModal()},onClose:function(){this.props.onClose?this.props.onClose():this.context.uim.uie.requestDismiss()},onCopy:function(e){var t=d.extractIsolatedBlocks(window.getSelection());e.clipboardData.setData("text/plain",t),e.stopPropagation(),e.preventDefault()},onViewPicture:function(e){if(this.canViewPicture){var t=e.target,n=function(e){e(t)};p.openModalMedia(o.createElement(f,{contact:this.props.contact,animateBorderRadius:!0,getZoomNode:n}),"profile-viewer")}},onDetailImageLoad:function(e){this.canViewPicture=!0},onClick:function(e,t){p.openChatFromUnread(t).then(function(e){e&&p.focusChatTextInput(t)}),this.onClose()},render:function(){var e,t,n=this,r=this.props.contact,i=this.state.commonGroups;i=_.compact(_.values(i)),_.isArray(i)&&i.length&&(e=i.map(function(e){return o.createElement(g,{chat:e,mode:g.Mode.INFO,onClick:n.onClick,key:e.id})}),e=o.createElement(w,{classes:"animate-enter well-simple-body",title:l10n.t("web_groups_participation_you_and_name"),subtitle:l10n.n(i.length),"data-list-scroll-offset":!0,noContainer:!0},o.createElement("div",{className:"drawer-section-body chatlist"},o.createElement(a["default"],{data:e,height:72,extraItems:4}))));var s=Store.Chat.get(r.id);_.isArray(i)&&s&&s.canDelete()&&(t=o.createElement("div",{className:"drawer-section chatlist list-icons animate-enter2 well-simple"},o.createElement(b,{iconClass:"icon-delete-danger",className:"danger first",a8n:"li-delete-chat",onClick:this.onDeleteChat},l10n.t("delete_chat"))));var c=null;this.props.contact.canBlock()&&(c=this.state.contactIsBlocked?o.createElement("div",{className:"drawer-section chatlist list-icons animate-enter2 well-simple"},o.createElement(b,{className:"success first",a8n:"li-unblock",iconClass:"icon-settings-blocked-success",onClick:this.onUnblockContact},l10n.t("unblock_contact"))):o.createElement("div",{className:"drawer-section chatlist list-icons animate-enter2 well-simple"},o.createElement(b,{className:"first",a8n:"li-block",iconClass:"icon-settings-blocked",onClick:this.onBlockContact},l10n.t("block_contact"))));var l=null;if(this.props.onMediaGallery&&s){var u=o.createElement("span",{className:"icon icon-chevron-right-alt"}),d=P.supportsFeature(P.F.LINK_DOC_GALLERY)?l10n.t("media_links_docs"):l10n.t("media");l=o.createElement(w,{title:d,titleOnClick:this.props.onMediaGallery,subtitle:u,classes:"animate-enter2",noContainer:!0},o.createElement(v,{chat:s}))}var p=null,h=s&&s.mute.canMute()?o.createElement(D,{chat:s}):null,f=null,m=null,k=null;(h||f||m)&&(k=o.createElement(w,{classes:"well-simple animate-enter2"},h,f,m));var N=o.createElement(T,{classes:"row-drawer-item"},o.createElement(C,{dir:"auto",onCopy:this.onCopy},o.createElement(S,{className:"title",selectable:!0,direction:"auto",text:this.state.status}))),O=o.createElement(T,{classes:"row-drawer-item last"},o.createElement(C,{className:"selectable-text title",dir:"auto"},r.formattedUser)),A=o.createElement(w,{classes:"animate-enter2 well-simple-body",title:l10n.t("contact_info_status_phone")},N,O),I=s&&s.presence?o.createElement(x,{presence:s.presence,location:"list"}):null;return o.createElement(y,{key:"contact-info-modal",id:"info",variant:"panel",onCancel:this.onClose},o.createElement("header",{className:"pane-header"},o.createElement("div",{className:"header-close"},o.createElement("button",{onClick:this.onClose},o.createElement("span",{className:"icon icon-x"}))),o.createElement("div",{className:"header-body"},o.createElement("div",{className:"header-main"},o.createElement("div",{className:"header-title"},l10n.t("web_contact_info"))))),o.createElement(E,{"data-list-scroll-container":!0},o.createElement("div",{className:"well well-chat"},o.createElement(M,{id:r.id,size:M.Size.LARGE,loader:!0,className:"drawer-scale well-chat-avatar",onLoad:this.onDetailImageLoad,onClick:this.onViewPicture,quality:M.Quality.HIGH}),o.createElement("div",{className:"well-chat-name"},o.createElement(C,{dir:"auto",onCopy:this.onCopy},o.createElement(S,{selectable:!0,text:r.formattedUser}))),o.createElement("div",{className:"well-chat-secondary"},I)),l,k,A,p,e,c,t))}});A.contextTypes={uim:o.PropTypes.instanceOf(O)},e.exports=A},function(e,t,n){"use strict";var r=n(6),i=n(8),a=n(1230),o=n(141),s=n(1236),c=n(1233),l=n(1235),u=n(1234),d=n(1256),p=n(1373),h=n(1283),f=n(144),m=n(435),g=n(1229),v=n(14),y=n(44),E=n(10),b=n(85),w=r.createClass({displayName:"ContactMsgInfoDrawer",mixins:[a,o,s],propTypes:{msg:r.PropTypes.instanceOf(g)},getInitialState:function(){return{msgInfo:void 0,star:this.async("msg.star")}},componentWillMount:function(){var e=this;Store.MsgInfo.find(this.props.msg.id).checkpoint(this.rejectOnUnmount()).then(function(t){e.setState({msgInfo:t}),e.addObserver(t,"change:playedRemaining change:readRemaining change:deliveryRemaining")})["catch"](v.Unmount,_.noop)["catch"](function(){e.setState({unimplemented:!0}),i.openToast(r.createElement(m,{msg:l10n.t("msg_info_failed"),id:m.genId("msg_info_failed")}))})},componentDidMount:function(){if(this.props.msg.type===g.TYPE.IMAGE&&(this.refs.scrollable.scrollTop=this.refs.scrollable.scrollHeight),this.props.msg.isGif){var e=this.getMsgComponent();e.play()}},isMsgVisible:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return e===this.props.msg.id&&(!!t||this.getMsgComponent())},getMsgComponent:function(){var e=this.refs.wrapper;if(e)return e.refs.component&&e.refs.component.refs.msg},onClose:function(){this.context.uim.uie.requestDismiss()},render:function(){var e=this.props.msg,t=this.state,n=t.msgInfo,i=t.star,a=t.unimplemented,o=void 0,s=void 0;if(n){var m=[],v=void 0,_=void 0,b=void 0;n.isPTT&&(s=l10n.t("message_info_seen"),v=n.played.head(),_=v&&v.t,b=r.createElement("span",{className:"icon icon-status icon-status-ptt-blue"}),m.push(r.createElement(p,{title:l10n.t("message_info_played"),t:_,icon:b,key:"played"}))),v=n.read.head(),_=v&&v.t,b=r.createElement("span",{className:"icon icon-status icon-status-dblcheck-ack"}),s=s||l10n.t("message_info_read"),m.push(r.createElement(p,{title:s,t:_,icon:b,key:"read"})),v=n.delivery.head(),_=v&&v.t,b=r.createElement("span",{className:"icon icon-status icon-status-dblcheck"}),m.push(r.createElement(p,{title:l10n.t("message_info_delivered"),t:_,icon:b,key:"delivery"})),o=r.createElement(d,{classes:"drawer-section-info well animate-enter"},m)}var w=void 0;n||a||(w=r.createElement(d,{classes:"drawer-section-spinner",key:"spinner"},r.createElement(f,{size:50,stroke:4})));var M=y("pane-preview-wrapper","pane-preview-wrapper-bg",{"pane-preview-resize":e.type===g.TYPE.PTT||e.type===g.TYPE.IMAGE||e.type===g.TYPE.LOCATION||e.type===g.TYPE.VCARD||e.isGif});return r.createElement(c,{key:"message-info-modal",id:"info",variant:"panel",onCancel:this.onClose},r.createElement(l,{title:l10n.t("message_info"),type:l.Type.SMALL,onCancel:this.onClose}),r.createElement("div",{className:M,ref:"scrollable"},r.createElement("div",{className:"pane-preview"},r.createElement("div",{className:"pane-chat-tile"}),r.createElement(h,{msg:e,key:"star-"+i.toString(),ref:"wrapper",displayType:E.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:h.Position.END}))),r.createElement(u,{classes:"drawer-body-msg-info"},w,o))}});w.contextTypes={uim:r.PropTypes.instanceOf(b)},e.exports=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(1229),c=n(8),l=n(1265),u=n(1233),d=n(1235),p=n(1234),h=n(1345),f=n(1250),m=o.createClass({displayName:"ContactViewerModal",propTypes:{msg:o.PropTypes.instanceOf(s).isRequired},render:function(){return o.createElement(l,{type:l.BOX},o.createElement(u,{key:"vcard-modal",onCancel:function(){return c.closeModal()}},o.createElement(d,{title:l10n.t("contact_viewer"),type:d.Type.POPUP,onCancel:function(){return c.closeModal()}}),o.createElement(p,null,o.createElement(a["default"],null,o.createElement(h,{parsedVCard:this.props.msg.vcard,thumbnail:f.thumbnail(this.props.msg.body),className:"chatlist column"})))))}});e.exports=m},function(e,t,n){"use strict";var r=n(6),i=n(437),a=n(1),o=n(1231),s=n(8),c=n(1230),l=n(1232),u=r.createClass({displayName:"DeleteChatPopup",mixins:[c],propTypes:{onCancel:r.PropTypes.func,onDeleteOrExit:r.PropTypes.func,chat:r.PropTypes.instanceOf(o).isRequired},getInitialState:function(){return{isReadOnly:this.async("chat.isReadOnly")}},getText:function(){var e=this.props.chat,t=e.title();return e.isGroup?this.state.isReadOnly?l10n.t("web_delete_group_dialog_title",{groupName:t}):l10n.t("web_exit_group_dialog_title",{groupName:t}):e.isUser?l10n.t("delete_chat_dialog_title",{name:t}):e.isBroadcast?l10n.t("delete_list_dialog_title"):void 0},getButton:function(){var e=this.props.chat;return e.isGroup?this.state.isReadOnly?l10n.t("web_delete"):l10n.t("web_exit"):e.isUser||e.isBroadcast?l10n.t("web_delete"):void 0},onCancel:function(){s.closeModal(),_.isFunction(this.props.onCancel)&&this.props.onCancel()},onDelete:function(){var e,t=this.props.chat;t.isGroup?e=this.state.isReadOnly?t.sendDelete():t.sendExit():t.isUser||t.isBroadcast?e=t.sendDelete():a.error("deleteChatPopup:onDelete Unsupported chat type")(),_.isFunction(this.props.onDeleteOrExit)&&e&&this.props.onDeleteOrExit(e),s.closeModal()},render:function(){return r.createElement("div",{className:"backdrop"},r.createElement("div",{className:"popup-container"},r.createElement("div",{className:"popup"},r.createElement("div",{className:"popup-body"},r.createElement("div",{className:"popup-title"},l10n.t("are_you_sure")),r.createElement("div",{className:"popup-contents"},r.createElement(l,{text:this.getText()}))),r.createElement("div",{className:"popup-controls"},r.createElement("button",{"data-a8n":i.key("cancel-btn"),className:"btn-plain popup-controls-item",onClick:this.onCancel},l10n.t("web_cancel")),r.createElement("button",{"data-a8n":i.key("delete-btn"),className:"btn-plain btn-default popup-controls-item",onClick:this.onDelete},this.getButton())))))}});e.exports=u},function(e,t,n){"use strict";var r=n(6),i=n(437),a=n(1),o=n(8),s=n(1271),c=n(435),l=n(44),u=n(0),d={title:0,hour:1,day:24,week:168},p=r.createClass({displayName:"DoNotDisturbSettings",getInitialState:function(){return{notifications:Store.Mute.getGlobalNotifications(),sounds:Store.Mute.getGlobalSounds(),previews:Store.Mute.getGlobalPreviews(),dnd:d.title}},componentWillUnmount:function(){this.state.dnd!==d.title&&o.openToast(r.createElement(c,{msg:this.globalMuteDurationLabel(this.state.dnd),id:c.genId()}))},globalMuteDurationLabel:function(e){switch(this.state.dnd){case 1:return l10n.t("global_muted_1hour");case 24:return l10n.t("global_muted_1day");case 168:return l10n.t("global_muted_1week");default:return a.log("DoNotDisturbSettings:globalMuteDurationLabel non standard global mute duration:"+e)(),l10n.t("global_muted")}},onSounds:function(){var e=!this.state.sounds;this.setState({sounds:e}),Store.Mute.setGlobalSounds(e)},onNotifications:function(){var e=!this.state.notifications;this.setState({notifications:e}),Store.Mute.setGlobalNotifications(e)},onPreviews:function(){var e=!this.state.previews;this.setState({previews:e}),Store.Mute.setGlobalPreviews(e)},onDND:function(e){var t=parseInt(e.target.value,10);if(0===t)return this.setState({dnd:d.title}),void Store.Mute.globalMute().unmute();this.setState({dnd:t});var n=u().unix()+60*e.target.value*60;Store.Mute.globalMute().mute(n)},onClose:function(e){o.closeModal()},render:function(){var e=[];if(window.Notification){e.push(r.createElement("div",{className:"controls-section",onClick:this.onNotifications,key:0},r.createElement("div",{"data-a8n":i.key("menu-icon-notifications"),className:"control"},r.createElement(s,{onChange:this.onNotifications,checked:this.state.notifications})),r.createElement("div",{className:"label"},l10n.t("option_desktop_notifications"))));var t=l("controls-section",{disabled:!this.state.notifications});e.push(r.createElement("div",{className:t,onClick:this.onPreviews,key:1},r.createElement("div",{"data-a8n":i.key("menu-icon-notifications"),className:"control"},r.createElement(s,{onChange:this.onPreviews,checked:this.state.previews})),r.createElement("div",{className:"label"},l10n.t("option_msg_previews"),r.createElement("div",{className:"hint"},l10n.t("option_msg_previews_hint_text")))))}return r.createElement("div",{className:"controls-container drawer-section"},r.createElement("div",{className:"controls-section",onClick:this.onSounds},r.createElement("div",{"data-a8n":i.key("menu-icon-notifications"),className:"control"},r.createElement(s,{onChange:this.onSounds,checked:this.state.sounds})),r.createElement("div",{className:"label"},l10n.t("option_sounds"))),e,r.createElement("div",{className:"controls-section controls-section-wide"},r.createElement("div",{className:"select"},r.createElement("select",{value:this.state.dnd,onChange:this.onDND},r.createElement("option",{value:d.title,disabled:this.state.state===d.title},l10n.t("option_select_mute")),r.createElement("option",{value:d.hour,disabled:this.state.state===d.hour},l10n.t("mute_1hour")),r.createElement("option",{value:d.day,disabled:this.state.state===d.day},l10n.t("mute_1day")),r.createElement("option",{value:d.week,disabled:this.state.state===d.week},l10n.t("mute_1week"))))))}});e.exports=p},function(e,t,n){"use strict";var r=n(6),i=n(44),a=r.createClass({displayName:"DrawerSectionFooter",propTypes:{children:r.PropTypes.node.isRequired,separator:r.PropTypes.bool},getDefaultProps:function(){return{separator:!1}},render:function(){var e=i("drawer-section-footer",{separator:this.props.separator
});return r.createElement("div",{className:e},r.createElement("div",{className:"col-main"},this.props.children))}});e.exports=a},function(e,t,n){"use strict";var r=n(6),i=n(8),a=n(10),o=n(88),s=n(24),c=n(432),l=n(85),u=r.createClass({displayName:"E2EInfoModal",propTypes:{e2eSubtype:r.PropTypes.string.isRequired,jid:r.PropTypes.string,chatId:r.PropTypes.string,unencryptedContact:r.PropTypes.string},onLearnMore:function(){var e;switch(this.props.e2eSubtype){case"info_encrypted":case"info_unencrypted":e=a.E2E_FAQ_LINK;break;case"identity":e=a.CODE_CHANGE_FAQ_LINK;break;case"encrypt":default:e=a.SECURITY_LINK}var t=o.build(e,{lg:Store.Conn.lg,lc:Store.Conn.lc});window.open(t,"_blank")},onVerificationClick:function(){i.closeModal(),i.verificationDrawer(this.props.jid)},render:function(){var e,t=null,n=null,a=i.closeModal.bind(i),o=l10n.t("web_ok");switch(this.props.e2eSubtype){case"info_encrypted":s.isGroup(this.props.chatId)?e=l10n.t("web_group_info_encrypted_description"):s.isBroadcast(this.props.chatId)&&(e=l10n.t("web_broadcast_info_encrypted_description"));break;case"info_unencrypted":e=s.isGroup(this.props.chatId)?l10n.t("web_group_info_unencrypted_description"):s.isBroadcast(this.props.chatId)?l10n.t("web_broadcast_info_unencrypted_description"):l10n.t("web_contact_info_unencrypted_description",{contact:this.props.unencryptedContact});break;case"identity":var l=Store.Contact.get(this.props.jid),u=l?l.formattedName:"";e=l10n.t("web_security_code_change_description",{name:u}),t=a,n=o,a=this.onVerificationClick,o=l10n.t("web_verify_button");break;case"encrypt":default:e=s.isGroup(this.props.chatId)?l10n.t("web_group_encryption_state_change_description"):s.isBroadcast(this.props.chatId)?l10n.t("web_broadcast_encryption_state_change_description"):l10n.t("web_individual_chat_encryption_state_change_description")}var d=r.createElement("span",{className:"action",onClick:this.onLearnMore},l10n.t("learn_more"));return r.createElement(c,{onOK:a,okText:o,onCancel:t,cancelText:n},e," ",d)}});u.contextTypes={uim:r.PropTypes.instanceOf(l)},e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1240),a=r(i),o=n(6),s=n(1230),c=n(141),l=n(8),u=n(1231),d=n(143),p=n(1251),h=n(1276),f=n(1233),m=n(1234),g=n(1256),v=n(1262),y=n(1295),_=n(1232),E=n(1238),b=n(432),w=n(1446),M=n(435),C=n(1242),S=n(1260),T=n(1261),k=n(218),x=n(85),N=n(1320),P=n(104),O=n(10),D=M.genId("max_participant_toast"),A=o.createClass({displayName:"GroupInfoDrawer",mixins:[s,c],propTypes:{chat:o.PropTypes.instanceOf(u).isRequired},getInitialState:function(){return{imgFull:this.async("chat.ProfilePicThumb.imgFull"),name:this.async("chat.contact.name")||"",isReadOnly:this.async("chat.isReadOnly"),pendingSubject:!1,pendingPhoto:!1,everyoneEncrypted:this.async("chat.contact.plaintextDisabled"),contextMenu:!1}},componentWillMount:function(){var e=this.props.chat.groupMetadata;this.addObserver(e.participants,"add remove reset sort change:isAdmin")},onImageSet:function(e,t){var n=Store.ProfilePicThumb.get(this.props.chat.id);this.setState({pendingPhoto:!0});var r;r=e&&t?n.setPicture(e,t):n.deletePicture(),r.bind(this).then(function(){this.isMounted()&&this.setState({pendingPhoto:!1})})},onParticipantClick:function(e,t){Store.Conn.me!==t.id&&Store.Chat.find(t.id).then(function(e){l.openChatFromUnread(e).then(function(t){t&&l.focusChatTextInput(e)})})},menuEnabled:function(e){var t=this.props.chat.groupMetadata.participants,n=t.get(e.id);return n&&(t.canPromote(n)||t.canRemove(n)||t.canVerifyIdentity(n))},onParticipantMenu:function(e,t){var n=this.props.chat.groupMetadata.participants,r=n.get(t.id);if(this.menuEnabled(t)){var i=[];if(n.canPromote(r)){var a=this.confirmParticipantPromote.bind(this,r);i.push(o.createElement(E,{a8n:"mi-grp-promote-admin",key:"promote",action:a},l10n.t("menuitem_make_group_admin")))}if(n.canRemove(r)){var s=this.confirmParticipantRemove.bind(this,r);i.push(o.createElement(E,{a8n:"mi-grp-remove-participant",key:"remove",action:s,shortcut:"d"},l10n.t("menuitem_remove")))}e.event&&e.event.persist(),this.setState({contextMenu:{contactId:t.id,menu:i,anchor:e.anchor,event:e.event}})}},contextClose:function(){this.setState({contextMenu:!1})},confirmParticipantRemove:function(e){var t=this.onParticipantRemove.bind(this,e),n=l10n.t("confirm_remove_group_participant",{participant:e.contact.formattedName,subject:this.props.chat.contact.name});l.openModal(o.createElement(b,{onOK:t,okText:l10n.t("remove"),onCancel:l.closeModal.bind(l),cancelText:l10n.t("web_cancel")},o.createElement(_,{text:n})))},onParticipantRemove:function(e){e.contact.pendingAction++,this.props.chat.groupMetadata.participants.removeParticipant(e).then(function(){e.contact.pendingAction--}),l.closeModal()},confirmParticipantPromote:function(e){var t=this.onParticipantPromote.bind(this,e),n=l10n.t("confirm_promote_group_participant",{participant:e.contact.formattedName,subject:this.props.chat.contact.name});l.openModal(o.createElement(b,{onOK:t,okText:l10n.t("menuitem_make_group_admin"),onCancel:l.closeModal.bind(l),cancelText:l10n.t("web_cancel")},o.createElement(_,{text:n})))},onParticipantPromote:function(e){e.contact.pendingAction++,this.props.chat.groupMetadata.participants.promoteParticipant(e).then(function(){e.contact.pendingAction--}),l.closeModal()},onVerifyIdentity:function(e){this.props.onVerification(e.contact)},openAddGroupParticipantFlow:function(){if(this.props.chat.groupMetadata.participants.length>=O.MAX_GROUP_SIZE){var e=l10n.t("action_group_create_failed_participant",{max:O.MAX_GROUP_SIZE});l.openToast(o.createElement(M,{msg:e,id:D}))}else{var t=o.createElement(w,{chat:this.props.chat});l.openModal(t,"modal-flow")}},onClose:function(){this.props.onClose?this.props.onClose():this.context.uim.uie.requestDismiss()},onExitOrDeleteGroup:function(){l.deleteOrExitChat(this.props.chat)},onSubjectChange:function(e){this.setState({name:e.target.value})},validateSubject:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return!!e.trim()},onSetSubjectError:function(){l.openModal(o.createElement(b,{onOK:l.closeModal.bind(l),okText:l10n.t("web_ok")},l10n.t("action_group_subject_empty")))},onSetSubject:function(e){var t=this.props.chat,n=t.groupMetadata;if(n.canSetSubject()){var r=C.emojify(this.state.name);if(r===t.contact.name)return this.setState({name:r});this.setState({pendingSubject:!0}),t.setSubject(r).bind(this)["finally"](function(){this.isMounted()&&this.setState({name:t.contact.name,pendingSubject:!1})})}},onCancelSubject:function(){this.setState({name:this.props.chat.contact.name})},render:function(){var e,t,n=this.props.chat,r=n.groupMetadata,i=this,s=r.participants.map(function(e){var t=e.contact,n=i.state.contextMenu&&t.id===i.state.contextMenu.contactId;return o.createElement(p,{contact:t,key:e.id,admin:!!e.isAdmin,onClick:i.onParticipantClick,contextEnabled:i.menuEnabled.bind(i,t),contextMenu:n,onContext:i.onParticipantMenu,showNotifyName:!0})});n.canDelete()&&(t=o.createElement("div",{className:"drawer-section chatlist list-icons animate-enter2 well-simple"},o.createElement(v,{iconClass:"icon-exit",a8n:"li-delete-group",className:"danger first",onClick:this.onExitOrDeleteGroup},n.isReadOnly?l10n.t("web_delete_group"):l10n.t("web_exit_group")))),r.participants.canAdd()&&(e=o.createElement("div",{className:"list-action list-action-alt",title:l10n.t("add_group_participant"),onClick:this.openAddGroupParticipantFlow},o.createElement("div",{className:"list-action-icon"},o.createElement("span",{className:"icon icon-add-user-light"})),o.createElement("div",{className:"list-action-body ellipsify"},l10n.t("add_group_participant"))));var c=void 0;r.participants.iAmAdmin()&&this.props.onGroupInviteLink&&(c=o.createElement("div",{className:"list-action list-action-alt",title:l10n.t("group_invite_link"),onClick:this.props.onGroupInviteLink},o.createElement("div",{className:"list-action-icon"},o.createElement("span",{className:"icon icon-link"})),o.createElement("div",{className:"list-action-body ellipsify"},l10n.t("group_invite_link"))));var l=s.length?o.createElement(g,{title:l10n.t("web_participants_title"),subtitle:l10n.t("web_participants_count",{count:s.length,max:O.MAX_GROUP_SIZE}),"data-list-scroll-offset":!0,classes:"animate-enter2 well-simple-body",ref:"container",noContainer:!0},e,c,o.createElement("div",{className:"drawer-section-body chatlist"},o.createElement(a["default"],{data:s,height:a["default"].DEFAULT_HEIGHT,extraItems:4}))):null,u=null;if(this.props.onMediaGallery){var _=o.createElement("span",{className:"icon icon-chevron-right-alt"}),E=P.supportsFeature(P.F.LINK_DOC_GALLERY)?l10n.t("media_links_docs"):l10n.t("media");u=o.createElement(g,{title:E,titleOnClick:this.props.onMediaGallery,subtitle:_,classes:"animate-enter2",noContainer:!0},o.createElement(h,{chat:n}))}var b=n.contact.profilePicThumb,w=n.isReadOnly||!b.canDelete()&&!b.canSet()?y.Type.NO_EDIT:y.Type.GROUP,M=o.createElement(y,{className:"well-chat-avatar",type:w,id:n.contact.id,pending:this.state.pendingPhoto,startImage:this.state.imgFull,onImageSet:this.onImageSet}),C=null;n.groupMetadata.creation&&(C=o.createElement("div",{className:"well-chat-secondary well-chat-secondary-group"},l10n.t("web_group_creation_time",{when:d.relativeDateAndTimeStr(n.groupMetadata.creation)})));var x=null,D=n&&n.mute.canMute()?o.createElement(N,{chat:n}):null,A=null,I=void 0;this.state.contextMenu&&(I=o.createElement(k,{displayName:"ChatContextMenu",escapable:!0,popable:!0,requestDismiss:this.contextClose},o.createElement(T,{contextMenu:this.state.contextMenu})));var R=null;return(D||A||x)&&(R=o.createElement(g,{classes:"well-simple animate-enter2"},D,A,x)),o.createElement(f,{key:"contact-info-modal",id:"info",variant:"panel",onCancel:this.onClose},o.createElement("header",{className:"pane-header"},o.createElement("div",{className:"header-close"},o.createElement("button",{onClick:this.onClose},o.createElement("span",{className:"icon icon-x"}))),o.createElement("div",{className:"header-body"},o.createElement("div",{className:"header-main"},o.createElement("div",{className:"header-title"},l10n.t("web_group_info"))))),o.createElement(m,{"data-list-scroll-container":!0},o.createElement("div",{className:"well well-chat"},M,o.createElement("div",{className:"well-chat-name"},o.createElement(S,{value:this.state.name,editable:r.canSetSubject(),pending:this.state.pendingSubject,showRemaining:!0,validate:this.validateSubject,maxLength:O.MAX_SUBJECT_LENGTH,onChange:this.onSubjectChange,onSave:this.onSetSubject,onError:this.onSetSubjectError,onCancel:this.onCancelSubject,supportsEmoji:!0,lockable:!0,lowProfile:!0,className:"text-input-large"})),C),u,R,l,t),I)}});A.contextTypes={uim:o.PropTypes.instanceOf(x)},e.exports=A},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(1231),c=n(1233),l=n(1235),u=n(1234),d=n(144),p=n(1236),h=n(14),f=n(141),m=n(1237),g=n(1232),v=n(1262),y=n(1449),E=n(1284),b=n(8),w=n(435),M={LOADING:0,REVOKING:1,SUCCESS:2},C=o.createClass({displayName:"GroupInviteLinkDrawer",mixins:[p,f],propTypes:{chat:o.PropTypes.instanceOf(s).isRequired,onBack:o.PropTypes.func.isRequired},getInitialState:function(){return{state:M.LOADING}},getErrorMessageFromStatusCode:function(e){switch(e){case 401:return l10n.t("group_invite_query_401");case 403:return l10n.t("group_invite_query_403");case 404:return l10n.t("group_invite_query_404");default:return l10n.t("group_invite_query_406")}},handleLoadingStatusCode:function(e){if(200===e)this.setState({state:M.SUCCESS});else{var t=this.getErrorMessageFromStatusCode(e);this.props.onBack(),b.openToast(o.createElement(w,{msg:t,id:w.genId()}))}},componentWillMount:function(){this.addObserver(this.props.chat.groupMetadata,"change:inviteCode"),this.props.chat.groupMetadata.groupInviteCode().checkpoint(this.rejectOnUnmount).then(this.handleLoadingStatusCode)["catch"](h.Unmount,_.noop)},onRevokeGroupInvite:function(){b.openModal(o.createElement(y,{chat:this.props.chat,onConfirm:this.onConfirmRevokeGroupInvite}),"modal-flow")},handleRevokingStatusCode:function(e){if(200===e)b.openToast(o.createElement(w,{msg:l10n.t("group_invite_revoke_success"),id:w.genId()})),this.setState({state:M.SUCCESS});else{var t=this.getErrorMessageFromStatusCode(e);this.props.onBack(),b.openToast(o.createElement(w,{msg:t,id:w.genId()}))}},onConfirmRevokeGroupInvite:function(){var e=this;this.setState({state:M.REVOKING}),a["default"].props({_:a["default"].delay(500),status:this.props.chat.groupMetadata.revokeGroupInvite()}).checkpoint(this.rejectOnUnmount).then(function(t){var n=t.status;e.handleRevokingStatusCode(n)})["catch"](h.Unmount,_.noop)},onSendGroupInviteLink:function(){var e=this.props.chat.createMessageFromText(this.props.chat.groupMetadata.groupInviteLink);b.openModal(o.createElement(E,{msgs:[e],isGroupInviteForward:!0}),"modal-flow")},onClickGroupInviteLink:function(e){e.preventDefault(),this.onSendGroupInviteLink()},onCopyLink:function(){window.getSelection().removeAllRanges();var e=document.querySelector("#group-invite-link-anchor"),t=document.createRange();t.selectNode(e),window.getSelection().addRange(t);var n=void 0;try{n=document.execCommand("copy"),window.getSelection().removeAllRanges()}catch(r){n=!1}n?b.openToast(o.createElement(w,{msg:l10n.t("group_invite_link_copy_success"),id:w.genId()})):b.openToast(o.createElement(w,{msg:l10n.t("group_invite_link_copy_failed"),id:w.genId()}))},renderDrawerBody:function(){var e=this.props.chat.groupMetadata,t=void 0;if(this.state.state===M.LOADING)t=o.createElement("div",{className:"group-invite-loading-container"},o.createElement(d,{className:"group-invite-spinner",size:55,stroke:3}),o.createElement("span",null,l10n.t("group_invite_check_link")));else if(this.state.state===M.REVOKING)t=o.createElement("div",{className:"group-invite-loading-container"},o.createElement(d,{className:"group-invite-spinner",size:55,stroke:3}),o.createElement("span",null,l10n.t("group_invite_revoke_in_progress",{groupName:this.props.chat.contact.name})));else{var n=e.groupInviteLink,r=null;document.queryCommandSupported("copy")&&(r=o.createElement(v,{iconClass:"icon-copy",a8n:"li-copy-link",onClick:this.onCopyLink},l10n.t("group_invite_drawer_copy_link"))),t=o.createElement(u,{wide:!0},o.createElement("div",{className:"chatlist list-identity list-invite"},o.createElement("div",{className:"chat chat-idle","data-ignore-capture":"any"},o.createElement("div",{className:"chat-avatar"},o.createElement(m,{id:this.props.chat.id,size:82,quality:m.Quality.HIGH})),o.createElement("div",{className:"chat-body"},o.createElement("div",{className:"chat-main"},o.createElement("div",{className:"chat-title"},o.createElement("span",{className:"emojitext ellipsify",dir:"auto"},o.createElement(g,{text:this.props.chat.contact.name,direction:"auto"})))),o.createElement("div",{className:"chat-status"},o.createElement("a",{id:"group-invite-link-anchor",href:n,onClick:this.onClickGroupInviteLink},n))))),o.createElement("div",{className:"controls-container drawer-section"},o.createElement("div",{className:"controls-section"},l10n.t("group_invite_link_description"))),o.createElement("div",{className:"chatlist list-icons list-actions"},o.createElement(v,{iconClass:"icon-share",a8n:"li-share-link",onClick:this.onSendGroupInviteLink},l10n.t("group_invite_drawer_send_link")),r,o.createElement(v,{iconClass:"icon-revoke",a8n:"li-revoke-link",onClick:this.onRevokeGroupInvite},l10n.t("group_invite_drawer_revoke_link"))))}return t},render:function(){return o.createElement(c,{id:"invite",onCancel:this.props.onBack},o.createElement(l,{title:l10n.t("group_invite_link"),onBack:this.props.onBack,type:l.Type.SMALL}),this.renderDrawerBody())}});e.exports=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(438),s=r(o),c=n(1253),l=r(c),u=n(6),d=n(432),p=n(144),h=n(1237),f=n(1236),m=n(8),g=n(14),v=n(10),y=n(55),E=n(1285),b={LOADING:0,SUCCESS:1,ACCEPT_ERROR:2,QUERY_ERROR:3},w=u.createClass({displayName:"GroupInviteModal",mixins:[f],props:{groupCode:u.PropTypes.string.isRequired},getInitialState:function(){return{state:b.LOADING,status:void 0,groupMetadata:void 0}},componentWillMount:function(){var e=this;y.groupInviteInfo(this.props.groupCode).checkpoint(this.rejectOnUnmount).then(function(t){var n=t.status,r=(0,s["default"])(t,["status"]);if(200===n){var i=new E(r);Store.Contact.gadd(r.id),e.setState({status:n,groupMetadata:i,state:b.SUCCESS})}else e.setState({status:n,state:b.QUERY_ERROR})})["catch"](g.Unmount,_.noop)},onViewGroup:function(){m.openChatFromUnread(Store.Chat.get(this.state.groupMetadata.id)),m.closeModal()},onJoinGroup:function(){var e=this;y.acceptGroupInvite(this.props.groupCode).then(function(e){var t=e.status,n=e.gid;return 200===t?Store.Chat.find(n):a["default"].reject(t)}).then(function(e){m.openChatFromUnread(e).then(function(t){t&&m.focusChatTextInput(e)}),m.closeModal()}).checkpoint(this.rejectOnUnmount)["catch"](g.Unmount,_.noop)["catch"](function(t){e.setState({state:b.ACCEPT_ERROR,status:t})})},onCancel:function(){m.closeModal()},render:function(){var e=this.state,t=e.state,n=e.status,r=e.groupMetadata,i={cancelText:l10n.t("group_invite_cancel"),onCancel:this.onCancel},a=void 0;if(t===b.LOADING)a=u.createElement("div",{className:"group-invite-loading-container"},u.createElement(p,{className:"group-invite-spinner",size:55,stroke:3}),u.createElement("span",null,l10n.t("group_invite_check_link")));else if(t===b.SUCCESS){var o=r.participants.map(function(e){return u.createElement("div",{key:e.id,className:"participant-wrapper"},u.createElement(h,{className:"participant-image",size:50,id:e.id}),u.createElement("span",{className:"participant-text"},e.contact.formattedName))}),s=Store.Contact.gadd(r.owner).formattedName,c=""+v.GROUP_INVITE_URL+this.props.groupCode;a=u.createElement("div",{className:"group-invite-modal"},u.createElement("div",{className:"metadata-container"},u.createElement("div",{className:"metadata-icon"},u.createElement("div",{className:"icon-group-default"}),u.createElement(l["default"],{src:c})),u.createElement("div",{className:"metadata-text"},u.createElement("span",{className:"metadata-title"},r.subject),u.createElement("span",{className:"metadata-subtitle"},l10n.t("group_invite_created_by",{participant:s})))),u.createElement("span",{className:"participants-title"},l10n.t("group_invite_participants",{count:o.length,_plural:o.length})),u.createElement("div",{className:"participants-container"},o));var f=Store.Chat.get(r.id),m=!!f&&!f.isReadOnly;i.onOK=m?this.onViewGroup:this.onJoinGroup,i.okText=m?l10n.t("group_invite_view"):l10n.t("group_invite_join")}else{var g=void 0;if(t===b.QUERY_ERROR)switch(n){case 401:g=l10n.t("group_invite_query_401");break;case 403:g=l10n.t("group_invite_query_403");break;case 404:g=l10n.t("group_invite_query_404");break;case 406:g=l10n.t("group_invite_query_406");break;case 410:g=l10n.t("group_invite_query_410");break;default:g=l10n.t("group_invite_query_500")}else if(t===b.ACCEPT_ERROR)switch(n){case 401:g=l10n.t("group_invite_accept_401");break;case 404:g=l10n.t("group_invite_accept_404");break;case 410:g=l10n.t("group_invite_accept_410");break;case 419:g=l10n.t("group_invite_accept_419");break;default:g=l10n.t("group_invite_accept_500")}i.cancelText=l10n.t("web_ok"),a=u.createElement("div",null,g)}return u.createElement(d,i,a)}});e.exports=w},function(e,t,n){"use strict";var r=n(6),i=n(432),a=n(1231),o=n(8),s=r.createClass({displayName:"GroupInviteRevokeModal",propTypes:{chat:r.PropTypes.instanceOf(a).isRequired,onConfirm:r.PropTypes.func.isRequired},onCancel:function(){o.closeModal()},onOK:function(){this.props.onConfirm(),o.closeModal()},render:function(){return r.createElement(i,{title:l10n.t("group_invite_drawer_revoke_link"),onOK:this.onOK,okText:l10n.t("group_invite_drawer_revoke_link"),onCancel:this.onCancel,cancelText:l10n.t("web_cancel")},r.createElement("div",{className:"textfield-static"},l10n.t("group_invite_revoke_confirmation_text",{groupName:this.props.chat.contact.name})))}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(8),a=n(1230),o=n(141),s=n(1236),c=n(1233),l=n(1235),u=n(1234),d=n(1256),p=n(1473),h=n(1374),f=n(1283),m=n(144),g=n(435),v=n(1229),y=n(1534),E=n(14),b=n(44),w=n(85),M=n(10),C=r.createClass({displayName:"GroupMsgInfoDrawer",mixins:[a,o,s],propTypes:{msg:r.PropTypes.instanceOf(v)},getInitialState:function(){return{msgInfo:void 0,star:this.async("msg.star")}},componentWillMount:function(){var e=this;Store.MsgInfo.find(this.props.msg.id).checkpoint(this.rejectOnUnmount()).then(function(t){e.setState({msgInfo:t}),e.addObserver(t.played,"add remove"),e.addObserver(t.read,"add remove"),e.addObserver(t.delivery,"add remove"),e.addObserver(t,"change:playedRemaining change:readRemaining change:deliveryRemaining")})["catch"](E.Unmount,_.noop)["catch"](function(){e.setState({unimplemented:!0}),i.openToast(r.createElement(g,{msg:l10n.t("msg_info_failed"),id:g.genId("msg_info_failed")}))})},getAnimateEnterClass:function(e){return"animate-enter"+(e===-1?"":e)},componentDidMount:function(){if(this.props.msg.type===v.TYPE.IMAGE&&(this.refs.scrollable.scrollTop=this.refs.scrollable.scrollHeight),this.props.msg.isGif){var e=this.getMsgComponent();e.play()}},isMsgVisible:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return e===this.props.msg.id&&(!!t||this.getMsgComponent())},getMsgComponent:function(){var e=this.refs.wrapper;if(e)return e.refs.component&&e.refs.component.refs.msg},onClose:function(){this.context.uim.uie.requestDismiss()},render:function(){var e,t=this.props.msg,n=this.state,i=n.msgInfo,a=n.star,o=n.unimplemented,s=-1,g=24,_=26,E=void 0,w=void 0;if(i&&i.isPTT){var C=r.createElement("span",{className:"icon icon-status icon-status-ptt-blue"}),S=i.played.map(function(e){return r.createElement(h,{participant:e,key:e.id})}),T=S.length>0?r.createElement("div",{className:"chatlist chatlist-plain"},S):null,k=i.playedRemaining>0?r.createElement(p,null,l10n.t("message_info_remaining",{count:i.playedRemaining,_plural:i.playedRemaining})):null,x=b(this.getAnimateEnterClass(s),"well-simple-body");w=l10n.t("message_info_seen_by"),e=k?g+_:g,R=y.minHeight(S,e),E=r.createElement(d,{classes:x,key:"played-section",style:R,title:l10n.t("message_info_played_by"),subtitle:C,footer:k},T)}var N=void 0;if(i&&(i.read.length>0||i.playedRemaining>0)){var P=r.createElement("span",{className:"icon icon-status icon-status-dblcheck-ack"}),O=i.read.map(function(e){return r.createElement(h,{participant:e,key:e.id})}),D=O.length>0?r.createElement("div",{className:"chatlist chatlist-plain"},O):null,A=i.readRemaining>0?r.createElement(p,null,l10n.t("message_info_remaining",{count:i.readRemaining,_plural:i.readRemaining})):null,I=b(this.getAnimateEnterClass(s),"well-simple-body");w=w||l10n.t("message_info_read_by"),e=A?g+_:g;var R=y.minHeight(O,e);N=r.createElement(d,{classes:I,key:"read-section",title:w,style:R,subtitle:P,footer:A},D)}var L=void 0;if(i&&(i.delivery.length>0||i.deliveryRemaining>0)){var U=r.createElement("span",{className:"icon icon-status icon-status-dblcheck"}),F=i.delivery.map(function(e){return r.createElement(h,{participant:e,key:e.id})}),j=F.length>0?r.createElement("div",{className:"chatlist chatlist-plain"},F):null,B=i.deliveryRemaining>0?r.createElement(p,null,l10n.t("message_info_remaining",{count:i.deliveryRemaining,_plural:i.deliveryRemaining})):null,G=b(this.getAnimateEnterClass(s),"well-simple-body");e=B?g+_:g,R=y.minHeight(F,e),L=r.createElement(d,{classes:G,key:"delivered-section",style:R,title:l10n.t("message_info_delivered_to"),subtitle:U,footer:B},j)}var z=void 0;i||o||(z=r.createElement(d,{classes:"drawer-section-spinner",key:"spinner"},r.createElement(m,{size:50,stroke:4})));var W=b("pane-preview-wrapper","pane-preview-wrapper-bg",{"pane-preview-resize":t.type===v.TYPE.PTT||t.type===v.TYPE.IMAGE||t.type===v.TYPE.LOCATION||t.type===v.TYPE.VCARD||t.isGif});return r.createElement(c,{key:"message-info-modal",id:"info",variant:"panel",onCancel:this.onClose},r.createElement(l,{title:l10n.t("message_info"),type:l.Type.SMALL,onCancel:this.onClose}),r.createElement("div",{className:W,ref:"scrollable"},r.createElement("div",{className:"pane-preview"},r.createElement("div",{className:"pane-chat-tile"}),r.createElement(f,{msg:t,key:"star-"+a.toString(),ref:"wrapper",displayType:M.DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:f.Position.END}))),r.createElement(u,{classes:"drawer-body-msg-info"},z,E,N,L))}});C.contextTypes={uim:r.PropTypes.instanceOf(w)},e.exports=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(1341),c=n(1231),l=n(1269),u=n(1245),d=n(1239),p=o.createClass({displayName:"GroupsModal",propTypes:{chats:o.PropTypes.arrayOf(o.PropTypes.instanceOf(c)),filter:o.PropTypes.func,onCancel:o.PropTypes.func.isRequired,onGroup:o.PropTypes.func.isRequired},getDefaultProps:function(){return{filter:function(){return!0}}},getInitialState:function(){return this.selection=new u,{loading:!0,searchFilter:void 0}},componentWillMount:function(){var e=this,t=this.props.chats;a["default"].delay(300).then(function(){return a["default"].all(_.map(_.filter(t,function(e){return e.groupMetadata.stale}),function(e){return e.groupMetadata.update()["catch"](_.noop)}))}).then(function(){return e.setState({loading:!1})})},onSelect:function(e,t){var n=t.props.chat;this.props.filter(n)===!0&&this.props.onGroup(t.props.chat)},onSearch:function(e){this.setState({searchFilter:e})},render:function(){var e=this,t=this.props,n=t.chats,r=t.onGroup,i=t.filter,a=t.onCancel,c=void 0;return this.state.loading?c=o.createElement(d.Loading,null):!function(){var t=l10n.accentFold(e.state.searchFilter),a=n.filter(function(e){return i(e)&&(!t||t&&e.contact.searchMatch(t))});a.length?(e.selection.init(_.map(a.filter(function(e){return i(e)===!0}),"id")),c=a.map(function(t){var n=void 0,a=void 0;return _.isString(i(t))&&(n=o.createElement("div",{className:"chat-status ellipsify",title:i(t)},i(t)),a="member"),o.createElement(l,{chat:t,mode:l.Mode.INFO,active:e.selection,secondary:n,noContext:!0,className:a,onClick:_.isString(i(t))?void 0:r.bind(null,t),key:t.id})})):c=o.createElement(d.SearchGroups,null)}(),o.createElement(s,{title:l10n.t("web_groups"),selection:this.selection,onSearch:this.onSearch,searchPlaceholder:l10n.t("search_groups"),onSelect:this.onSelect,onCancel:a},c)}});e.exports=p},function(e,t,n){"use strict";var r=n(6),i=n(1233),a=n(1235),o=n(1234),s=n(1262),c=n(1490),l=n(8),u=n(226),d=n(88),p="animated-doodle",h=n(1548),f={"class":".animated-doodle",low:{"default":h},high:{"default":h}},m=r.createClass({displayName:"HelpDrawer",propTypes:{onClose:r.PropTypes.func.isRequired},componentWillMount:function(){u.isAssetLoaded(p)||u.loadAsset(f,p)},onTOS:function(){var e="https://www.whatsapp.com/legal/";e=d.build(e,{lg:l10n.getLocale()}),window.open(e,"_blank")},onFAQ:function(){var e="http://www.whatsapp.com/faq/web";e=e=d.build(e,{lg:l10n.getLocale()}),window.open(e,"_blank")},onContactUs:function(){l.openModal(r.createElement(c,null))},render:function(){return r.createElement(i,{onCancel:this.onBack,id:"help"},r.createElement(a,{a8n:"drawer-title-help",title:l10n.t("help_drawer_title"),onBack:this.props.onClose,type:a.Type.LARGE}),r.createElement(o,{wide:!0},r.createElement("div",{className:"controls-section animated-doodle"}),r.createElement("div",{className:"chatlist list-icons list-actions"},r.createElement(s,{className:"drawer-list-item",a8n:"li-faq",onClick:this.onFAQ},l10n.t("web_settings_faq")),r.createElement(s,{className:"drawer-list-item",a8n:"li-contact-us",onClick:this.onContactUs},l10n.t("send_logs_title")),r.createElement(s,{className:"drawer-list-item",a8n:"li-tos",onClick:this.onTOS},l10n.t("terms_and_privacy_link")))))}});e.exports=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=(n(1231),n(1229),n(1276)),g=n(1391),v=n(1386),y=n(218),_=n(1233),E=n(1235),b=n(1234),w=n(1352),M=n(1248),C=n(106),S=n(440),T=n(104),k=n(38),x=n(44),N={MEDIA:"media",DOCS:"docs",LINKS:"links"},P=function(e){function t(){(0,s["default"])(this,t);var e=(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments));return e.onSelectMessages=function(){e.state.selectable||e.setState({selectable:!0})},e.onCancelSelection=function(){e.state.selectable&&(e.selectedMessages.unsetAll(),e.setState({selectable:!1}))},e.onMessageSelect=function(t,n){e.onSelectMessages(),e.selectedMessages.setVal(t,n)},e.selectedMessages=new M([],function(e){return e.id.toString()}),e.state={selected:N.MEDIA,direction:null,selectable:!1},e}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"onSelectTab",value:function(e){var t=k.values(N).indexOf(this.state.selected),n=k.values(N).indexOf(e),r=n>t?"right":"left";this.setState({selected:e,direction:r})}},{key:"getTabs",value:function(){var e=this;if(!T.supportsFeature(T.F.LINK_DOC_GALLERY))return null;var t=[{tab:N.MEDIA,title:S.t("media")},{tab:N.DOCS,title:S.t("docs")},{tab:N.LINKS,title:S.t("links")}].map(function(t){var n=x("menu-item",{active:e.state.selected===t.tab});return f.createElement("button",{className:n,onClick:e.onSelectTab.bind(e,t.tab),key:t.tab,title:t.title},t.title)});return f.createElement("div",{className:"menu-tabs menu-tabs-lists","data-active-tab":this.state.selected},t)}},{key:"getContent",value:function(){var e=this.props.chat;if(!T.supportsFeature(T.F.LINK_DOC_GALLERY))return f.createElement(m,{chat:e,selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages,fullCollection:!0});var t=void 0;switch(this.state.selected){case N.MEDIA:t=f.createElement(m,{chat:e,selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages,fullCollection:!0});break;case N.LINKS:t=f.createElement(g,{chat:e,selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages});break;case N.DOCS:t=f.createElement(v,{chat:e,selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages})}return t}},{key:"render",value:function(){var e=this.props.chat,t=this.getTabs(),n=this.getContent(),r=this.state.selectable?f.createElement(y,{displayName:"MediaMultiSelect",escapable:!0,requestDismiss:this.onCancelSelection},f.createElement(w,{chat:e,noSortOnForward:!0,selectedMessages:this.selectedMessages,onCancel:this.onCancelSelection})):null,i="right"===this.state.direction?"slide-forward":"slide-back",a=T.supportsFeature(T.F.LINK_DOC_GALLERY)?" ":S.t("media");return f.createElement(_,{id:"multimedia-gallery",onCancel:this.props.onBack},f.createElement(E,{title:a,onBack:this.props.onBack,type:E.Type.LARGE}),r,t,f.createElement(b,{"data-list-scroll-container":!0},f.createElement(C,{transitionName:i,className:"column"},f.createElement("div",{className:"multimedia-gallery",key:this.state.selected},f.createElement("div",{className:"column"},n)))))}}]),t}(f.Component);e.exports=P},function(e,t,n){"use strict";var r=n(6),i=n(1230),a=n(143),o=n(44),s=n(1237),c=n(1232),l=n(104),u=n(1229),d=r.createClass({displayName:"MediaPanelHeader",propTypes:{msg:r.PropTypes.instanceOf(u).isRequired,onGoToMsgClick:r.PropTypes.func.isRequired,onUnstarClick:r.PropTypes.func.isRequired,onStarClick:r.PropTypes.func.isRequired,openForwardFlow:r.PropTypes.func.isRequired,onDownloadClick:r.PropTypes.func.isRequired,onClose:r.PropTypes.func.isRequired},mixins:[i],getInitialState:function(){return{renderableUrl:this.async("msg.mediaData.renderableUrl")}},getMenuBtns:function(){var e=this.props.msg,t=null,n=null,i=null,a=null,s="menu-item menu-item-hover";if(t=r.createElement("div",{className:s,onClick:this.props.onGoToMsgClick},r.createElement("span",{
className:"icon icon-bubble",title:l10n.t("go_to_message")})),l.supportsFeature(l.F.STARRED)){var c=void 0,u=void 0,d=void 0;e.star?(c=this.props.onUnstarClick,u="icon icon-unstar-btn",d=l10n.t("unstar_message")):(c=this.props.onStarClick,u="icon icon-star-btn",d=l10n.t("star_message")),n=r.createElement("div",{className:s,onClick:c},r.createElement("span",{className:u,title:d}))}return i=r.createElement("div",{className:s,onClick:this.props.openForwardFlow},r.createElement("span",{className:"icon btn-media-forward icon-forward",title:l10n.t("forward")})),a=r.createElement("div",{className:o(s,{disabled:!this.state.renderableUrl}),onClick:this.props.onDownloadClick},r.createElement("a",{className:"icon icon-download",title:l10n.t("web_button_download")})),{btnGoToMsg:t,btnStar:n,btnForward:i,btnDownload:a}},render:function(){var e=this.props.msg,t=e.displayName(!0,!0);e.isGroupMsg&&(t+=" @ "+e.chat.title());var n=this.getMenuBtns(),i=n.btnGoToMsg,l=n.btnStar,u=n.btnForward,d=n.btnDownload,p=o("media-panel-header",{});return r.createElement("div",{className:p},r.createElement("div",{className:"chat media-chat"},r.createElement("div",{className:"chat-avatar"},r.createElement(s,{id:e.sender,size:40})),r.createElement("div",{className:"chat-body"},r.createElement("div",{className:"chat-main"},r.createElement(c,{ellipsify:!0,text:t})),r.createElement("div",{className:"chat-secondary"},r.createElement("div",{className:"chat-status ellipsify"},a.relativeDateAndTimeStr(e.t))))),r.createElement("div",{className:"menu menu-horizontal media-panel-tools"},i,l,u,d,r.createElement("div",{className:"menu-item menu-item-hover"},r.createElement("button",{className:"icon icon-x-viewer",title:l10n.t("web_close"),onClick:this.props.onClose}))))}});e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1253),a=r(i),o=n(1249),s=n(6),c=n(37),l=n(1229),u=n(1230),d=n(142),p=n(1232),h=n(1326),f=n(1315),m=n(1254),g=n(1277),v=n(8),y=n(1284),E=n(432),b=n(1244),w=n(1483),M=n(1274),C=n(104),S=n(1353),T=n(1356),k=n(44),x=n(218),N=500,P=2,O=s.createClass({displayName:"MediaViewerModal",mixins:[u],propTypes:{msg:s.PropTypes.instanceOf(l).isRequired,zoomIn:s.PropTypes.bool,getZoomNode:s.PropTypes.func,onBack:s.PropTypes.func.isRequired,onExitAnimation:s.PropTypes.func,onNext:s.PropTypes.func,onPrev:s.PropTypes.func,onImgZoomIn:s.PropTypes.func},getDefaultProps:function(){return{getZoomNode:_.noop}},getInitialState:function(){return{star:this.async("msg.star"),mediaStage:this.async("msg.mediaData.mediaStage"),imgZoomed:!1}},componentWillMount:function(){if(this.props.msg.mediaData.mediaStage===b.STAGE.RESOLVED&&this.props.zoomIn){var e=this.props.getZoomNode(this.props.msg.id);this.setState({zoomElement:e}),this.style={opacity:0}}},componentDidMount:function(){this.style={}},onImageLoad:function(e){var t=this.state.zoomElement;t&&e&&this.props.zoomIn&&!this.zoomed&&(this.animateZoom(t,e),this.zoomed=!0)},animateZoom:function(e,t){var n=this,r=t.getBoundingClientRect(),i=e.getBoundingClientRect(),a=i.top-r.top,o=i.left-r.left,s=e.clientWidth/t.clientWidth,l=(t.clientHeight-e.clientHeight)/2,u=(t.clientWidth-e.clientWidth)/2;a-=l,o-=u,Velocity(t,{opacity:0,translateX:o,translateY:a,scale:s},{duration:0}).then(function(){Velocity(t,{opacity:[1,0],translateX:[0,o],translateY:[0,a],scale:[1,s]},{duration:N,easing:[.1,.82,.25,1]});var e=c.findDOMNode(n.refs.caption);e&&Velocity(e,{opacity:[1,0]},{duration:N})})},openForwardFlow:function(e){e.stopPropagation();var t=this.props.msg;t.isUnsentMedia?v.openModal(s.createElement(E,{title:l10n.t("err_unsent_forward_title"),onOK:v.closeModal.bind(v),okText:l10n.t("web_ok")},l10n.t("err_unsent_forward_text"))):v.openModal(s.createElement(y,{msgs:[this.props.msg]}),"modal-flow")},onScroll:function(e){Math.abs(e.deltaY)>7&&this.onClose()},onImgZoomIn:function(e){if(e&&this.refs.media){var t=this.refs.media;this.listenToMouseMove=t.heightOveflow>0||t.widthOveflow>0}this.setState({imgZoomed:e}),this.props.onImgZoomIn(e)},onZoomOut:function(){this.refs.media&&this.state.imgZoomed&&this.refs.media.onImageClick()},onMouseMove:function(e){this.handleMouseMove(e.pageX,e.pageY)},handleMouseMove:_.throttle(function(e,t){var n=this.refs.media&&this.refs.media.refs.image,r=c.findDOMNode(n);if(r){var i=r.parentNode,a=i.parentNode,o=this.refs.media.getTranslatePosition(a,e,t),s=o.translateX,l=o.translateY;Velocity(i,"stop"),Velocity(i,{translateX:s,translateY:l,scale:P},{duration:0})}},42),onDownloadClick:function(e){e.stopPropagation(),M.initDownload(this.props.msg)},onStarClick:function(e){e.stopPropagation(),this.props.msg.chat.sendStarMsgs([this.props.msg],!0)},onUnstarClick:function(e){e.stopPropagation(),this.props.msg.chat.sendStarMsgs([this.props.msg],!1)},onGoToMsgClick:function(e){e.stopPropagation(),this.onClose(),v.existsDrawerRight(function(e){e&&2===S.column&&v.closeDrawerRight()});var t=this.props.msg;v.openChatAt(t.chat,t.chat.getSearchContext(t))},getMenuBtns:function(){var e=this.props.msg,t=null,n=null,r=null,i=null,a=k("menu-item menu-item-hover",{disabled:!e.mediaData.renderableUrl});if(t=s.createElement("div",{className:"menu-item menu-item-hover",onClick:this.onGoToMsgClick},s.createElement("span",{className:"icon icon-bubble",title:l10n.t("go_to_message")})),C.supportsFeature(C.F.STARRED)){var o=void 0,c=void 0,l=void 0;e.star?(o=this.onUnstarClick,c="icon icon-unstar-btn",l=l10n.t("unstar_message")):(o=this.onStarClick,c="icon icon-star-btn",l=l10n.t("star_message")),n=s.createElement("div",{className:a,onClick:o},s.createElement("span",{className:c,title:l}))}return r=s.createElement("div",{className:a,onClick:this.openForwardFlow},s.createElement("span",{className:"icon btn-media-forward icon-forward",title:l10n.t("forward")})),i=s.createElement("div",{className:a,onClick:this.onDownloadClick},s.createElement("a",{className:"icon icon-download",title:l10n.t("web_button_download")})),{btnGoToMsg:t,btnStar:n,btnForward:r,btnDownload:i}},onClose:function(){var e=this;if(!this.closing){this.closing=!0,_.isFunction(this.props.onExitAnimation)&&this.props.onExitAnimation();var t=this.props.getZoomNode(this.props.msg.id);if(!t)return this.props.onBack();var n=this.refs.media,r=void 0;if(n&&n.refs){var i=this.props.msg.mediaData.type;i===b.TYPE.IMAGE?r=n.image:this.props.msg.mediaData.isGif&&(r=n.refs.player)}if(!r)return this.props.onBack();r=c.findDOMNode(r);var a=r.getBoundingClientRect(),o=t.getBoundingClientRect(),s=o.top-a.top,l=o.left-a.left,u=t.clientWidth/r.clientWidth,d=(r.clientHeight-t.clientHeight)/2,p=(r.clientWidth-t.clientWidth)/2;s-=d,l-=p,Velocity(r,{translateX:[l,0],translateY:[s,0],scale:[u,1]},{duration:200,easing:[.1,.82,.25,1]}).then(function(){e.props.onBack()});var h=c.findDOMNode(this.refs.caption);h&&Velocity(h,{opacity:[0,1]},{duration:200,easing:[.1,.82,.25,1]})}},render:function(){var e,t=this.props.msg,n=t.mediaData;switch(n.type){case b.TYPE.IMAGE:e=s.createElement(D,{msg:t,key:t.id,style:this.style,onLoad:this.onImageLoad,onImgZoomIn:this.onImgZoomIn,ref:"media"});break;case b.TYPE.VIDEO:e=s.createElement(A,{msg:t,key:t.id,onLoad:n.isGif?this.onImageLoad:null,ref:"media"});break;case b.TYPE.AUDIO:e=s.createElement(R,{msg:t,key:t.id})}var r=void 0;if(t.caption){var i=t.mentionMap(),a=this.props.zoomIn&&(n.isGif||n.type===b.TYPE.IMAGE);r=s.createElement(p,{ref:"caption",className:{"media-caption":!0,"caption-hidden":a},linkify:!0,format:!0,mention:i,text:t.caption})}var o=k("media",{"media-with-caption":!!r}),c=s.createElement("span",{className:"icon icon-chevron-right icon-l",title:l10n.t("next_button")}),l=k("btn btn-round btn-media-next",{"disabled-btn":!this.props.onNext}),u=s.createElement("button",{className:l,onClick:this.props.onNext||function(e){return e.stopPropagation()}},c),d=s.createElement("span",{className:"icon icon-chevron-left icon-l",title:l10n.t("previous_button")}),h=k("btn btn-round btn-media-prev",{"disabled-btn":!this.props.onPrev}),f=s.createElement("button",{className:h,onClick:this.props.onPrev||function(e){return e.stopPropagation()}},d),m=k("media-viewer",{"media-viewer-animate":this.props.zoomIn,"cursor-zoom-out":this.state.imgZoomed}),g=this.state.imgZoomed?null:this.onScroll,v=this.state.imgZoomed?null:this.onClose,y=this.state.imgZoomed&&this.listenToMouseMove?this.onMouseMove:null,_=this.state.imgZoomed?this.onZoomOut:null;return s.createElement(x,{displayName:"MediaViewer",escapable:!0,requestDismiss:this.onClose},s.createElement("div",{className:m,onClick:_,onMouseMove:y},s.createElement(w,{msg:this.props.msg,onGoToMsgClick:this.onGoToMsgClick,onUnstarClick:this.onUnstarClick,onStarClick:this.onStarClick,openForwardFlow:this.openForwardFlow,onDownloadClick:this.onDownloadClick,onClose:this.onClose}),s.createElement("div",{className:"media-content",dir:"ltr",ref:"container",onWheel:g,onClick:v},f,s.createElement("div",{className:o},s.createElement(L,{msg:t}),e,r),u)))}}),D=s.createClass({displayName:"MediaImage",mixins:[u,d],propTypes:{msg:s.PropTypes.instanceOf(l).isRequired,style:s.PropTypes.object,onLoad:s.PropTypes.func,onImgZoomIn:s.PropTypes.func},getInitialState:function(){return{mediaStage:this.async("msg.mediaData.mediaStage"),zoomIn:null}},componentDidMount:function(){this.props.msg.forceDownloadMedia()},onImageClick:function(e){if(e&&e.stopPropagation(),this.state.zoomIn)return this.props.onImgZoomIn(!1),void this.setState({zoomIn:null});var t=c.findDOMNode(this.image),n=t.parentNode,r=n.parentNode;this.heightOveflow=n.clientHeight*P-r.clientHeight,this.widthOveflow=n.clientWidth*P-r.clientWidth;var i=this.getTranslatePosition(r,e.pageX,e.pageY),a=i.translateX,o=i.translateY;this.props.onImgZoomIn(!0),this.setState({zoomIn:{factor:P,translateX:a,translateY:o}})},getTranslatePosition:function(e,t,n){var r=window.innerWidth/2-t,i=window.innerHeight/2-n,a=this.widthOveflow>0?1.5*r*this.widthOveflow/e.clientWidth:0,o=this.heightOveflow>0?1.5*i*this.heightOveflow/e.clientHeight:0;return{translateX:a,translateY:o}},render:function(){var e=this,t=this.props.msg,n=t.mediaData,r=this.state.zoomIn,i=k("media-viewer-img",{"cursor-zoom-in":!r});if(n.mediaStage===b.STAGE.RESOLVED){var c={width:n.fullWidth,height:n.fullHeight},l=s.createElement(a["default"],{src:n.renderableUrl,ref:(0,o.GetRef)("image",this),onClick:this.onImageClick,style:this.props.style,className:i});return r&&(l=s.createElement(x,{displayName:"ZoomInImage",ref:"image",escapable:!0,requestDismiss:function(){return e.onImageClick()}},l)),s.createElement(m,{type:m.TYPES.ZOOM_IN,size:c,zoomIn:this.state.zoomIn,onObjectLoad:this.props.onLoad},l)}return s.createElement(I,{msg:t})}}),A=s.createClass({displayName:"MediaVideo",mixins:[u,d],propTypes:{msg:s.PropTypes.instanceOf(l).isRequired,style:s.PropTypes.object,onLoad:s.PropTypes.func},getInitialState:function(){return{played:!1,mediaStage:this.async("msg.mediaData.mediaStage"),size:{width:0,height:0}}},componentWillMount:function(){this.updateSize()},componentWillReceiveProps:function(){this.updateSize()},componentDidMount:function(){var e=this.props.msg;e.forceDownloadMedia()},updateSize:function(){var e=this.props.msg.mediaData;e.mediaStage===b.STAGE.RESOLVED&&e.fullWidth&&e.fullHeight&&this.setState({size:this.getSize()})},onPlayerError:function(e){},onPlayerClick:function(e){e.stopPropagation();var t=c.findDOMNode(this.refs.player);e.clientY>t.clientHeight+t.offsetTop-44||(t.paused?t.play():t.pause())},onResize:function(e){this.setState({size:e})},stopPropagation:function(e){e.stopPropagation()},getSize:function(){var e=this.props.msg.mediaData,t=330;return!e.isGif||e.fullWidth>=t?{width:e.fullWidth,height:e.fullHeight}:{width:t,height:e.fullHeight*t/e.fullWidth}},render:function(){var e=this.props.msg,t=e.mediaData,n=t.isGif,r=t.mediaStage===b.STAGE.RESOLVED;return r?s.createElement(m,{type:m.TYPES.SCALE_DOWN,size:this.state.size,onObjectLoad:this.props.onLoad,style:this.props.style},s.createElement(h,{msg:e,ref:"player",className:"media-viewer-img",onError:this.onPlayerError,onClick:n?this.stopPropagation:this.onPlayerClick,autoPlay:!0,controls:!n,loop:n,onResize:this.onResize},l10n.t("video_playback_not_supported"))):s.createElement(I,{msg:e})}}),I=s.createClass({displayName:"BlurredImage",stopPropagation:function(e){e.stopPropagation()},render:function(){var e=this.props.msg,t="data:image/jpeg;base64,"+e.body,n=T.boundHeightWidth(10*e.height,10*e.width,500,500),r={width:n.width,height:n.height};return s.createElement("div",{className:"media-viewer-blur-crop",style:r,onClick:this.stopPropagation},s.createElement("img",{className:"media-viewer-blur-img",src:t}))}}),R=s.createClass({displayName:"MediaAudio",mixins:[u],propTypes:{msg:s.PropTypes.instanceOf(l).isRequired},getInitialState:function(){return{mediaStage:this.async("msg.mediaData.mediaStage")}},render:function(){var e=this.props.msg;return e.mediaData.mediaStage===b.STAGE.RESOLVED?s.createElement(f,{msg:e,className:"media-viewer-img media-viewer-audio",autoPlay:!0,controls:!0},l10n.t("audio_playback_not_supported")):s.createElement("div",{className:"image-audio"})}}),L=s.createClass({displayName:"MediaStage",mixins:[u],propTypes:{msg:s.PropTypes.instanceOf(l).isRequired},getInitialState:function(){return{mediaStage:this.async("msg.mediaData.mediaStage")}},onUnsupportedDownloadClick:function(e){var t=this;e.stopPropagation(),v.openModal(s.createElement(E,{onCancel:v.closeModal.bind(v),onOK:function(){v.closeModal(),M.initDownload(t.props.msg)},okText:l10n.t("web_button_download"),cancelText:l10n.t("web_cancel"),title:l10n.t("download_unsupported_media_title")},l10n.t("download_unsupported_media_prompt")))},downloadMedia:function(e){e.stopPropagation(),this.props.msg.forceDownloadMedia()},stopPropagation:function(e){e.stopPropagation()},render:function(){var e=this.props.msg.mediaData,t=null;switch(e.mediaStage){case b.STAGE.RESOLVED:case b.STAGE.ERROR_MISSING:return null;case b.STAGE.ERROR_UNSUPPORTED:return t=this.onUnsupportedDownloadClick,s.createElement(g.Download,{filesize:e.size,onClick:t});case b.STAGE.NEED_POKE:return t=this.downloadMedia,s.createElement(g.Download,{filesize:e.size,onClick:t});default:return t=this.stopPropagation,s.createElement("div",{onClick:t},s.createElement(g.Pending,null))}}});e.exports=O},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(1265),c=n(1233),l=n(1235),u=n(1234),d=n(8),p=n(1229),h=n(1250),f=n(1345),m=o.createClass({displayName:"MultiVCardModal",propTypes:{msg:o.PropTypes.instanceOf(p).isRequired},_renderVCard:function(e,t){var n=h.parse(e.vcard);return n?o.createElement(f,{key:t,parsedVCard:n,thumbnail:h.thumbnail(e.vcard),className:"multi-vcard-dialog-contact"}):null},render:function(){var e=this,t=this.props.msg;return o.createElement(s,{type:s.BOX},o.createElement(c,{onCancel:function(){return d.closeModal()}},o.createElement(l,{title:l10n.t("multi_vcard_number_of_contacts",{count:t.vcardList.length,_plural:t.vcardList.length}),type:l.Type.POPUP,onCancel:function(){return d.closeModal()}}),o.createElement(u,null,o.createElement(a["default"],null,o.createElement("div",{className:"multi-vcard-dialog-body"},t.vcardList.map(function(t,n){return e._renderVCard(t,n)}))))))}});e.exports=m},function(e,t,n){"use strict";var r=n(6),i=n(37),a=n(1231),o=n(8),s=n(1232),c=n(0),l=n(84),u=function(){return[{label:l10n.t("web_mute_8hours"),duration:8},{label:l10n.t("web_mute_1week"),duration:168},{label:l10n.t("web_mute_1year"),duration:8760}]},d=r.createClass({displayName:"MutePopup",propTypes:{onCancel:r.PropTypes.func,onMute:r.PropTypes.func.isRequired,chat:r.PropTypes.instanceOf(a).isRequired},getInitialState:function(){return{mute:8}},onChange:function(e){this.setState({mute:parseInt(e.target.value,10)})},onMute:function(e){e.stopPropagation(),o.closeModal(),this.props.onMute(3600*this.state.mute+c().unix(),!0)},componentDidMount:function(){l.focus(i.findDOMNode(this.refs.button))},render:function(){var e=this.props.onCancel||function(){o.closeModal()},t=this.state.mute,n=this,i=u().map(function(e){var i=e.duration;return r.createElement("li",{key:"mute-"+i},r.createElement("label",null,r.createElement("input",{type:"radio",name:"duration",value:e.duration,checked:t===i,onChange:n.onChange}),e.label))});return r.createElement("div",{className:"backdrop"},r.createElement("div",{className:"popup-container"},r.createElement("div",{className:"popup"},r.createElement("div",{className:"popup-body"},r.createElement("div",{className:"popup-title",dir:"auto"},r.createElement(s,{text:l10n.t("mute_time",{name:this.props.chat.title()})})),r.createElement("div",{className:"popup-contents"},r.createElement("form",{ref:"form"},r.createElement("ol",{className:"choices"},i)))),r.createElement("div",{className:"popup-controls"},r.createElement("button",{className:"btn-plain popup-controls-item",onClick:e},l10n.t("web_cancel")),r.createElement("button",{ref:"button",className:"btn-plain btn-default popup-controls-item",onClick:this.onMute},l10n.t("web_menuitem_mute"))))))}});e.exports=d},function(e,t,n){"use strict";var r=n(6),i=n(1233),a=n(1235),o=n(1234),s=n(1260),c=n(1295),l=n(106),u=n(1242),d=r.createClass({displayName:"NewGroupDrawer",propTypes:{thumb:r.PropTypes.string,full:r.PropTypes.string,subject:r.PropTypes.string,onBack:r.PropTypes.func.isRequired,onContinue:r.PropTypes.func.isRequired},getInitialState:function(){return{text:this.props.subject||"",thumb:this.props.thumb,full:this.props.full,emojiActive:!1}},componentDidMount:function(){this.refs.emojiInput.restoreFocus()},preventBlur:function(e){e.preventDefault(),e.stopPropagation(),this.refs.emojiInput.restoreFocus()},onImageSet:function(e,t){this.setState({thumb:e,full:t})},onContinue:function(){var e=u.emojify(this.state.text.trim()),t=this.refs.photoPicker;if(t.state.isEditing){var n=this;t.cropImage().then(function(t){n.props.onContinue(e,t.thumb,t.full)})}else this.props.onContinue(e,this.state.thumb,this.state.full)},onInputChange:function(e){var t=e.target.value;this.setState({text:t})},render:function(){var e=this.state.text.trim().length>0,t=e?r.createElement("div",{className:"drawer-section drawer-controls"},r.createElement("button",{className:"btn btn-round",onClick:this.onContinue},r.createElement("span",{className:"icon icon-forward-light icon-l"}))):null;return r.createElement(i,{id:"new-group",onCancel:this.props.onBack},r.createElement(a,{title:l10n.t("new_group_flow_title"),type:a.Type.LARGE,onBack:this.props.onBack}),r.createElement(o,{wide:!0},r.createElement("div",{className:"drawer-section"},r.createElement(c,{type:c.Type.GROUP,startImage:this.state.full,onImageSet:this.onImageSet,ref:"photoPicker"})),r.createElement("div",{className:"drawer-section",onMouseDown:this.preventBlur},r.createElement(s,{ref:"emojiInput",value:this.state.text,maxLength:25,showRemaining:!0,onChange:this.onInputChange,placeholder:l10n.t("group_subject"),onEnter:e?this.onContinue:_.noop,supportsEmoji:!0})),r.createElement(l,{transitionName:"btn"},t)))}});e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(1233),c=n(1235),l=n(1234),u=n(1314),d=n(1382),p=n(141),h=n(10),f=n(8),m=n(435),g=n(84),v=n(106),y=m.genId("max_participant_toast"),E=o.createClass({displayName:"NewGroupParticipantsDrawer",mixins:[p],propTypes:{thumb:o.PropTypes.string,full:o.PropTypes.string,subject:o.PropTypes.string.isRequired,onBack:o.PropTypes.func.isRequired,onContinue:o.PropTypes.func.isRequired},getInitialState:function(){var e=this;return this.props.uimContext&&(this.props.uimContext.uimClose=function(){e.onBack()}),{searchText:"",participants:[],shouldFocus:!0}},getFilteredContacts:function(){var e=Store.Contact.getFilteredContacts();e=_.difference(e,this.state.participants);var t=this.state.searchText;return t?(t=l10n.accentFold(t),e.filter(function(e){return e.searchMatch(t)})):e},componentDidMount:function(){this.focus()},componentDidUpdate:function(){this.adjustInput()},onKeyDown:function(e){if("Backspace"!==e.key||this.state.searchText||_.isEmpty(this.state.participants))"Enter"===e.key&&_.size(this.state.participants)&&this.onContinue();else{e.preventDefault();var t=this.state.participants;this.setState({participants:t.slice(0,t.length-1),shouldFocus:!0})}},onInput:function(e){this.setState({searchText:e.target.value})},adjustInput:function(){var e=this.refs.input.offsetParent.offsetWidth-10,t=this.refs.sizer.offsetWidth,n=t>e?e:t;this.refs.input.style.width=n+"px";var r;r=e-this.refs.input.offsetLeft-n>0?e-this.refs.input.offsetLeft:e,this.refs.input.style.width=r+"px",this.state.shouldFocus&&this.focus()},onReset:function(){this.setState({searchText:"",shouldFocus:!0})},focus:function(){g.focus(this.refs.input)},onBack:function(){var e=this.props;e.onBack(e.subject,e.thumb,e.full)},onContinue:function(){var e=this.props;e.onContinue(e.subject,e.thumb,e.full,this.state.participants)},onDelete:function(e,t){var n=_.without(this.state.participants,t);this.setState({participants:n,shouldFocus:!n.length})},onContactClick:function(e,t){var n=this.state.participants;if(_.includes(n,t))this.setState({participants:_.without(n,t),shouldFocus:!0});else if(n.length>=h.MAX_GROUP_SIZE){var r=l10n.t("action_group_create_failed_participant",{max:h.MAX_GROUP_SIZE});f.openToast(o.createElement(m,{msg:r,id:y}))}else this.setState({participants:n.concat(t),searchText:"",shouldFocus:!0})},onFocusList:function(e){this.refs.list&&(e.preventDefault(),e.stopPropagation(),a["default"].flashFocus=Date.now(),this.refs.list.focusFirst())},onFocusParticipants:function(e){e.repeat||0!==this.refs.input.selectionStart||this.refs.participantList&&(e.preventDefault(),e.stopPropagation(),a["default"].flashFocus=null,this.refs.participantList.focusLast())},onSelectFirst:function(e){e.preventDefault(),e.stopPropagation();var t=_.head(this.getFilteredContacts());t&&this.onContactClick(e,t)},onFocusSearch:function(e){a["default"].flashFocus=Date.now(),g.focus(this.refs.input)},render:function(){var e=_.size(this.state.participants)?o.createElement("button",{className:"btn btn-round",onClick:this.onContinue},o.createElement("span",{className:"icon icon-checkmark-light"})):null,t=_.size(this.state.participants)?" ":l10n.t("group_participant_hint"),n={down:this.onFocusList,enter:this.state.searchText?this.onSelectFirst:_.size(this.state.participants)?this.onContinue:_.noop,up:this.onFocusParticipants};return n[l10n.LR("left","right")]=this.onFocusParticipants,o.createElement(s,{id:"new-group",onCancel:this.onBack},o.createElement(c,{title:l10n.t("add_group_participants_title"),type:c.Type.LARGE,onBack:this.onBack}),o.createElement(l,null,o.createElement("div",{className:"drawer-section new-group-search"},o.createElement("div",{className:"input-clear input-ext"},o.createElement(a["default"],{handlers:n,className:"input input-line"},o.createElement("div",{className:"list-names list-deletable new-group-preview"},o.createElement("div",{className:"new-group-participants","data-list-scroll-container":!0},o.createElement(d,{ref:"participantList",contacts:this.state.participants,onDelete:this.onDelete,onFocusSearch:this.onFocusSearch}))),o.createElement("input",{className:"inputarea",ref:"input",placeholder:t,onKeyDown:this.onKeyDown,onChange:this.onInput,value:this.state.searchText}),o.createElement("span",{className:"inputarea-sizer",ref:"sizer"},this.state.searchText)))),o.createElement("div",{className:"new-group-contacts","data-list-scroll-container":!0},o.createElement(u,{ref:"list",contacts:this.getFilteredContacts(),onFocusSearch:this.onFocusSearch,onClick:this.onContactClick})),o.createElement(v,{transitionName:"btn",className:"drawer-section drawer-controls"},e)))}});e.exports=E},function(e,t,n){"use strict";var r=n(6),i=n(1233),a=n(1235),o=n(1234),s=n(1472),c=r.createClass({displayName:"NotificationsDrawer",propTypes:{onClose:r.PropTypes.func.isRequired},render:function(){return r.createElement(i,{onCancel:this.onBack,id:"notifications"},r.createElement(a,{a8n:"drawer-title-notifications",title:l10n.t("notifications_drawer_title"),onBack:this.props.onClose,type:a.Type.LARGE}),r.createElement(o,{wide:!0},r.createElement(s,{key:"notifications"})))}});e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(105),a=r(i),o=n(6),s=n(145),c=n(432),l=n(8),u=n(1305),d=n(453),p=n(27),h=n(1260),f=n(435),m=320,g=50,v=10,y=500,E=o.createClass({displayName:"SendLogsPopup",mixins:[s],getInitialState:function(){return{email:"",emailError:void 0,confirmEmail:"",confirmEmailError:void 0,subject:l10n.t("send_logs_default_subject"),subjectError:void 0,description:"",descriptionError:void 0}},componentDidMount:function(){this.refs.emailAddr.restoreFocus()},onSend:function(){var e={},t=this.state.email.trim(),n=this.state.confirmEmail.trim();if(this.validateEmail(t)||(e.emailError=l10n.t("send_logs_email_invalid")),this.validateConfirmEmail(n)||(e.confirmEmailError=l10n.t("send_logs_email_nomatch")),this.validateDescription()||(e.descriptionError=l10n.t("send_logs_too_short")),this.validateSubject()||(e.subjectError=l10n.t("send_logs_subject_error")),_.isEmpty(e)){this.setState({email:t,confirmEmail:n,emailError:void 0,confirmEmailError:void 0,descriptionError:void 0,subjectError:void 0});var r=Store.Conn.me?d.format(Store.Conn.me.split("@")[0]):null,i=this.state.subject.trim()||l10n.t("send_logs_default_subject");p.uploadUserReport(r,t,i,this.state.description),l.closeModal(),l.openToast(o.createElement(f,{msg:l10n.t("send_logs_sent"),id:f.genId()}))}else e.email=t,e.confirmEmail=n,this.setState(e)},onCancel:function(){l.closeModal()},onSubjectChange:function(e){var t={subject:e.target.value};this.state.subjectError&&this.validateSubject(t.subject)&&(t.subjectError=void 0),this.setState(t)},onSubjectBlur:function(){var e=void 0;this.validateSubject()||(e=l10n.t("send_logs_subject_error")),this.state.subjectError!==e&&this.setState({subjectError:e})},onDescriptionChange:function(e){var t={description:e.target.value};this.state.descriptionError&&this.validateDescription(t.description)&&(t.descriptionError=void 0),this.setState(t)},onDescriptionBlur:function(){var e=void 0;!this.state.description&&!this.state.descriptionError||this.validateDescription()||(e=l10n.t("send_logs_too_short")),this.state.descriptionError!==e&&this.setState({descriptionError:e})},onEmailChange:function(e){var t={email:e.target.value};this.state.emailError&&this.validateEmail(t.email)&&(t.emailError=void 0),this.setState(t)},onEmailBlur:function(){var e=void 0,t=this.state.email.trim(),n={};!this.state.email&&!this.state.emailError||this.validateEmail(t)||(e=l10n.t("send_logs_email_invalid")),this.state.emailError!==e&&(n.emailError=e),this.state.email!==t&&(n.email=t),_.isEmpty(n)||this.setState(n)},onConfirmEmailChange:function(e){var t={confirmEmail:e.target.value};this.state.confirmEmailError&&this.validateConfirmEmail(t.confirmEmail)&&(t.confirmEmailError=void 0),this.setState(t)},onConfirmEmailBlur:function(){var e=void 0,t=this.state.confirmEmail.trim(),n={};!this.state.confirmEmail&&!this.state.confirmEmailError||this.validateConfirmEmail(t)||(e=l10n.t("send_logs_email_nomatch")),this.state.confirmEmailError!==e&&(n.confirmEmailError=e),this.state.confirmEmail!==t&&(n.confirmEmail=t),_.isEmpty(n)||this.setState(n)},validateEmail:function(){var e=arguments.length<=0||void 0===arguments[0]?this.state.email:arguments[0];return u.validateEmail(e)},validateConfirmEmail:function(){var e=arguments.length<=0||void 0===arguments[0]?this.state.confirmEmail:arguments[0];return this.state.email===e},validateDescription:function(){var e=arguments.length<=0||void 0===arguments[0]?this.state.description:arguments[0];return e.length>v},validateSubject:function(){arguments.length<=0||void 0===arguments[0]?this.state.subject:arguments[0];return!0},stopPropagation:function(e){e.stopPropagation()},render:function(){var e={enter:this.stopPropagation};return o.createElement(c,{title:l10n.t("send_logs_title"),okText:l10n.t("send_logs_confirm"),onOK:this.onSend,onCancel:this.onCancel},o.createElement(a["default"],{handlers:e},o.createElement(h,{className:"send-logs-input",ref:"emailAddr",value:this.state.email,error:this.state.emailError,maxLength:m,onChange:this.onEmailChange,onBlur:this.onEmailBlur,placeholder:l10n.t("send_logs_email_address")}),o.createElement(h,{className:"send-logs-input",editable:!0,value:this.state.confirmEmail,error:this.state.confirmEmailError,maxLength:m,onChange:this.onConfirmEmailChange,onBlur:this.onConfirmEmailBlur,placeholder:l10n.t("send_logs_email_confirm")}),o.createElement(h,{className:"send-logs-input",value:this.state.subject,error:this.state.subjectError,maxLength:g,onChange:this.onSubjectChange,onBlur:this.onSubjectBlur,placeholder:l10n.t("send_logs_email_subject")}),o.createElement(h,{className:"send-logs-input",value:this.state.description,error:this.state.descriptionError,maxLength:y,onChange:this.onDescriptionChange,onBlur:this.onDescriptionBlur,placeholder:l10n.t("describe_logs"),multiline:!0})))}});e.exports=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1255),m=r(f),g=n(6),v=n(1233),y=n(1235),_=n(1234),E=n(1262),b=(n(444),n(440)),w=n(1237),M=n(1232),C=function(e){function t(){var e,n,r,i;(0,s["default"])(this,t);for(var o=arguments.length,c=Array(o),l=0;l<o;l++)c[l]=arguments[l];return n=r=(0,d["default"])(this,(e=(0,a["default"])(t)).call.apply(e,[this].concat(c))),r.status=window.Store.Status.gaddUp(r.props.profileId),i=n,(0,d["default"])(r,i)}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"componentWillMount",value:function(){this.props.addListener(this.status,"change:status")}},{key:"render",value:function(){return g.createElement(v,{id:"settings",onCancel:this.props.onClose},g.createElement(y,{title:b.t("settings_flow_title"),onBack:this.props.onClose,type:y.Type.LARGE}),g.createElement(_,null,g.createElement("div",{className:"chatlist list-identity"},g.createElement("div",{className:"chat",onClick:this.props.onProfile,"data-ignore-capture":"any"},g.createElement("div",{className:"chat-avatar"},g.createElement(w,{id:window.Store.Conn.me,size:82,quality:w.Quality.HIGH})),g.createElement("div",{className:"chat-body"},g.createElement("div",{className:"chat-main"},g.createElement("div",{className:"chat-title"},g.createElement("span",{className:"emojitext ellipsify",dir:"auto"},g.createElement(M,{text:window.Store.Conn.pushname,direction:"auto"})))),g.createElement("div",{className:"chat-status"},g.createElement("span",{className:"emojitext ellipsify",dir:"auto"},g.createElement(M,{text:this.status.status||b.t("contact_status_loading"),direction:"auto"})))))),g.createElement("div",{className:"chatlist list-icons list-actions"},g.createElement(E,{a8n:"li-notifications",iconClass:"icon-settings-notifications",onClick:this.props.onNotifications},b.t("menuitem_notifications")),g.createElement(E,{a8n:"li-chat_wallpaper",iconClass:"icon-settings-wallpaper",onClick:this.props.onWallpaper},b.t("menuitem_wallpaper")),g.createElement(E,{a8n:"li-blocked",iconClass:"icon-settings-blocked",onClick:this.props.onBlocked},b.t("menuitem_blocked")),g.createElement(E,{a8n:"li-help",iconClass:"icon-settings-help",onClick:this.props.onHelp},b.t("menuitem_help")))))}}]),t}(g.Component);t["default"]=(0,m["default"])(C)},function(e,t,n){"use strict";var r=n(6),i=n(141),a=n(8),o=n(12),s=r.createClass({displayName:"TermsOfServiceModal",mixins:[i],componentDidMount:function(){this.addObserver(Store.Conn,"change:tos",this.close)},close:function(){0===Store.Conn.tos&&a.closeModal()},logout:function(){a.closeModal(),o.logout()},render:function(){var e,t=null;switch(Store.Conn.tos){default:case 1:e=l10n.t("web_terms_of_service_1"),t=r.createElement("div",{className:"popup-controls"
},r.createElement("button",{className:"btn-plain btn-default popup-controls-item",onClick:a.closeModal.bind(a)},l10n.t("ok_got_it")));break;case 2:e=l10n.t("web_terms_of_service_2"),t=r.createElement("div",{className:"popup-controls"},r.createElement("button",{className:"btn-plain popup-controls-item",onClick:this.logout},l10n.t("menuitem_logout")))}return r.createElement("div",{className:"backdrop"},r.createElement("div",{className:"popup-container"},r.createElement("div",{className:"popup"},r.createElement("div",{className:"popup-body"},r.createElement("div",{className:"popup-contents"},e)),t)))}});e.exports=s},function(e,t,n){"use strict";var r=n(6),i=n(1231),a=n(1229),o=n(8),s=n(1232),c=n(432),l=r.createClass({displayName:"UnstarAllPopup",propTypes:{chat:r.PropTypes.instanceOf(i),msgs:r.PropTypes.arrayOf(r.PropTypes.instanceOf(a))},onCancel:function(){o.closeModal()},onUnstar:function(){var e=this.props.chat,t=this.props.msgs;e&&e.pendingAction++,Store.Chat.unstarAllMessages(t,e)["finally"](function(){e&&e.pendingAction--}),o.closeModal()},render:function(){return r.createElement(c,{title:l10n.t("are_you_sure"),onOK:this.onUnstar,okText:l10n.t("unstar_all_button"),onCancel:this.onCancel},r.createElement("div",null,r.createElement(s,{text:l10n.t("unstar_all_confirm")})))}});e.exports=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(6),m=n(1265),g=n(1233),v=n(1235),y=n(1234),_=n(1340),E=n(24),b=n(1250),w=window._,M=window.l10n,C=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"renderContacts",value:function(){var e=this,t=w.filter(this.props.vCard.TEL,function(e){return e.properties.waid});return t.map(function(t){var n=E.numberToWid(w.first(t.properties.waid));return f.createElement(_,{title:E.formattedUser(n),onClick:function(){return e.onSelect(n)},icon:f.createElement("span",{className:e.props.iconClass}),key:"vCard-"+t.index},b.getType(t))})}},{key:"onSelect",value:function(e){this.props.onSelect(e)}},{key:"render",value:function(){return f.createElement(m,{type:m.BOX},f.createElement(g,null,f.createElement(v,{onCancel:this.props.onCancel,type:v.Type.POPUP,title:M.t("choose_phone_number")}),f.createElement(y,null,f.createElement("div",{className:"chatlist column"},f.createElement("div",{className:"drawer-item-container-compact"},this.renderContacts())))))}}]),t}(f.Component);C.defaultProps={iconClass:"icon icon-chat",onCancel:w.noop,onSelect:w.noop},e.exports=C},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=new Uint8Array(e),r=new Uint8Array(t),i=n.length,a=r.length;if(i!==a)return!1;for(var o=0;o<i;o++)if(n[o]!==r[o])return!1;return!0}var a=n(2),o=r(a),s=n(6),c=n(37),l=n(1230),u=n(8),d=n(1528).CombinedFingerprint,p=n(10),h=n(219),f=n(1233),m=n(1256),g=n(1234),v=n(14),y=n(1263),E=n(1),b=n(1289),w=n(1236),M=n(1226),C=n(451),S=n(144),T=n(145),k=n(1325),x=n(85),N=s.createClass({displayName:"VerificationFilePicker",propTypes:{mime:s.PropTypes.string.isRequired,onPick:s.PropTypes.func.isRequired},stopPropagation:function(e){e.stopPropagation()},render:function(){return s.createElement("input",{accept:this.props.mime,type:"file",style:{display:"none"},onChange:this.props.onPick,onClick:this.stopPropagation})}}),P=s.createClass({displayName:"VerificationQRCode",propTypes:{binary:s.PropTypes.object,contact:s.PropTypes.instanceOf(h).isRequired,visible:s.PropTypes.bool},getDefaultProps:function(){return{binary:null}},getInitialState:function(){return{hover:!1,currentQRBinary:null,currentQRDataURL:null}},componentDidMount:function(){this.props.binary&&this.generateQRCode()},componentDidUpdate:function(e,t){this.generateQRCode()},shouldComponentUpdate:function(e,t){return!(this.compareBinary(e.binary,this.props.binary)&&this.compareBinary(t.currentQRBinary,this.state.currentQRBinary)&&e.visible===this.props.visible&&t.hover===this.state.hover&&t.currentQRDataURL===this.state.currentQRDataURL)},onMouseOver:function(e){this.state.hover||this.setState({hover:!0})},onMouseEnter:function(e){this.state.hover||this.setState({hover:!0})},onMouseLeave:function(e){this.state.hover&&this.setState({hover:!1})},fingerprintsMatched:function(e,t){return i(e.publicKey,t.publicKey)&&i(e.identifier,t.identifier)},compareBinary:function(e,t){if(!e&&!t)return!0;var n=d.parse(e),r=d.parse(t);if(!n&&!r)return!0;if(!(n.version||r.version||n.localFingerprint||r.localFingerprint||n.remoteFingerprint||r.remoteFingerprint))return!0;if(n.version!==r.version)return!1;var i=this.fingerprintsMatched(n.localFingerprint,r.localFingerprint),a=this.fingerprintsMatched(n.remoteFingerprint,r.remoteFingerprint);return i&&a},generateQRCode:function(){var e=c.findDOMNode(this.refs.QRCodeContainer),t=this.props.binary;if(!e||!t)return void this.setState({currentQRBinary:null,currentQRDataURL:null});if(!this.compareBinary(this.state.currentQRBinary,t)){this.qr&&delete this.qr,this.qr=new C(e,{text:t,width:p.QR_EDGE/2,height:p.QR_EDGE/2,correctLevel:C.CorrectLevel.L}),this.setState({currentQRBinary:t});var n=e.getElementsByTagName("canvas")[0];if(!n)return void this.setState({currentQRDataURL:null});var r=n.toDataURL("image/png");this.setState({currentQRDataURL:r})}},render:function(){var e=null;if(this.props.visible){var t=null;if(this.state.hover&&this.state.currentQRDataURL){var n=this.props.contact.formattedUser,r=Store.Contact.get(Store.Conn.me).formattedUser,i="Verification Code between "+r+" and "+n+".png";t=s.createElement("a",{href:this.state.currentQRDataURL,download:i},s.createElement("div",{className:"avatar-overlay",key:"avatar-overlay"},s.createElement("div",{className:"avatar-overlay-text"},l10n.t("web_verify_download_code"))))}e=s.createElement("div",{onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},t,s.createElement("div",{className:"verification-circle",ref:"QRCodeContainer"}))}return e}}),O=s.createClass({displayName:"VerificationSpinner",propTypes:{visible:s.PropTypes.bool},render:function(){var e=null;return this.props.visible&&(e=s.createElement("div",{className:"verification-circle"},s.createElement("div",{className:"spinner"},s.createElement(S,{size:40,stroke:4})))),e}}),D=s.createClass({displayName:"VerificationCircle",propTypes:{binary:s.PropTypes.object,contact:s.PropTypes.instanceOf(h).isRequired,visible:s.PropTypes.bool},render:function(){var e=null;return this.props.visible&&(e=s.createElement("div",{className:"verification-circle-container"},s.createElement(P,{visible:!!this.props.binary,binary:this.props.binary,contact:this.props.contact}),s.createElement(O,{visible:!this.props.binary}))),e}}),A=s.createClass({displayName:"VerificationString",NUM_ROWS:3,NUM_BLOCKS_PER_ROW:4,NUM_DIGITS_PER_BLOCK:5,propTypes:{string:s.PropTypes.string},getDefaultProps:function(){return{string:null}},shouldComponentUpdate:function(e,t){return e.string!==this.props.string},numDigitsInVerificationString:function(){return this.NUM_ROWS*this.NUM_BLOCKS_PER_ROW*this.NUM_DIGITS_PER_BLOCK},render:function(){if(!this.props.string)return s.createElement("div",null,l10n.t("loading"));var e=this.props.string;if(e.length!==this.numDigitsInVerificationString())return E.error("verificationString:render this.props.stringshould be "+this.numDigitsInVerificationString()+" characters long instead of "+e.length+".")(),s.createElement("div",null,l10n.t("web_verify_string_error"));for(var t=[],n=0;n<this.NUM_ROWS;n++){for(var r=[],i=0;i<this.NUM_BLOCKS_PER_ROW;i++){for(var a=[],o=0;o<this.NUM_DIGITS_PER_BLOCK;o++){var c=e.charAt(n*this.NUM_DIGITS_PER_BLOCK*this.NUM_BLOCKS_PER_ROW+i*this.NUM_DIGITS_PER_BLOCK+o);a.push(s.createElement("span",{className:"digit",key:o},c))}r.push(s.createElement("span",{className:"block",key:i},a," "))}t.push(s.createElement("div",{className:"row",key:n},r))}return s.createElement("div",{className:"textfield-static selectable-text"},t)}}),I=s.createClass({displayName:"VerificationCheckmark",propTypes:{visible:s.PropTypes.bool},render:function(){var e=null;return this.props.visible&&(e=s.createElement("div",{className:"verification-checkmark-container"},s.createElement("div",{className:"verification-checkmark"},"✓ "))),e}}),R=s.createClass({displayName:"VerificationError",propTypes:{visible:s.PropTypes.bool},render:function(){var e=null;return this.props.visible&&(e=s.createElement("div",{className:"verification-error-container"},s.createElement("div",{className:"verification-error"},"!"))),e}}),L=s.createClass({displayName:"VerificationBanner",propTypes:{children:s.PropTypes.node.isRequired},render:function(){return s.createElement("div",{className:"error-banner"},this.props.children)}}),U=s.createClass({displayName:"VerificationWebcam",CAPTURE_INTERVAL:200,propTypes:{stream:s.PropTypes.object.isRequired,onCapture:s.PropTypes.func.isRequired,onClose:s.PropTypes.func.isRequired},mixins:[T],getInitialState:function(){return{videoURL:window.URL.createObjectURL(this.props.stream)}},componentDidMount:function(){window.addEventListener("resize",this.adjustOverlayPosition)},componentWillUnmount:function(){if(this.clearSafeInterval(this.captureInterval),this.state.videoURL){var e=this.props.stream;b.stop(e),window.URL.revokeObjectURL(this.state.videoURL)}},onVideoLoaded:function(e){this.captureInterval||(this.adjustOverlayPosition(),this.captureInterval=this.safeInterval(this.capture,this.CAPTURE_INTERVAL))},capture:function(){var e=this;if(this.refs.verificationVideo){var t=document.createElement("canvas"),n=c.findDOMNode(this.refs.verificationVideo);t.width=n.videoWidth/2,t.height=n.videoHeight/2;var r=t.getContext("2d");r.drawImage(n,t.width/2,t.height/2,t.width,t.height,0,0,t.width,t.height),t.toBlob(function(t){var n=window.URL.createObjectURL(t);E.log(n),e.props.onCapture(n)},"image/jpeg",1)}},adjustOverlayPosition:function(){var e=c.findDOMNode(this.refs.verificationVideo),t=c.findDOMNode(this.refs.verificationOverlay);if(e&&t){var n=e.offsetHeight,r=e.offsetWidth,i=r/3,a=i,o=(r-i)/2,s=(n-a)/2;t.style.width=i+"px",t.style.height=a+"px",t.style.margin=s+"px "+o+"px"}},render:function(){var e=null;return this.state.videoURL&&(e=s.createElement("div",{className:"webcam"},s.createElement(k,{autoPlay:!0,ref:"verificationVideo",onPlay:this.onVideoLoaded,src:this.state.videoURL}),s.createElement("div",{className:"overlay",ref:"verificationOverlay"}),s.createElement("button",{onClick:this.props.onClose},s.createElement("span",{className:"icon icon-x-alt"})))),e}}),F=s.createClass({displayName:"VerificationDrawer",ICON_DELAY:3e3,BANNER_DELAY:5e3,HINT_DELAY:7e3,ERROR_TYPE:{CORRECT:0,PUBLIC_KEY_MISMATCHED:1,REMOTE_MISMATCHED:2,LOCAL_MISMATCHED:3,BOTH_MISMATCHED:4,INVALID_QR_CODE:5},mixins:[l,w,T],propTypes:{contact:s.PropTypes.instanceOf(h).isRequired,isFirstLevel:s.PropTypes.bool},getInitialState:function(){return this.asyncState({binary:"contact.verificationBinary",string:"contact.verificationString"},{circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,webcamVisible:!1,bannerVisible:!1,bannerText:null,stream:null,isDragging:!1})},componentDidUpdate:function(e,t){(t.binary&&!this.state.binary||t.string&&!this.state.string)&&this.props.contact.queryIdentity()["catch"](function(e){E.error("VerificationDrawer:queryIdentity error: "+e)()})},componentWillMount:function(){this.props.contact.queryIdentity()["catch"](function(e){E.error("verificationDrawer:queryIdentity error: "+e)()})},onDragStart:function(){this.blockDrop=!0},onDragEnd:function(){this.blockDrop=!1},onDragOver:function(){this.state.isDragging||this.blockDrop||this.setState({isDragging:!0})},onDrop:function(e){this.blockDrop||(this.setState({isDragging:!1}),this.state.binary&&this.state.string&&this.onUploadSelect(e))},onDragLeave:function(e){this.setState({isDragging:!1})},showWebcamStream:function(e){this.setState({webcamVisible:!0,circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,stream:e}),this.hintTimer&&(this.clearSafeTimeout(this.hintTimer),delete this.hintTimer),this.hintTimer=this.safeDelay(this.showWebcamHint,this.HINT_DELAY)},showWebcamHint:function(){this.state.webcamVisible&&!this.state.bannerVisible&&this.showBanner(l10n.t("web_verify_webcam_hint"))},onWebcamOpen:function(e){var t=this,n=b.start("camera");o["default"].race([n,this.rejectOnUnmount()]).checkpoint(this.rejectOnUnmount()).then(function(e){return t.showWebcamStream(e)})["catch"](v.Unmount,function(){n.then(function(e){return b.stop(e)})["catch"](_.noop)})["catch"](v.GUM.PermissionDeniedError,function(){u.openModal(s.createElement(y,{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_fail_description",type:y.TYPE.GUIDE_UNBLOCK}))})["catch"](v.GUM.GUMError,function(){u.openModal(s.createElement(y,{title:"guide_desktop_camera_missing_title",desc:"guide_desktop_camera_missing_description",type:y.TYPE.GUIDE_NONE}))})},onWebcamClose:function(e){this.setState({webcamVisible:!1,bannerVisible:!1,stream:null})},onWebcamCapture:function(e){this.verifyImage(e,!0)},onUploadClick:function(){c.findDOMNode(this.refs.verificationFilePicker).click()},onUploadSelect:function(e){e.stopPropagation();var t=e.target.files||e.dataTransfer.files;if(t&&t[0]){var n=t[0],r=URL.createObjectURL(n);this.verifyImage(r,!1);var i=c.findDOMNode(this.refs.verificationFilePickerForm);i&&i.reset()}},componentWillUnmount:function(){clearTimeout(this.iconTimer),clearTimeout(this.bannerTimer),clearTimeout(this.hintTimer)},onClose:function(e){this.props.onClose?this.props.onClose():this.context.uim.uie.requestDismiss()},getErrorBannerText:function(e){var t=void 0,n=this.props.contact.formattedShortName;switch(e){case this.ERROR_TYPE.REMOTE_MISMATCHED:t=l10n.t("web_verify_error_remote_mismatched",{contact:n});break;case this.ERROR_TYPE.LOCAL_MISMATCHED:case this.ERROR_TYPE.BOTH_MISMATCHED:t=l10n.t("web_verify_error_local_mismatched",{contact:n});break;case this.ERROR_TYPE.INVALID_QR_CODE:default:t=l10n.t("web_verify_error_invalid_upload")}return t},showCheckmark:function(){this.onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!0,errorIconVisible:!1,bannerVisible:!1}),this.iconTimer&&(this.clearSafeTimeout(this.iconTimer),delete this.iconTimer),this.iconTimer=this.safeDelay(this.hideCheckmark,this.ICON_DELAY)},showErrorIcon:function(){this.onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!1,errorIconVisible:!0,bannerVisible:!1}),this.iconTimer&&(this.clearSafeTimeout(this.iconTimer),delete this.iconTimer),this.iconTimer=this.safeDelay(this.hideError,this.ICON_DELAY)},showErrorBanner:function(e){var t=this.getErrorBannerText(e);this.showBanner(t)},showBanner:function(e){this.setState({circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,bannerVisible:!0,bannerText:e}),this.bannerTimer&&(this.clearSafeTimeout(this.bannerTimer),delete this.bannerTimer),this.bannerTimer=this.safeDelay(this.hideBanner,this.BANNER_DELAY)},hideCheckmark:function(){this.state.errorIconVisible||this.setState({circleVisible:!0}),this.setState({checkmarkVisible:!1})},hideError:function(){this.state.checkmarkVisible||this.setState({circleVisible:!0}),this.setState({errorIconVisible:!1})},hideBanner:function(){this.setState({bannerVisible:!1})},validateFingerprint:function(e){if(!e||0===!e.version||!e.localFingerprint||!e.remoteFingerprint)return this.ERROR_TYPE.INVALID_QR_CODE;var t=d.parse(this.state.binary),n=i(e.remoteFingerprint.identifier,t.localFingerprint.identifier),r=i(e.localFingerprint.identifier,t.remoteFingerprint.identifier);if(!n&&!r)return this.ERROR_TYPE.BOTH_MISMATCHED;if(!n)return this.ERROR_TYPE.REMOTE_MISMATCHED;if(!r)return this.ERROR_TYPE.LOCAL_MISMATCHED;var a=i(e.remoteFingerprint.publicKey,t.localFingerprint.publicKey),o=i(e.localFingerprint.publicKey,t.remoteFingerprint.publicKey);return a&&o?this.ERROR_TYPE.CORRECT:this.ERROR_TYPE.PUBLIC_KEY_MISMATCHED},decodeQRCode:function(e){return new o["default"](function(t,n){M.callback=function(e,r){if(r)n(r);else if(e.length<1)n("QR decoder did not return decoded binary");else{var i=new Uint8Array(e[0]);t(i)}},M.decode(e)})},verifyImage:function(e,t){var n=this;this.decodeQRCode(e).then(d.parse).then(function(e){var r=n.validateFingerprint(e);r?t&&r===n.ERROR_TYPE.INVALID_QR_CODE||(n.setState({errorType:r}),r===n.ERROR_TYPE.PUBLIC_KEY_MISMATCHED?n.showErrorIcon():n.showErrorBanner(r)):n.showCheckmark()})["catch"](function(e){t||(n.setState({errorType:n.ERROR_TYPE.INVALID_QR_CODE}),n.showErrorBanner(n.ERROR_TYPE.INVALID_QR_CODE))})["finally"](function(){window.URL.revokeObjectURL(e)})},render:function(){var e=null,t=null,n=null;this.state.binary&&(navigator.getUserMedia&&(e=s.createElement(m,{classes:"animate-enter2"},s.createElement("button",{className:"btn btn-info",onClick:this.state.webcamVisible?this.onWebcamClose:this.onWebcamOpen},this.state.webcamVisible?l10n.t("web_verify_webcam_close_button"):l10n.t("web_verify_webcam_open_button")))),t=s.createElement(m,{classes:"animate-enter2"},s.createElement("button",{className:"btn btn-info",onClick:this.onUploadClick},l10n.t("web_verify_upload_button")),s.createElement("p",{className:"drag-and-drop-explanation"},this.state.isDragging?l10n.t("web_verify_drag_and_drop_dragging"):null)),n=s.createElement("form",{ref:"verificationFilePickerForm"},s.createElement(N,{mime:"image/*",onPick:this.onUploadSelect,ref:"verificationFilePicker"})));var r=null;this.state.webcamVisible&&(r=s.createElement(U,{stream:this.state.stream,onCapture:this.onWebcamCapture,onClose:this.onWebcamClose}));var i=null;this.state.bannerVisible&&(i=s.createElement(L,null,this.state.bannerText));var a="icon icon-";return a+=this.props.isFirstLevel?"x":"back",s.createElement(f,{id:"verification",onDrop:this.onDrop,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onCancel:this.onClose},s.createElement("header",{className:"pane-header"},s.createElement("div",{className:"header-close"},s.createElement("button",{onClick:this.onClose},s.createElement("span",{className:a}))),s.createElement("div",{className:"header-body"},s.createElement("div",{className:"header-main"},s.createElement("div",{className:"header-title"},l10n.t("web_verify_title"))),s.createElement("div",{className:"header-secondary"},l10n.t("web_you"),", ",this.props.contact.formattedUser))),r,i,s.createElement(g,{classes:this.state.webcamVisible?"webcam-visible":null,info:!0,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},s.createElement(m,{classes:"drawer-scale drawer-section-photo"},s.createElement(D,{binary:this.state.binary,contact:this.props.contact,visible:this.state.circleVisible}),s.createElement(I,{visible:this.state.checkmarkVisible}),s.createElement(R,{visible:this.state.errorIconVisible})),s.createElement(m,{classes:"animate-enter2"},s.createElement("div",{className:"verification-string"},s.createElement(A,{string:this.state.string}))),s.createElement(m,{classes:"animate-enter2"},s.createElement("p",{className:"verification-explanation"},s.createElement("span",null,l10n.t("web_verify_explanation")," "),s.createElement("a",{target:"_blank",href:p.E2E_FAQ_LINK},l10n.t("learn_more")))),e,t,n))}});F.contextTypes={uim:s.PropTypes.instanceOf(x)},e.exports=F},function(e,t,n){"use strict";var r=n(6),i=n(1233),a=n(1235),o=n(1234),s=n(1230),c=n(8),l=n(435),u=n(10),d=r.createClass({displayName:"ColorCanvas",propTypes:{colorHex:r.PropTypes.string.isRequired,isSelected:r.PropTypes.bool.isRequired,isDefault:r.PropTypes.bool.isRequired},getInitialState:function(){return{hover:!1}},onClick:function(e){var t=this.encodeColor(this.props.colorHex);t!==Store.ChatPreference.get("defaultPreference").wallpaperColor&&(Store.ChatPreference.get("defaultPreference").set("wallpaperColor",t),c.openToast(r.createElement(l,{msg:l10n.t("wallpaper_color_set"),id:l.genId()})))},onMouseOver:function(e){this.state.hover||(this.setState({hover:!0}),Store.ChatPreference.trigger("wallpaper_color_preview",this.encodeColor(this.props.colorHex)))},onMouseEnter:function(e){this.state.hover||(this.setState({hover:!0}),Store.ChatPreference.trigger("wallpaper_color_preview",this.encodeColor(this.props.colorHex)))},onMouseLeave:function(e){this.state.hover&&(this.setState({hover:!1}),Store.ChatPreference.trigger("wallpaper_color_preview"))},encodeColor:function(e){return"#ede9e4"===e?u.DEFAULT_CHAT_WALLPAPER:e},render:function(){var e="wallpaper-color-canvas";this.state.hover&&(e+=" canvas-hover"),this.props.isSelected&&(e+=" canvas-active");var t=this.props.isDefault?r.createElement("span",{className:"wallpaper-default-title"},l10n.t("default_wallpaper")):null;return r.createElement("span",{className:e,style:{backgroundColor:this.props.colorHex},onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick},t)}}),p=r.createClass({displayName:"ColorGrid",mixins:[s],propTypes:{id:r.PropTypes.string.isRequired,colors:r.PropTypes.array.isRequired},getInitialState:function(){return{wallpaperColor:this.async("id.ChatPreference.wallpaperColor")}},render:function(){for(var e=!0,t=this.state.wallpaperColor,n=this.props.colors.map(function(n){var i=!1,a=!1;return(t===n||t===u.DEFAULT_CHAT_WALLPAPER&&e)&&(i=!0),e&&(a=!0,e=!1),r.createElement(d,{colorHex:n,isSelected:i,isDefault:a,key:n})}),i=0;i<2;i++)n.push(r.createElement("div",{key:"emptyEl"+i,className:"wallpaper-color-empty"}));return r.createElement("div",{className:"wallpaper-color-grid"},n)}}),h=r.createClass({displayName:"WallpaperDrawer",propTypes:{onClose:r.PropTypes.func},render:function(){var e=r.createElement(p,{colors:u.WALLPAPER_COLOR,id:"defaultPreference"});return r.createElement(i,{id:"wallpaper",onCancel:this.props.onClose},r.createElement(a,{title:l10n.t("wallpaper_flow_title"),onBack:this.props.onClose,type:a.Type.LARGE}),r.createElement(o,null,e))}});e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(433),s=n(1346),c=n(439),l=n(10),u=n(14),d=s.STATE,p=d.READY,h=d.ERROR,f=c.FILETYPE,m=f.IMAGE,g=f.VIDEO,v=f.DOCUMENT,y=f.AUDIO,_=1,E=o.extend({model:s,initialize:function(){this.errorMsgs=null,this.ignored=0,o.prototype.initialize.call(this)},removeSingleton:function(e,t){e.url&&window.URL.revokeObjectURL(e.url),e.original&&e.original.url&&window.URL.revokeObjectURL(e.original.url)},remove:function(e,t){var n=this;Array.isArray(e)?e.forEach(function(e){return n.removeSingleton(e,t)}):this.removeSingleton(e,t),o.prototype.remove.call(this,e,t)},"delete":function(){var e=this;this.models.forEach(function(t){return e.removeSingleton(t)}),o.prototype["delete"].call(this)},contains:function(e){return this.indexOf(e)>-1},getValidMedias:function(){return this.filter({state:p})},getAfter:function(e){var t=this.getValidMedias(),n=t.indexOf(e);return n<0||n===t.length-1?null:t[n+1]},getBefore:function(e){var t=this.getValidMedias(),n=t.indexOf(e);return n<=0?null:t[n-1]},processFiles:function(e,t){var n=this,r=this.getValidMedias().length,i=e.length+r>l.MAX_FILES?Math.max(l.MAX_FILES-r,0):e.length,o=e.length-i;0===i?o&&this.trigger("max_upload_limit",o):this.ignore(o);var c=e.slice(0,i).map(function(e){var r=_++,i=new s({id:r,file:e,chat:t,uiProcessed:!1});return n.add(i)});return a["default"].map(c,function(e){return e.processPromise})},ignore:function(e){e>0&&(this.ignored+=e)},uiProcessMsgs:function(){var e=[],t=void 0,n=void 0,r=0,i=0,a=0,o=0,s=0,c=!1,d=l.MAX_MEDIA_UPLOAD_SIZE/1024/1024;if(this.forEach(function(e){if(!e.uiProcessed&&(e.uiProcessed=!0,t||e.state!==p||(t=e),e.state===h))if(e.exception instanceof u.MediaFileTooLarge)switch(e.getFileType()){case m:r+=1;break;case g:i+=1;break;case y:a+=1;break;case v:o+=1}else e.exception instanceof u.MediaFileFailedLoad?c=!0:s+=1}),r>0&&e.push(l10n.t("image_too_big",{number:r,_plural:r,maxSize:d+"MB"})),i>0&&e.push(l10n.t("video_too_big",{number:i,_plural:i,maxSize:d+"MB"})),a>0&&e.push(l10n.t("audio_too_big",{number:a,_plural:a,maxSize:d+"MB"})),o>0&&e.push(l10n.t("document_too_big",{number:o,_plural:o,maxSize:d+"MB"})),s>0&&e.push(l10n.t("files_not_supported",{number:s,_plural:s})),c&&(e=[],e.push(l10n.t("media_failed_load"))),e.length>1){e=[];var f=r+i+a+o+s;0===s?e.push(l10n.t("files_too_big",{number:f,_plural:f,maxSize:d+"MB"})):e.push(l10n.t("files_not_added",{number:f,_plural:f}))}return this.errorMsgs=e.join(" "),this.ignore(this.getValidMedias().length-l.MAX_FILES),n=this.ignored,this.ignored=0,n&&this.trigger("max_upload_limit",n),{activeMedia:t,errorMsgs:this.errorMsgs}}});e.exports=E},function(e,t,n){"use strict";var r=n(87),i=n(219),a=r.extend({Collection:"Blocklist",children:{contact:i},props:{id:"string"},initialize:function(){this.contact=Store.Contact.gadd({id:this.id}),this.listenTo(this.contact,"all",this._getCachedEventBubblingHandler("contact"))}});e.exports=a},function(e,t,n){"use strict";var r=n(433),i=n(1498),a=r.extend({model:i,handle:function(e){var t=e.shift(),n=t.blocklist,r=_.map(n,function(e){return{id:e}});this.set(r)}});e.exports=new a},function(e,t,n){"use strict";var r=n(1),i=n(87),a=n(8),o=i.extend({Collection:"Call",props:{id:"string",type:"string",from:"string"},initialize:function(){this.listenToAndRun(this,"change:type",this.updateNotification)},updateNotification:function(){r.log("call:"+this.type+" id:"+this.id+" from:"+this.from)(),"offer"===this.type||"offer_video"===this.type?a.alertCall(this.id,this.from,"offer_video"===this.type):a.cancelCall(this.id)}});e.exports=o},function(e,t,n){"use strict";var r=n(433),i=n(1500),a=n(446),o=r.extend({model:i,handle:function(e){var t=e.shift();switch(t.type){case"offer":case"offer_video":case"accept":case"reject":case"terminate":a.tosShowCallNotification&&this.add(t,{merge:!0})}}});e.exports=new o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(16),a=r(i),o=n(2),s=r(o),c=n(6),l=n(10),u=n(1),d=n(433),p=n(1231),h=n(55),f=n(56),m=n(46),g=n(8),v=n(14),y=n(67).ActionToast,E=n(67).ActionType,b=n(24),w=n(12),M=d.extend({model:p,comparator:function(e,t){return e.t?t.t?""+e.t+e.id>""+t.t+t.id?-1:1:-1:1},initialize:function(){var e=this;d.prototype.initialize.call(this),this.notSpam={},this.promises={sendUnstarAll:null},this.listenTo(this,"change:t change:isVisible",this.sort),this.listenTo(w,"change:stream",function(){w.stream===w.STREAM.RESUMING&&e.forEach(function(e){e.pendingMsgs=!1})})},active:function C(){var C=_.head(this.filter("active"));return C?C.id:void 0},_find:function(e){return s["default"].resolve({id:e,createdLocally:!0})},_findQuery:function(e){var t=this;return h.chatFindQuery(!!e.retry).then(function(e){return"preempted"===e?s["default"].reject("chats preempted"):(Store.Conn.platform===Store.Conn.PLATFORMS.IPHONE&&(_.isEmpty(e)?Store.Msg.trigger(l.COLLECTION_HAS_SYNCED):setTimeout(function(){Store.Msg.trigger(l.COLLECTION_HAS_SYNCED)},2500)),t.trigger(l.COLLECTION_HAS_SYNCED),s["default"].resolve(e))})},handle:function(e){var t=e.shift(),n=this;if(_.isArray(t)){var r=[],i=[];t.forEach(function(e){if("c.us"===e.id)i.push(e);else{var t=!!n.get(e.id),o=["delete","clear","archive","unarchive","star","unstar","spam","modify_tag"].indexOf(e.type)>-1;o?t&&o?i.push(e):u.log("Model:chat:handle received junk chat record: "+(0,a["default"])(e))():r.push(e)}});var o=_.findIndex(r,function(e){return b.isPSA(e.id)});o>-1&&(r[o].name=l10n.t("whatsapp_psa_contact_name")),n.add(r,{merge:!0}),i.forEach(function(e){var t=e.type;if("c.us"===e.id)switch(t){case"clear":u.log("Model:chat:handle:clear:all before:"+e.before+" kind:"+e.kind)(),n.forEach(function(t){"number"==typeof e.before?t.deleteMsgsOlderThan(e.before,e.star,e.kind):t.deleteMsgs(e.star,e.kind)});break;case"delete":u.log("Model:chat:handle:delete:all")(),n.forEach(function(e){e["delete"]()});break;case"archive":u.log("Model:chat:handle:archive:all")(),n.forEach(function(e){e.archive=!0});break;case"unarchive":u.log("Model:chat:handle:unarchive:all")(),n.forEach(function(e){e.archive=!1});break;case"unstar":u.log("Model:chat:handle:unstar:all")(),Store.AllStarredMsgs["delete"](),n.forEach(function(e){e.unstarAll()});break;default:u.error("Model:chat:handle unknown "+(0,a["default"])(e),e)()}else{var r=n.get(e.id);if(!r)return;switch(t){case"clear":case"star":case"unstar":if(e.keys){for(var i=e.keys.length,o="star"===t,s=[],c=[],l=[],d=!1,p=0;p<i;p++){var h,f,g,v,y,E=e.keys[p];_.isArray(E)?(h=E[0],f=E[1],g=E[2],v=new m({fromMe:f,remote:e.id,id:h,participant:g}),y=Store.Msg.get(v),y?"clear"===t?y["delete"]():(y.star=o,o&&l.push(y)):o&&(d=!0)):_.isObject(E)&&"star"===t&&(v=E.id,y=Store.Msg.get(E.id),y?(y.star=!0,l.push(y)):c.push(E)),s.push(v.toString())}"star"!==t&&"unstar"!==t||Store.AllStarredMsgs.process(o,c,l,d),u.log("model:Chat:handle:messages:"+[t,e.id,s.join(),e.modifyTag].join())()}else"clear"===t?("number"==typeof e.before?r.deleteMsgsOlderThan(e.before,e.star,e.kind):r.deleteMsgs(e.star,e.kind),u.log("model:Chat:handle cleared chat:"+[e.id,e.before,e.modifyTag,e.kind].join())()):"unstar"===t&&(r.unstarAll(),u.log("model:Chat:handle unstarred chat: "+e.id)());isNaN(e.modifyTag)||(r.modifyTag=e.modifyTag);break;case"delete":r["delete"](),u.log("model:Chat:handle deleted chat for "+e.id)();break;case"archive":r.archive=!0;break;case"unarchive":r.archive=!1;break;case"spam":r.notSpam=e.notSpam;break;case"modify_tag":r.modifyTag=e.modifyTag}}})}else if("leave"===t.cmd)t.gids.forEach(function(e){var t=n.get(e);t&&t.exit()});else if("preempt"===t.cmd)Store.Chat.add(t.response,{merge:!0}),Store.Conn.platform===Store.Conn.PLATFORMS.IPHONE&&(_.isEmpty(t.response)?Store.Msg.trigger(l.COLLECTION_HAS_SYNCED):setTimeout(function(){Store.Msg.trigger(l.COLLECTION_HAS_SYNCED)},2500)),this.trigger(l.COLLECTION_HAS_SYNCED);else if("action"===t.cmd){var s=t.id,c=t.data;if("create"===c[0]||"introduce"===c[0]){var d=c[1],p=c[2],h=_.map(p.admins,function(e){return{id:e,isAdmin:!0}}).concat(_.map(p.regulars,function(e){return{id:e,isAdmin:!1}}));Store.GroupMetadata.add({id:s,creation:p.creation,owner:d,participants:h,stale:!1},{merge:!0}),Store.Contact.add({id:s,name:p.subject},{merge:!0});var f=Store.Chat.get(s);if(!f)return;var v=f.msgs.last();if(!v)return;"gp2"===v.type&&"add"===v.subtype&&_.head(v.recipients)===Store.Conn.me&&g.alertNewMsg(v)}else{var y=Store.Chat.get(t.id);y?y.handleGroupAction.apply(y,t.data):u.error("model:chat: unknown chat for action "+(0,a["default"])(t))()}}else u.error("model:chat: unknown payload: "+(0,a["default"])(t))()},createGroup:function(e,t,n,r,i){var a=this,o=_.map(r,"id"),s=h.createGroup(e,o),l=new E(l10n.t("action_group_creating"));i=i||y.genId();var d=s.then(function(e){return 200===e.status?new E(l10n.t("action_group_created")):406===e.status?new E(l10n.t("action_group_create_failed")+" "+l10n.t("action_group_create_failed_406")):void 0})["catch"](function(o){return u.error("models:chatCollection:createGroup dropped")(o),new E(l10n.t("action_group_create_failed"),l10n.t("action_try_again"),a.createGroup.bind(a,e,t,n,r,i))});return g.openToast(c.createElement(y,{id:i,initialAction:l,pendingAction:d})),s.then(function(e){if(200===e.status&&e.gid&&Store.Chat.find(e.gid).then(function(e){g.openChatBottom(e).then(function(t){t&&g.focusChatTextInput(e)})}),200===e.status&&!e._duplicate&&t&&n){var r=Store.ProfilePicThumb.gadd(e.gid);return r.setPicture(t,n)}200===e.status&&e._duplicate&&u.error("createGroup failed to set picture.")()})},sync:function(){return this.findQuery({})["catch"](v.WapDrop,_.noop),s["default"].all([f.waitForBBEvent(this,l.COLLECTION_HAS_SYNCED),Store.Msg._hasSynced()])},resyncMessages:function(){u.log("ChatStore:resyncMessages")();var e=Store.Chat.filter(function(e){return e.isVisible}),t=e.map(function(e){var t=e.id,n={wid:t,archive:e.archive,mute:e.mute.expiration,active:e.active,isReadOnly:e.isReadOnly,modifyTag:e.modifyTag,unreadCount:e.unreadCount,notSpam:e.notSpam},r=e.lastReceivedKey;if(r){var i=r;
n.id=i.id,n.fromMe=i.fromMe.toString(),n.participant=i.participant}return n});return h.resyncMessages(t).then(function(e){return e.status>=400?(u.error("ChatStore:resyncMessages resume error "+e.status)(),s["default"].reject(new Error("ChatStore:resyncMessages resume error "+e.status))):(u.log("ChatStore:resyncMessages resume success")(),e.checksum&&Store.Contact.resyncContacts(e.checksum),e.statusChecksum&&Store.StatusV3.sync(e.statusChecksum),e.data.forEach(function(e){if(e.disableUnreadAnchor=!1,"delete"!==e.type&&!b.isPSA(e.id)){var t=Store.Contact.get(e.id);t?e.name&&(t.name=e.name):Store.Contact.add({id:e.id,name:e.name})}var n=Store.Chat.get(e.id);return n?void("clear"===e.type?!function(){n.resetMediaMsgs();var t=[];n.msgs.forEach(function(e){return t.push(e)}),n.msgChunks.length&&n.msgChunks.forEach(function(e){e.models.forEach(function(e){return t.push(e)})}),n.set({t:e.t,unreadCount:e.unreadCount,createdLocally:!1,archive:e.archive,isReadOnly:e.isReadOnly,modifyTag:e.modifyTag,msgs:[],notSpam:e.notSpam,unreadMsgAnchor:void 0,disableUnreadAnchor:e.disableUnreadAnchor,pendingMsgs:e.pendingMsgs}),n.mute.setMute(e.muteExpiration),_.each(t,function(e){e["delete"]()}),u.log("model:chat:resume: cleared chat for "+e.id)()}():"delete"===e.type?(n["delete"](),u.log("model:chat:resume: deleted chat for "+e.id)()):(n.set(e,{merge:!0}),n.mute.setMute(e.muteExpiration))):void Store.Chat.add(e)}),s["default"].resolve())})["catch"](v.WapDrop,function(e){return u.error("ChatStore:resyncMessages resume dropped")(),s["default"].reject(e)})},unstarAllMessages:function(e,t){var n=this,r=t?t.promises:this.promises,i=t?t.id:void 0;if(r.sendUnstarAll)return r.sendUnstarAll;r.sendUnstarAll=h.sendUnstarAll(i);var a=new E(l10n.t("action_message_unstarring_all")),o=r.sendUnstarAll.then(function(e){return 200===e.status?new E(l10n.t("action_message_unstarred_all")):e.status>=400?new E(l10n.t("action_message_unstar_all_failed")):void 0})["catch"](function(r){return u.error("models:chat:sendUnstarAll dropped")(r),new E(l10n.t("action_message_unstar_all_failed"),l10n.t("action_try_again"),function(){return n.unstarAllMessages(e,t)})});return g.openToast(c.createElement(y,{id:y.genId(),initialAction:a,pendingAction:o})),r.sendUnstarAll.then(function(n){200===n.status&&(_.forEach(e,function(e){e.set("star",!1)}),t?Store.AllStarredMsgs.remove(e):Store.AllStarredMsgs.reset())})["finally"](function(){r.sendUnstarAll=null})}});e.exports=new M},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(433),s=n(1229),c=n(10),l=n(14),u=o.extend({model:s,initialize:function(){var e=this;o.prototype.initialize.call(this),this.hasDocBefore=!0,this.listenTo(Store.Msg,"remove",function(t){t.isDoc&&e.remove(t)})},queryDocs:function(e,t){var n=this;if(t)return this.queryDocBefore?this.queryDocBefore:(this.queryDocBefore=Store.Msg.queryMedia(t.id.remote,c.MEDIA_QUERY_LIMIT,"before",t.id,"document").then(function(e){return(!e||e.length<c.MEDIA_QUERY_LIMIT)&&(n.hasDocBefore=!1),n.add(e.filter(function(e){return e.isDoc}),{at:0}),{length:e.length}})["catch"](l.WapDrop,l.E404,_.noop)["finally"](function(){n.queryDocBefore=null,n.trigger("query_doc_before")}),this.trigger("query_doc_before"),this.queryDocBefore);var r=e.msgs.models;if(0===this.length){if(!r||0===r.length)return new a["default"](function(e){e({eof:!0})});this.add(r.filter(function(e){return e.isDoc}),{at:0})}if(this.length<=2*c.MEDIA_QUERY_LIMIT){var i=0===this.length?_.head(r):this.head();return this.queryDocs(e,i)}return new a["default"](function(e){e({eof:!1})})}});e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(433),s=n(1229),c=n(10),l=n(14),u=o.extend({model:s,initialize:function(){var e=this;o.prototype.initialize.call(this),this.hasLinkBefore=!0,this.listenTo(Store.Msg,"remove",function(t){t.isLink&&e.remove(t)})},queryLinks:function(e,t){var n=this;if(t)return this.queryLinkBefore?this.queryLinkBefore:(this.queryLinkBefore=Store.Msg.queryMedia(t.id.remote,c.MEDIA_QUERY_LIMIT,"before",t.id,"url").then(function(e){return(!e||e.length<c.MEDIA_QUERY_LIMIT)&&(n.hasLinkBefore=!1),n.add(e.filter(function(e){return e.isLink}),{at:0}),{length:e.length}})["catch"](l.WapDrop,l.E404,_.noop)["finally"](function(){n.queryLinkBefore=null,n.trigger("query_link_before")}),this.trigger("query_link_before"),this.queryLinkBefore);var r=e.msgs.models;if(0===this.length){if(!r||0===r.length)return new a["default"](function(e){e({eof:!0})});this.add(r.filter(function(e){return e.isLink}),{at:0})}if(this.length<=2*c.MEDIA_QUERY_LIMIT){var i=0===this.length?_.head(r):this.head();return this.queryLinks(e,i)}return new a["default"](function(e){e({eof:!1})})}});e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(433),s=n(1229),c=n(10),l=n(14),u={before:"before",after:"after"},d=o.extend({model:s,initialize:function(){var e=this;o.prototype.initialize.call(this),this.hasMediaBefore=!0,this.hasMediaAfter=!0,this.listenTo(Store.Msg,"remove",function(t){t.isMedia&&e.remove(t)})},contains:function(e){return this.models.indexOf(e)>-1},getAfter:function(e){var t=this.models.indexOf(e);return t<0||t===this.models.length-1?null:this.models[t+1]},getBefore:function(e){var t=this.models.indexOf(e);return t<=0?null:this.models[t-1]},loadEarlierMedias:function(){var e=this.head();e&&this.queryMedia(null,e)},loadRecentMedias:function(){var e=this.last();e&&this.queryMedia(null,e,u.after)},loadMoreAroundIfNeeded:function(e){if(e){var t=this.models.indexOf(e);t<20&&this.hasMediaBefore&&this.loadEarlierMedias(),this.models.length-t<20&&this.hasMediaAfter&&this.loadRecentMedias()}},queryMedia:function(e,t){var n=this,r=arguments.length<=2||void 0===arguments[2]?u.before:arguments[2];if(!t){var i=e.msgs.models;if(!i||0===i.length)return new a["default"](function(e){e({eof:!0})});this.add(i.filter(function(e){return e.isMedia}),{at:0});var o=this.models;if(this.downloadMedias(o),o.length<=2*c.MEDIA_QUERY_LIMIT){var s=0===o.length?_.head(i):_.head(o);return this.queryMedia(e,s)}return new a["default"](function(e){e({eof:!1})})}return r===u.before?this.queryMediaBefore?this.queryMediaBefore:(this.queryMediaBefore=Store.Msg.queryMedia(t.id.remote,c.MEDIA_QUERY_LIMIT,r,t.id).then(function(e){(!e||e.length<c.MEDIA_QUERY_LIMIT)&&(n.hasMediaBefore=!1);var t=[];return e&&e.length>0&&(t=e.filter(function(e){return e.isMedia}),n.downloadMedias(t)),n.add(t,{at:0}),{length:t.length}})["catch"](l.WapDrop,l.E404,_.noop)["finally"](function(){n.queryMediaBefore=null,n.trigger("query_media_before")}),this.trigger("query_media_before"),this.queryMediaBefore):r===u.after?this.queryMediaAfter?this.queryMediaAfter:this.queryMediaAfter=Store.Msg.queryMedia(t.id.remote,c.MEDIA_QUERY_LIMIT,r,t.id).then(function(e){(!e||e.length<c.MEDIA_QUERY_LIMIT)&&(n.hasMediaAfter=!1);var t=[];return e&&e.length>0&&(t=e.filter(function(e){return e.isMedia}),n.downloadMedias(t)),n.add(t),{length:t.length}})["catch"](l.WapDrop,l.E404,_.noop)["finally"](function(){n.queryMediaAfter=null,n.trigger("query_media_after")}):void 0},downloadMedias:function(e){_.forEach(e,function(e){e.downloadMedia()})}});e.exports=d},function(e,t,n){"use strict";var r=n(87),i=r.extend({Collection:"ChatPreference",props:{id:"string",wallpaperColor:"string"}});e.exports=i},function(e,t,n){"use strict";var r=n(433),i=n(1506),a=n(10),o=r.extend({model:i,initialize:function(){r.prototype.initialize.call(this,{CachePolicy:{id:"chat_preference",policy:r.CACHE_POLICY.LOAD,delay:1e3}})},initializeFromCache:function(){this.get("defaultPreference")||this.add({id:"defaultPreference",wallpaperColor:a.DEFAULT_CHAT_WALLPAPER})},get:function(e,t){return r.prototype.get.call(this,e,t)||r.prototype.get.call(this,"defaultPreference")}});e.exports=new o},function(e,t,n){"use strict";var r=n(10),i=n(1),a=n(27),o=n(14),s={handle:function(e){var t=e.shift();switch(t.type){case"const":r[t.key]=t.value;break;case"read":if(t.isStatus){Store.StatusV3.handle([t]);break}case"unread":var n=Store.Chat.get(t.jid);n&&("read"===t.type?n.markSeen():"unread"===t.type&&n.markUnseen());break;case"picture":Store.ProfilePicThumb.imageChanged(t.jid,t.tag);break;case"log":a.upload("server-requested");break;case"privacy":t.jid?(Store.Presence.update(t.jid)["catch"](o.WapDrop,_.noop),Store.ProfilePicThumb.update(t.jid)["catch"](o.WapDrop,_.noop),Store.Status.update(t.jid)["catch"](o.WapDrop,_.noop)):i.error("Store:Cmd:handle:privacy no jid",t)();break;case"identity":if(t.jid){var s=Store.Contact.get(t.jid);s?s.updateIdentity(t):i.error("Store:Cmd:handle:identity no contact",t)()}else i.error("Store:Cmd:handle:identity no jid",t)();break;default:i.warn("Store.Cmd:handle:unknown "+t.type,t)()}}};e.exports=s},function(e,t,n){"use strict";var r=n(87),i=r.extend({idAttribute:"char",props:{"char":"string",variant:"string"}});e.exports=i},function(e,t,n){"use strict";var r=n(433),i=n(1509),a=n(436),o=r.extend({model:i,initialize:function(){r.prototype.initialize.call(this,{CachePolicy:{id:"emoji_variant_collection",policy:r.CACHE_POLICY.LOAD,delay:1e3}})},setVariant:function(e,t){var n=a.skinToneEmojis[e];if(!n)throw new Error("attempt to store variantless emoji");this.gadd({"char":n,variant:t})},getVariant:function(e){if(a.skinToneEmojis[e]){var t=this.get(e);return t?t.variant:null}throw new Error("attempt to get variantless emoji")}});e.exports=new o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1),s=n(433),c=n(1285),l=n(55),u=n(14),d=n(24),p=s.extend({model:c,initialize:function(){s.prototype.initialize.call(this,{staleCollection:!0})},onResume:function(){_.union(Store.Chat.where({active:!0}).filter(function(e){return e.isGroup||e.isBroadcast}),Store.Chat.where({isBroadcast:!0})).forEach(function(e){Store.GroupMetadata.find(e.id)["catch"](u.WapDrop,_.noop)})},_find:function(e){var t=this;if(d.isGroup(e)){var n=Store.Chat.get(e);return n&&n.isReadOnly?l.groupMetadataFindFromPhone(e).then(function(t){return"ok"===t.status?t.data:"missing"===t.status?void _.defer(function(){Store.Chat.get(e)["delete"]()}):"error"===t.status?(o.error("model:GroupMetadata:find error "+t.info)(),a["default"].reject(new Error("model:GroupMetadata:find error"))):void 0}):l.groupMetadataFind(e).then(function(n){if(n.status>=400)return{id:e,stale:!1};var r=[],i=t.get(e);return i?i.participants.set(n.participants):r=n.participants,t.updateSubject(e,n.subject),{id:n.id,owner:n.owner,creation:n.creation,participants:r}})}return d.isBroadcast(e)?l.contactFindBroadcast(e).then(function(t){if(200===t.status){var n=Store.GroupMetadata.get(e);if(n&&!n.stale)return a["default"].resolve(n);var r=[];return n?n.participants.set(t.recipients):r=t.recipients,{id:e,participants:r}}return 404===t.status?a["default"].reject("False broadcast list query."):(o.error("models:GroupMetadataCollection:_find:bclist error: "+t.status)(),a["default"].reject(new Error("models:GroupMetadataCollection:_find:bclist error: "+t.status)))}):(o.log("groupMetadata:find trying to fetch non-group/bclist wid "+e)(),a["default"].reject(new Error("groupMetadata:find trying to fetch non-group/bclist wid "+e)))},_handle:function(e){return e},updateSubject:function(e,t){_.isString(t)&&Store.Contact.find(e).then(function(e){e.name||(e.name=t)})}});e.exports=new p},function(e,t,n){"use strict";var r=n(1351);e.exports={Blocklist:n(1499),Call:n(1501),Chat:n(1502),Cmd:n(1508),GroupMetadata:n(1511),Msg:n(1513),MsgInfo:n(1515),AllStarredMsgs:new r,Mute:n(1516),Presence:n(1517),ProfilePicThumb:n(1518),Props:n(1519),RecentEmoji:n(1521),EmojiVariant:n(1510),Status:n(1522),ChatPreference:n(1507),StatusV3:n(1524),StatusV3Privacy:n(1525)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(!w.supportsFeature(w.F.CONTACT_HAS_PUSHNAME)&&e.notifyName){var t=Store.Contact.get(e.sender);t&&!t.isMe&&(!t._notifyName||t._notifyName.t<e.t)&&(t._notifyName={name:e.notifyName,t:e.t},t.trigger("change:_notifyName",e.notifyName))}}function a(e,t,n,r){var a=[],o=[];if(t.forEach(function(t,s){t.id instanceof T||(v.error("msgCollection:_processMultipleMessages: el.id is not a MsgKey"+(new Error).stack)(),O.upload("forgot-to-create-msgkey"),t.id=new T({from:t.from,to:t.to,id:t.id,participant:t.participant,self:t.self})),_.isString(e)&&b.isBroadcast(e)&&delete t.broadcast,"ptt"===t.type&&!t.id.fromMe&&t.ack<0&&(t.ack=0);var c=Store.Msg.get(t.id);if(c){t.ack<c.ack&&delete t.ack;for(var l in t)t.hasOwnProperty(l)&&"undefined"==typeof t[l]&&delete t[l];t.id.fromMe&&!c.clientUrl&&t.clientUrl&&(t.phoneUploading=!1),n.isHistory&&(t.isNewMsg=!1);var u=c.t?_.omit(t,"t"):t;c.set(u),n.isHistory&&(c.recvFresh||r)&&!c.search?(v.warn("model:Msg:handle:processMM:"+(c.recvFresh?"dup:":"overlap:")+c.id)(),o.push(c)):n.isHistory&&c.search?(c.search=!1,v.warn("model:Msg:handle:processMM load search as history "+c.id)(),a.push(c.toJSON())):"search"!==n.add&&"resync"!==n.add||a.push(c.toJSON()),i(c)}else M.typeIsMMS(t.type)&&!t.clientUrl&&(t.phoneUploading=t.id.fromMe&&0===t.ack),"search"===n.add&&(t.search=!0),n.update||a.push(t)}),0===a.length&&0===o.length){if(e&&n.pendingMsgsDone){var s=Store.Chat.get(e);s&&(s.pendingMsgs=!1)}return m["default"].resolve(t.map(function(e){return Store.Msg.get(e.id)}))}var l=d(a).then(function(e){var t=Store.Msg.add(e,{merge:!0});return _.each(t,function(e){i(e)}),t});if(e){var p;if(b.isStatusV3(e)){var h=t[0],f=h.id.fromMe?Store.Conn.me:h.author;p=Store.StatusV3.find(f)}else p=Store.Chat.find(e);return m["default"].all([l,p]).spread(function(i,a){var s,l,d="after"===n.add||"last"===n.add,p=!n.isHistory,h=!1;if("unread"===n.add?(s=r,a.msgChunks.push(s),l=n.firstUnreadKey):"last"===n.add&&n.resume?(s=r,h=!0):s="function"==typeof r?r():r,c(t,i,o,a,d,s||a.msgs,l,h),n.pendingMsgsDone&&(a.pendingMsgs=!1),p&&b.isBroadcast(e)&&!b.isStatusV3(e)&&i.forEach(function(t){if("broadcast_notification"===t.type){var n=Store.GroupMetadata.get(e);"add"===t.subtype?n.participants.add({id:t.body},{merge:!0}):"remove"===t.subtype&&n.participants.remove(t.body),a.groupMetadata.stale=!1}else t.recvFresh&&!t.isNotification&&u(t)}),w.supportsFeature(w.F.RECENT_EMOJI_SYNC)&&!Store.RecentEmoji.syncDue)for(var f=0;f<i.length;f++){var m=i[f];if(m.isNewMsg&&m.isSentByMe&&m.containsEmoji){Store.RecentEmoji.periodicSync();break}}return t.map(function(e){return Store.Msg.get(e.id)})})}return l.then(function(e){return t.map(function(e){return Store.Msg.get(e.id)}).filter(function(e){return!!e.chat})})}function o(e,t,n,r,i,a){var o=r||t.msgs;if(e=_.isArray(e)?e:[e],0!==e.length){var s=o===t.msgs;if(a){s&&v.error("models:msg:store:resetMostRecentMsgs .msgs === cmc !")(),s=!0,t.lastReceivedKey=_.last(e).id,o.add(e);var c=new N;c.replace(t.msgs),t.msgChunks.push(c),t.replaceMsgsCollection(o),t.msgs.trigger("change:last",t.msgs.last())}else n?(s&&(t.lastReceivedKey=_.last(e).id),o.add(e)):o.add(e,{at:0});if(n&&s||!Store.Msg.lastReceivedReceipt[t.id])for(var l=e.length,u=l-1;u>=0;u--){var d=e[u],p=d.id;if(p.fromMe&&!d.isNotification){Store.Msg.updateLastReceipt(p.remote,d.t);break}}i&&!t.unreadMsgAnchor&&(t.disableUnreadAnchor?t.disableUnreadAnchor=!1:t.unreadMsgAnchor=_.find(e,function(e){return e.id.toString()===i.toString()}))}}function s(e,t,n,r,i){var a,o,s,c={},l={},u=n.length,d=i;if(0===u)return{msgs:t,collection:d};for(a=0;a<u;a++)o=n[a],l[o.id]=o;for(u=t.length,a=0;a<u;a++)o=t[a],c[o.id]=o;var p=[];for(u=e.length,a=0;a<u;a++)if(o=e[a],s=c[o.id],s&&p.push(s),s=l[o.id])if(s.recvFresh)p.push(s),r.removeMsg(s),s.unset("recvFresh");else{var h=r.getAllCMCs(),f=_.find(h,function(e){return e.get(o.id)});i&&f===i||(f?(f.forEach(function(e){p.push(e),delete l[e.id]}),f===r.msgs?(r.replaceMsgsCollection(i),d=r.msgs):(r.notifyMsgCollectionMerge(i,f,i),r.removeMsgsCollection(f))):(v.error("models:Msg:reorder trying to merge CMC of orphaned message "+o.id,o)(),p.push(l[o.id])))}return{msgs:p,collection:d}}function c(e,t,n,r,i,a,c,l){var u=s(e,t,n,r,a);o(u.msgs,r,i,u.collection,c,l)}function l(e){return _.isObject(e)?JSON.parse((0,h["default"])(e)):e}function u(e){function t(t){var n=new T({from:e.from,to:t,id:r.id});if(!Store.Msg.some(_.matches({id:n}))){var i=l(e);i.to=t,i.id=n,i.broadcast=!0;var a=Store.Msg.add(i,{merge:!0});Store.Chat.find(t).then(function(e){o(a,e,!0)})}}var n,r=e.id;if(!e.invis)if(e.recipients&&0!==e.recipients.length)n=e.recipients,e.recipients.forEach(t);else{var i=Store.GroupMetadata.get(r.remote);i?(n=l(i.participants),_.map(n,"id").forEach(t)):v.log("model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: "+r.remote)()}return n}function d(e){return m["default"].all(e.map(function(e){return["image","video"].indexOf(e.type)>-1&&e.body?P.loadImage("data:image/jpeg;base64,"+e.body).then(function(t){return e.width=t.width,e.height=t.height,e})["catch"](function(t){return v.assert(!1,"fillInThumbnailDims","model:msgs:fillInThumbnailDims thumb failed to load msg: "+e.id.toString()+" error: "+t)(t),e.width=void 0,e.height=void 0,e.body=void 0,m["default"].resolve(e)}):m["default"].resolve(e)}))}var p=n(16),h=r(p),f=n(2),m=r(f),g=n(10),v=n(1),y=n(433),E=n(14),b=n(24),w=n(104),M=n(1229),C=n(56),S=n(88),T=n(46),k=n(12),x=n(55),N=n(1267),P=n(1252),O=n(27),D=6e4,A=y.extend({model:M,initialize:function(){y.prototype.initialize.call(this),this.lastReceivedReceipt={},this.preAck={},this.pendingAdd={},this.ftsCache={},this.listenTo(k,"change:stream",function(){k.stream===k.STREAM.DISCONNECTED&&(this.preAck={})})},_findQuery:function(e){var t,n=this;switch(e.direction){case"before":case"after":t=e.direction;break;default:t="before"}return x.msgFindQuery(t,e).then(function(r){if(r.status>=400)return v.error("model:Msg:findQuery error "+r.status)(),m["default"].reject(r.status);var i=function(){var t=n.get(e),r=Store.Chat.get(e.remote);return t?t.msgChunk:r?r.msgs:void 0};return r.forEach(function(e){e.invis=!0}),v.log("model:Msg:findQuery:got:"+r.length+":"+e.direction)(),n.processMultipleMessages(e.remote,r,{add:t,isHistory:!0},i)})},resyncChatMsgs:function(e,t){var n=this,r="number"!=typeof t||isNaN(t)?g.PAGE_SIZE:t;return x.msgFindQuery("before",{remote:e,count:r}).then(function(e){return e.status>=400?(v.error("model:Msg:resyncChatMsgs error "+e.status)(),m["default"].reject(e.status)):n.processMultipleMessages(void 0,e,{add:"resync"})})},getStarred:function(e,t,n,r){var i=this,a={count:"number"!=typeof t||isNaN(t)?g.PAGE_SIZE:t,chat:e&&_.isString(e)?e:void 0,remote:n&&n.remote,id:n&&n.id,fromMe:n&&n.fromMe,participant:n&&n.participant,media:r?"gif":void 0};return x.msgFindQuery("star",a).then(function(e){return e.status>=400?(v.error("model:Msg:getStarred error "+e.status)(),m["default"].reject(e.status)):i.processMultipleMessages(void 0,e,{add:"search"})})},incrementalStarredUpdate:function(e){return this.processMultipleMessages(void 0,e,{add:"search"})},search:function I(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=this,r=arguments[2],i=arguments[3];if(1!==t||i)return this._search(e,t,r,i);var a=this.ftsCache[e];if(a)return a;var I=this._search(e,t,r,i);this.ftsCache[e]=I;var o=function(){n.ftsCache[e]=null};return _.delay(o,D),I["catch"](o),I},_search:function(e,t,n,r){var i=this,a={searchTerm:e,page:t&&_.isNumber(t)?t:1,count:n&&_.isNumber(n)?n:g.PAGE_SIZE,remote:r};return x.msgFindQuery("search",a).then(function(e){if(e.status>=400)return v.error("model:Msg:search error "+e.status)(),m["default"].reject(e.status);var t=_.isArray(e)?e:e.messages,n=!!_.isArray(e)||e.eof;return m["default"].props({messages:i.processMultipleMessages(void 0,t,{add:"search"}),eof:n})})},queryMedia:function(e,t,n,r,i){var a=this,o={remote:e,count:t&&_.isNumber(t)?t:g.PAGE_SIZE,id:r&&r.id,fromMe:r&&r.fromMe,participant:r&&r.participant,direction:n||"before",media:i};return x.msgFindQuery("media",o).then(function(e){return e.status>=400?(v.error("model:Msg:media error "+e.status)(),m["default"].reject(e.status)):a.processMultipleMessages(void 0,e,{add:"search"})})},getContext:function(e,t){var n=this,r=this.get(e);return r?m["default"].all([x.msgFindQuery("before",e),x.msgFindQuery("after",e)]).spread(function(i,a){return _.isArray(i)&&_.isArray(a)?(r.search=!1,m["default"].all([n.processMultipleMessages(e.remote,i,{add:"before",isHistory:!0},t),n.processMultipleMessages(e.remote,a,{add:"after",isHistory:!0},t)])):(v.error("model:msg:getContext fetch error",i,a)(),m["default"].reject(i.status||a.status))}):x.msgFindQuery("after",e).then(function(r){return _.isArray(r)?n.processMultipleMessages(e.remote,r,{add:"after",isHistory:!0},t):(v.error("model:msg:getContext:after fetch error",r)(),m["default"].reject(r.status))}).then(function(t){var r=t[0],i=r.id.clone();return i.count=e.count+1,m["default"].all([x.msgFindQuery("before",i).then(function(t){if(!_.isArray(t))return v.error("model:msg:getContext:before fetch error",t)(),m["default"].reject(t.status);var i=t[t.length-1],a=i.id;if(!a.equals(e))return v.error("model:msg:getContext:before ctx message mismatch",t)(),m["default"].reject(405);var o=function(){return r.msgChunk};return n.processMultipleMessages(e.remote,t,{add:"before",isHistory:!0},o)}),m["default"].resolve(t)])})},handle:function(e){function t(e,t){var n=new T({from:o.from,to:e,id:t,participant:o.participant,selfDir:o.self||"out"}),r=a.get(n);if(r){r.updateAck(o.ack),a.updateLastReceipt(n.remote,o.t);var i=n.remote;b.isUser(i)&&(Store.MsgInfo.update(t,o.from,e,o.ack,i,o.t),b.isBroadcast(o.broadcast)&&Store.MsgInfo.update(t,o.from,o.broadcast,o.ack,i,o.t))}else v.log("Msg:out of order ack",o)(),a.preAck[n]=o}var n,r,i,a=this,o=e.shift();if("ack"===o.cmd){var s=[o.to];if(b.isBroadcast(o.to)&&1===o.ack){var c=Store.GroupMetadata.get(o.to);c&&Array.prototype.push.apply(s,_.map(c.participants.toArray(),"id"))}return s.forEach(function(e){t(e,o.id)}),!0}if("acks"===o.cmd)return o.id.forEach(function(e){t(o.to,e)}),!0;if(o.msg)return b.isStatusV3(o.chat)&&!Store.StatusV3.handleUpdate(o.msg,o.meta.checksum)||(o.msg.recvFresh=!0,o.msg.isNewMsg=!0,this.processMultipleMessages(o.chat,[o.msg],{add:"after",update:"update"===o.meta.add,isHistory:!1})),!0;if(o.msgs){var l=o.msgs.length;if(!l)return!1;r=o.meta,r.isHistory=!0,"unread"===r.add&&(r.firstUnreadKey=new T({fromMe:r.unreadFromMe,remote:o.chat,id:r.unreadId,participant:r.unreadParticipant}),i=new N);for(var u=0;u<l;u++)n=o.msgs[u],n.invis=!0;return Store.Conn.platform===Store.Conn.PLATFORMS.IPHONE&&this.trigger(g.COLLECTION_HAS_SYNCED),this.processMultipleMessages(o.chat,o.msgs,r,i),!0}if(o.recent){r=o.meta,delete o.recent,delete o.meta,this.trigger(g.COLLECTION_HAS_SYNCED),r.isHistory=!0;for(var d in o)"last"===r.add&&r.resume&&(i=new N),n=o[d],n.invis=!0,this.processMultipleMessages(d,[n],r,i)}else v.log("************** Msg else clause. something strange is going on")()},_hasSynced:function(){return C.waitForBBEvent(this,g.COLLECTION_HAS_SYNCED)},"delete":function(){y.prototype["delete"].call(this),this.lastReceivedReceipt={},this.preAck={}},send:function(e){return m["default"].callSynchronously(function(){var t=e.id,n=e.toJSON();if(w.supportsFeature(w.F.SPAM)&&Store.Chat.find(e.id.remote).then(function(e){e.isTrusted()||e.sendNotSpam()["catch"](_.noop)}),e.isNewMsg=!0,!e.isGroupMsg&&Store.Blocklist.get(e.to))return m["default"].reject(new E.ContactBlocked("Contact is blocked"));if(b.isBroadcast(n.to))var r=u(n);delete n.status,delete n.mimetype,delete n.height,delete n.width,delete n.recipients,delete n.chat,delete n.broadcast,delete n.ack,delete n.invis,delete n.filehash,delete n.recvFresh,delete n.mediaData,S.isHttp(e.url)||delete n.url,S.isHttp(e.clientUrl)||delete n.clientUrl;for(var i in n)null!==n[i]&&"undefined"!=typeof n[i]||delete n[i];return e.isMMS&&(n.avparams=e.avParams()),"chat"!==n.type||"url"!==n.subtype||w.supportsFeature(w.F.URL)||delete n.subtype,n.quotedMsg&&!w.supportsFeature(w.F.REPLIES_OUT)&&(delete n.quotedMsg,delete n.quotedStanzaID,delete n.quotedRemoteJid,delete n.quotedParticipant),n.mentionedJidList&&!w.supportsFeature(w.F.MENTIONS_OUT)&&delete n.mentionedJidList,Store.Chat.find(e.id.remote).then(function(t){return t.sendSeen(),m["default"].props({reply:x.msgCreateRecord(n,e.local),chat:t})}).then(function(n){var i=n.reply,a=n.chat;if(200===i.status){var o=t.remote,s=t.fromMe&&t.remote===Store.Conn.me?3:i.data?i.data.ack:1;return e.updateAck(s),a.lastReceivedKey=t,Store.Msg.updateLastReceipt(o,i.t),b.isBroadcast(o)&&(r?r.forEach(function(e){var n=new T({from:Store.Conn.me,to:e.id,id:t.id}),r=Store.Msg.get(n);r&&(r.ack=1,Store.Msg.updateLastReceipt(e,r.t),Store.Chat.find(e).then(function(e){e.lastReceivedKey=n}))}):v.log("model:msg:createRecord bclist server ack, no recipients")()),"success"}return 408!==i.status&&v.assert(!1,"send-not-200","Phone responded "+i.status)(),"dropped"})["catch"](function(e){return v.error("model:msg:createRecord dropped msg: "+n.id)(n.type),v.assert(!1,"send-msg-error","Got error "+e)(e),"dropped"})})},resyncReceipts:function(){v.log("Msg:resyncReceipts")();var e=[];for(var t in Store.Msg.lastReceivedReceipt){var n,r=Store.Chat.get(t);if(n=r?w.gte([0,5])?r.getFirstMsgWithStatus():r.getFirstMsgFromMe():void 0){var i=n.id;i.t=Store.Msg.lastReceivedReceipt[t]||n.t||0,e.push(i)}else v.error("Msg:resyncReceipts wid in lastReceivedReceipt, but no msg: "+t)()}return 0===e.length?m["default"].resolve():x.resyncReceipts(e).then(function(e){_.isArray(e)?(v.log("Msg:resyncReceipts success")(),e.forEach(function(e){Store.Msg.updateLastReceipt(e.id,e.t),e.acks.forEach(function(t){if(4===t.length){var n=new T({fromMe:t[1],remote:e.id,id:t[0],participant:t[2]}),r=Store.Msg.get(n);r&&r.updateAck(t[3])}else v.error("Msg:resyncReceipts invalid response: "+(0,h["default"])(t))()})})):v.error("Msg:resyncReceipts error",e)()})["catch"](E.LogoutDrop,E.EphemeralDrop,E.BrowserReplacedDrop,_.noop)["catch"](function(e){throw v.error("Msg:resyncReceipts dropped "+e+" "+(e?e.stack:"no stack"))(),new Error("Msg:resyncReceipts dropped")})},updateLastReceipt:function(e,t){var n=this.lastReceivedReceipt[e];(!n||t>n)&&(this.lastReceivedReceipt[e]=t)},processMultipleMessages:function(e,t,n,r){var i=this,o=arguments;if(e){var s,c=this.pendingAdd[e];return s=c?c.then(function(){return a.apply(i,o)}):a.apply(i,o),s["finally"](function(){i.pendingAdd[e]===s&&(i.pendingAdd[e]=null)}),this.pendingAdd[e]=s}return a.apply(i,o)}});e.exports=new A},function(e,t,n){"use strict";var r=n(87),i=n(1349),a=n(219),o=n(443),s=n(445),c=r.extend({props:{id:"string",t:"number"},children:{contact:a},initialize:function(){this.contact=Store.Contact.gadd({id:this.id}),this.listenTo(this.contact,"all",this._getCachedEventBubblingHandler("contact"))},getCollection:function(){return this.collection}}),l=o.extend(s,{model:c,comparator:function(e,t){return a.Comparator(e.contact,t.contact)},isStateStale:function(e){var t=this.get(e);return t&&t.stale}}),u=r.extend(i,{Collection:"MsgInfo",props:{id:"msgKey",isPTT:"boolean",playedRemaining:{type:"number","default":0},readRemaining:{type:"number","default":0},deliveryRemaining:{type:"number","default":0}},collections:{played:l,read:l,delivery:l},derived:{settled:{deps:["isPTT","playedRemaining","readRemaining"],fn:function(){return this.isPTT?!this.playedRemaining:!this.readRemaining}}}});e.exports=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1),s=n(24),c=n(46),l=n(433),u=n(1229),d=n(1514),p=n(12),h=n(55),f=l.extend({model:d,initialize:function(){l.prototype.initialize.call(this,{staleCollection:!0})},_initializeStaleCollection:function(){var e=this;this.listenTo(p,"change:stream",function(){p.stream===p.STREAM.DISCONNECTED&&e.forEach(function(e){e.settled||e.set("stale",!0)})})},_find:function(e){var t=Store.Msg.get(e);return t?t.isSentByMe?h.queryMsgInfo(t.id).then(function(e){return e.status>=400?(o.log("model:MsgInfo:findQuery error "+e.status)(),a["default"].reject(e.status)):(e.id=t.id,e.isPTT=t.type===u.TYPE.PTT,a["default"].resolve(e))}):a["default"].reject("message not sent by me"):a["default"].reject("No message found for id: "+e)},update:function(e,t,n,r,i,a){var l=new c({from:t,to:n,id:e,participant:i}),u=new c({from:t,to:n,id:e}),d=this.get(l)?this.get(l):this.get(u),p=s.isUser(u.remote),h=void 0,f=void 0;if(d)switch(r){case 4:if(h=d.played.get(i),h||(d.played.add({id:i,t:a}),d.playedRemaining-=1),p)break;case 3:if(f=d.read.filter(function(e){return e.id===i}),d.read.remove(f),3===r&&(d.read.add({id:i,t:a}),0===f.length&&(d.readRemaining-=1)),p)break;case 2:f=d.delivery.filter(function(e){return e.id===i}),d.delivery.remove(f),2===r&&(d.delivery.add({id:i,t:a}),0===f.length&&(d.deliveryRemaining-=1));break;default:o.error("model:MsgInfo:handle ack err: "+r,arguments)()}},handle:function(e){var t=this,n=e.shift();switch(n.cmd){case"ack":this.update(n.id,n.from,n.to,n.ack,n.participant,n.t);break;case"acks":n.id.forEach(function(e){t.update(e,n.from,n.to,n.ack,n.participant,n.t)})}}});e.exports=new f},function(e,t,n){"use strict";var r=n(1),i=n(433),a=n(1350),o=n(15),s="global_mute",c=!0,l=!0,u=!0,d=i.extend({model:a,initialize:function(){i.prototype.initialize.call(this,{CachePolicy:{id:"mute",policy:i.CACHE_POLICY.LOAD,delay:1e3}})},initializeFromCache:function(){var e=o.getGlobalSounds();this.setGlobalSounds(e);var t=o.getGlobalNotifications();this.setGlobalNotifications(t);var n=o.getGlobalPreviews();this.setGlobalPreviews(n)},saveToCache:function(){if(Store.Conn.me){var e=this._config.CachePolicy.id;r.log("models:mute:cache-save: "+e)(),o.setCollection(e,[this.globalMute().toJSON()])}},globalMute:function(){var e=this.get(s);return e?e:this.add({id:s})},getGlobalSounds:function(){return c},setGlobalSounds:function(e){c=e,o.setGlobalSounds(e)},getGlobalNotifications:function(){return l},setGlobalNotifications:function(e){l=e,o.setGlobalNotifications(e)},getGlobalPreviews:function(){return u},setGlobalPreviews:function(e){u=e,o.setGlobalPreviews(e)},handle:function(e){for(var t=0;t<e.length;t++){var n=e[t],r=Store.Chat.get(n.id);r&&"mute"===n.type&&r.mute.setMute(n.muteExpiration)}}});e.exports=new d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1),s=n(433),c=n(1286),l=n(55),u=n(107),d=n(14),p=s.extend({model:c,initialize:function(){s.prototype.initialize.call(this,{staleCollection:!0}),this.listenTo(u,"change:phoneActive",this.onPresenceSubscribabilityChange)},_find:function(e){var t=this.gadd(e);return t.isUser?(t.isSubscribed=!0,l.presenceSubscribe(e)["catch"](function(e){return t.isSubscribed=!1,a["default"].reject(e)})["catch"](d.WapDrop,_.noop),l.lastseenFind(e).then(function(n){return 423===n.status?{id:e,stale:!0,hasData:!1}:401===n.status?(t.handle({id:e,deny:!0}),{id:e}):(n.id=e,t.handle(n),{id:e})})):a["default"].resolve({id:e})},handle:function(e){var t=e.shift();if(t.id===Store.Conn.me)"unavailable"===t.type?this.forEach(function(e){"unavailable"===e.type||e.stale||this.add({id:e.id,type:"unavailable",t:t.t,stale:!1},{merge:!0})}.bind(this)):o.log('models:presence:handle for self is not "unavailable" !')();else{var n=this.get(t.id);n&&("unsubscribe"===t.type?n.set({isSubscribed:!1,stale:!0}):(n.handle(t),n.stale=!1))}},onPresenceSubscribabilityChange:function(){u.phoneActive?Store.Chat.forEach(function(e){e.active&&e.presence.isUser&&e.presence.update()["catch"](d.WapDrop,_.noop)}):this.forEach(function(e){e.reset(),e.set({stale:!0,isSubscribed:!1})})}});e.exports=new p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1),s=n(433),c=n(454),l=n(15),u=n(55),d=n(14),p=n(24),h=n(448),f=n(107),m=n(12),g=s.extend({model:c,initialize:function(){s.prototype.initialize.call(this,{staleCollection:!0,CachePolicy:{id:"profile_pic_thumb",trigger:"change:tag change:raw",policy:s.CACHE_POLICY.LOAD,delay:5e3}}),this.listenTo(f,"change:phoneActive",function(){
f.phoneActive&&this.onPhoneActive()})},get:function(e){var t=s.prototype.get.call(this,e);if(!_.isString(e))return t;var n=s.prototype.get.call(this,h(e));if(n){if(this.remove(n,{silent:!0}),t)return t;var r=n.toJSON();return r.id=e,this.add(r,{silent:!0})}return t?t:void 0},saveToCache:function(){if(Store.Conn.me){var e=this._config.CachePolicy.id,t=this.models.filter(function(e){return p.isWid(e.id)});t=t.map(function(e){return e=e.toJSON(),e.id=h(e.id),e}),o.log("models:profilePic:cache-save: "+e)(),l.setCollection(e,t)}},onPhoneActive:function(){if(m.stream===m.STREAM.CONNECTED){var e=[];this.forEach(function(t){t._uiObservers&&t.stale&&(t.tag||t.unset("tag",{silent:!0}),e.push(t))}),this.resyncPictures(e)}},onResume:function(){var e=this.filter(_.property("_uiObservers")).map(function(e){return e.tag||e.unset("tag",{silent:!0}),e});this.resyncPictures(e)},_find:function(e){var t=Store.Chat.get(e);return t&&t.isReadOnly?u.profilePicFindThumbFromPhone(e,this.get(e)):u.profilePicFind(e).then(function(t){return 401===t.status?{id:e,raw:void 0,tag:""}:423===t.status?{id:e,stale:!0}:t.status>=400?{id:e,tag:null}:"undefined"==typeof t.status?{id:e,tag:t.tag,raw:null,eurl:t.eurl}:void 0})["catch"](d.WapDrop,function(){return{id:e,stale:!0}})},imageChanged:function(e,t){var n=Store.ProfilePicThumb.get(e);n&&("remove"===t?n.unset("tag"):n.tag!==t&&n.update()["catch"](d.WapDrop,_.noop))},resyncPictures:function(e){return 0===e.length?a["default"].resolve():u.resyncPictures(e.map(function(e){return{id:e.id,tag:e.tag}})).then(function(e){if(423===e.status)o.warn("ProfilePicThumbStore:resyncPictures blocked")();else{if(e.status>=400)throw o.error("ProfilePicThumbStore:resyncPictures error "+e.status)(e),new Error("ProfilePicThumbStore:resyncPictures error");if(!_.isArray(e))throw o.error("ProfilePicThumbStore:resyncPictures unknown reply",e)(),new Error("ProfilePicThumbStore:resyncPictures unknown reply");o.log("ProfilePicThumbStore:resyncPictures success")(),e.forEach(function(e){var t=Store.ProfilePicThumb.get(e.id);t&&t.set({tag:e.tag,raw:void 0,stale:!1})})}})["catch"](d.WapDrop,_.noop)["catch"](function(e){o.error("ProfilePicThumbStore:resyncPictures dropped: "+e)()})}});e.exports=new g},function(e,t,n){"use strict";function r(e){return"number"==typeof e&&e>0?e-1:s.MAX_GROUP_SIZE}function i(e){return"number"==typeof e&&e>0?1024*e*1024:s.MAX_MEDIA_UPLOAD_SIZE}function a(e){return"number"==typeof e&&e>0?1024*e:s.IMG_MAX_BYTES}function o(e){var t;c.Global.webcBucket=e.bucket||null;for(t in d)if("undefined"!=typeof e[t]){var n,r,i=d[t];_.isArray(i)?(n=i[0],r=i[1](e[t])):(n=i,r=e[t]),n&&(s[n]=r)}for(t in u.F)"undefined"!=typeof e[t]&&u.setFeature(t,!!e[t])}var s=n(10),c=n(57),l=n(55),u=n(104),d={bucket:null,gifSearch:"SHOW_GIF_SEARCH",imageMaxEdge:"IMG_MAX_EDGE",imageMaxKBytes:["IMG_MAX_BYTES",a],maxParticipants:["MAX_GROUP_SIZE",r],maxSubject:"MAX_SUBJECT_LENGTH",media:["MAX_MEDIA_UPLOAD_SIZE",i]},p={handle:function(e){var t=e.shift();"number"==typeof t.status&&t.status>=400||o(t)},fetch:function(){return l.queryServerProps().then(function(e){"number"==typeof e.status&&e.status>=400||o(e)})}};e.exports=p},function(e,t,n){"use strict";var r=n(87),i=r.extend({idAttribute:"char",props:{"char":"string",weight:"number"}});e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(10),s=n(1),c=n(433),l=n(1520),u=n(55),d=n(14),p=n(436),h=n(104),f=c.extend({model:l,comparator:function(e,t){return e.weight>t.weight?-1:1},initialize:function(){c.prototype.initialize.call(this,{CachePolicy:{id:"recent_emoji_collection",policy:c.CACHE_POLICY.LOAD,delay:2e3}}),this.listenTo(this,"change:weight change:length",this.sortTrimScale),this.dirty=!1,this.syncDue=!1},"delete":function(){c.prototype["delete"].call(this),this.dirty=!1,this.syncDue=!1},_findQuery:function(e){return h.supportsFeature(h.F.RECENT_EMOJI_SYNC)?u.recentEmojiQuery(e?this.toArray():void 0).then(function(e){return _.isArray(e)?(e.forEach(function(e){e["char"]=p.normalizeEmoji(e["char"])}),a["default"].resolve(e)):(s.error("models:recentEmoji:findQuery error",e)(),a["default"].reject("recent emoji fetch error"))}):a["default"].reject("gk recent emoji sync unsupported")},sync:function(){var e=this;return this.findQuery(this.dirty)["finally"](function(){e.dirty=!1})["catch"](d.WapDrop,_.isString,_.noop)},_sync:_.throttle(function(e,t){e.sync()["finally"](t)},o.EMOJI_SYNC_DELAY,{leading:!1}),periodicSync:function(){h.supportsFeature(h.F.RECENT_EMOJI_SYNC)&&(s.log("models:recentEmoji:periodicSync due:"+this.syncDue+" dirty: "+this.dirty)(),this.syncDue=!0,this._sync(this,function(){this.syncDue=!1}.bind(this)))},sortTrimScale:function(){var e=this.length;e&&(this.sort(),e>30&&this.remove(this.models.slice(30)),_.head(this.models).weight<10&&_.last(this.models).weight>.01||this.forEach(function(t,n){t.weight=1+3*((e-n)/e)}))},increment:function(e){this.forEach(function(t){t["char"]===e?t.weight+=1:t.weight*=.9,t.weight=Math.round(1e3*t.weight)/1e3}),this.get(e)||this.add({"char":e,weight:1}),this.dirty=!0,this.periodicSync()}});e.exports=new f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(1),c=n(433),l=n(444),u=n(55),d=n(14),p=n(107),h=n(12),f=n(8),m=n(104),g=n(67).ActionToast,v=n(67).ActionType,y=c.extend({model:l,initialize:function(){c.prototype.initialize.call(this,{staleCollection:!0}),this.listenTo(p,"change:phoneActive",function(){p.phoneActive&&this.onPhoneActive()})},onPhoneActive:function(){h.stream===h.STREAM.CONNECTED&&this.onResume()},onResume:function(){this.filter(_.property("_uiObservers")).forEach(function(e){Store.Status.find(e.id)["catch"](d.WapDrop,_.noop)})},_find:function(e){return u.statusFind(e).then(function(t){return _.isNumber(t.status)?423===t.status?{id:e,stale:!0,status:""}:t.status>=400?{id:e,status:""}:void 0:{id:e,status:t.status}})["catch"](d.WapDrop,function(){return{id:e,stale:!0,status:""}})},_handle:function(e){return e},canSetMyStatus:function(){return m.supportsFeature(m.F.SET_STATUS)},setMyStatus:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=arguments[1];if(t=t.trim(),!t)return a["default"].reject(new d.ActionError);if(!this.canSetMyStatus())return a["default"].reject(new d.ActionError);var r=u.sendSetStatus(t),i=new v(l10n.t("action_status_setting")),c=this.get(Store.Conn.me).status;n=n||g.genId();var l=r.then(function(t){return 200===t.status?new v(l10n.t("action_status_set"),l10n.t("action_undo"),e.setMyStatus.bind(e,c,n)):t.status>=400?new v(l10n.t("action_status_set_failed")):void 0})["catch"](function(r){throw s.error("models:statusCollection:setMyStatus dropped")(r),new v(l10n.t("action_status_set_failed"),l10n.t("action_try_again"),e.setMyStatus.bind(e,t,n))});return f.openToast(o.createElement(g,{id:n,initialAction:i,pendingAction:l})),r.bind(this).then(function(e){200!==e.status||e._duplicate||(this.get(Store.Conn.me).status=t)})}});e.exports=new y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(32),s=n(1347),c=n(10),l=n(1),u=n(1229),d=n(55),p=s.extend({Collection:"StatusV3",props:{id:"string",t:"number",unreadCount:"number",totalCount:"number",mute:"boolean",pic:"object",_msgs:{type:"array","default":function(){return[]}}},session:{readKeys:{type:"object","default":function(){return{}}}},derived:{renderedThumbnail:{deps:["msgsChanged","pic","totalCount"],fn:function(){if(this.msgs.length===this.totalCount)for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&(t.type===u.TYPE.IMAGE||t.type===u.TYPE.VIDEO)&&t.body)return delete this.pic,o.decode(t.body)}return this.pic}}},initialize:function(){s.prototype.initialize.call(this),this._msgs.length>0&&(Store.StatusV3.addStatusMessages(this.id,this._msgs),this._msgs=[])},"delete":function(){s.prototype["delete"].call(this),Store.StatusV3.remove(this.id)},onEmptyMRM:function(){var e=this;l.log("models:StatusV3:removeMsg 0 messages left, querying...")(),this.loadMore()["catch"](function(t){404===t&&e["delete"]()})},loadMore:function(){var e=this;return this.msgs.msgLoadState.noEarlierMsgs?a["default"].resolve():this.msgs.msgLoadState.isLoadingEarlierMsgs?this.msgs.loadEarlierPromise:Store.StatusV3.loadMore(this.id,c.PAGE_SIZE,this.msgs.last()).then(function(t){return _.isArray(t)&&t.length<c.PAGE_SIZE&&(e.msgs.msgLoadState.noEarlierMsgs=!0),t})["catch"](function(t){404===t&&e["delete"]()})},handleReadStatus:function(e){this.readKeys[e]||(this.readKeys[e]=!0,this.unreadCount>0?this.unreadCount--:l.error("statusv3:"+this.id+":new read key but unreadCount 0")())},sendReadStatus:function(e){var t=this;return d.sendStatusSeen(e).then(function(n){200===n.status&&t.handleReadStatus(e)})},sendMute:function(e){var t=this;return d.sendStatusMute(this.id,e).then(function(n){200===n.status&&(t.mute=e)})}});e.exports=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(433),s=n(32),c=n(10),l=n(14),u=n(1),d=n(1523),p=n(55),h=o.extend({model:d,initialize:function(){o.prototype.initialize.call(this),this.checksum=void 0},"delete":function(){o.prototype["delete"].call(this),delete this.checksum},_find:function(e){return a["default"].resolve({id:e})},_findQuery:function(e){var t=this;return p.statusQuery().then(function(e){return t.checksum=e.checksum,e.statuses})},loadMore:function(e,t,n){return p.statusQuery(e,t,n&&n.id).then(function(e){return e.status>=400?(u.error("model:statusv3:findQuery error "+e.status)(),a["default"].reject(e.status)):(e.forEach(function(e){e.invis=!0}),u.log("model:statusv3:loadMore:"+e.length)(),Store.Msg.processMultipleMessages(c.STATUS_WID,e,{add:"after",isHistory:!0}))})},sync:function(e){return!e||this.checksum&&this.checksum!==e?this.findQuery({},{set:this.hasSynced()})["catch"](l.WapDrop,_.noop):a["default"].resolve(void 0)},hasSynced:function(){return!!this.checksum},handleUpdate:function(e,t){var n=e.author;if(this.updateChecksum(t),this.hasSynced()){var r=this.get(n);if(r){var i=r.totalCount===r.msgs.length;return e.invis||r.unreadCount++,r.totalCount++,r.t=e.t,!i&&e.body&&(r.pic=s.decode(e.body)),i}return this.add({id:n,t:e.t,unreadCount:e.invis?0:1,totalCount:1,mute:!1,_msgs:[e]}),!1}return!1},updateChecksum:function(e){e?this.hasSynced()&&(this.checksum=e):u.error("models:statusV3:no_checksum")()},handle:function(e){var t=this,n=e.shift();if(_.isArray(n))n.forEach(function(e){var n=t.get(e.id);n&&(n.mute=e.mute)});else switch(n.type){case"read":this.updateChecksum(n.checksum);var r=this.get(n.chat);r?r.handleReadStatus(n.key):u.log("models:statusV3:read:no_status:"+[n.chat,n.key].join())(n);break;case"privacy":Store.StatusV3Privacy.update(n);break;default:u.warn("models:statusV3:unknown:"+n.type,n)()}},addStatusMessages:function(e,t){return Store.Msg.processMultipleMessages(c.STATUS_WID,t,{add:"after",isHistory:!0})}});e.exports=new h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(87),s=n(1),c=n(12),l=n(55),u=n(24),d=o.extend({props:{blacklist:{type:"array","default":function(){return[]}},whitelist:{type:"array","default":function(){return[]}},type:"string"},session:{isValid:"boolean"},initialize:function(){var e=this;o.prototype.initialize.call(this),this.isValid=!1,this.listenTo(c,"change:stream",function(){c.stream===c.STREAM.RESUMING&&(e.isValid=!1)})},query:function(){var e=this;return l.getStatusPrivacy().then(function(t){switch(t.status){case 200:e.set({blacklist:t.blacklist,whitelist:t.whitelist,type:t["default"],isValid:!0});break;case 404:e.set({type:"contacts",isValid:!0});break;default:return s.error("statusV3Privacy:query:error:"+t.status,t)(),a["default"].reject(t.status)}})},update:function(e){this.isValid&&(e.whitelist&&this.set({type:"whitelist",whitelist:e.whitelist}),e.blacklist&&this.set({type:"blacklist",blacklist:e.blacklist}),e.contacts&&(this.type="contacts"))},sendSetPrivacy:function(e,t){var n=this;if(!this.isValid)return a["default"].reject("called setPrivacy when isValid false");var r;switch(e){case"blacklist":case"whitelist":if(r=_.isArray(t)?t.filter(function(e){return u.isUser(e)}):void 0,!_.isArray(r)||0===r.length)return a["default"].reject("called setPrivacy blacklist/whitelist with no valid jids");break;case"contacts":break;default:e="contacts"}return l.setStatusPrivacy(e,r).then(function(t){if(200===t.status){var i={};i[e]=r,n.update(i)}return t})["catch"](function(e){})}});e.exports=new d({id:1})},function(e,t){"use strict";e.exports={Action:"keyboard_action",Event:"keyboard_event",Events:{LOGGED_IN:"logged_in",LOGGED_OUT:"logged_out",ARCHIVE:"archived",MUTE:"muted",READ:"read",READ_ONLY:"read_only",CHAT_KIND:"chat_kind",ZOOM:"zoom",LAUNCH:"launch"},Actions:{PREFERENCES:"preferences",NEW_CHAT:"new_chat",NEW_GROUP:"new_group",PROFILE_STATUS:"profile_status",LOGOUT:"logout",SEARCH:"search",ZOOM_IN:"zoom_in",ZOOM_OUT:"zoom_out",ZOOM_RESET:"zoom_reset",TOGGLE_UNREAD:"toggle_unread",DELETE_CHAT:"delete_chat",DELETE_GROUP:"delete_group",EXIT_GROUP:"exit_group",TOGGLE_ARCHIVE:"toggle_archive",TOGGLE_MUTE:"toggle_mute",SEARCH_CHAT:"search_chat",NEXT_CHAT:"next_chat",PREV_CHAT:"prev_chat",CONTACT_US:"contact_us",METRIC_UPDATE:"metric_update"},Metrics:{BETA_UPDATES:"beta_updates"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(6),s=n(10),c=n(83),l=n(141),u=n(142),d=n(24),p=n(107),h=n(14),f=n(1242),m=n(231),g=o.createClass({displayName:"NotificationManager",mixins:[c,l,u],componentWillMount:function(){this.tone=new Audio(s.NOTIFICATION_TONE_PATH),this.regCmd("alert_new_msg",this.alertNewMsg),this.regCmd("alert_call",this.showCallNotification),this.regCmd("cancel_call",this.cancelCallNotification),this.addObserver(Store.Chat,"add remove reset change:archive change:unreadCount",this.updateUnreadCount),this.addObserver(Store.Chat,"change:hasUnread",this.closeNotifications),this.addObserver(p,"change:displayInfo",this.updateUnreadCount)},componentDidMount:function(){this.updateUnreadCount()},componentWillUnmount:function(){m.setTitleAndIcon(0),m.closeAllNotifications()},closeNotifications:function(e,t){t||m.closeChatNotifications(e.id)},updateUnreadCount:function(){var e;e=p.displayInfo===p.INFO.OFFLINE?-1:p.displayInfo===p.INFO.TIMEOUT?-1:Store.Chat.filter(function(e){return!e.archive&&e.isDirty()}).length,this.count!==e&&(this.count=e,m.setTitleAndIcon(e))},alertNewMsg:function(e){var t=e.chat;if(!(document.hasFocus()&&t.get("active")||Store.Mute.globalMute().isMuted)){if(t.mute.isMuted){if(!e.isGroupMsg)return;if(!e.isMentioned(Store.Conn.me)&&!e.isQuoted(Store.Conn.me))return;var n=Store.Chat.get(e.sender);if(n&&n.mute.isMuted)return}if(Store.Mute.getGlobalNotifications()&&this.showDesktopNotification(e),Store.Mute.getGlobalSounds())if(t.isGroup){var r=Date.now(),i=t.squelch||0;r>i&&(this.playAudioNotification(),Store.GroupMetadata.find(t.id).then(function(e){var n=e.participants.length,i=1e3*Math.min(120,30+5*n);t.squelch=r+i})["catch"](h.WapDrop,function(){t.squelch=r+6e4}))}else this.playAudioNotification()}},showCallNotification:function(e,t,n){if(window.Notification&&window.Notification.permission===s.PERMISSION_ALLOWED){var r=Store.Contact.get(t),i=r?r.get("formattedName"):d.formattedUser(t),o=n?l10n.t("incoming_video_call_notification_title",{name:i}):l10n.t("incoming_voice_call_notification_title",{name:i}),c=l10n.t("incoming_call_notification_text");Store.ProfilePicThumb.find(t).timeout(1e3,"showCallNotificationTimeout").then(function(n){var r=n&&n.get("img")?n.get("img"):s.USER_DEFAULT_ICON;m.showNotification(t,e,o,c,r,!0)})["catch"](h.WapDrop,a["default"].TimeoutError,function(n){m.showNotification(t,e,o,c,s.USER_DEFAULT_ICON,!0)}),Store.Mute.getGlobalSounds()&&this.playAudioNotification()}},cancelCallNotification:function(e){m.closeNotification(e),Store.Call.remove(Store.Call.get(e))},showDesktopNotification:function(e){if(window.Notification&&window.Notification.permission===s.PERMISSION_ALLOWED){var t=e.get("chat"),n=t.get("id"),r=f.asDesktopNotification(e);r&&r.charCodeAt(0)>=128&&(r=" "+r);var i=t.isGroup?s.GROUP_DEFAULT_ICON:s.USER_DEFAULT_ICON,o=t.isGroup?l10n.t("default_group_message_notification_title"):l10n.t("default_contact_message_notification_title");Store.ProfilePicThumb.find(n).timeout(1500,"showDesktopNotificationTimeout").then(function(a){var s=t.contact.formattedName||o,c=a?a.img:"";m.showNotification(n,e.id,s,r,c||i,!1)})["catch"](h.WapDrop,a["default"].TimeoutError,function(a){var s=t.contact.formattedName||o;m.showNotification(n,e.id,s,r,i,!1)})}},playAudioNotification:function(){this.tone.play()},render:function(){return null}});e.exports=g},function(e,t,n){"use strict";function r(e){s(this,r,e)}function i(e){s(this,i,e)}var a=n(233),o=a.defineProtobufClass,s=a.construct,c=3,l=13,u=14;o(r,{publicKey:[1,l],identifier:[2,l]}),o(i,{version:[1,c],localFingerprint:[2,u,r],remoteFingerprint:[3,u,r]}),e.exports={FingerprintData:r,CombinedFingerprint:i}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return(0,u["default"])(_.pick(e,["message","filename","lineno","colno"]))}function a(e,t,n,r){if(!e)throw new f.MediaEncryptionError('decrypt async, missing "type"');if(!t)throw new f.MediaEncryptionError('decrypt async, missing "buffer"');if(!n)throw new f.MediaEncryptionError('decrypt async, missing "mediaKey"');var a=new m.WebcCryptoMedia({webcCryptoType:m.WEBC_CRYPTO_TYPE_CODE.DECRYPT});return p.supportsWebCrypto().then(function(o){return o?(a.webcCryptoLibrary=m.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO,d.decryptE2EMediaWithWebCrypto(e,t,n,r)):(a.webcCryptoLibrary=m.WEBC_CRYPTO_LIBRARY_CODE.CRYPTOJS,new c["default"](function(i,a){var o=new h;o.onmessage=i,o.onerror=a,o.postMessage({command:"decrypt-e2e-media",type:e,buffer:t,mediaKey:n,mimetype:r})})["catch"](function(e){throw new Error(i(e))}).then(function(e){return e.data}))}).then(function(e){return a.webcCryptoFileSize=t.byteLength,a.markWebcCryptoElapsedT(),a.commit(),e})}function o(e,t,n){if(!e)throw new f.MediaEncryptionError('encrypt async, missing "type"');if(!t)throw new f.MediaEncryptionError('encrypt async, missing "buffer"');if(!n)throw new f.MediaEncryptionError('encrypt async, missing "mediaKey"');var r=new m.WebcCryptoMedia({webcCryptoType:m.WEBC_CRYPTO_TYPE_CODE.ENCRYPT});return p.supportsWebCrypto().then(function(a){return a?(r.webcCryptoLibrary=m.WEBC_CRYPTO_LIBRARY_CODE.WEBCRYPTO,d.encryptE2EMediaWithWebCrypto(e,t,n)):(r.webcCryptoLibrary=m.WEBC_CRYPTO_LIBRARY_CODE.CRYPTOJS,new c["default"](function(r,i){var a=new h;a.onmessage=r,a.onerror=i,a.postMessage({command:"encrypt-e2e-media",type:e,buffer:t,mediaKey:n})})["catch"](function(e){throw new Error(i(e))}).then(function(e){return e.data}))}).then(function(e){return r.webcCryptoFileSize=e.size,r.markWebcCryptoElapsedT(),r.commit(),e})}var s=n(2),c=r(s),l=n(16),u=r(l),d=n(222),p=n(229),h=n(1551),f=n(14),m=n(57);e.exports={decryptE2EMedia:a,encryptE2EMedia:o}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),a=r(i),o=n(1543),s=n(220),c=n(1),l={enrich:function(e){switch(s.previewType(e.mimetype)){case"pdf":return this.enrichPdf(e);case"msoffice":return this.enrichDoc(e);default:return a["default"].resolve({media:e})}},enrichPdf:function(e){var t,n=e.mediaBlob;return o.fileToPdf(n).then(function(n){return t=n,o.pdfToImg(n,1).then(function(t){var r=t;return r.pdfPages=n.numPages,{media:e,documentPreview:r}})})["catch"](function(t){return c.log("pdf preview generation failed",t)(),{media:e}})["finally"](function(){t&&o.releasePdf(t)})},enrichDoc:function(e){return a["default"].resolve({media:e})}};e.exports=l},function(e,t){"use strict";e.exports={SMILEYS_PEOPLE:["ordered1456","ordered1500","ordered1457","ordered1458","ordered1459","ordered1460","ordered1461","ordered1462","ordered1463","ordered1465","ordered1466","ordered1522","ordered1523","ordered0078","ordered1467","ordered1468","ordered1469","ordered1480","ordered1479","ordered1481","ordered1482","ordered1484","ordered1485","ordered1483","ordered1749","ordered1751","ordered1470","ordered1755","ordered1471","ordered1510","ordered1472","ordered1473","ordered1474","ordered1524","ordered1752","ordered1507","ordered1486","ordered1487","ordered1488","ordered1489","ordered1476","ordered1477","ordered1521","ordered0077","ordered1491","ordered1478","ordered1499","ordered1497","ordered1492","ordered1502","ordered1505","ordered1496","ordered1504","ordered1503","ordered1494","ordered1495","ordered1490","ordered1493","ordered1498","ordered1475","ordered1501","ordered1509","ordered1506","ordered1748","ordered1511","ordered1750","ordered1753","ordered1508","ordered1200","ordered1205","ordered1464","ordered1105","ordered1094","ordered1095","ordered1096","ordered1106","ordered0069","ordered1103","ordered1104","ordered1754","ordered1514","ordered1512","ordered1513","ordered1515","ordered1516","ordered1517","ordered1520","ordered1519","ordered1518","ordered1576","ordered0923","ordered0911","ordered0917","ordered0893","ordered0150","ordered0899","ordered0881","ordered0887","ordered0869","ordered0875","ordered0905","ordered0063","ordered0162","ordered0156","ordered1413","ordered0929","ordered1206","ordered1606","ordered1425","ordered1756","ordered1419","ordered0168","ordered1138","ordered0867","ordered0868","ordered0855","ordered0861","ordered0853","ordered0852","ordered1446","ordered0954","ordered0955","ordered1070","ordered0956","ordered0962","ordered0968","ordered0974","ordered1029","ordered1028","ordered1058","ordered1064","ordered1040","ordered1047","ordered1046","ordered1009","ordered1008","ordered1077","ordered1076","ordered1120","ordered1119","ordered1393","ordered1392","ordered0622","ordered1088","ordered1022","ordered1097","ordered1550","ordered1549","ordered1108","ordered1107","ordered1526","ordered1525","ordered1538","ordered1537","ordered1565","ordered1564","ordered1595","ordered1594","ordered1583","ordered1582","ordered1157","ordered1156","ordered1145","ordered1144","ordered1131","ordered1021","ordered1020","ordered1700","ordered1699","ordered0685","ordered0684","ordered1005","ordered1007","ordered1006","ordered1180","ordered1181","ordered1179","ordered1176","ordered1177","ordered1175","ordered0990","ordered0992","ordered0993","ordered0991","ordered0994","ordered1000","ordered1002","ordered1003","ordered1001","ordered1004","ordered0985","ordered0987","ordered0988","ordered0986","ordered0989","ordered0995","ordered0997","ordered0998","ordered0996","ordered0999","ordered0980","ordered0982","ordered0983","ordered0981","ordered0984","ordered0944","ordered0939","ordered0940","ordered0938","ordered0941","ordered0943","ordered0942","ordered1137","ordered1171","ordered0953","ordered0950","ordered0951","ordered0952","ordered0948","ordered0949","ordered0936","ordered0658","ordered0641","ordered0935","ordered0119","ordered0640","ordered0947","ordered0945","ordered0946","ordered1229","ordered0937","ordered1404","ordered1173","ordered0493"],ANIMALS_NATURE:["ordered0842","ordered0837","ordered0833","ordered0845","ordered0836","ordered0847","ordered0848","ordered0828","ordered0835","ordered1763","ordered0834","ordered0843","ordered0849","ordered0844","ordered0813","ordered0841","ordered1561","ordered1562","ordered1563","ordered0806","ordered0808","ordered0827","ordered0826","ordered0824","ordered0823","ordered0825","ordered0846","ordered0811","ordered0840","ordered1766","ordered0817","ordered0815","ordered0800","ordered0818","ordered0816","ordered1405","ordered1764","ordered1762","ordered0801","ordered0822","ordered0820","ordered0819","ordered0821","ordered0832","ordered0839","ordered0799","ordered0798","ordered0794","ordered0793","ordered0791","ordered0790","ordered0792","ordered0830","ordered0831","ordered0812","ordered0804","ordered0803","ordered0805","ordered0802","ordered0810","ordered0788","ordered0789","ordered0807","ordered1765","ordered1359","ordered0809","ordered0829","ordered0796","ordered0795","ordered0851","ordered0850","ordered0797","ordered0838","ordered0542","ordered0621","ordered0539","ordered0540","ordered0541","ordered0538","ordered0552","ordered0062","ordered0553","ordered0635","ordered0633","ordered0556","ordered0555","ordered0554","ordered0551","ordered0547","ordered0548","ordered0546","ordered0544","ordered0549","ordered0545","ordered1178","ordered0557","ordered0537","ordered0620","ordered0814","ordered1406","ordered0505","ordered0504","ordered0506","ordered0512","ordered0513","ordered0514","ordered0515","ordered0508","ordered0509","ordered0510","ordered0511","ordered0517","ordered0520","ordered0518","ordered0519","ordered0521","ordered0516","ordered0206","ordered0522","ordered1212","ordered0180","ordered0057","ordered0053","ordered0525","ordered0115","ordered0526","ordered0527","ordered0054","ordered0528","ordered0116","ordered0530","ordered0107","ordered1333","ordered1201","ordered0183","ordered0529","ordered0056","ordered0114","ordered0533","ordered1204","ordered0531","ordered0532","ordered0055","ordered0060","ordered1203","ordered1202","ordered0501"],FOOD_DRINK:["ordered0568","ordered0567","ordered0569","ordered0563","ordered0564","ordered0565","ordered0562","ordered0560","ordered0572","ordered0561","ordered0571","ordered0570","ordered0566","ordered0558","ordered0559","ordered0543","ordered0550","ordered0585","ordered0600","ordered0583","ordered1767","ordered0576","ordered0575","ordered0589","ordered0604","ordered0573","ordered0584","ordered0534","ordered0574","ordered0582","ordered0535","ordered0536","ordered0581","ordered0603","ordered0590","ordered0588","ordered0602","ordered0580","ordered0578","ordered0579","ordered0577","ordered0587","ordered0586","ordered0592","ordered0593","ordered0591","ordered0601","ordered0619","ordered0599","ordered0597","ordered0598","ordered0596","ordered0616","ordered0594","ordered0595","ordered0611","ordered0612","ordered0608","ordered0609","ordered0610","ordered0615","ordered0607","ordered0606","ordered0061","ordered0613","ordered0605","ordered0614"],ACTIVITY:["ordered0112","ordered0681","ordered0711","ordered0113","ordered0679","ordered0742","ordered0712","ordered0666","ordered0745","ordered0780","ordered0744","ordered0743","ordered0741","ordered0781","ordered0127","ordered0652","ordered0131","ordered0680","ordered0130","ordered0683","ordered0726","ordered0725","ordered0133","ordered0132","ordered0738","ordered0737","ordered0697","ordered0696","ordered0714","ordered0713","ordered1648","ordered1647","ordered0710","ordered1676","ordered1675","ordered1688","ordered1687","ordered1720","ordered1391","ordered0643","ordered0678","ordered0708","ordered0642","ordered0709","ordered0778","ordered0664","ordered0660","ordered0648","ordered0662","ordered0657","ordered0659","ordered0661","ordered0653","ordered0656","ordered0677","ordered0674","ordered0672","ordered0675","ordered0673","ordered0676","ordered0663","ordered0665","ordered0667","ordered0668"],TRAVEL_PLACES:["ordered1635","ordered1633","ordered1637","ordered1624","ordered1626","ordered0740","ordered1631","ordered1629","ordered1630","ordered1628","ordered1638","ordered1639","ordered1640","ordered0739","ordered1673","ordered1663","ordered1632","ordered1625","ordered1636","ordered1634","ordered1645","ordered1644","ordered1643","ordered1615","ordered1623","ordered1641","ordered1616","ordered1617","ordered1620","ordered1642","ordered1614","ordered1618","ordered1619","ordered1622","ordered1621","ordered1613","ordered1743","ordered0148","ordered1744","ordered1745","ordered0129","ordered1742","ordered1659","ordered0128","ordered1747","ordered1612","ordered1746","ordered1227","ordered0099","ordered1662","ordered0145","ordered1627","ordered1661","ordered1660","ordered1450","ordered1646","ordered0650","ordered0651","ordered0649","ordered0749","ordered0492","ordered1452","ordered0771","ordered0126","ordered0639","ordered0124","ordered0746","ordered1451","ordered0502","ordered1454","ordered0747","ordered0144","ordered0756","ordered1740","ordered1741","ordered0496","ordered0495","ordered0754","ordered0748","ordered0755","ordered0498","ordered0497","ordered0751","ordered0494","ordered0500","ordered0503","ordered0523","ordered0629","ordered0628","ordered0499","ordered0750","ordered0774","ordered0773","ordered0757","ordered1453","ordered0758","ordered0759","ordered0752","ordered0760","ordered0770","ordered0761","ordered0762","ordered0763","ordered0764","ordered0766","ordered0768","ordered0769","ordered0767","ordered1182","ordered0753","ordered0123","ordered1361","ordered1362","ordered1360","ordered0122"],OBJECTS:["ordered0027","ordered1282","ordered1283","ordered1228","ordered0029","ordered1431","ordered1432","ordered1433","ordered1434","ordered1407","ordered1442","ordered1230","ordered1231","ordered1232","ordered1233","ordered1293","ordered1288","ordered1289","ordered1290","ordered0654","ordered1294","ordered0647","ordered1263","ordered0058","ordered1264","ordered1265","ordered1291","ordered1292","ordered0644","ordered0645","ordered0646","ordered0038","ordered0039","ordered0037","ordered1389","ordered0040","ordered0028","ordered1266","ordered1307","ordered1308","ordered1197","ordered1334","ordered1388","ordered1439","ordered1739","ordered1225","ordered1222","ordered1221","ordered1223","ordered1224","ordered1217","ordered1220","ordered1174","ordered0101","ordered1335","ordered1336","ordered0098","ordered1737","ordered0118","ordered1337","ordered0103","ordered0120","ordered1339","ordered1199","ordered1338","ordered1445","ordered0100","ordered1738","ordered1667","ordered0110","ordered0111","ordered0782","ordered1342","ordered1295","ordered1168","ordered0102","ordered1341","ordered1340","ordered1390","ordered1170","ordered1169","ordered0524","ordered1717","ordered1719","ordered1726","ordered1734","ordered1313","ordered1443","ordered1665","ordered1731","ordered1732","ordered1735","ordered1435","ordered0125","ordered1455","ordered1733","ordered0618","ordered0630","ordered0637","ordered0617","ordered0632","ordered0631","ordered0638","ordered0772","ordered0636","ordered0149","ordered1274","ordered1273","ordered1272","ordered1172","ordered1270","ordered1269","ordered1271","ordered0779","ordered1318","ordered1275","ordered1276","ordered1277","ordered1278","ordered1279","ordered1280","ordered1261","ordered1236","ordered1237","ordered1250","ordered1243","ordered1241","ordered1242","ordered1440","ordered1441","ordered1239","ordered1238","ordered1240","ordered1437","ordered1449","ordered1438","ordered1244","ordered1234","ordered1235","ordered1436","ordered1444","ordered1281","ordered1252","ordered1253","ordered1251","ordered1254","ordered1256","ordered1257","ordered1258","ordered1259","ordered1255","ordered1319","ordered1247","ordered1408","ordered1249","ordered1248","ordered0146","ordered1245","ordered1246","ordered1664","ordered0634","ordered0775","ordered0777","ordered0682","ordered0776","ordered1411","ordered1412","ordered1409","ordered1410","ordered0175","ordered1262","ordered0174","ordered1311","ordered1312","ordered1314","ordered1315","ordered1309","ordered1310"],SYMBOLS:["ordered0192","ordered1191","ordered1190","ordered1189","ordered1192","ordered1184","ordered0191","ordered1185","ordered1194","ordered1183","ordered1187","ordered1186","ordered1188","ordered1193","ordered1195","ordered0074","ordered0178","ordered0073","ordered1358","ordered0076","ordered0179","ordered1343","ordered1363","ordered0075","ordered0072","ordered1736","ordered0117","ordered0079","ordered0080","ordered0081","ordered0082","ordered0083","ordered0084","ordered0085","ordered0086","ordered0087","ordered0088","ordered0089","ordered0090","ordered0222","ordered0104","ordered0481","ordered0487","ordered0070","ordered0071","ordered1285","ordered1284","ordered0484","ordered0478","ordered0486","ordered0488","ordered0485","ordered0182","ordered0228","ordered0490","ordered1215","ordered0489","ordered0211","ordered0210","ordered0482","ordered0483","ordered0480","ordered0214","ordered0215","ordered0218","ordered0219","ordered0216","ordered0226","ordered0121","ordered1260","ordered1666","ordered0185","ordered0207","ordered1198","ordered0095","ordered1711","ordered1670","ordered1674","ordered1672","ordered1326","ordered1286","ordered0190","ordered0189","ordered0187","ordered0188","ordered0015","ordered0016","ordered1216","ordered1301","ordered1302","ordered1345","ordered0105","ordered0209","ordered0106","ordered1712","ordered1344","ordered0096","ordered0479","ordered1226","ordered0184","ordered0181","ordered0186","ordered0147","ordered0507","ordered0044","ordered1196","ordered0491","ordered0198","ordered0765","ordered0477","ordered1727","ordered1728","ordered1729","ordered1730","ordered0097","ordered1668","ordered1718","ordered0217","ordered1671","ordered1713","ordered1714","ordered1716","ordered1715","ordered1669","ordered0655","ordered1287","ordered0476","ordered1332","ordered1329","ordered1328","ordered1331","ordered0018","ordered0224","ordered0225","ordered0227","ordered0220","ordered0223","ordered0221","ordered0003","ordered0004","ordered0005","ordered0006","ordered0007","ordered0008","ordered0009","ordered0010","ordered0011","ordered0012","ordered1327","ordered1330","ordered0001","ordered0002","ordered0047","ordered0041","ordered0036","ordered0042","ordered0043","ordered0034","ordered0035","ordered0030","ordered0031","ordered0032","ordered0033","ordered0048","ordered1356","ordered1357","ordered0196","ordered0201","ordered0202","ordered0203","ordered0022","ordered0023","ordered0024","ordered0021","ordered0020","ordered0019","ordered0026","ordered0025","ordered0199","ordered0200","ordered1296","ordered1297","ordered1298","ordered1300","ordered1299","ordered0670","ordered0671","ordered0208","ordered0197","ordered0176","ordered0193","ordered0194","ordered0195","ordered0177","ordered1219","ordered1218","ordered0017","ordered0013","ordered0014","ordered1322","ordered1321","ordered1323","ordered1325","ordered1324","ordered0059","ordered1320","ordered0108","ordered0109","ordered1348","ordered1349","ordered1354","ordered1355","ordered1352","ordered1353","ordered1350","ordered1351","ordered1347","ordered1346","ordered0045","ordered0046","ordered0052","ordered0051","ordered0050","ordered0049","ordered0204","ordered0205","ordered1303","ordered1304","ordered1305","ordered1306","ordered1317","ordered1316","ordered1268","ordered1267","ordered0854","ordered1213","ordered1214","ordered1448","ordered0213","ordered0212","ordered0669","ordered0091","ordered0092","ordered0093","ordered0094","ordered1364","ordered1365","ordered1366","ordered1367","ordered1368","ordered1369","ordered1370","ordered1371","ordered1372","ordered1373","ordered1374","ordered1375","ordered1376","ordered1377","ordered1378","ordered1379","ordered1380","ordered1381","ordered1382","ordered1383","ordered1384","ordered1385","ordered1386","ordered1387"],
FLAGS:["ordered0231","ordered0243","ordered0234","ordered0289","ordered0239","ordered0229","ordered0236","ordered0233","ordered0237","ordered0232","ordered0238","ordered0235","ordered0242","ordered0241","ordered0240","ordered0244","ordered0260","ordered0251","ordered0247","ordered0246","ordered0263","ordered0248","ordered0264","ordered0253","ordered0255","ordered0261","ordered0257","ordered0258","ordered0245","ordered0262","ordered0259","ordered0334","ordered0464","ordered0256","ordered0250","ordered0249","ordered0252","ordered0279","ordered0345","ordered0274","ordered0265","ordered0328","ordered0352","ordered0268","ordered0441","ordered0273","ordered0275","ordered0281","ordered0266","ordered0276","ordered0347","ordered0269","ordered0267","ordered0272","ordered0277","ordered0325","ordered0278","ordered0280","ordered0282","ordered0283","ordered0286","ordered0285","ordered0287","ordered0288","ordered0290","ordered0292","ordered0436","ordered0316","ordered0294","ordered0291","ordered0296","ordered0297","ordered0300","ordered0302","ordered0299","ordered0298","ordered0303","ordered0308","ordered0402","ordered0442","ordered0304","ordered0313","ordered0307","ordered0284","ordered0310","ordered0311","ordered0317","ordered0312","ordered0306","ordered0315","ordered0320","ordered0319","ordered0309","ordered0314","ordered0321","ordered0322","ordered0326","ordered0324","ordered0323","ordered0327","ordered0337","ordered0333","ordered0329","ordered0336","ordered0335","ordered0330","ordered0332","ordered0331","ordered0338","ordered0271","ordered0340","ordered0342","ordered0339","ordered0341","ordered0353","ordered0343","ordered0346","ordered0470","ordered0351","ordered0344","ordered0354","ordered0363","ordered0355","ordered0360","ordered0359","ordered0364","ordered0357","ordered0361","ordered0362","ordered0375","ordered0371","ordered0369","ordered0383","ordered0385","ordered0382","ordered0372","ordered0380","ordered0370","ordered0377","ordered0378","ordered0381","ordered0472","ordered0384","ordered0301","ordered0367","ordered0366","ordered0374","ordered0368","ordered0379","ordered0365","ordered0386","ordered0373","ordered0387","ordered0396","ordered0395","ordered0393","ordered0388","ordered0398","ordered0392","ordered0389","ordered0391","ordered0397","ordered0390","ordered0376","ordered0349","ordered0394","ordered0399","ordered0405","ordered0412","ordered0410","ordered0400","ordered0403","ordered0413","ordered0401","ordered0404","ordered0408","ordered0406","ordered0411","ordered0409","ordered0414","ordered0415","ordered0416","ordered0418","ordered0419","ordered0254","ordered0426","ordered0348","ordered0356","ordered0407","ordered0462","ordered0469","ordered0430","ordered0435","ordered0420","ordered0431","ordered0417","ordered0422","ordered0429","ordered0425","ordered0437","ordered0428","ordered0427","ordered0421","ordered0432","ordered0473","ordered0318","ordered0350","ordered0434","ordered0295","ordered0358","ordered0423","ordered0433","ordered0439","ordered0424","ordered0270","ordered0438","ordered0454","ordered0445","ordered0455","ordered0444","ordered0447","ordered0443","ordered0446","ordered0450","ordered0452","ordered0449","ordered0451","ordered0448","ordered0440","ordered0453","ordered0457","ordered0456","ordered0230","ordered0305","ordered0458","ordered0465","ordered0459","ordered0460","ordered0467","ordered0461","ordered0463","ordered0466","ordered0468","ordered0293","ordered0471","ordered0474","ordered0475","ordered1769","ordered1770","ordered1771"]}},function(e,t,n){"use strict";var r=n(1550),i=n(1143),a=null,o={getMatchedEmojiUnicode:function(e){var t=this.getEmojiTrie(),n=_.uniq(_.flatMap(t.getMatches(e),function(e){return e.value}));return n},getEmojiTrie:function(){if(!a){var e=_.map(r,function(e,t){return{value:e,keyword:t}});a=i(e,"keyword")}return a}};e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(23),a=r(i),o=n(26),s=r(o),c=function(){function e(){(0,a["default"])(this,e)}return(0,s["default"])(e,[{key:"trigger",value:function(e){}}]),e}();e.exports=new c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1240),a=r(i),o=3;e.exports={minHeight:function(e,t){return{minHeight:e.length>o?o*a["default"].DEFAULT_HEIGHT+t:e.length*a["default"].DEFAULT_HEIGHT+t}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1258),m=n(225),g=n(86),v=n(1257),y=v.matchAll,_=function(e){function t(e){(0,s["default"])(this,t);var n=(0,d["default"])(this,(0,a["default"])(t).call(this));return n._length=e,n._regex=new RegExp("("+m.arabic+"{"+e+"})("+m.arabic+")","g"),n}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"mutate",value:function(e,t){return t[1]+"​"+t[2]}},{key:"match",value:function(e){return g.isWebkit?e.length<=this._length?null:y(this._regex,e):null}},{key:"isFragment",get:function(){return!0}},{key:"alwaysApply",get:function(){return!0}}]),t}(f);e.exports=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(1138),a=r(i),o=n(36),s=r(o),c=n(23),l=r(c),u=n(26),d=r(u),p=n(82),h=r(p),f=n(81),m=r(f),g=n(1309),v=n(1141),y=function(e){function t(e){(0,l["default"])(this,t);var n=(0,h["default"])(this,(0,s["default"])(t).call(this,e));return n.handlers=new a["default"],n.defaultHandler=null,n}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"onMutatorNode",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0].mutator,i=this.getHandler(r)||this.defaultHandler;return v(i,'Missing handler for "'+r.constructor+'"'),i.call.apply(i,[this].concat(t,[this.args]))}},{key:"addHandler",value:function(e,t){this.handlers.set(e,t)}},{key:"setDefaultHandler",value:function(e){this.defaultHandler=e}},{key:"getHandler",value:function(e){return this.handlers.get(e.constructor)}}]),t}(g);e.exports=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(45),m=r(f),g=n(1258),v=n(436),y=n(1257),E=y.matchAll,b={"(y)":"👍","(n)":"👎",":-)":"🙂",":-(":"🙁",":-p":"😛",":-|":"😐",":-\\":"😕",":-d":"😀",":-*":"😘","<3":"❤","^_^":"😁",">_<":"😆",";-)":"😉"},w=(0,m["default"])(b).map(window._.escapeRegExp).join("|"),M=new RegExp("((?:"+w+")+)","ig"),C=new RegExp("("+w+")","i"),S=new RegExp("([*_~\\s]|```)"),T=function(e){function t(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];(0,s["default"])(this,t);var n=(0,d["default"])(this,(0,a["default"])(t).call(this));return n.skin=e,n}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"match",value:function(e){return E(M,e,function(t,n){var r=e.substr(Math.max(0,t.index-3),Math.min(3,t.index));if(t.index&&!S.test(r))return null;var i=e.substr(t.index+t[0].length,3);return i&&!S.test(i)?null:t})}},{key:"mutate",value:function(e){var t=this,n=_.compact(e.split(C)),r=_.map(n,function(e){if(!e)return e;var n=b[e.toLowerCase()];return n?t.skin&&v.skinToneEmojis[n]?Store.EmojiVariant.getVariant(n)||n:n:e});return r.join("")}},{key:"isFragment",get:function(){return!0}}]),t}(g);e.exports=T},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(438),m=r(f),g=n(146),v=r(g),y=n(1536),_=n(1227),E=n(8),b=n(1257),w=b.jsx,M=n(6),C=n(1287),S=C.dir,T=n(1291),k=n(1359),x=n(1306),N=n(1307),P=n(1310),O=n(1311),D=n(1360),A=n(1308),I=n(1389),R=function(e,t){var n=t.match.href;return{href:n,title:n,rel:"noopener noreferrer",target:"_blank"}},L=function(e,t,n){var r=(0,v["default"])(n,1),i=r[0];return{emoji:i}},U=function(){return{className:"matched-text"}},F=function(e,t){var n=t.match.jid,r=Store.Contact.gadd({id:n}),i=function(){var e=Store.Chat.gadd(r.id);E.chatInfoDrawer(e)};return{onClick:i,className:"matched-mention","data-jid":n,"data-display":"@"+r.display}},j=function(e){var t=e.children,n=(0,m["default"])(e,["children"]),r=(0,v["default"])(t,1),i=r[0],a=i.substring(1);return M.createElement("span",n,M.createElement("span",{className:"at-symbol"},"@"),M.createElement("span",{dir:S(a)||"auto"},a))},B=function(e){function t(){var e;(0,s["default"])(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=(0,d["default"])(this,(e=(0,a["default"])(t)).call.apply(e,[this].concat(r)));return o.addHandler(k,w.make(I,k,L)),o.addHandler(N,w.make("a",N,R)),o.addHandler(T,w.make("code",T)),o.addHandler(O,w.make("strong",O)),o.addHandler(x,w.make("em",x)),o.addHandler(P,w.make("del",P)),o.addHandler(D,w.make("span",D,U)),o.addHandler(A,w.make(j,A,F)),o}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"onRoot",value:function(e){return _(e.reduce(function(e,t,n){return e["root-child-"+n]=t,e},{}))}},{key:"onDelimiter",value:function(){return null}}]),t}(y);e.exports=B},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1309),m=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"onRoot",value:function(e){return e.join("")}},{key:"onMutatorNode",value:function(e,t){return t.join("")}}]),t}(f);e.exports=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(36),a=r(i),o=n(23),s=r(o),c=n(26),l=r(c),u=n(82),d=r(u),p=n(81),h=r(p),f=n(1309),m=function(e){function t(){return(0,s["default"])(this,t),(0,d["default"])(this,(0,a["default"])(t).apply(this,arguments))}return(0,h["default"])(t,e),(0,l["default"])(t,[{key:"onRoot",value:function(e){return e.join("")}},{key:"onMutatorNode",value:function(e,t){return t.join("")}},{key:"onDelimiter",value:function(){return""}}]),t}(f);e.exports=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){return v++,g?g:new window.AudioContext}function a(){v--,0===v&&g&&(g.close&&g.close(),g=void 0)}var o=n(2),s=r(o),c=n(23),l=r(c),u=n(26),d=r(u),p=n(1364),h=n(439),f=n(13),m="audio/wav",g=void 0,v=0,y=function(){function e(t){(0,l["default"])(this,e),this.oggBlob=t}return(0,d["default"])(e,[{key:"generateBlob",value:function(){return this.oggBlobToWAVBlob(this.oggBlob,1)}},{key:"oggBlobToWAVBlob",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?2:arguments[1];return new s["default"](function(r,o){var s=new p,c=[],l=[],u=i(),d={outputBufferSampleRate:u.sampleRate,bufferLength:4096};s.onmessage=function(e){if(null===e.data){for(var i=function(e){c.forEach(function(t,n){t=t[e]||t[0];for(var r=0;r<t.length;r++)l.push(t[r])})},o=0;o<n;o++)i(o);var s=t.encodeWAV(l,u,n),d=new Blob([s.readByteArray()],{type:m});a(),r(d)}else c.push(e.data),n=c[0].length},s.postMessage({command:"decode-init",config:d}),h.blobToArrayBuffer(e).then(function(e){s.postMessage({command:"decode",pages:new Uint8Array(e)}),s.postMessage({command:"decode-done"})})})}},{key:"encodeWAV",value:function(e,t,n){var r=new f(44+2*e.length,(!0));r.writeString("RIFF"),r.writeUint32(36+2*e.length),r.writeString("WAVE"),r.writeString("fmt "),r.writeUint32(16),r.writeUint16(1),r.writeUint16(n),r.writeUint32(t.sampleRate),r.writeUint32(t.sampleRate*n*2),r.writeUint16(2*n),r.writeUint16(16),r.writeString("data"),r.writeUint32(2*e.length);for(var i=0;i<e.length;i++){var a=Math.max(-1,Math.min(e[i],1));a*=a>0?32767:32768,r.writeInt16(Math.floor(a))}return r}}]),e}();e.exports=y},function(e,t,n){"use strict";var r=n(1364),i=function a(e){if(!a.isRecordingSupported())throw"Recording is not supported in this browser";this.audioContext=new window.AudioContext,this.config=e=e||{},this.config.command="encode-init",this.config.bufferLength=e.bufferLength||4096,this.config.monitorGain=e.monitorGain||0,this.config.numberOfChannels=e.numberOfChannels||1,this.config.originalSampleRate=this.audioContext.sampleRate,this.config.encoderSampleRate=e.encoderSampleRate||48e3,this.config.streamPages=e.streamPages||!1,this.config.leaveStreamOpen=e.leaveStreamOpen||!1,this.config.maxBuffersPerPage=e.maxBuffersPerPage||40,this.config.encoderApplication=e.encoderApplication||2049,this.config.encoderFrameSize=e.encoderFrameSize||20,this.config.streamOptions=e.streamOptions||{optional:[],mandatory:{googEchoCancellation:!1,googAutoGainControl:!1,googNoiseSuppression:!1,googHighpassFilter:!1}},this.state="inactive",this.eventTarget=document.createDocumentFragment(),this.createAudioNodes()};i.isRecordingSupported=function(){return window.AudioContext&&navigator.getUserMedia},i.prototype.addEventListener=function(e,t,n){this.eventTarget.addEventListener(e,t,n)},i.prototype.clearStream=function(){this.stream&&(this.stream.getTracks().forEach(function(e){e.stop()}),delete this.stream)},i.prototype.createAudioNodes=function(){var e=this;this.scriptProcessorNode=this.audioContext.createScriptProcessor(this.config.bufferLength,this.config.numberOfChannels,this.config.numberOfChannels),this.scriptProcessorNode.onaudioprocess=function(t){e.encodeBuffers(t.inputBuffer)},this.monitorNode=this.audioContext.createGain(),this.setMonitorGain(this.config.monitorGain),this.config.sampleRate<this.audioContext.sampleRate&&this.createButterworthFilter()},i.prototype.createButterworthFilter=function(){this.filterNode=this.audioContext.createBiquadFilter(),this.filterNode2=this.audioContext.createBiquadFilter(),this.filterNode3=this.audioContext.createBiquadFilter(),this.filterNode.type=this.filterNode2.type=this.filterNode3.type="lowpass";var e=this.config.sampleRate/2;this.filterNode.frequency.value=this.filterNode2.frequency.value=this.filterNode3.frequency.value=e-e/3.5355,this.filterNode.Q.value=.51764,this.filterNode2.Q.value=.70711,this.filterNode3.Q.value=1.93184,this.filterNode.connect(this.filterNode2),this.filterNode2.connect(this.filterNode3),this.filterNode3.connect(this.scriptProcessorNode)},i.prototype.encodeBuffers=function(e){if("recording"===this.state){for(var t=[],n=0;n<e.numberOfChannels;n++)t[n]=e.getChannelData(n);this.encoder.postMessage({command:"encode",buffers:t}),this.duration+=e.duration,this.eventTarget.dispatchEvent(new CustomEvent("duration",{detail:this.duration}))}},i.prototype.initStream=function(e){if(this.stream)return void this.eventTarget.dispatchEvent(new Event("streamReady"));if(e)return this.stream=e,this.sourceNode=this.audioContext.createMediaStreamSource(e),this.sourceNode.connect(this.filterNode||this.scriptProcessorNode),this.sourceNode.connect(this.monitorNode),void this.eventTarget.dispatchEvent(new Event("streamReady"));var t=this;navigator.getUserMedia({audio:this.config.streamOptions},function(e){t.stream=e,t.sourceNode=t.audioContext.createMediaStreamSource(e),t.sourceNode.connect(t.filterNode||t.scriptProcessorNode),t.sourceNode.connect(t.monitorNode),t.eventTarget.dispatchEvent(new Event("streamReady"))},function(e){t.eventTarget.dispatchEvent(new ErrorEvent("streamError",{error:e}))})},i.prototype.pause=function(){"recording"===this.state&&(this.state="paused",this.eventTarget.dispatchEvent(new Event("pause")))},i.prototype.removeEventListener=function(e,t,n){this.eventTarget.removeEventListener(e,t,n)},i.prototype.resume=function(){"paused"===this.state&&(this.state="recording",this.eventTarget.dispatchEvent(new Event("resume")))},i.prototype.setMonitorGain=function(e){this.monitorNode.gain.value=e},i.prototype.start=function(){if("inactive"===this.state&&this.stream){var e=this;this.encoder=new r,this.config.streamPages?this.encoder.addEventListener("message",function(t){e.streamPage(t.data)}):(this.recordedPages=[],this.totalLength=0,this.encoder.addEventListener("message",function(t){e.storePage(t.data)})),this.encodeBuffers=function(){delete this.encodeBuffers},this.duration=0,this.state="recording",this.monitorNode.connect(this.audioContext.destination),this.scriptProcessorNode.connect(this.audioContext.destination),this.eventTarget.dispatchEvent(new Event("start")),this.eventTarget.dispatchEvent(new CustomEvent("duration",{detail:this.duration})),this.encoder.postMessage(this.config)}},i.prototype.stop=function(){"inactive"!==this.state&&(this.state="inactive",this.audioContext.close&&this.audioContext.close(),this.monitorNode.disconnect(),this.scriptProcessorNode.disconnect(),this.config.leaveStreamOpen||this.clearStream(),this.encoder.postMessage({command:"encode-done"}))},i.prototype.storePage=function(e){if(this.recordedPages.push(e),this.totalLength+=e.length,4&e[5]){for(var t=new Uint8Array(this.totalLength),n=0,r=0;r<this.recordedPages.length;r++)t.set(this.recordedPages[r],n),n+=this.recordedPages[r].length;this.eventTarget.dispatchEvent(new CustomEvent("dataAvailable",{detail:new Blob([t],{type:"audio/ogg; codecs=opus"})})),this.recordedPages=[],this.eventTarget.dispatchEvent(new Event("stop"))}},i.prototype.streamPage=function(e){this.eventTarget.dispatchEvent(new CustomEvent("dataAvailable",{detail:new Blob([e],{type:"audio/ogg; codecs=opus"})})),4&e[5]&&this.eventTarget.dispatchEvent(new Event("stop"))},e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){return u["default"].loop(function(e,t,r){var i=u["default"].delay(p.expBackoff(r,12e4,0,0));return new u["default"](function(t,r){n.e(86).then(function(r){var i=n(1312);i.PDFJS.workerSrc="./pdf.worker.js",e(i),t(i)}.bind(null,n))["catch"](function(e){n.oe(e)})})["catch"](function(e){return i})})}var a=n(23),o=r(a),s=n(26),c=r(s),l=n(2),u=r(l),d=n(1252),p=n(90);n(1553);var h=function(){function e(){(0,o["default"])(this,e)}return(0,c["default"])(e,null,[{key:"fileToPdf",value:function(e){var t=URL.createObjectURL(e);return i().then(function(e){return e.PDFJS.getDocument(t)})}},{key:"releasePdf",value:function(e){return e.destroy()}},{key:"pdfToImg",value:function(e,t){var n=document.createElement("canvas");return e.getPage(t).then(function(e){var t=e.getViewport(1),r=n.getContext("2d");n.height=t.height,n.width=t.width;var i={canvasContext:r,viewport:t};return e.render(i)}).then(function(){return d.canvasToBlob(n)}).then(function(e){var t=n.height,r=n.width,i=URL.createObjectURL(e);return{url:i,thumbUrl:i,width:r,height:t}})}}]),e}();e.exports=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(45),a=r(i),o=n(26),s=r(o),c=n(23),l=r(c),u=function p(e){(0,l["default"])(this,p),this.promise=e,this.lastUsedTime=this.createdTime=+Date.now()},d=function(){function e(t,n){var r=n.maxCached,i=void 0===r?10:r,a=n.maxAge,o=void 0===a?1/0:a,s=n.shouldCache;(0,l["default"])(this,e),this._cache={},this._maxCached=i,this._maxAge=o,this._createPromiseFunc=t,this._shouldCacheFunc=s}return(0,s["default"])(e,[{key:"getOrRun",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0],o=this._cache;if(this._maxAge!==1/0)for(var s=Date.now()-this._maxAge,c=(0,a["default"])(o),l=0;l<c.length;l++){var d=c[l];o[d].createdTime<s&&delete o[d]}var p=o[i];if(p)return p.lastUsedTime=+Date.now(),p.promise;var h=(0,a["default"])(o);if(h.length>=this._maxCached){for(var f=void 0,m=void 0,g=0;g<h.length;g++){var v=h[g],y=o[v];(!m||y.lastUsedTime<m)&&(m=y.lastUsedTime,f=v)}delete o[f]}var _=this._createPromiseFunc.apply(void 0,n);return o[i]=new u(_),_.then(function(t){var n=e._shouldCacheFunc;n&&e._cache[i]===_&&!n(t)&&delete e._cache[i]})["catch"](function(){e._cache[i]===_&&delete e._cache[i]}),_}}]),e}();e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return new Blob([e.readByteArray()])}function a(e){return new s["default"](function(t,n){var r=new FileReader;r.addEventListener("loadend",function(){t(l["default"].build(r.result))}),r.addEventListener("error",function(e){return n(e)}),r.readAsArrayBuffer(e)})}var o=n(2),s=r(o),c=n(13),l=r(c),u=n(1547),d=r(u);e.exports=function(e){return s["default"].all(e.map(function(e){var t=e.blob;return a(t)})).then(function(t){var n=new d["default"];return t.forEach(function(t,r){return n.add(t,e[r].name)}),i(n.create())})}},function(e,t){"use strict";function n(e,t){for(o||(o=r());e.size();)t=o[255&(t^e.readUint8())]^t>>>8;return~t>>>0}function r(){for(var e=new Uint32Array(256),t=0,n=0,r=0;t<256;n=++t){for(r=0;r<8;++r)n=1&n?n>>>1^i:n>>>1;e[t]=n}return e}Object.defineProperty(t,"__esModule",{value:!0});var i=3988292384,a=4294967295,o=void 0;t["default"]=function(e){var t=arguments.length<=1||void 0===arguments[1]?a:arguments[1];return e.peek(n,t)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return(t<<6|n)<<5|r/2}function a(e){var t=e.getFullYear()-1980,n=e.getMonth()+1;return(t<<4|n)<<5|e.getDate()}function o(e){var t=(0,m["default"])(e,2),n=t[0],r=t[1],o=r.path,s=r.crc,c=r.date,l=new _["default"](S+o.length,(!0));return l.writeUint32(w),l.writeUint8(x),l.writeUint8(k),l.writeUint16(0),l.writeUint16(T),l.writeUint16(i(c)),l.writeUint16(a(c)),l.writeUint32(s),l.writeUint32(n.size()),l.writeUint32(n.size()),l.writeUint16(o.length),l.writeUint16(0),l.writeString(o),l}function s(e,t){var n=(0,m["default"])(e,2),r=n[0],o=n[1],s=o.path,c=o.crc,l=o.date,u=new _["default"](M+s.length,(!0));return u.writeUint32(E),u.writeUint8(x),u.writeUint8(k),u.writeUint8(x),u.writeUint8(k),u.writeUint16(0),u.writeUint16(T),u.writeUint16(i(l)),u.writeUint16(a(l)),u.writeUint32(c),u.writeUint32(r.size()),u.writeUint32(r.size()),u.writeUint16(s.length),u.writeUint16(0),u.writeUint16(0),u.writeUint16(0),u.writeUint16(0),u.writeUint32(0),u.writeUint32(t),u.writeString(s),u}function c(e,t,n){var r=new _["default"](C,(!0));return r.writeUint32(b),r.writeUint16(0),r.writeUint16(0),r.writeUint16(e),r.writeUint16(e),r.writeUint32(t),r.writeUint32(n),r.writeUint16(0),r}function l(e){return e.replace(/\\/,"/").replace(N,"")}Object.defineProperty(t,"__esModule",{value:!0});var u=n(23),d=r(u),p=n(26),h=r(p),f=n(146),m=r(f),g=n(1546),v=r(g),y=n(13),_=r(y),E=33639248,b=101010256,w=67324752,M=46,C=22,S=30,T=0,k=0,x=10,N=/[^\x00-\x7F]/g,P=function(){function e(){(0,d["default"])(this,e),this.files=[]}return(0,h["default"])(e,[{key:"add",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?new Date:arguments[2];this.files.push([e,{crc:(0,v["default"])(e),path:l(t),date:n}])}},{key:"create",value:function(){var e=0,t=0,n=0,r=[],i=[];this.files.forEach(function(a,c){var l=(0,m["default"])(a,1),u=l[0],d=u.size(),p=o(a),h=s(a,n),f=p.size()+d;n+=f,e+=f+h.size(),t+=h.size(),i.push(p,u),r.push(h)});var a=c(this.files.length,t,n),l=new _["default"](e+a.size(),(!0));return l.write.apply(l,i.concat(r,[a])),l}}]),e}();t["default"]=P},function(e,t,n){e.exports=n.p+"img/600127bdb5f7627ede5cd4ef320f55b0.png"},function(e,t){e.exports=[65,26,32,26,73,1,11,1,5,1,6,23,24,31,32,449,451,7,21,2,16,5,14,1,130,4,6,2,4,4,5,1,7,1,2,3,4,1,2,20,21,83,84,140,147,166,167,38,40,7,8,39,40,1,7,-1,46,-1,2,-1,3,-1,3,-1,2,-56,64,-1,3,-1,2,-1,14,-48,82,-3,4,-101,116,-2,9,-2,12,-23,24,-30,57,-91,102,-58,67,-2,6,-28,32,-1,10,-1,4,-1,6,-43,46,-135,167,55,56,1,2,4,12,4,5,3,10,10,12,29,30,2,3,8,10,2,4,22,23,7,8,1,4,4,7,4,10,2,4,2,3,1,9,1,5,2,3,3,7,12,14,7,15,1,2,6,10,2,4,22,23,7,8,2,3,2,3,2,6,3,27,4,5,1,8,10,12,3,17,1,2,9,10,3,4,22,23,7,8,2,3,5,8,4,12,1,2,2,5,1,16,2,6,11,19,1,9,2,3,8,10,2,4,22,23,7,8,2,3,5,8,2,3,1,7,2,4,2,12,1,5,2,3,3,7,18,29,1,2,6,9,3,4,4,7,2,3,1,2,2,5,2,5,3,6,12,16,2,3,2,5,3,4,3,6,1,7,1,15,13,27,3,4,8,9,3,4,23,24,16,19,1,4,4,23,3,8,2,6,10,25,1,3,2,3,8,9,3,4,23,24,10,11,5,8,8,9,3,4,2,11,2,9,1,2,2,6,10,11,2,17,2,3,8,9,3,4,41,43,4,9,3,4,3,4,1,9,1,8,3,7,16,19,7,9,2,3,18,21,24,25,9,10,1,3,7,15,3,9,8,14,10,12,3,15,48,49,2,14,7,15,13,50,2,3,1,3,2,3,1,3,1,7,4,5,7,8,3,4,1,2,1,3,2,3,4,5,2,11,1,3,5,6,1,10,10,12,4,36,24,26,27,28,1,2,1,6,10,11,36,54,1,6,1,3,5,54,8,9,6,7,13,50,45,49,1,7,1,3,2,4,25,27,4,7,16,20,13,14,2,4,6,7,15,16,40,41,1,6,1,3,377,378,4,6,7,8,1,2,4,6,41,42,4,6,33,34,4,6,7,8,1,2,4,6,15,16,57,58,4,6,67,72,29,32,16,32,86,88,6,9,639,640,26,31,89,96,13,14,4,18,18,21,2,11,18,32,13,14,3,18,52,54,1,8,8,9,2,13,7,8,1,4,10,48,10,16,88,96,41,42,1,6,70,80,31,35,4,6,3,7,2,3,6,19,40,42,5,16,44,48,26,32,11,48,23,25,2,5,56,57,1,10,1,2,2,10,6,19,10,16,10,16,14,100,48,49,1,6,1,2,5,6,9,13,27,36,9,14,32,36,2,4,1,4,56,57,1,3,3,4,1,4,2,10,48,56,2,7,15,18,51,115,8,19,1,14,1,8,4,5,6,7,2,11,192,256,278,280,6,8,38,40,6,8,8,9,1,2,1,2,1,2,31,33,53,54,7,8,1,4,3,4,7,10,4,6,6,10,13,18,3,4,7,24,1,1,-1,98,1,14,1,17,13,114,1,5,1,3,10,11,1,4,5,11,1,2,1,2,1,2,4,5,11,13,4,9,5,9,2,18,41,470,69,95,1,263,78,528,1,340,256,1024,47,48,47,48,133,139,4,7,2,14,38,39,1,6,1,3,56,63,2,17,23,32,7,8,7,8,7,8,7,8,7,8,7,8,7,8,7,557,3,28,9,13,2,3,5,7,5,9,86,92,3,4,90,91,4,9,41,44,94,95,43,96,45,48,48,64,28,31,50,65,12,16,47,48,119,123,99,101,31,32,6582,6656,20950,20992,1165,1232,317,320,28,48,47,64,30,32,80,82,6,48,102,103,37,39,8,71,11,12,3,4,4,5,25,27,1,9,8,16,52,64,68,78,12,36,12,14,38,46,25,36,2,13,30,36,48,49,2,6,2,3,17,18,11,15,7,8,25,26,41,47,2,4,2,13,3,4,8,9,1,3,10,12,32,33,51,52,1,4,2,4,5,7,1,2,1,25,17,19,8,19,6,8,6,8,6,15,7,8,7,8,54,64,117,118,2,3,4,7,10,16,11172,11184,23,27,49,2101,6766,6768,106,144,7,19,5,10,-1,2,-10,11,-532,534,-144,176,-13,14,-2,114,-143,177,26,32,26,37,89,92,6,8,6,8,6,8,3,38,12,13,26,27,19,20,2,3,15,17,14,48,123,128,1,2,1,5,45,48,9,153,45,176,29,32,49,96,36,48,27,32,38,48,30,31,37,41,14,56,158,160,10,96,40,48,52,63,1,145,311,320,22,32,8,160,-287,288,-225,228,-1,3,-5,9,-40,43,-4,5,-165,167,-82,89,-800,831,-385,385,1,2,54,69,7,31,10,28,49,53,2,4,7,21,25,32,10,19,36,41,1,10,14,26,35,36,3,14,52,61,11,14,1,3,16,17,20,31,18,19,28,31,2,3,1,3,6,72,7,8,1,2,4,5,15,16,11,17,47,48,3,16,10,18,2,3,8,10,2,4,22,23,7,8,2,3,5,8,3,4,4,6,2,4,3,5,1,7,1,6,7,291,51,57,1,2,4,6,1,3,4,12,10,176,50,56,4,6,1,3,27,63,51,59,2,3,1,3,4,15,10,48,43,44,1,2,2,8,1,10,10,64,26,32,2,6,1,10,16,368,83,95,1,449,57,1344,922,1024,111,112,5,16,196,2944,1071,5120,583,9216,569,576,31,32,10,14,2,98,30,37,1,11,48,55,15,25,10,11,7,8,21,26,19,899,69,80,47,67,13,16493,2,3072,107,112,13,16,9,16,10,12,1,3,1,4961,246,256,39,41,62,65,9,25,2,9,30,34,59,434,18,160,85,86,71,72,2,4,1,3,2,4,4,5,12,13,1,2,7,8,65,66,4,6,8,9,7,8,28,29,4,5,5,6,1,4,7,8,340,342,51,52,57,58,57,58,57,58,57,58,8,60,512,567,4,54,8,9,14,15,7,3451,-208,215,-1561,1563,-270,542,31,32,58,64,43,118,29,42,43,48,9,16,2,3504,42711,42752,4149,4160,222,224,5762,16352,542,788480,65534,65536,65534]},function(e,t){e.exports={1:["🕐","🕜"],2:["🕑","🕝"],3:["🕒","🕞"],4:["🍀","🕓","🕟"],5:["🕔","🕠"],6:["🕕","🕡"],7:["🕖","🕢"],8:["🎱","🕗","🕣"],9:["🕘","🕤"],10:["🕙","🕥"],11:["🕚","🕦"],12:["🕛","🕧"],18:["🔞"],30:["🕧","🕜","🕝","🕞","🕟","🕠","🕡","🕢","🕣","🕤","🕥","🕦"],100:["💯"],143:["😍","😘","💗","💖","😗","😙","😚","💝","💏","💑","💟","💙","💚","💛","💜","💞","💘","💓","💕"],1234:["🔢"],"!":["❕","❗"],"+1":["👍"],"-1":["👎"],"...":["😒"],"10:00":["🕙"],"10:30":["🕥"],"11:00":["🕚"],"11:30":["🕦"],"12:00":["🕛"],"12:30":["🕧"],"1:00":["🕐"],"1:30":["🕜"],"2:00":["🕑"],"2:30":["🕝"],"3:00":["🕒"],"3:30":["🕞"],"4:00":["🕓"],"4:30":["🕟"],"5:00":["🕔"],"5:30":["🕠"],"6:00":["🕕"],"6:30":["🕡"],"7:00":["🕖"],"7:30":["🕢"],"8 ball":["🎱"],"8:00":["🕗"],"8:30":["🕣"],"9:00":["🕘"],"9:30":["🕤"],"?":["❔","❓"],"a+":["💯"],abc:["🔤"],abcd:["🔡"],abraham:["🎩"],absolutely:["👊"],accomplished:["✅"],action:["🎬"],actor:["🎭"],actress:["🎭"],admission:["🎫","🎟"],adorbs:["😘","💘","💞","🐶"],aerial:["🚡"],afraid:["😨"],again:["🔄"],agree:["👊"],airplane:["✈","🛩","🛫","🛬"],alarm:["⏰"],alcohol:["🍻","🍺","🍷","🍸","🍹"],alien:["👽","👾"],aliens:["📡"],almond:["🌰"],alphabet:["🔤"],amble:["🚶"],ambulance:["🚑"],amtrak:["🚄","🚅"],"amusement park":["🎡","🎢"],anchor:["⚓","🔱"],angel:["😇","👼"],angelic:["😇"],angels:["😇"],anger:["😡","😤","😠"],angle:["📏","📐"],angry:["😡","😤","😠","💢","🗯"],anguished:["😧"],animal:["🐵","🙈","🙉","🙊","🐱","😸","🐶","🐮","🐷","🐴","🐙","🐳","🐨","🐒","🐯","🐕","🐺","😹","😺","😻","😼","😽","😾","🙀","🐩","😿","🐈","🐋","🐅","🐆","🐎","🐂","🐹","🐃","🐄","🐖","🐗","🐽","🐏","🐑","🐐","🐪","🐫","🐘","🐭","🐁","🐟","🐀","🐰","🐇","🐻","🐼","🐔","🐓","🐣","🐤","🐥","🐦","🐧","🐸","🐊","🐢","🐍","🐲","🐉","🐬","🐠","🐡","🐚","🐌","🐛","🐜","🐝","🐞"],animals:["🐕","🐈","🐖","🐄","🐇","🐏","🐅","🐆","🐂","🐃","🐐","🐁","🐓","🐊"],anniversary:["💝","💐","💕","💏","💑","💞"],ant:["🐜"],antartica:["🐧"],antenna:["📡","📶"],anxious:["😥","😨","😟"],apology:["🙇"],applause:["👏"],apple:["🍎","🍏"],approval:["👏"],aquarius:["♒"],arid:["🌵"],aries:["🐏"],arrived:["🛄","🚆","🚈"],art:["🎭","🎨","🖼"],arty:["🎨"],ask:["🙏"],astonished:["😲"],astronomy:["⭐"],atheist:["⚛"],athletic:["👟"],atm:["🏧"],atom:["⚛"],aubergine:["🍆"],australia:["🐨"],automated:["🏧"],automobile:["🚗","🚘"],autumn:["🍂"],awesome:["👍","😎","😃","👌","🎉","👏","😛","✨"],awful:["😔","😞","😢"],awk:["😐","😑","😬","😳"],awkward:["😐","😑","😬","😳","😶"],aye:["✊"],baa:["🐑"],babies:["👶","🍼"],baby:["👶","👼","🚼","🍼","🐣","🐤","🐥"],back:["🔙"],"back door":["🚪"],backpack:["🎒"],bacon:["🐷","🐖"],bactrian:["🐫"],bad:["👎","😐","😑"],"bad haircut":["👵"],badge:["📛"],bae:["😍","😘","😚","💏","💑","👫","👬","👭"],bag:["👜","🎒","👝","🛍","💰"],baggage:["🛄","🛅"],bags:["🛄"],bald:["👴"],ball:["🏈","🏀","🎱","🏉","🎾","🎳","🔮","🏌","⛹","🍙","🎊","⚽","⚾","🏐","🏏","🏑","🏓"],balling:["😭"],balloon:["🎈","💬","🗯","💭"],ballot:["☑","🗳"],bamboo:["🎍","🐼"],banana:["🍌","🐵","🐒"],bangs:["👧"],bank:["💰","🏧","💵","💸","💳","🏦","💴","💶","💷","💹","💱"],banknote:["💵","💸","💶","💴","💷"],banner:["🎋"],bar:["🍻","🍺","🍹","🍷","🍸","📶","🍫","🍶","🍾","🏮","📊","⏸"],barber:["💇","💈"],barrel:["🍯"],barrier:["🚧"],bars:["📶"],bart:["🚈","🚉","🚊"],baseball:["⚾"],basic:["😐","😑"],basketball:["🏀"],bath:["🛀","🛁"],"bathing suit":["👙"],bathroom:["🚽"],bathtub:["🛀","🛁"],battery:["🔋"],beach:["🌴","🌞","🏄","😎","🍹","🍍","🐚","👙","🐳","🐋","🐬","🏖"],bear:["🐻","🍯","🐨"],beast:["💪"],beauty:["🌹","👄","💇"],bed:["😴","🛏"],bedtime:["😴"],bee:["🐝"],beef:["🍖"],beer:["🍺","🍻"],beetle:["🐞"],befuddled:["😕"],beg:["🙏"],bell:["🔔","🛎","🎐","🔕"],"belmont stakes":["🐴","🐎"],"bench press":["💪"],bento:["🍱"],berry:["🍓"],bestest:["💜"],bestfriend:["👭"],bestfriends:["👭"],bestie:["👭"],bet:["💰"],beyonce:["💍"],bff:["👭","👥","👯"],bible:["😇"],biceps:["💪"],bicycle:["🚲","🚴","🚵","🚳"],bicyclist:["🚴","🚵"],"big cat":["🐯","🐅","🐆"],bike:["🚲","🚴","🚵","🚳"],"bike gang":["🚲"],"bike lock":["🔐"],bikini:["👙"],bill:["💵","💸","💴","💶","💷"],billiard:["🎱"],billion:["💰","💲","💸","💷"],billionaire:["🚤"],biohazard:["☣"],bird:["🐣","🐤","🐦","🕊"],birds:["🐓"],birth:["🍼"],birthday:["🎈","✨","🎉","🎂","💐"],blame:["😠","😞","😨","😳"],bless:["⛪"],blessed:["😇"],blond:["👵","👱"],blonde:["👩","👱"],blondie:["👩","👵","👱"],blossom:["🌸","🌼","🌷"],blouse:["👚"],blowfish:["🐡"],"blu-ray":["💿","📀"],blue:["😰","💙","👕","👖","📘","🔷","🔹","🔵"],blush:["😊","😚"],boar:["🐗"],boat:["⛵","🚣","🚤","⛴","🛥","🚢"],body:["💪","👀","👃","👣","👅","💀","👄","👂","👁"],bolt:["🔩"],bomb:["💣","💥"],bond:["👭"],bonding:["👭"],bone:["🍖","🍗"],book:["📚","📖","📘","📗","📙","📕","📔"],bookbag:["🎒"],bookmark:["🔖","📑"],books:["📚"],boom:["💣","👊","💥","🎆","🎇"],boot:["👢"],booze:["🍷","🍸","🍻","🍺","🍹"],bored:["😒","😔"],born:["🍼"],boss:["😏"],botany:["🌿"],bottle:["🍼","🍶","🍾"],"bottoms up":["🍻"],bouquet:["💐"],bow:["🙏","🙇","🏹"],bowl:["🍜"],bowling:["🎳"],box:["📦","🎁","🍱","📤","📥","🗳","🗃","☑"],boy:["👦","👨","👨‍👩‍👧‍👦","👨‍👩‍👦‍👦","👨‍👨‍👦","👨‍👨‍👧‍👦","👨‍👨‍👦‍👦","👩‍👩‍👦","👩‍👩‍👧‍👦","👩‍👩‍👦‍👦","👨‍👦","👨‍👦‍👦","👨‍👧‍👦","👩‍👦","👩‍👦‍👦","👩‍👧‍👦"],boyfriend:["👨"],boys:["👬"],brb:["🔜"],bread:["🍞"],"break":["💔"],breakfast:["🍴","🍳"],breaky:["🍴"],bride:["👰"],bridge:["🌉"],briefcase:["💼"],
bright:["😎","☀","🌝","🌞","🌟","🌠","🔆"],"bright-eyed":["👧"],brightness:["🔆","🔅"],bro:["😎","👨","👊","💪"],broken:["💔"],brown:["👞"],bruh:["👊","💯"],buddhist:["☸"],buffalo:["🐃"],bug:["🐛"],build:["📲"],building:["🏫","🏢","🌆","🌇","🏠","🏡","🏤","🏯","⛪","🏣","🏥","🏦","🏨","🏩","🏪","🏬","🏭","🏰"],bulb:["💡"],bull:["🐂","🎯","♉"],bullet:["🚅"],bullseye:["🎯"],bumblebee:["🐝"],bump:["👊"],bunny:["🐇","🐰","👯"],burger:["🍔"],burn:["🔥"],bus:["🚌","🚋","🚍","🚎","🚐","🚏"],busstop:["🚏"],bust:["👤","👥"],buttercup:["🌼"],butterflies:["😟"],cab:["🚕","🚖"],cabbie:["🚕","🚖"],cable:["🚠","🚡"],caboose:["🚂"],cactus:["🌵"],caffeine:["☕"],cake:["🍰","🎂","🍥"],calendar:["📅","📆","🗓"],calm:["😌"],camcorder:["📹"],camel:["🐪","🐫"],camera:["📷","🎥","🎦","📹","📸"],camp:["🌲"],camping:["⛺","🏕"],"cant even":["😶"],"cant watch":["🙈"],candy:["🍭","🍫","🍬"],cantaloupe:["🍈"],cap:["🎓"],capricorn:["🐐","♑"],car:["🚙","🚘","🚕","🚚","🚛","🏎","🚃","🚞","🚋","🚓","🚔","🚗","🚨","🚡"],carbs:["🍞"],cardiac:["💛"],cardio:["💓"],carousel:["🎠"],cars:["🚘","🚍","🚖"],cartoon:["💭"],"case":["🛄","🛅"],cash:["💰","💸","🏧","💲","💳","💷"],casino:["🎰"],castle:["🏰","🏯"],casual:["👕","👖"],cat:["🐱","🐈","😺","😸","😹","😻","😼","😽","🙀","😿","😾"],cats:["🐈"],"caught off guard":["😦"],cavities:["🍬"],cd:["💿","📀"],celebrate:["🎈","🎉"],celebration:["🎈","🎉","🎂","🎆","🎊","🎇","🎁","🎀","🎅","🎃","🎄","🎏","🎓","🙌","🎋","🎍","🎎","🎐","🎑","🎗","🎖","🎌"],cell:["📱","📳","📲","📶","📵","📴"],chair:["💺"],chapel:["⛪","💒"],charge:["💳","💲"],chart:["📈","📉","📊","💹"],check:["✅","✔","☑"],checked:["🛄","✅"],"checked off":["✅","✔","☑"],checkered:["🏁"],checking:["✅"],cheerful:["😀"],cheers:["🍻"],cheery:["😀"],chef:["🔪"],chequered:["🏁"],cherry:["🍒","🌸"],chestnut:["🌰"],chicken:["🐔","🍗"],child:["👪","🚸"],chocolate:["🍫"],"choo choo":["🚆"],choppy:["🌊"],christ:["✝"],christian:["✝","☦"],christmas:["🎅","🎄"],"christmas tree":["🌲"],church:["⛪","👼"],cigarette:["🚬"],cinema:["🎥","🎦","🎞","📽"],circus:["🎪"],citrus:["🍊","🍋","🍍"],city:["🌆","🏢","🏙"],clap:["👏"],clearly:["👊","💯"],clenched:["✊","👊"],clink:["🍻"],clipboard:["📋"],clock:["⏰","⌚","⏱","⏲","🕰","🕛","🕧","🕐","🕜","🕑","🕝","🕒","🕞","🕓","🕟","🕔","🕠","🕕","🕡","🕖","🕢","🕗","🕣","🕘","🕤","🕙","🕥","🕚","🕦"],clockwise:["🔁","🔂","🔃"],"close call":["😥"],closed:["😚","📕","🔒","📫","📪","🔐"],"closed eyes":["😙"],closet:["🚪","🚾"],clothes:["👕","👖","👗","👒","👟","👞","👚","🎩","👠","👢","👛","👜","👝"],clothing:["👔","👕","👖","👗","👙","👚","👢","👞","👒","🎩","👑","👘","👟","👠","👡","☔","👣","👓","👛","👜","👝","🎓","📿","🌂","☂"],cloud:["💭","☁","⛅","⛈","🌤","🌥","🌦","🌧","🌨","🌩","🌪","🌫","🌬"],clover:["🍀"],club:["🍷","🍸","🍹","🍻","♣"],clubs:["♣"],coaster:["🎢"],cocktail:["🍸","🍹"],cocoa:["🍫"],coffee:["☕"],coffin:["⚰"],colada:["🍍"],cold:["❄","⛄","😓","😷","😰","💧","😅","🏔","🌨","☃"],collage:["📌"],collar:["👕","👚"],collide:["💥"],collision:["💥"],colorful:["🎨"],comfortable:["👘"],comic:["💭","💥","💣","💪","💨","💩","💦","💫","💬","💡","💤","💢","💧","💠"],communication:["📱","📲","📞","📠","📰","📳","📶","📢","📟","📩","📦","📫","📝"],complete:["✅"],completed:["✅"],complicated:["😥"],computer:["💻","💽","💾","🖥","🖨","⌨","🖱","🖲","💿","📀"],concentrate:["😣"],concentration:["😣"],conch:["🐚"],confectionary:["🍭"],confetti:["🎊"],confounded:["😖"],confused:["😕","😖"],confusing:["😕"],congrats:["👏"],congratulations:["👏"],construction:["👷","🚧","🚩","🏗"],contact:["📡","🔭","🔎"],controller:["🎮"],convenience:["🏪"],cooked:["🍚"],cookie:["🍪"],cooking:["🍴","🍳","🔪","🍽","🏺"],cool:["😎","🆒","😛"],coolstorybro:["😒"],cop:["👮"],copyright:["©"],corn:["🌽"],correct:["👊"],cosmetics:["💄","💅"],cost:["💰","😑","😫","😲"],"country home":["🏠","🏡"],couple:["💏","💑","👫","👬","👭"],cover:["📔"],cow:["🐮","🐄"],cracked:["🔓"],crazy:["😜"],cream:["🍨","🍦"],creative:["🎨"],creature:["👾","👹","👻","👽","🐙","👺"],credit:["💳"],crescent:["🌙","🌒","🌘"],crocodile:["🐊"],crops:["🌽"],crossed:["🔀","⚔","🎌"],crossing:["🚸"],crown:["👑","👸"],cruise:["🚣"],crushed:["💔"],cry:["😢","😭","😿"],crying:["😢","😭","😩","😂"],cubical:["🏢"],cupid:["💘"],"curious george":["🐵"],curls:["💪"],currency:["💲","💵","💴","💶","💷","💹","💱"],current:["🆕"],curry:["🍛"],custard:["🍮"],customs:["🛃"],cut:["✂"],"cutting edge":["🆕"],cya:["👋"],cycle:["🚲"],cycling:["🚲"],cyclist:["🚲","🚴","🚵"],cyclone:["🌀"],dancer:["💃","👯"],dandelion:["🌼"],danger:["⚡"],dangerous:["💣"],dango:["🍡"],dapper:["😏"],dart:["🎯"],data:["📈","📉","📊"],date:["😗","😙","😚","💏","💘","💕","💄","💐","📅"],dating:["😗","😙","😚","💕","👫","👬","👭","💋"],daughter:["👧"],daughters:["👭"],david:["✡"],day:["🌞"],daydream:["💭"],dazed:["😳"],dead:["💀","😐","😑","😳","😵"],deadpan:["😐"],death:["💀","⚰","⚱","☠"],deciduous:["🌳"],decisions:["💭"],decorated:["📔"],dejavu:["🔄"],dejected:["😔","😞"],deleted:["❎"],delicious:["😋","🍑"],delivering:["📨"],delivery:["🚚","📦"],denim:["👖"],dentist:["😷","😬"],department:["🏬"],dermatologist:["😷"],desert:["🐫","🌵","🏜","🏝"],desrt:["🐪"],dessert:["🍪","🍩","🍧","🍦","🍨","🎂","🍰","🍫","🍡","🍬","🍭","🍮"],devil:["👿"],dharma:["☸"],dialog:["💬","🗨"],diamond:["💎","💍","💠","🔶","🔷","🔸","🔹"],dice:["🎲"],died:["😔"],diet:["🍎"],difficult:["☯","✝"],dim:["🔅"],dinner:["🍴","🍗","🍔","🍕","🐟"],dionyses:["🍇"],disappointed:["😞","😥"],disgruntled:["🙍"],dish:["📡"],dislike:["👎"],distraught:["😖"],diva:["💁"],division:["➗"],dizzy:["😵","💫","🌀"],"do not pass":["⛔"],doctor:["😷","🏥","💊","💉"],document:["📃","📄"],dog:["🐶","🐕","🐩"],dogs:["🐕"],dollar:["💸","💲","💵","💰"],dolphin:["🐬"],donatello:["🐢"],done:["✅","☑","✔"],donut:["🍩"],"doo doo":["💩"],door:["🚪"],dope:["👌","👍"],doughnut:["🍩"],"down under":["🐨"],downward:["📉"],dr:["😷"],dragon:["🐲","🐉"],drawing:["✏"],dream:["💭"],dreams:["💭","🌜","✨","🌒"],dress:["👗","👢","👠","👛","👜","👝","👚"],dressage:["🐴"],dressed:["👕","👖","👗","👚"],drink:["🍷","🍸","🍵","🍹","🍺","🍻","🍶","🍼","☕","🍾","🏺"],drinking:["🍷","🍸","🍹","🍺","🍻","🚰"],drinks:["🍷","🍸","🍹","🍺","🍻"],drive:["🚐","🚕","🚙","🚚","🚛"],driving:["😎","🚗"],dromedary:["🐪"],drop:["💧","☔"],droplet:["💧","💦"],droplets:["💦"],drought:["🌵"],drove:["🚘","🚖","🚦"],drugs:["💊"],drunk:["🍹"],dry:["🚱"],dude:["👱"],dul:["✈"],dundy:["🐊"],dung:["💩"],dusk:["🌆","🌇"],dvd:["💿","📀"],"e-mail":["✉","📨","📩","📧"],"e.t.":["🔭"],ear:["👂","🌽","🌾"],earbud:["🎧"],ears:["👂"],earth:["🌻","🌍","🌎","🌏","🌐"],east:["➡"],eat:["🍴","🍔"],education:["🎓","📔","📕","📖","📗","📘","📙","📚","🎒"],eek:["😰"],egg:["🍳","🐣"],eggplant:["🍆"],eight:["🎱","8⃣","🕗","🕣"],elderly:["👴"],electric:["💡","🚃","🔌","⚡","🔦"],electricity:["🔌","⚡"],elegant:["💃","🌹"],elephant:["🐘"],eleven:["🕚","🕦"],email:["✉","📧","📨","📩","📤","📥"],embarassed:["😳","🙈"],emergency:["🚑","🚨"],emotion:["❤","💘","💓","💔","💕","💋","💖","💗","💙","💚","💛","💜","💝","💞","💟","♥"],employed:["👔"],end:["🔚"],engaged:["💍"],engagement:["💍","💎"],engine:["🚂","🚒"],entertainment:["🎸","🎲","🎮","🎯","🎠","🎨","🎢","🎭","🎆","🎣","🃏","🎵","🎤","🎷","🎹","🎺","🎻","📻"],envelope:["✉","📨","📩"],epic:["😜","😯","😱"],equine:["🐴"],eruption:["🌋"],escargot:["🐌"],euro:["💶"],europe:["🌍"],evening:["🌆"],evergreen:["🌲"],everyone:["👥","👫","👬","👭"],evil:["🙈","🙉","🙊"],ewe:["🐑"],exchange:["💱"],excited:["🎉","😅","👏","👻","💖","💗"],exclamation:["❗","❕","⁉","‼","❣"],exercise:["😳","🙆"],experiment:["🔬"],explode:["💥"],explosion:["💣"],expressionless:["😑"],extraterrestrial:["👽","👾"],eye:["👀","😜","😎","😁","😄","😊","😍","😙","😚","😝","😸","😻","😽","👁","👓","🕶","🎯"],eyebrows:["😏"],eyeglasses:["👓"],eyewear:["😎","👓","🕶"],face:["😀","😄","😆","😉","😊","😋","😎","😍","😘","😚","☺","😇","😐","😑","😶","😏","😣","😥","😮","😯","😪","😫","😴","😌","😛","😜","😝","😒","😓","😔","😕","😖","😲","😞","😟","😤","😢","😭","😦","😧","😨","😩","😬","😰","😱","😳","😵","😡","😠","👿","😈","👹","👺","🗿","😁","😂","😃","😅","😗","😙","🙂","🤗","🤔","🙄","🤐","🤓","🙃","🤑","☹","🙁","😷","🤒","🤕","💀","☠","👻","👽","👾","🤖","💩","😺","😸","😹","😻","😼","😽","🙀","😿","😾","🙈","🙉","🙊","👼","💆","🗣","👀","⛑","🐵","🐶","🐺","🐱","🦁","🐯","🐴","🦄","🐮","🐷","🐽","🐭","🐹","🐰","🐻","🐼","🐸","🐲","🐳","🌚","🌛","🌜","🌝","🌞","🌬"],factory:["🏭"],fail:["😞","😩","⛔"],"fairy tale":["🐲","😇","👿","😈","👸","🎅","👼","👹","👻","💀","👽","👾","🐉","🔮"],faithful:["💯"],family:["👪","👨‍👩‍👧","👨‍👩‍👧‍👦","👨‍👩‍👦‍👦","👨‍👩‍👧‍👧","👨‍👨‍👦","👨‍👨‍👧","👨‍👨‍👧‍👦","👨‍👨‍👦‍👦","👨‍👨‍👧‍👧","👩‍👩‍👦","👩‍👩‍👧","👩‍👩‍👧‍👦","👩‍👩‍👦‍👦","👩‍👩‍👧‍👧","👨‍👦","👨‍👦‍👦","👨‍👧","👨‍👧‍👦","👨‍👧‍👧","👩‍👦","👩‍👦‍👦","👩‍👧","👩‍👧‍👦","👩‍👧‍👧"],fancy:["👗","👛","🎩"],fantasy:["👹","😇","👿","😈","👸","🎅","👼","👺","👻","👽","👾","📖","📗","📘","📙","📚","🔮"],farm:["🐴","🐎","🐮","🐷","🐂","🐄","🐖","🐽","🐑","🐐","🌽"],fart:["💨"],fast:["🏃","👟","💨","⏩"],"fast food":["🍔","🍟"],fat:["🐖"],fax:["📠"],fear:["😨","😱"],fearful:["😨","😱"],feed:["🍴"],feels:["😂","😍","😫","😓","😖","😤","😢","😩","😵","😡","😠"],feet:["👞","🐾"],felicia:["👋"],ferris:["🎡"],fetch:["💁"],fighting:["✊"],file:["📁","📂","🗃","🗄"],film:["🎥","🎦","🎞","📽"],finish:["🏁"],fire:["🔥","🚒"],fireworks:["🎆","🎇"],fish:["🐟","🐠","🐡","🎣","🍥","♓"],fishes:["🐟","🐠"],fishing:["🐟","🚣"],fist:["👊","✌","✊"],five:["✋","5⃣","🕔","🕠"],fixed:["✅"],flag:["🏁","🚩","🇦🇩","🇦🇪","🇦🇫","🇦🇬","🇦🇮","🇦🇱","🇦🇲","🇦🇴","🇦🇶","🇦🇷","🇦🇸","🇦🇹","🇦🇺","🇦🇼","🇦🇽","🇦🇿","🇧🇦","🇧🇧","🇧🇩","🇧🇪","🇧🇫","🇧🇬","🇧🇭","🇧🇮","🇧🇯","🇧🇱","🇧🇲","🇧🇳","🇧🇴","🇧🇶","🇧🇷","🇧🇸","🇧🇹","🇧🇼","🇧🇾","🇧🇿","🇨🇦","🇨🇨","🇨🇩","🇨🇫","🇨🇬","🇨🇭","🇨🇮","🇨🇰","🇨🇱","🇨🇲","🇨🇳","🇨🇴","🇨🇷","🇨🇺","🇨🇻","🇨🇼","🇨🇽","🇨🇾","🇨🇿","🇩🇪","🇩🇯","🇩🇰","🇩🇲","🇩🇴","🇩🇿","🇪🇨","🇪🇪","🇪🇬","🇪🇭","🇪🇷","🇪🇸","🇪🇹","🇪🇺","🇫🇮","🇫🇯","🇫🇰","🇫🇲","🇫🇴","🇫🇷","🇬🇦","🇬🇧","🇬🇩","🇬🇪","🇬🇫","🇬🇬","🇬🇭","🇬🇮","🇬🇱","🇬🇲","🇬🇳","🇬🇵","🇬🇶","🇬🇷","🇬🇸","🇬🇹","🇬🇺","🇬🇼","🇬🇾","🇭🇰","🇭🇳","🇭🇷","🇭🇹","🇭🇺","🇮🇨","🇮🇩","🇮🇪","🇮🇱","🇮🇲","🇮🇳","🇮🇴","🇮🇶","🇮🇷","🇮🇸","🇮🇹","🇯🇪","🇯🇲","🇯🇴","🇯🇵","🇰🇪","🇰🇬","🇰🇭","🇰🇮","🇰🇲","🇰🇳","🇰🇵","🇰🇷","🇰🇼","🇰🇾","🇰🇿","🇱🇦","🇱🇧","🇱🇨","🇱🇮","🇱🇰","🇱🇷","🇱🇸","🇱🇹","🇱🇺","🇱🇻","🇱🇾","🇲🇦","🇲🇨","🇲🇩","🇲🇪","🇲🇬","🇲🇭","🇲🇰","🇲🇱","🇲🇲","🇲🇳","🇲🇴","🇲🇵","🇲🇶","🇲🇷","🇲🇸","🇲🇹","🇲🇺","🇲🇻","🇲🇼","🇲🇽","🇲🇾","🇲🇿","🇳🇦","🇳🇨","🇳🇪","🇳🇫","🇳🇬","🇳🇮","🇳🇱","🇳🇴","🇳🇵","🇳🇷","🇳🇺","🇳🇿","🇴🇲","🇵🇦","🇵🇪","🇵🇫","🇵🇬","🇵🇭","🇵🇰","🇵🇱","🇵🇲","🇵🇳","🇵🇷","🇵🇸","🇵🇹","🇵🇼","🇵🇾","🇶🇦","🇷🇪","🇷🇴","🇷🇸","🇷🇺","🇷🇼","🇸🇦","🇸🇧","🇸🇨","🇸🇩","🇸🇪","🇸🇬","🇸🇭","🇸🇮","🇸🇰","🇸🇱","🇸🇲","🇸🇳","🇸🇴","🇸🇷","🇸🇸","🇸🇹","🇸🇻","🇸🇽","🇸🇾","🇸🇿","🇹🇨","🇹🇩","🇹🇫","🇹🇬","🇹🇭","🇹🇯","🇹🇰","🇹🇱","🇹🇲","🇹🇳","🇹🇴","🇹🇷","🇹🇹","🇹🇻","🇹🇼","🇹🇿","🇺🇦","🇺🇬","🇺🇸","🇺🇾","🇺🇿","🇻🇦","🇻🇨","🇻🇪","🇻🇬","🇻🇮","🇻🇳","🇻🇺","🇼🇫","🇼🇸","🇽🇰","🇾🇪","🇾🇹","🇿🇦","🇿🇲","🇿🇼"],flags:["🏁"],flair:["💃"],flame:["🔥"],flashlight:["🔦"],"flat top":["👱"],fleek:["👌","👍"],"fleur-de-lis":["⚜"],flex:["💪"],flipper:["🐬"],flirt:["😉","😏","😘","😗","😚","😙","👫"],floppy:["💾"],florida:["🐊","🌞"],flower:["🌻","🌺","🌹","🌸","🌷","🌼","💐","💮","🎴"],"flu shot":["💉"],fluffy:["🐩","🐑"],flushed:["😳"],fly:["✈","😎","💸","🕊"],fml:["💩"],focus:["😣"],fog:["🌁","🌫"],folder:["📁","📂"],food:["🍴","🍎","🍔","🍕","🍌","🍳","🍟","🍒","🍇","🍈","🍉","🍊","🍋","🍍","🍏","🍐","🍝","🍑","🍓","🍅","🍆","😋","🍞","🍖","🍗","🍲","🍱","🍘","🍙","🍚","🍛","🍜","🍠","🍢","🍣","🍤","🍥","🍡","🍦","🍧","🍨","🍩","🍪","🎂","🍰","🍫","🍬","🍭","🍮","🍯"],foot:["👞"],football:["🏈","🏉","⚽"],footprint:["👣"],forbidden:["🙊","🚫","🙈","🙉","🙅","🔕","⛔","🚳","🚭","🚯","🚷","📵","🔞"],forest:["🌲","🌳"],forgot:["😮","😧","🙈"],fork:["🍴","🍽"],formal:["🎩"],fortune:["🔮","🔯"],fountain:["⛲","🖋"],four:["🍀","4⃣","🕓","🕟"],frat:["😎"],free:["🆓"],fresh:["🆕"],fried:["🍤"],friend:["👥","👨","👫","👬","👭"],friends:["👫","👬","👭","👥"],friendship:["👭"],fries:["🍟"],frog:["🐸"],"front door":["🚪"],frown:["😦","🙍","☹","🙁"],fruit:["🍎","🍌","🍓","🍒","🍇","🍈","🍉","🍊","🍋","🍍","🍏","🍐","🍑","🍅"],frustrated:["😖","😠"],fry:["🍳"],frying:["🍳"],fuel:["⛽"],fuelpump:["⛽"],fuji:["🗻"],full:["😋","💯","🌝","🌕"],fun:["😜"],funeral:["⚱"],fungus:["🍄"],funny:["😜"],futbol:["⚽"],future:["🔮"],g2g:["👋"],gamble:["🎰"],gambling:["🎰"],game:["👾","🎰","🎯","🎴","🎱","🎳","🎮","🎲","♠","♥","♦","♣","🃏","🏁","🏐","🏏","🏑","🏒","🏓","🏸","🕹","🀄"],"game of thrones":["👑","🐉","🐗"],games:["👾"],garden:["🐞","🐛","🐌","🐜","🏡"],"garden party":["👒"],gas:["⛽"],gasoline:["⛽"],gem:["💎"],germany:["🍺"],germs:["😷"],ghost:["👻"],gift:["🎁"],girl:["👧","👨‍👩‍👧","👨‍👩‍👧‍👦","👨‍👩‍👧‍👧","👨‍👨‍👧","👨‍👨‍👧‍👦","👨‍👨‍👧‍👧","👩‍👩‍👧","👩‍👩‍👧‍👦","👩‍👩‍👧‍👧","👨‍👧","👨‍👧‍👦","👨‍👧‍👧","👩‍👧","👩‍👧‍👦","👩‍👧‍👧"],girls:["👭"],girly:["👭"],glass:["🍷","🍸","🔍","🔎"],glasses:["😎","👓","🕶"],glittery:["🌟"],globe:["🌍","🌐","🌎","🌏"],glow:["🌟"],goat:["🐐","♑"],goblin:["👺"],golf:["⛳","🚩","🏌"],gondola:["🚠","🚡"],gone:["💨"],"goo goo":["👶"],good:["👍"],"good night":["😴","💖"],googley:["👀"],goose:["😎"],gossip:["💁"],gotcha:["👌","👍"],"gotta go":["💨"],graduation:["🎓"],grain:["🍞","🌾"],grains:["🌾"],grape:["🍇"],graph:["📊","📈","📉","💹"],grateful:["✨"],great:["👍","👏"],green:["🍏","🌳","💚","📗","🔰"],grimace:["😬"],grin:["😀","😃","😁","😄","😸"],grizzly:["🐻"],groove:["💃"],gross:["😝"],growing:["💗"],growl:["🐻"],growth:["🌱","🌷","📈","💹"],grub:["🍤"],gtfo:["😲"],gtg:["👋"],guard:["💂"],guardsman:["💂"],guitar:["🎸"],gun:["🔫"],gym:["💪"],habitat:["🌳"],haha:["😂"],"hail a cab":["🚖"],hair:["💇"],haircut:["👩","💇","💈"],halloween:["🎃","👻","🍫","🍬"],halo:["😇"],hamburger:["🍔"],hammer:["🔨","⚒","🛠"],hamster:["🐹"],hand:["✋","👏","🖖","🙋","💁","👌","👍","👊","✊","🙅","🙆","👫","👬","👭","👈","👉","☝","👆","🖕","👇","✌","🤘","🖐","👎","👋","✍","👐","🙌","🙏"],handbag:["👛","👜","👝"],hands:["✋","🙋","🖖"],happy:["😀","😄","😃","😂","😆","🙋"],"happy feet":["🐧"],hardhat:["👷"],hash:["#⃣"],hashtag:["#⃣"],hat:["🎩","👒","👷","👲","🎓","⛑"],hatching:["🐣"],hats:["👒","🎩"],hbd:["💯"],headache:["😣"],headphone:["🎧"],healing:["☮"],health:["🍎"],healthy:["🍏"],hear:["👂","🙉"],"hear no evil":["🙉"],hearing:["👂"],heart:["❤","💖","💗","💓","💞","💕","💙","💚","💛","💜","💘","💟","😍","😘","💏","💑","💝","💋","💌","😻","♥"],heartbeat:["💓"],heartbreaker:["😉"],heartpulse:["💗"],hearts:["💕","😍","♥"],heat:["🌞","😳"],hecka:["👍","👎"],heel:["👠"],hehe:["😂"],helicopter:["🚁"],hella:["👍","👎"],helmet:["💂","⛑"],herb:["🌿"],hibiscus:["🌺"],hide:["🙈"],high:["🔊"],"high five":["✋"],hike:["🚶"],hitched:["💒"],hole:["⛳","🕳"],hollywood:["🎥"],home:["🏠","🏡"],"home improvement":["🔨","🔧","🔩"],homie:["😏","👊","👏","👅","🔝","💯"],honey:["🍯","🐻","🐝"],"honey jar":["🍯"],honeybee:["🐝"],honeypot:["🍯"],hoop:["🏀"],horn:["📯"],horns:["😈","🐏","🤘"],horrible:["😝"],horse:["🐴","🐎","🎠","🏇"],horses:["🐴"],hospital:["🏥"],hot:["☕","😳","💣","♨","🌶"],hotel:["🏨","🏩","🛍","🛎","🛌","🛏","🛋"],hotsprings:["♨"],hourglass:["⌛","⏳"],hours:["⏰","⏳"],house:["🏠","🏡","🏘","🏚"],hrs:["⏰"],hump:["🐪","🐫"],hundred:["💯"],hungry:["🍴","😋","🍉","🍗","🍔","🍕"],hurry:["🏃"],hushed:["😯"],"i dont believe you":["😮"],"i know":["🙋"],icecream:["🍦"],idea:["💡","💭"],ily:["💖","💜","😍","💙","😘","😚","💕","💗","😗","💘","😙","💓","💚","💛","💝"],imp:["👿"],"in love":["😍"],inbox:["📥"],"inbox zero":["📥"],incoming:["📨"],index:["📇","👈","👉","☝","👆","👇","🗂"],inexpressive:["😑"],infant:["👶","🍼"],ink:["🔏"],innocent:["😇"],insect:["🐜","🐞","🐛","🐝","🕷"],instagram:["📷"],instrument:["🎸","🎷","🎹","🎺","🎻"],interesting:["💯"],intersection:["🚥","🚦"],invent:["💭"],invention:["💭"],irish:["🍀"],ironic:["😼"],italian:["🍝"],jack:["🎃"],jacked:["💪"],jar:["🍯"],"jazz hands":["👐"],jealous:["😑","😒","😐"],jeans:["👖"],jel:["😐","😑","😒"],jelly:["😐","😑","😒"],jet:["✈"],jewel:["💎"],jfk:["✈"],job:["🏢"],jockey:["🏇"],joke:["😜"],joker:["🃏"],journey:["🛄"],karaoke:["🎤"],"kentucky derby":["🐎"],key:["🔑","🔐","🗝"],keyboard:["🎹","⌨"],keys:["🔑"],kick:["👞","👟"],kid:["👦"],kidding:["😏","💯"],kimono:["👘"],king:["👑"],kiss:["😘","💋","💏","😗","😙","😚","💑","😽","👄"],kisses:["😘","😗","😙","😚","😍","💕","💖","💗","💝"],kissing:["😗","💋","👄"],kitten:["🐱","🐈"],kitty:["🐱"],knife:["🔪","🍴","🍽","🗡"],knights:["🐉","⚜"],knock:["✊"],knowledge:["📖","📚"],knuckle:["👊"],koala:["🐨"],lab:["🔬","🔍","🔎"],ladies:["👭"],lady:["👧","👩","👵","👚","👜"],"lady beetle":["🐞"],ladybird:["🐞"],ladybug:["🐞"],lake:["🚣","🚤"],landscape:["🌆"],lantern:["🎃","🏮"],las:["✈"],late:["⏰"],later:["👋"],latest:["🆕"],laugh:["😀","😄","😆","😂"],laughing:["😂"],laughter:["😂"],launch:["🚀"],lavatory:["🚾","🚹","🚺","🚻"],lax:["✈"],leaf:["🍁","🌿","🍀","🍃","🍂","🔰"],lebron:["👑"],ledger:["📒"],leer:["😏"],"left luggage":["🛅"],legit:["👌","👍"],lemon:["🍋"],leonardo:["🐢"],leopard:["🐆"],letter:["💌","📩","📨","✉","📧","📤","📥"],lga:["✈"],liberty:["🗽"],library:["📚","📖","📗","📘","📙"],lick:["👅"],light:["💡","🔦","🔆","🚨","🚥","🚦","🕯","🏮"],"light rail":["🚈"],lightning:["⚡","🌩"],like:["👍"],lincoln:["🎩"],link:["🔗","🖇"],links:["🔗"],lips:["👄","💋"],lipstick:["👄","💄"],list:["✅"],listen:["👂","🙉"],listening:["👂"],litter:["🚮","🚯"],lives:["☯"],loaf:["🍞"],location:["📍"],lock:["🔒","🔐","🔓","🔏","🔑","🗝"],locked:["🔒","🔐"],locomotive:["🚂"],lol:["😂","😆","😄"],lollipop:["🍭"],lonely:["💔"],look:["👀"],looking:["👀"],loopy:["😜"],lorry:["🚛"],losing:["😔","😞"],"losing hair":["👴"],loud:["📢","🔊"],loudspeaker:["📢"],love:["💕","💓","💜","💙","😍","😘","💏","💑","😙","🌹","💘","💐","💚","💛","💌","😻","🏩"],"love you":["😘"],lover:["😘"],loving:["😍","💕"],lowercase:["🔡"],lucky:["🍀"],luggage:["🛅"],lunch:["🍴"],luxury:["🚤"],mad:["😡","😠","😖","💢","🗯"],"mad men":["🍸"],maddening:["😡","😠"],magic:["🔮"],magical:["✨"],magnifying:["🔍","🔎"],"mai tai":["🍹"],mail:["📫","💌","📧","📨","📩","📪","📬","📭","📮","📤","📥"],mailbox:["📫","📪","📬","📭","📮"],maize:["🌽"],makeup:["💄","💅"],man:["👫","👬","👨","👴","👲","🕴","👨‍👩‍👧","👨‍👩‍👧‍👦","👨‍👩‍👦‍👦","👨‍👩‍👧‍👧","👨‍👨‍👦","👨‍👨‍👧","👨‍👨‍👧‍👦","👨‍👨‍👦‍👦","👨‍👨‍👧‍👧","👨‍👦","👨‍👦‍👦","👨‍👧","👨‍👧‍👦","👨‍👧‍👧","👞","🚹"],manicure:["💅"],map:["📍","🗺","🗾"],maple:["🍁"],marathon:["🏃"],mario:["🍄"],martini:["🍸"],mask:["🎭","😷"],massage:["💆"],math:["➕","➖","➗","📏","📐"],maverick:["😎"],maze:["🌽"],meat:["🍖"],meatballs:["🍝"],media:["📝"],medicine:["💊","💉","😷","🏥"],medieval:["👑"],meditate:["🙇"],meditation:["🙇"],megaphone:["📣"],melon:["🍈"],memo:["📝"],meridians:["🌐"],message:["💬"],messenger:["⚡"],messi:["⚽"],metro:["🚇"],mia:["✈"],mic:["🎤","🎙"],michelangelo:["🐢"],microphone:["🎤","🎙"],microscope:["🔬"],milk:["🐮","🐄","🐐","🍼"],"milky way":["🌌"],million:["💰","💸","💲"],millionaire:["🚤"],minibus:["🚐"],minidisk:["💽"],minus:["➖"],miss:["😢"],"miss you":["😘"],mobile:["📱","📳","📴","📲","📵","📶"],money:["💰","💸","💵","💲","💎","💶","💷","💳","💴","🤑","💹","💱"],moneybag:["💰"],monkey:["🐵","🙈","🙉","🙊","🐒","🍌"],monorail:["🚈","🚝"],monster:["👹","👺","👻","💀","👽","👾","☠","🤖","💩"],moo:["🐮","🐄"],moon:["🌝","🌛","🌚","🌙","🌑","🌒","🌓","🌔","🌕","🌖","🌗","🌘","🎑","🌜"],morning:["🌄","☕","🌅","💖","😘"],mountain:["🗻","🌄","🌋","🚵","🏔","⛰","🚞","🚠"],mouse:["🐭","🐁"],mouth:["👄","😮","😦","😆","😺","😃","😄","😶","🤐","🤑","😰"],mouthless:["😶"],move:["🚛"],movie:["🎥","🎦","🎬","🎞","📽"],moyai:["🗿"],muah:["😘","💗"],mug:["🍺","🍻"],multiplication:["❎","✖","❌"],multiply:["❎","✖","❌"],muscle:["💪"],museum:["🎨","🖼"],mushroom:["🍄"],music:["🎵","🎶","🎼","🎤","🎷","🎸","🎹","🎺","🎻","🔊","🎙","🎚","🎛"],mute:["🔕","😶","🔇"],nail:["💅"],name:["📛"],nap:["😴","😫"],nascar:["🏁"],nature:["🐝","💧","🌞","🌈","🌊","🐌","🐞","🌺","🌻","🌼","🌷","🌴","🌵","🍁","🍃","🌋","🗻","🌄","🌅","⚡","⭐"],necktie:["👔"],nectarine:["🍊"],needle:["💉"],negative:["📉"],neither:["☯"],nerves:["😟"],nervous:["😰","😟","😓","😅","💗"],neutral:["😐"],"new":["🆕"],newborn:["👶","🐥","🍼"],news:["📰","🗞"],newspaper:["📰","🗞"],ng:["🆖"],nice:["👏","😀","😁"],night:["🌠","🌃","🌟","🌉","🌚","😘","😙","🌕","🌙","🌛","🌜","🌝"],nights:["🌜","🌒","🌘"],nine:["9⃣","🕘","🕤"],no:["👎","🙈","🙉","🙊","🙅","🔕","⛔","🚫","🚳","🚭","🚯","🚷","📵","🔞"],"no good":["👎"],nono:["🙈"],noodle:["🍜"],nope:["👎"],north:["⬆"],northeast:["↗"],northwest:["↖"],nose:["👃","🐽"],noses:["👃"],nosey:["👃"],"not amused":["😐"],"not funny":["😐"],"not laughing":["😐"],"not sure":["😕"],"not this time":["😥"],notebook:["📔","📓","📒"],notes:["📝","📋","🎶"],novels:["📖","📚"],numbers:["🔢"],nuptuals:["💒"],nutty:["😜"],ocean:["🌊","🏄","🐳","🐋","🐬","🐙"],octoberfest:["🍺"],octopus:["🐙"],odor:["👃"],off:["📴"],office:["💼","🏢","💻"],officer:["👮"],ogre:["👹"],oh:["🙀"],ok:["🆗","👌"],okay:["👍","🆗","👌"],oktoberfest:["🍺"],"old school":["📼","📇"],omfg:["😲"],omg:["😮","👀","😑","🙈","😯","🙆","😝","😲"],omw:["👣","🔜"],oncoming:["🚍","🚔","🚖","🚘"],one:["1⃣","🕐","🕜"],"one hump":["🐪"],oolong:["🍵"],oops:["🙊"],orange:["🍊","📙","🔶","🔸"],ord:["✈"],ornithology:["🐦"],outbox:["📤"],outdoors:["🌻","🌳"],outgoing:["📩"],outside:["🌞"],outtie:["👋"],"over easy":["🍳"],ox:["🐂","♉"],"package":["📦"],packing:["🛃","🛄"],page:["📄","📃"],pager:["📟"],paid:["💰"],painter:["🎨"],painting:["🎨","🖼","🖌"],palette:["🎨"],palm:["🌴"],pan:["🍳"],panda:["🐼"],pants:["👖"],paper:["📰","📜","✂","🗞"],paperclip:["📎","🖇"],parcel:["📦"],parking:["🅿"],party:["🎉","😛","😜","🍹"],passport:["🛂"],password:["🔑"],pasta:["🍝"],pastry:["🍰","🍥","🎂"],patrol:["🚓"],paw:["🐾"],paws:["🐾"],pay:["💲","💸","💳"],paying:["💰"],peace:["✌","😌","☮","🕊"],peaceful:["☮"],peach:["🍑"],pear:["🍐"],pedestrian:["🚸","🚶","🚷"],pencil:["✏","📝"],penguin:["🐧"],pensive:["😔"],pepperoni:["🍕"],"perfect score":["💯"],performing:["🎭"],persevere:["😣"],pet:["🐶","🐱","🐕","🐈","🐹","🐰","🐇"],pho:["🍜"],phone:["📱","📞","📳","📲","📶","☎","📵","📴"],photo:["📷"],piano:["🎹"],picnic:["🍉"],picturesque:["🌅"],pig:["🐷","🐽","🐖","🐗"],pigtails:["👧"],pill:["💊"],pills:["💊"],pin:["📍","📌"],pina:["🍍"],pinch:["👌"],pine:["🎍"],"pine tree":["🌲"],pineapple:["🍍"],pint:["🍺"],pissed:["😒","😈"],pistol:["🔫"],pizza:["🍕"],plane:["✈","🛄"],plant:["🌻","🌺","🌸","🌹","🌱","🌼","🌷","🎍","💐","🌴","🌵","🌾","🍀","🏵","☘","🌰"],play:["▶","⏯"],please:["🙏"],plug:["🔌"],plus:["➕"],"po po":["👮"],police:["👮","🚓","🚔","🚨"],polish:["💅"],poo:["💩"],poodle:["🐩"],pooh:["🍯"],pool:["👙"],poop:["💩"],popo:["👮"],popper:["🎉"],pork:["🐷","🐖"],poseidon:["🔱"],postbox:["📫","📪","📬","📭","📮"],"pot of gold":["💰"],potassium:["🍌"],poultry:["🍗"],pound:["👊","#⃣","💷"],pounds:["💷"],pouting:["😡","😾","🙎"],prawn:["🍤"],pray:["🙏"],prayed:["👏"],preakness:["🐎"],predator:["🐯","🐅","🐆"],pregnant:["👶"],present:["🎁"],pride:["🌈"],princess:["👸","🐸"],print:["👣","🐾"],"private":["🔒"],prize:["🏆"],progress:["✅"],prohibited:["🚫","⛔","🚭","🙅","🙈","🙉","🙊","🚳","🚯","🚱","🚷","🔕","📵","🔞"],"pub grub":["🍤"],"public address":["📢"],pudding:["🍮"],pulsating:["💓"],pulse:["💓","💗"],pump:["⛽"],punch:["👊","✊"],puppies:["🐶"],puppy:["🐶"],purple:["💜"],purse:["👛","👜","👝"],pushpin:["📌","📍"],queen:["👑"],question:["❓","🙋","⁉","❔"],"question mark":["❓","❔"],quick:["🏃"],quiet:["🙊","😶","🔇","🔕"],rabbit:["🐰","🐇"],race:["🏁"],racehorse:["🐎","🏇"],racing:["🏁","🏇","🐎","🏎","🏍"],rad:["👍","👌","😎"],radio:["📻","🔘"],radioactive:["☢"],rage:["😡","😠"],railway:["🚆","🚉","🚞","🚂","🚃","🚄","🚅","🚈","🚟","🛤"],rain:["☔","🌂","🌈","⛈","🌦","🌧","☂","⛱"],rainbow:["🌈"],raised:["🙋","✋","🙌"],ram:["🐏","♈"],ramen:["🍜"],ranch:["🏠","🏡"],raphael:["🐢"],rat:["🐀"],rays:["☀"],reading:["📖","📚","📗","📘","📙"],ready:["🛄"],realize:["💭"],receive:["📨","📥","📲"],record:["🎥","⏺"],recycle:["♻"],red:["🍎","🌹","😡","🀄","🏮","🔼","🔽","🔺","🔻","🔴"],refresh:["🔄","🔃"],registered:["®"],relaxed:["😎","☺"],relief:["😌"],relieved:["😌","😥"],religion:["✡","☸","☯","✝","☦","☪","📿","⛪","🕌","🕍","⛩","🕋","🛐","🕉","🕎"],"reno 911":["👮"],repairs:["🔨"],repeat:["🔁"],restaurant:["🍴","🍔","🍕","🍗","🍞","🍖","🍟","🍲","🍱","🍘","🍙","🍚","🍛","🍜","🍝","🍠","🍢","🍣","🍤","🍥","🍡","🍦","🍧","🍨","🍩","🍪","🍰","🍫","🍬","🍭","🍮","🍯","🍶","🍷","🍸","🍹","🍺","🍻","🍳","🏮"],restroom:["🚾","🚹","🚺","🚻"],revolver:["🔫"],rewind:["⏪","🔄"],ribbon:["🎀","💝","🎗"],rice:["🍚","🍙","🌾","🍛","🍘"],rich:["💰","💶"],ride:["🚲"],riding:["🚴","🚵","🏇"],"right handed":["✋"],ring:["💍"],ripe:["🍎","🍐"],ripped:["💪"],river:["🚣"],rock:["👊"],rocket:["🚀"],rofl:["😂","😆"],roflcopter:["🚁"],roflew:["🍴"],rolodex:["📇"],romance:["💏","😘","💑","💋","💐","💘","💙","😍","💌","💍","💎","💒"],romantic:["😘","😍","💚"],ronaldo:["⚽"],rooster:["🐓"],ropeway:["🚡"],rose:["🌹"],row:["🚣"],rowboat:["🚣"],rowing:["🚣"],royal:["👑"],"royal family":["👑"],royalty:["👑"],rugby:["🏉"],ruler:["📏","📐"],runner:["🏃"],running:["🏃","👟","💨","🎽"],rush:["🏃"],rushed:["😰"],sad:["😢","😭","😩","💧","😖","😞","💔","😿"],sailboat:["⛵"],sailing:["⛵"],sake:["🍶"],salud:["🍻"],sandal:["👡"],santa:["🎅"],sapling:["🌱"],sash:["🎽"],sassy:["💁"],satchel:["🎒"],satellite:["📡","🛰"],satisfied:["😊","😆"],saunter:["🚶"],savour:["😋"],savouring:["😋"],sax:["🎷"],saxophone:["🎷"],scared:["😨","😱","😰","🙈","😧","😦","😓"],scary:["😧","😦","👻"],school:["📚","🎒","🚌","🏫","📔"],science:["🔬","🔭","🔎","🔍","📡"],scissors:["✂"],score:["🎼","💯"],scream:["😱"],screamer:["😱"],scroll:["📜"],scrooge:["💰"],search:["🔎","🔍"],seat:["💺"],secret:["🙊","🙈","🙉"],see:["👀","🙈"],"see no evil":["🙈"],seedling:["🌱"],seeing:["👀"],selfie:["📷"],semi:["🚛"],send:["📩"],sent:["✉","📨","📩","📤"],serious:["👔"],serpent:["🐍","⛎"],"settle down":["🏠","🏡"],seven:["7⃣","🕖","🕢"],sexy:["😉","💋"],sfo:["✈"],shade:["👿","😡","😈","😠","😐"],shadow:["👤"],shakespeare:["🎭"],sheep:["🐏","🐑"],shell:["🐚"],shh:["🙉"],shine:["🌞"],shining:["🌟"],shinkansen:["🚄","🚅"],shipping:["📦"],shirt:["👔","👕","👚","🎽"],shocked:["😲"],shoe:["👟","👠","👞","👡","👢"],shoes:["👟","👠","👞","👢"],shooting:["🌠"],shopping:["👛","👠","👗","👖","👕","👢","👜","👚","👞","👟","🛍"],shortcake:["🍰","🍓"],shot:["💉"],shower:["🚿"],shrimp:["🍤"],sick:["😷","😵","💊","🤒","💉"],"side - saddle":["🐴"],signal:["📶","🚥","🚦"],silence:["😶"],silent:["😶","🔇","🔕"],silhouette:["👤","👥","🗣"],"simple home":["🏠","🏡"],sing:["🎤"],sis:["👭"],sister:["👭"],sisters:["👭"],six:["6⃣","🕕","🕡"],ski:["🎿","🏂","⛷"],"ski lift":["🚠"],skull:["💀","☠"],slay:["🏆","😎","🌟","✨"],sleep:["😴","💤","😪","🛌","🛏"],sleeping:["😴","💤","😪"],sleepy:["😩","💤"],slice:["🍕","🍰"],slick:["😏"],slide:["😉","😏"],"slide rule":["📐"],slot:["🎰"],slots:["🎰"],slug:["🐌"],slurp:["👅"],smel:["🐽"],smell:["👃"],smells:["👃"],smh:["😒","🙈","💩"],smile:["😀","😊","😁","😆","😃","😄","😇","😈","☺","😅","😋","😎","😍","😙","🙂","😺","😸","😻","😼"],smiling:["😁","😆","☺"],smirk:["😏"],smoke:["🚫","🚭"],smoking:["🚭","🚬"],smooch:["😘","😗"],smooches:["😘","😗","😚"],sms:["💬"],smug:["😏"],snail:["🐌"],snake:["🐍","⛎"],snap:["📷"],snapchat:["👻"],sneaker:["👟"],sneeze:["😫"],snicker:["😏"],snout:["🐽"],snow:["❄","⛄","🎿","🏂","⛷","🏔","🌨","☃"],snowboard:["🏂"],snowflake:["❄"],snowman:["⛄","☃"],sob:["😭"],soba:["🍜"],soccer:["⚽"],solidarity:["✊"],soothe:["💆"],sound:["👂","🔇","🔈","🔉","🔊","📢","📣","🔔","🔕","🎵","🎶","🎤","🎧"],sour:["🍋"],sow:["🐖"],space:["👽","👾","🌌","🚀","🌠","🌑","🌒","🌓","🌔","🌕","🌖","🌗","🌘","🌙","🌚","🌛","☀","🌝","🌞","🛰","☄"],spade:["♠"],spaghetti:["🍝"],sparkle:["🌟","💖","🎇","✨","❇"],sparkling:["💖"],speak:["🙊","🗣"],"speak no evil":["🙊"],speech:["💬","🗨"],speechless:["😶"],speed:["🏃","🚄","🚅"],speedboat:["🚤"],speilberg:["🎥"],"spin class":["🚲"],spinning:["🚲"],spiral:["🐚","🗒","🗓"],spirit:["😇"],splashing:["💦"],spock:["🖖"],sport:["🏈","🏀","⚾","⚽","🏉","🎾","🏄","⛳","🎿","🏂","🏊","🚵","🎳","🎣","🏇","🚴","🏆","🏁"],spouting:["🐳"],spring:["🐝","🌸"],springs:["♨"],springtime:["🌸"],sprout:["🌱"],star:["🌟","⭐","🌠","💫","🌃","✨","✡","🔯","✴"],"star trek":["🖖"],starbucks:["☕"],stars:["⭐","💫"],statue:["🗽","🗿"],stealth:["🙊"],steaming:["☕","♨","🍜"],stein:["🍺"],stew:["🍲"],stop:["✋","🚏","⏹"],"stop light":["🚦","🚥"],stoplight:["🚦","🚥"],store:["🏪","🏬"],stradivarius:["🎻"],"straight edge":["📏"],strat:["🎸"],stratocaster:["🎸"],strawberry:["🍓"],streamer:["🎏"],stress:["😟"],stressed:["😟","😧"],stride:["🚶"],strike:["🎳"],stroll:["🚶"],strong:["💪"],study:["📚"],stunned:["😯"],stunner:["😎"],style:["😎"],suave:["😏"],suburban:["🏠","🏡"],suburbia:["🏠","🏡"],subway:["🚇"],sucks:["😔"],summer:["🍉","⛵","🚤"],"summer ale":["🍺"],sun:["☀","🌞","⛅","🌄","🌅","😎","🌻","🌆","🌇","🌤","🌥","🌦","⛱"],sunflower:["🌻"],sunglasses:["😎","🕶"],sunny:["☀","🌞"],"sunny side up":["🍳"],sunrise:["🌄","🌅"],sunset:["🌆","🌇"],sunshine:["🌞"],suprise:["😧","😦"],surf:["🌊"],surfer:["🏄"],surfing:["🏄"],surprised:["😯","🙀"],sushi:["🍣"],swag:["😏","😎"],swagger:["😏","😎","🚶"],sweat:["😅","💦","😥","😰","😓","💧"],sweet:["🍭","🍪","🍦","🍩","🍬","🍫","🍰","🎂","🍯","🍓","🍠","🍡","🍧","🍨","🍮"],"sweet tooth":["🍬","🍫"],swim:["🏊","👙"],swimmer:["🏊"],syringe:["💉"],syrup:["🍁"],tada:["🎉"],talk:["💬"],tangerine:["🍊"],tango:["💃"],tao:["☯"],taoist:["☯"],tape:["📼"],target:["🎯"],taurus:["🐂"],taxi:["🚕","🚖"],tbt:["📻","📷","📹"],tea:["🍵","☕"],teacup:["🍵"],tear:["😢","💧","😿","😭","😂","😹"],tears:["😂"],tease:["😉"],teeth:["😁","😀"],telephone:["📱","☎","📞","📲","📵","📶","📳","📴"],telescope:["🔭"],television:["📺"],tempura:["🍤"],tennis:["🎾","👟"],tent:["⛺","🎪"],text:["💬"],thank:["🙏"],thanks:["🙏"],"that was close":["😓"],theater:["🎭"],theatre:["🎭"],thesbian:["🎭"],think:["💭"],thinking:["💭","🤔"],thought:["💭"],thoughts:["💭"],thumb:["👍","👎"],"thumbs down":["👎"],"thumbs up":["👍"],thx:["🙏"],ticket:["🎫","🎟"],tiger:["🐯","🐅"],time:["⌚","⏰","⌛"],tired:["💤","😪","😴","😵","😫","😩"],titanic:["🚢"],tm:["™"],tmi:["🙉"],"to do list":["📋"],toast:["🍞","🍻"],toilet:["🚽"],tokyo:["🗼"],tomato:["🍅"],tongue:["😜","😛","😝","👅"],tool:["🔨","🔧","🔩","🔦","✂","🔪","🏺","⚓","🔥","🔍","🔎","🔬","🔭","⛏","⚒","🛠","🔫","🏹","⚙","🗜","⚗","⚖","💉","🔮","🔰","🔱"],top:["🎩","🔝"],tophat:["🎩"],toronto:["🍁"],total:["☯"],totally:["😲"],tower:["🗼"],tractor:["🚜"],trademark:["™"],traffic:["🚥","🚦","🚸","⛔"],train:["🚂","🚆","🚄","🚅","🚉","🚃","🛤"],trains:["🚂"],tram:["🚃","🚎","🚊","🚋"],tramway:["🚡"],travel:["✈","🚢","🚃","🚁","🚅","🗿","🚤","⛵","🚀","🛄","🚂","🚇"],tree:["🌳","🌲","🌴","🎄","🎋"],trident:["🔱"],trip:["🚞","📷","🛄"],"triple crown":["🐎"],"triple crown preakness":["🐴"],triste:["😢"],trolley:["🚋","🚎"],trolleybus:["🚃","🚎","🚊","🚋"],trophy:["🏆"],tropical:["🌴","🍹","🍍","🐠"],tropics:["🍹"],trousers:["👖"],truck:["🚛","🚚","🚒"],trumpet:["🎺"],tshirt:["👕"],ttfn:["👋"],ttyl:["👊","👋"],tub:["🛀"],tubular:["👍","👌"],tulip:["🌷"],turkey:["🍗","🦃"],turtle:["🐢"],turtles:["🐢"],tv:["📺"],twelve:["🕛","🕧"],twig:["🌱"],twinsies:["👯"],twister:["🌀"],two:["2⃣","🕑","🕝"],"two hump":["🐫"],typing:["💬"],uber:["🚕","🚖"],udon:["🍜"],ufo:["👾","👽"],ugh:["😒"],uh:["😐","😑"],"uh oh":["😐","😑"],umbrella:["☔","🌂","🏖","☂","⛱"],unamused:["😒"],"under the tuscan sun":["😚"],underage:["🔞"],understood:["✊"],unexpressive:["😑"],unhappy:["😞","😒","😡","😢","😭","😠","😧","😩"],unlock:["🔓","🔑"],unlocked:["🔓"],"up and to the right":["📈"],upset:["🙍"],urn:["⚱"],vacation:["✈","🍹"],vaccination:["💉"],
vaccinatoins:["💉"],valentine:["💝","💌","💘"],vampire:["⚰"],van:["🚐"],vegetable:["🍆","🍅"],vehicle:["🚗","🚙","🚘","🚐","🚚","🚕","🚛","🚝","🚌","🚑","🚜","🚁"],versus:["🆚"],vhs:["📼"],video:["📹","📼","📻","📽","📺","📷","📸"],"video game":["🎮"],videocassette:["📼"],violin:["🎻"],"vitamin c":["🍊"],voip:["📞"],volcano:["🌋"],voltage:["⚡"],vulcan:["🖖"],wacky:["😜"],waiting:["⏰","⏳"],walk:["🚶","👣"],walking:["🚶"],warning:["⚠"],watch:["⌚"],water:["💧","🌊","🐃","🚿","🚰","🚾","🚱","♒"],"water dog":["🐩"],watermelon:["🍉"],wave:["👋","🌊"],waves:["🏄"],waving:["👋","🏴","🏳"],wavy:["〰"],wc:["🚾","🚹","🚺"],weary:["😩","🙀"],weather:["☀","⛅","☁","☔","💧","❄","🌞","🌈","🌀","🌡"],wedding:["💍","👰","💎","💒"],weekend:["👕","👖"],weightlift:["💪"],weird:["😒"],weirdo:["😜"],western:["🐴"],whale:["🐳","🐋"],whatever:["😝","😒"],whatsapp:["📱","📲"],wheat:["🍞"],wheelchair:["♿"],"where the heart is":["🏠","🏡"],whitecaps:["🌊"],wilbur:["🐷"],"willy wonka":["🍭"],win:["🏆","👑","🌟","🏁","😎","💰","✨"],wine:["🍷"],wink:["😉","😏","😜"],winking:["😉"],winks:["😉"],"winnie the pooh":["🍯"],winning:["🏆","😎"],woah:["😯","😮"],wolf:["🐺"],wonder:["💭"],wool:["🐑"],"work out":["💦"],workout:["💦"],world:["🌍","🌏","🌎","🌐","🗺"],worried:["😟","😨"],worry:["😟"],wow:["😮"],wrapped:["🎁"],wrapper:["🍬"],wrench:["🔧","🛠"],writing:["✏","📔"],wtf:["😑","😒","😲"],xoxo:["😘","😚","😗","💗","😍","💖","💕","💝"],yacht:["⛵"],yang:["☯"],yay:["😃","👏"],yeah:["👍","😎","✨"],"yellow cab":["🚖"],"yellow taxi":["🚕","🚖"],yen:["💴","💹"],yes:["👍","👊"],yikes:["😰","😓"],yin:["☯"],yolo:["😜","😝","💀","⏳","🎆"],yosemite:["🐻"],yum:["😋","🍇","🍉","🍑","🍟"],zap:["⚡"],zen:["😌"],zoo:["🐅","🐆","🐃","🐏","🐊"],zz:["💤"],zzz:["💤","😴"],zzzz:["💤"],"grinning face":["😀"],"grinning face with smiling eyes":["😁"],"face with tears of joy":["😂"],joy:["😂","😹"],rolling:["🙄"],"smiling face with open mouth":["😃"],open:["😃","😄","😅","😆","😮","😦","😰","😺","👐","📖","📬","📭","📂","🔓"],"smiling face with open mouth & smiling eyes":["😄"],"smiling face with open mouth & cold sweat":["😅"],"smiling face with open mouth & closed eyes":["😆"],"winking face":["😉"],"smiling face with smiling eyes":["😊"],"face savouring delicious food":["😋"],um:["😋"],"smiling face with sunglasses":["😎"],"smiling face with heart-eyes":["😍"],"face blowing a kiss":["😘"],"kissing face":["😗"],"kissing face with smiling eyes":["😙"],"kissing face with closed eyes":["😚"],"smiling face":["☺"],outlined:["☺","❔","❕","🔳"],"slightly smiling face":["🙂"],"hugging face":["🤗"],hug:["🤗"],hugging:["🤗"],"thinking face":["🤔"],"neutral face":["😐"],"expressionless face":["😑"],"face without mouth":["😶"],"face with rolling eyes":["🙄"],eyes:["🙄","👀"],"smirking face":["😏"],"persevering face":["😣"],"disappointed but relieved face":["😥"],whew:["😥"],"face with open mouth":["😮"],sympathy:["😮"],"zipper-mouth face":["🤐"],zipper:["🤐"],"hushed face":["😯"],"sleepy face":["😪"],"tired face":["😫"],"sleeping face":["😴"],"relieved face":["😌"],"nerd face":["🤓"],geek:["🤓"],nerd:["🤓"],"face with stuck-out tongue":["😛"],"face with stuck-out tongue & winking eye":["😜"],"face with stuck-out tongue & closed eyes":["😝"],taste:["😝"],"unamused face":["😒"],"face with cold sweat":["😓"],"pensive face":["😔"],"confused face":["😕"],"upside-down face":["🙃"],"upside-down":["🙃"],"money-mouth face":["🤑"],"astonished face":["😲"],"frowning face":["☹"],"slightly frowning face":["🙁"],"confounded face":["😖"],"disappointed face":["😞"],"worried face":["😟"],"face with steam from nose":["😤"],triumph:["😤"],won:["😤"],"crying face":["😢"],"loudly crying face":["😭"],"frowning face with open mouth":["😦"],"anguished face":["😧"],"fearful face":["😨"],"weary face":["😩"],"grimacing face":["😬"],"face with open mouth & cold sweat":["😰"],"face screaming in fear":["😱"],munch:["😱"],"flushed face":["😳"],"dizzy face":["😵"],"pouting face":["😡"],"angry face":["😠"],"smiling face with halo":["😇"],fairytale:["😇","😈","👿","👹","👺","💀","👻","👽","👾","👼","👸","🐲","🐉","🔮"],"face with medical mask":["😷"],"face with thermometer":["🤒"],ill:["🤒"],thermometer:["🤒","🌡"],"face with head-bandage":["🤕"],bandage:["🤕"],hurt:["🤕"],injury:["🤕"],"smiling face with horns":["😈"],"angry face with horns":["👿"],demon:["👿"],Japanese:["👹","👺","🍙","🍡","🏣","🏯","🎋","🎍","🎎","🎴","🏮","🔰","🈁","🈂","🈷","🈶","🈯","🉐","🈹","🈚","🈲","🉑","🈸","🈴","🈳","㊗","㊙","🈺","🈵","🎌"],"skull and crossbones":["☠"],crossbones:["☠"],"alien monster":["👾"],"robot face":["🤖"],robot:["🤖"],"pile of poo":["💩"],"smiling cat face with open mouth":["😺"],"grinning cat face with smiling eyes":["😸"],"cat face with tears of joy":["😹"],"smiling cat face with heart-eyes":["😻"],"cat face with wry smile":["😼"],wry:["😼"],"kissing cat face with closed eyes":["😽"],"weary cat face":["🙀"],"crying cat face":["😿"],"pouting cat face":["😾"],"see-no-evil monkey":["🙈"],gesture:["🙈","🙉","🙊","🙍","🙎","🙅","🙆","🙋","🙇","🙌","🙏"],not:["🙈","🙉","🙊","🙅","🔕","⛔","🚫","🚳","🚭","🚯","🚷","📵","🔞"],"hear-no-evil monkey":["🙉"],"speak-no-evil monkey":["🙊"],young:["👦","👧","👶","🌱"],Virgo:["👧","♍"],zodiac:["👧","👬","🦁","🐂","🐏","🐐","🐍","🐟","🦀","🦂","🏺","🏹","⚖","♈","♉","♊","♋","♌","♍","♎","♏","♐","♑","♒","♓","⛎"],woman:["👩","👵","💃","👫","👭","👨‍👩‍👧","👨‍👩‍👧‍👦","👨‍👩‍👦‍👦","👨‍👩‍👧‍👧","👩‍👩‍👦","👩‍👩‍👧","👩‍👩‍👧‍👦","👩‍👩‍👦‍👦","👩‍👩‍👧‍👧","👩‍👦","👩‍👦‍👦","👩‍👧","👩‍👧‍👦","👩‍👧‍👧","👚","👠","👡","👢","👒","🚺"],"old man":["👴"],old:["👴","👵","🗝"],"old woman":["👵"],"baby angel":["👼"],justice:["⚖","♎"],scales:["⚖","♎"],worker:["👷"],business:["🕴"],"police officer":["👮"],detective:["🕵"],sleuth:["🕵"],spy:["🕵"],"construction worker":["👷"],"person wearing turban":["👳"],turban:["👳"],"blond-haired person":["👱"],"Santa Claus":["🎅"],Christmas:["🎅","🎄"],claus:["🎅"],father:["🎅"],"bride with veil":["👰"],veil:["👰"],"man with Chinese cap":["👲"],guapimao:["👲"],"person frowning":["🙍"],"person pouting":["🙎"],"person gesturing NO":["🙅"],"person gesturing OK":["🙆"],OK:["🙆","👌","🆗"],"person tipping hand":["💁"],help:["💁","🆘"],information:["💁","ℹ"],tipping:["💁"],"person raising hand":["🙋"],"person bowing":["🙇"],sorry:["🙇"],"person getting massage":["💆"],salon:["💆"],"person getting haircut":["💇"],parlor:["💇"],"person walking":["🚶"],"person running":["🏃"],"woman dancing":["💃"],dancing:["💃"],"people with bunny ears partying":["👯"],bunnyear:["👯"],partying:["👯"],"man in business suit levitating":["🕴"],suit:["🕴"],"speaking head":["🗣"],head:["🗣"],speaking:["🗣"],"bust in silhouette":["👤"],"busts in silhouette":["👥"],"horse racing":["🏇"],skier:["⛷"],snowboarder:["🏂"],"person golfing":["🏌"],"person surfing":["🏄"],"person rowing boat":["🚣"],"person swimming":["🏊"],"person bouncing ball":["⛹"],"person lifting weights":["🏋"],lifter:["🏋"],weight:["🏋","⚖"],"person biking":["🚴"],biking:["🚴"],"person mountain biking":["🚵"],"racing car":["🏎"],motorcycle:["🏍"],balance:["⚖","♎"],"man and woman holding hands":["👫"],hold:["👫","👬","👭"],"two men holding hands":["👬"],Gemini:["👬","♊"],twins:["👬","♊"],"two women holding hands":["👭"],"couple with heart":["💑"],"light skin tone":["🏻"],skintone:["🏻","🏼","🏽","🏾","🏿"],"type1–2":["🏻"],"medium-light skin tone":["🏼"],type3:["🏼"],"medium skin tone":["🏽"],type4:["🏽"],"medium-dark skin tone":["🏾"],type5:["🏾"],"dark skin tone":["🏿"],type6:["🏿"],"flexed biceps":["💪"],"backhand index pointing left":["👈"],backhand:["👈","👉","👆","👇"],finger:["👈","👉","☝","👆","🖕","👇","🖖","🤘","🖐"],point:["👈","👉","☝","👆","👇"],"backhand index pointing right":["👉"],"index pointing up":["☝"],up:["☝","👆","👍","🔝","🆙"],"backhand index pointing up":["👆"],"middle finger":["🖕"],"backhand index pointing down":["👇"],down:["👇","👎","📩","📉","⬇","⤵","🔽","⏬","🔻"],"victory hand":["✌"],v:["✌"],victory:["✌"],cross:["⛑","⛪","✝","☦","🎌"],"vulcan salute":["🖖"],"sign of the horns":["🤘"],"rock-on":["🤘"],call:["📲"],"raised hand with fingers splayed":["🖐"],splayed:["🖐"],"raised hand":["✋"],"OK hand":["👌"],"raised fist":["✊"],"oncoming fist":["👊"],"waving hand":["👋"],"clapping hands":["👏"],"writing hand":["✍"],write:["✍"],"open hands":["👐"],"raising hands":["🙌"],hooray:["🙌"],"folded hands":["🙏"],folded:["🙏"],"nail polish":["💅"],care:["💅"],footprints:["👣"],"kiss mark":["💋"],"heart with arrow":["💘"],arrow:["💘","📲","📩","🏹","⬆","↗","➡","↘","⬇","↙","⬅","↖","↕","↔","↩","↪","⤴","⤵","🔃","🔄","🔙","🔚","🔛","🔜","🔝","🔀","🔁","🔂","▶","⏩","⏭","⏯","◀","⏪","⏮","🔼","⏫","🔽","⏬"],"red heart":["❤"],"beating heart":["💓"],beating:["💓"],"broken heart":["💔"],"two hearts":["💕"],"sparkling heart":["💖"],"growing heart":["💗"],"blue heart":["💙"],"green heart":["💚"],"yellow heart":["💛"],yellow:["💛","🔰"],"purple heart":["💜"],"heart with ribbon":["💝"],"revolving hearts":["💞"],revolving:["💞","🚨"],"heart decoration":["💟"],"heavy heart exclamation":["❣"],mark:["❣","📑","🔖","🔛","✅","✔","❌","❎","〽","‼","⁉","❓","❔","❕","❗","™","🆙"],punctuation:["❣","‼","⁉","❓","❔","❕","❗","〰"],"love letter":["💌"],"anger symbol":["💢"],"sweat droplets":["💦"],"dashing away":["💨"],dash:["💨","〰"],"speech balloon":["💬"],bubble:["💬","🗯","💭"],"left speech bubble":["🗨"],"right anger bubble":["🗯"],"thought balloon":["💭"],dark:["🕶","🌑"],"t-shirt":["👕"],"woman’s clothes":["👚"],coin:["👛"],"clutch bag":["👝"],pouch:["👝"],"shopping bags":["🛍"],"school backpack":["🎒"],"man’s shoe":["👞"],"running shoe":["👟"],"high-heeled shoe":["👠"],"woman’s sandal":["👡"],"woman’s boot":["👢"],"woman’s hat":["👒"],"top hat":["🎩"],"graduation cap":["🎓"],"rescue worker’s helmet":["⛑"],aid:["⛑"],"prayer beads":["📿"],beads:["📿"],necklace:["📿"],prayer:["📿"],"gem stone":["💎"],"monkey face":["🐵"],"dog face":["🐶"],"wolf face":["🐺"],"cat face":["🐱"],"lion face":["🦁"],Leo:["🦁","♌"],lion:["🦁","♌"],"tiger face":["🐯"],"horse face":["🐴"],equestrian:["🐎"],"unicorn face":["🦄"],unicorn:["🦄"],"cow face":["🐮"],Taurus:["🐂","♉"],"water buffalo":["🐃"],"pig face":["🐷"],"pig nose":["🐽"],Aries:["🐏","♈"],Capricorn:["🐐","♑"],"two-hump camel":["🐫"],"mouse face":["🐭"],"hamster face":["🐹"],"rabbit face":["🐰"],chipmunk:["🐿"],bat:["🏏","🏓"],"bear face":["🐻"],"panda face":["🐼"],"paw prints":["🐾"],"hatching chick":["🐣"],chick:["🐣","🐤","🐥"],"baby chick":["🐤"],"front-facing baby chick":["🐥"],dove:["🕊"],"frog face":["🐸"],terrapin:["🐢"],tortoise:["🐢"],bearer:["🐍","♒","⛎"],Ophiuchus:["🐍","⛎"],"dragon face":["🐲"],"spouting whale":["🐳"],Pisces:["🐟","♓"],"tropical fish":["🐠"],"spiral shell":["🐚"],crab:["🦀","♋"],Cancer:["🦀","♋"],spider:["🕷","🕸"],"spider web":["🕸"],web:["🕸"],scorpion:["🦂","♏"],scorpio:["🦂","♏"],Scorpius:["🦂","♏"],"cherry blossom":["🌸"],"white flower":["💮"],rosette:["🏵"],"evergreen tree":["🌲"],"deciduous tree":["🌳"],shedding:["🌳"],"palm tree":["🌴"],"sheaf of rice":["🌾"],shamrock:["☘"],"four leaf clover":["🍀"],"maple leaf":["🍁"],falling:["🍁","🍂","🌠"],"fallen leaf":["🍂"],"leaf fluttering in wind":["🍃"],blow:["🍃","🌬"],flutter:["🍃"],wind:["🍃","🌬","🎐"],grapes:["🍇"],"red apple":["🍎"],"green apple":["🍏"],cherries:["🍒"],potato:["🍠"],"ear of corn":["🌽"],"hot pepper":["🌶"],pepper:["🌶"],toadstool:["🍄"],nut:["🔩"],french:["🍟"],"cheese wedge":["🧀"],cheese:["🧀","🍕"],"meat on bone":["🍖"],"poultry leg":["🍗"],leg:["🍗"],"french fries":["🍟"],"hot dog":["🌭"],frankfurter:["🌭"],hotdog:["🌭"],sausage:["🌭"],taco:["🌮"],mexican:["🌮","🌯"],burrito:["🌯"],wrap:["🌯"],kebab:["🍢"],"pot of food":["🍲"],pot:["🍲","🍯"],popcorn:["🍿"],"bento box":["🍱"],"rice cracker":["🍘"],cracker:["🍘"],"rice ball":["🍙"],"cooked rice":["🍚"],"curry rice":["🍛"],"steaming bowl":["🍜"],"roasted sweet potato":["🍠"],roasted:["🍠"],oden:["🍢"],seafood:["🍢"],skewer:["🍢","🍡"],stick:["🍢","🍡","🏑","🏒"],"fried shrimp":["🍤"],"fish cake with swirl":["🍥"],swirl:["🍥"],"soft ice cream":["🍦"],ice:["🍦","🍧","🍨","🏒","⛸"],soft:["🍦","🔈"],"shaved ice":["🍧"],shaved:["🍧"],"ice cream":["🍨"],"birthday cake":["🎂"],"chocolate bar":["🍫"],"honey pot":["🍯"],"baby bottle":["🍼"],"hot beverage":["☕"],beverage:["☕","🍵","🍶","🍷"],"teacup without handle":["🍵"],cup:["🍵","🍶"],"bottle with popping cork":["🍾"],cork:["🍾"],popping:["🍾"],"wine glass":["🍷"],"cocktail glass":["🍸"],"tropical drink":["🍹"],"beer mug":["🍺"],"clinking beer mugs":["🍻"],"fork and knife with plate":["🍽"],plate:["🍽"],"fork and knife":["🍴"],"kitchen knife":["🔪"],hocho:["🔪"],weapon:["🔪","🏺","🗡","⚔","🔫","🏹","🛡"],amphora:["🏺"],Aquarius:["🏺","♒"],jug:["🏺"],"globe showing Europe-Africa":["🌍"],Africa:["🌍"],Europe:["🌍"],"globe showing Americas":["🌎"],Americas:["🌎"],"globe showing Asia-Australia":["🌏"],Asia:["🌏"],Australia:["🌏","🇦🇺"],"globe with meridians":["🌐"],"world map":["🗺"],"map of Japan":["🗾"],Japan:["🗾","🇯🇵"],"snow-capped mountain":["🏔"],"mount fuji":["🗻"],"beach with umbrella":["🏖"],"desert island":["🏝"],island:["🏝"],"national park":["🏞"],park:["🏞"],stadium:["🏟"],"classical building":["🏛"],classical:["🏛"],"building construction":["🏗"],cityscape:["🏙"],"derelict house":["🏚"],derelict:["🏚"],"house with garden":["🏡"],"office building":["🏢"],"Japanese post office":["🏣"],post:["🏣","🏤","📯","🚩"],"post office":["🏤"],European:["🏤","🏰"],"love hotel":["🏩"],"convenience store":["🏪"],"department store":["🏬"],"Japanese castle":["🏯"],"Tokyo tower":["🗼"],Tokyo:["🗼"],"Statue of Liberty":["🗽"],Christian:["⛪","✝","☦"],mosque:["🕌"],islam:["🕌","🕋","☪"],Muslim:["🕌","🕋","☪"],synagogue:["🕍"],Jew:["🕍","✡"],Jewish:["🕍","✡"],temple:["🕍"],"shinto shrine":["⛩"],shinto:["⛩"],shrine:["⛩"],kaaba:["🕋"],foggy:["🌁"],"night with stars":["🌃"],"sunrise over mountains":["🌄"],"cityscape at dusk":["🌆"],"bridge at night":["🌉"],"hot springs":["♨"],"carousel horse":["🎠"],"ferris wheel":["🎡"],amusementpark:["🎡","🎢"],wheel:["🎡","☸"],"roller coaster":["🎢"],roller:["🎢"],"barber pole":["💈"],pole:["💈","🎣"],"circus tent":["🎪"],"performing arts":["🎭"],"framed picture":["🖼"],frame:["🖼"],picture:["🖼"],"artist palette":["🎨"],"slot machine":["🎰"],steam:["🚂"],"railway car":["🚃"],"high-speed train":["🚄"],"high-speed train with bullet nose":["🚅"],station:["🚉","⛽"],"mountain railway":["🚞"],"tram car":["🚋"],"oncoming bus":["🚍"],"fire engine":["🚒"],"police car":["🚓"],"oncoming police car":["🚔"],"oncoming taxi":["🚖"],"oncoming automobile":["🚘"],"sport utility vehicle":["🚙"],recreational:["🚙"],sportutility:["🚙"],"delivery truck":["🚚"],"articulated lorry":["🚛"],"bus stop":["🚏"],motorway:["🛣"],highway:["🛣"],road:["🛣"],"railway track":["🛤"],"fuel pump":["⛽"],"police car light":["🚨"],beacon:["🚨"],"horizontal traffic light":["🚥"],"vertical traffic light":["🚦"],sign:["☢","☣"],ship:["⚓","🛳","🚢","🔱"],resort:["⛵"],sea:["⛵"],"passenger ship":["🛳"],passenger:["🛳","⛴","🚢"],ferry:["⛴"],"motor boat":["🛥"],motorboat:["🛥"],aeroplane:["✈","🛩","🛫","🛬"],"small airplane":["🛩"],"airplane departure":["🛫"],"check-in":["🛫"],departure:["🛫"],departures:["🛫"],"airplane arrival":["🛬"],arrivals:["🛬"],arriving:["🛬"],landing:["🛬"],"suspension railway":["🚟"],suspension:["🚟"],"mountain cableway":["🚠"],"aerial tramway":["🚡"],"bellhop bell":["🛎"],bellhop:["🛎"],"person in bed":["🛌"],"couch and lamp":["🛋"],couch:["🛋"],lamp:["🛋"],"person taking bath":["🛀"],sand:["⌛","⏳"],timer:["⌛","⏳","⏲"],"hourglass with flowing sand":["⏳"],"alarm clock":["⏰"],stopwatch:["⏱"],"timer clock":["⏲"],"mantelpiece clock":["🕰"],"twelve o’clock":["🕛"],"00":["🕛","🕐","🕑","🕒","🕓","🕔","🕕","🕖","🕗","🕘","🕙","🕚"],"o’clock":["🕛","🕐","🕑","🕒","🕓","🕔","🕕","🕖","🕗","🕘","🕙","🕚"],"twelve-thirty":["🕧"],thirty:["🕧","🕜","🕝","🕞","🕟","🕠","🕡","🕢","🕣","🕤","🕥","🕦"],"one o’clock":["🕐"],"one-thirty":["🕜"],"two o’clock":["🕑"],"two-thirty":["🕝"],"three o’clock":["🕒"],three:["🕒","🕞"],"three-thirty":["🕞"],"four o’clock":["🕓"],"four-thirty":["🕟"],"five o’clock":["🕔"],"five-thirty":["🕠"],"six o’clock":["🕕"],"six-thirty":["🕡"],"seven o’clock":["🕖"],"seven-thirty":["🕢"],"eight o’clock":["🕗"],"eight-thirty":["🕣"],"nine o’clock":["🕘"],"nine-thirty":["🕤"],"ten o’clock":["🕙"],ten:["🕙","🕥"],"ten-thirty":["🕥"],"eleven o’clock":["🕚"],"eleven-thirty":["🕦"],"new moon":["🌑"],"waxing crescent moon":["🌒"],waxing:["🌒","🌔"],"first quarter moon":["🌓"],quarter:["🌓","🌗","🌛","🌜"],"waxing gibbous moon":["🌔"],gibbous:["🌔","🌖"],"full moon":["🌕"],"waning gibbous moon":["🌖"],waning:["🌖","🌘"],"last quarter moon":["🌗"],"waning crescent moon":["🌘"],"crescent moon":["🌙"],"new moon face":["🌚"],"first quarter moon with face":["🌛"],"last quarter moon with face":["🌜"],"full moon with face":["🌝"],"sun with face":["🌞"],"white medium star":["⭐"],"glowing star":["🌟"],"shooting star":["🌠"],"sun behind cloud":["⛅"],"cloud with lightning and rain":["⛈"],thunder:["⛈"],"sun behind small cloud":["🌤"],"sun behind large cloud":["🌥"],"sun behind rain cloud":["🌦"],"cloud with rain":["🌧"],"cloud with snow":["🌨"],"cloud with lightning":["🌩"],tornado:["🌪"],whirlwind:["🌪"],"wind face":["🌬"],typhoon:["🌀"],"closed umbrella":["🌂"],"umbrella with rain drops":["☔"],"umbrella on ground":["⛱"],"high voltage":["⚡"],"snowman without snow":["⛄"],comet:["☄"],"water wave":["🌊"],"jack-o-lantern":["🎃"],"Christmas tree":["🎄"],sparkler:["🎇"],sparkles:["✨"],"party popper":["🎉"],"confetti ball":["🎊"],"tanabata tree":["🎋"],"pine decoration":["🎍"],"Japanese dolls":["🎎"],doll:["🎎"],festival:["🎎"],"carp streamer":["🎏"],carp:["🎏"],"wind chime":["🎐"],chime:["🎐"],"moon viewing ceremony":["🎑"],ceremony:["🎑"],"wrapped gift":["🎁"],"reminder ribbon":["🎗"],reminder:["🎗"],"admission tickets":["🎟"],"military medal":["🎖"],medal:["🎖","🏅"],military:["🎖"],"sports medal":["🏅"],"soccer ball":["⚽"],volleyball:["🏐"],"american football":["🏈"],american:["🏈"],"rugby football":["🏉"],racquet:["🎾","🏸"],"pool 8 ball":["🎱"],"8ball":["🎱"],cricket:["🏏"],"field hockey":["🏑"],field:["🏑"],hockey:["🏑","🏒"],"ice hockey":["🏒"],puck:["🏒"],"ping pong":["🏓"],paddle:["🏓"],pingpong:["🏓"],tabletennis:["🏓"],badminton:["🏸"],birdie:["🏸"],shuttlecock:["🏸"],"direct hit":["🎯"],hit:["🎯"],"flag in hole":["⛳"],"ice skate":["⛸"],skate:["⛸"],"fishing pole":["🎣"],"running shirt":["🎽"],athletics:["🎽"],skis:["🎿"],joystick:["🕹"],videogame:["🕹"],"game die":["🎲"],die:["🎲"],"spade suit":["♠"],card:["♠","♥","♦","♣","🃏","🎴","💳","🗂","📇","🗃"],"heart suit":["♥"],"diamond suit":["♦"],"club suit":["♣"],wildcard:["🃏"],"mahjong red dragon":["🀄"],mahjong:["🀄"],"flower playing cards":["🎴"],playing:["🎴"],"muted speaker":["🔇"],speaker:["🔇"],"speaker low volume":["🔈"],"speaker medium volume":["🔉"],medium:["🔉"],"speaker high volume":["🔊"],publicaddress:["📢"],cheering:["📣"],"postal horn":["📯"],postal:["📯"],"bell with slash":["🔕"],"musical score":["🎼"],"musical note":["🎵"],note:["🎵","🎶","💴","💵","💶","💷","💸","🗒"],"musical notes":["🎶"],"studio microphone":["🎙"],studio:["🎙"],"level slider":["🎚"],level:["🎚"],slider:["🎚"],"control knobs":["🎛"],control:["🎛","🛂"],knobs:["🎛"],"musical keyboard":["🎹"],drum:["🛢"],"mobile phone":["📱"],"mobile phone with arrow":["📲"],"telephone receiver":["📞"],receiver:["📞"],"fax machine":["📠"],"electric plug":["🔌"],"laptop computer":["💻"],pc:["💻"],personal:["💻"],"desktop computer":["🖥"],desktop:["🖥"],printer:["🖨"],"computer mouse":["🖱"],trackball:["🖲"],"computer disk":["💽"],disk:["💽","💾","💿","📀"],optical:["💽","💿","📀"],"floppy disk":["💾"],"optical disk":["💿"],"movie camera":["🎥"],"film frames":["🎞"],frames:["🎞"],"film projector":["📽"],projector:["📽"],"clapper board":["🎬"],clapper:["🎬"],"camera with flash":["📸"],flash:["📸"],"video camera":["📹"],"left-pointing magnifying glass":["🔍"],"right-pointing magnifying glass":["🔎"],"satellite antenna":["📡"],candle:["🕯"],"light bulb":["💡"],torch:["🔦"],"red paper lantern":["🏮"],"notebook with decorative cover":["📔"],"closed book":["📕"],"open book":["📖"],"green book":["📗"],"blue book":["📘"],"orange book":["📙"],"page with curl":["📃"],curl:["📃","➰","➿"],"page facing up":["📄"],"rolled-up newspaper":["🗞"],rolled:["🗞"],"bookmark tabs":["📑"],marker:["📑"],tabs:["📑"],label:["🏷"],"money bag":["💰"],"yen banknote":["💴"],"dollar banknote":["💵"],"euro banknote":["💶"],"pound banknote":["💷"],"money with wings":["💸"],wings:["💸"],"credit card":["💳"],"chart increasing with yen":["💹"],market:["💹"],rise:["💹"],trend:["💹","📈","📉"],upward:["💹","📈"],"currency exchange":["💱"],"heavy dollar sign":["💲"],"incoming envelope":["📨"],"envelope with arrow":["📩"],"outbox tray":["📤"],tray:["📤","📥"],"inbox tray":["📥"],"closed mailbox with raised flag":["📫"],"closed mailbox with lowered flag":["📪"],lowered:["📪","📭"],"open mailbox with raised flag":["📬"],"open mailbox with lowered flag":["📭"],"ballot box with ballot":["🗳"],"black nib":["✒"],nib:["✒","🔏"],pen:["✒","🖋","🖊","🔏"],"fountain pen":["🖋"],ballpoint:["🖊"],paintbrush:["🖌"],crayon:["🖍"],"file folder":["📁"],"open file folder":["📂"],"card index dividers":["🗂"],dividers:["🗂"],"tear-off calendar":["📆"],"spiral notepad":["🗒"],pad:["🗒","🗓"],"spiral calendar":["🗓"],"card index":["📇"],"chart increasing":["📈"],"chart decreasing":["📉"],"bar chart":["📊"],"round pushpin":["📍"],"linked paperclips":["🖇"],"straight ruler":["📏"],straightedge:["📏"],"triangular ruler":["📐"],set:["📐"],triangle:["📐","▶","⏭","⏯","◀","⏮"],cutting:["✂"],"card file box":["🗃"],"file cabinet":["🗄"],cabinet:["🗄"],filing:["🗄"],wastebasket:["🗑"],"locked with pen":["🔏"],privacy:["🔏"],"locked with key":["🔐"],secure:["🔐"],"old key":["🗝"],clue:["🗝"],pick:["⛏","⚒"],mining:["⛏"],"hammer and pick":["⚒"],"hammer and wrench":["🛠"],spanner:["🛠","🔧"],dagger:["🗡"],"crossed swords":["⚔"],swords:["⚔"],handgun:["🔫"],"bow and arrow":["🏹"],archer:["🏹","♐"],archery:["🏹"],Sagittarius:["🏹","♐"],shield:["🛡"],"nut and bolt":["🔩"],gear:["⚙"],clamp:["🗜"],compress:["🗜"],vice:["🗜"],alembic:["⚗"],chemistry:["⚗"],"balance scale":["⚖"],Libra:["⚖","♎"],chains:["⛓"],chain:["⛓"],"funeral urn":["⚱"],ashes:["⚱"],moai:["🗿"],"oil drum":["🛢"],oil:["🛢"],"crystal ball":["🔮"],crystal:["🔮"],"ATM sign":["🏧"],teller:["🏧"],"litter in bin sign":["🚮"],litterbin:["🚮"],"potable water":["🚰"],potable:["🚰"],"wheelchair symbol":["♿"],access:["♿"],"men’s room":["🚹"],"women’s room":["🚺"],WC:["🚻"],"baby symbol":["🚼"],changing:["🚼"],"water closet":["🚾"],"passport control":["🛂"],"baggage claim":["🛄"],claim:["🛄"],locker:["🛅"],"children crossing":["🚸"],"no entry":["⛔"],entry:["⛔","🚫"],"no bicycles":["🚳"],"no smoking":["🚭"],"no littering":["🚯"],"non-potable water":["🚱"],"non-drinking":["🚱"],"non-potable":["🚱"],"no pedestrians":["🚷"],"no mobile phones":["📵"],"no one under eighteen":["🔞"],agerestriction:["🔞"],eighteen:["🔞"],"up arrow":["⬆"],cardinal:["⬆","➡","⬇","⬅"],direction:["⬆","↗","➡","↘","⬇","↙","⬅","↖"],"up-right arrow":["↗"],intercardinal:["↗","↘","↙","↖"],"right arrow":["➡"],"down-right arrow":["↘"],southeast:["↘"],"down arrow":["⬇"],south:["⬇"],"down-left arrow":["↙"],southwest:["↙"],"left arrow":["⬅"],west:["⬅"],"up-left arrow":["↖"],"up-down arrow":["↕"],"left-right arrow":["↔"],"right arrow curving left":["↩"],"left arrow curving right":["↪"],"right arrow curving up":["⤴"],"right arrow curving down":["⤵"],"clockwise vertical arrows":["🔃"],reload:["🔃"],"anticlockwise arrows button":["🔄"],anticlockwise:["🔄"],counterclockwise:["🔄"],withershins:["🔄"],"BACK arrow":["🔙"],"END arrow":["🔚"],"ON! arrow":["🔛"],on:["🔛"],"SOON arrow":["🔜"],soon:["🔜"],"TOP arrow":["🔝"],"place of worship":["🛐"],worship:["🛐"],"atom symbol":["⚛"],om:["🕉"],Hindu:["🕉"],"star of David":["✡"],David:["✡"],"wheel of dharma":["☸"],Buddhist:["☸"],"yin yang":["☯"],"latin cross":["✝"],"orthodox cross":["☦"],"star and crescent":["☪"],"peace symbol":["☮"],menorah:["🕎"],candelabrum:["🕎"],candlestick:["🕎"],"dotted six-pointed star":["🔯"],"shuffle tracks button":["🔀"],"repeat button":["🔁"],"repeat single button":["🔂"],once:["🔂"],"play button":["▶"],right:["▶","⏯"],"fast-forward button":["⏩"],"double":["⏩","⏪","⏫","⏬","⏸","➿"],forward:["⏩"],"next track button":["⏭"],nextscene:["⏭"],nexttrack:["⏭"],"play or pause button":["⏯"],pause:["⏯","⏸"],"reverse button":["◀"],left:["◀"],reverse:["◀"],"fast reverse button":["⏪"],"last track button":["⏮"],previousscene:["⏮"],previoustrack:["⏮"],"up button":["🔼"],button:["🔼","🔽","🔘","🔲","🔳"],"fast up button":["⏫"],"down button":["🔽"],"fast down button":["⏬"],"pause button":["⏸"],vertical:["⏸"],"stop button":["⏹"],square:["⏹","❎","▪","▫","◻","◼","◽","◾","⬛","⬜","🔲","🔳"],"record button":["⏺"],circle:["⏺","⭕","Ⓜ","⚪","⚫","🔴","🔵"],"dim button":["🔅"],low:["🔅"],"bright button":["🔆"],"antenna bars":["📶"],"vibration mode":["📳"],mode:["📳"],vibration:["📳"],"mobile phone off":["📴"],"recycling symbol":["♻"],"name badge":["📛"],"Japanese symbol for beginner":["🔰"],beginner:["🔰"],chevron:["🔰"],"trident emblem":["🔱"],emblem:["🔱"],"heavy large circle":["⭕"],o:["⭕","🅾"],"white heavy check mark":["✅"],"ballot box with check":["☑"],"heavy check mark":["✔"],"heavy multiplication x":["✖"],cancel:["✖","❌"],x:["✖","❌"],"cross mark":["❌"],"cross mark button":["❎"],"heavy plus sign":["➕"],"heavy minus sign":["➖"],"heavy division sign":["➗"],"curly loop":["➰"],loop:["➰","➿"],"double curly loop":["➿"],"part alternation mark":["〽"],part:["〽"],"eight-spoked asterisk":["✳"],asterisk:["✳"],"eight-pointed star":["✴"],"double exclamation mark":["‼"],bangbang:["‼"],"exclamation question mark":["⁉"],interrobang:["⁉"],"white question mark":["❔"],"white exclamation mark":["❕"],"exclamation mark":["❗"],"wavy dash":["〰"],"trade mark":["™"],keycap:["#️⃣","*️⃣","0️⃣","1️⃣","2️⃣","3️⃣","4️⃣","5️⃣","6️⃣","7️⃣","8️⃣","9️⃣"],"keycap 10":["🔟"],keycap10:["🔟"],"hundred points":["💯"],"input latin uppercase":["🔠"],ABCD:["🔠"],input:["🔠","🔡","🔢","🔣","🔤"],latin:["🔠","🔡","🔤"],letters:["🔠","🔡","🔤"],uppercase:["🔠"],"input latin lowercase":["🔡"],"input numbers":["🔢"],"input symbols":["🔣"],"〒♪&%":["🔣"],"input latin letters":["🔤"],"A button (blood type)":["🅰"],a:["🅰"],bloodtype:["🅰","🆎","🅱","🅾"],"AB button (blood type)":["🆎"],ab:["🆎"],"B button (blood type)":["🅱"],b:["🅱"],"CL button":["🆑"],cl:["🆑"],"COOL button":["🆒"],"FREE button":["🆓"],i:["ℹ"],"ID button":["🆔"],id:["🆔"],identity:["🆔"],"circled M":["Ⓜ"],m:["Ⓜ"],"NEW button":["🆕"],"NG button":["🆖"],"O button (blood type)":["🅾"],"OK button":["🆗"],"P button":["🅿"],"SOS button":["🆘"],sos:["🆘"],"UP! button":["🆙"],"VS button":["🆚"],vs:["🆚"],"Japanese “here” button":["🈁"],"“here”":["🈁"],katakana:["🈁","🈂"],"ココ":["🈁"],"Japanese “service charge” button":["🈂"],"“servicecharge”":["🈂"],"サ":["🈂"],"Japanese “monthly amount” button":["🈷"],"“monthlyamount”":["🈷"],ideograph:["🈷","🈶","🈯","🉐","🈹","🈚","🈲","🉑","🈸","🈴","🈳","㊗","㊙","🈺","🈵"],"月":["🈷"],"Japanese “not free of charge” button":["🈶"],"“notfreeofcharge”":["🈶"],"有":["🈶"],"Japanese “reserved” button":["🈯"],"“reserved”":["🈯"],"指":["🈯"],"Japanese “bargain” button":["🉐"],"“bargain”":["🉐"],"得":["🉐"],"Japanese “discount” button":["🈹"],"“discount”":["🈹"],"割":["🈹"],"Japanese “free of charge” button":["🈚"],"“freeofcharge”":["🈚"],"無":["🈚"],"Japanese “prohibited” button":["🈲"],"“prohibited”":["🈲"],"禁":["🈲"],"Japanese “acceptable” button":["🉑"],"“acceptable”":["🉑"],"可":["🉑"],"Japanese “application” button":["🈸"],"“application”":["🈸"],"申":["🈸"],"Japanese “passing grade” button":["🈴"],"“passinggrade”":["🈴"],"合":["🈴"],"Japanese “vacancy” button":["🈳"],"“vacancy”":["🈳"],"空":["🈳"],"Japanese “congratulations” button":["㊗"],"“congratulations”":["㊗"],"祝":["㊗"],"Japanese “secret” button":["㊙"],"“secret”":["㊙"],"秘":["㊙"],"Japanese “open for business” button":["🈺"],"“openforbusiness”":["🈺"],"営":["🈺"],"Japanese “no vacancy” button":["🈵"],"“novacancy”":["🈵"],"満":["🈵"],"black small square":["▪"],geometric:["▪","▫","◻","◼","◽","◾","⬛","⬜","🔶","🔷","🔸","🔹","🔺","🔻","💠","🔘","🔲","🔳","⚪","⚫","🔴","🔵"],"white small square":["▫"],"white medium square":["◻"],"black medium square":["◼"],"white medium-small square":["◽"],"black medium-small square":["◾"],"black large square":["⬛"],"white large square":["⬜"],"large orange diamond":["🔶"],"large blue diamond":["🔷"],"small orange diamond":["🔸"],"small blue diamond":["🔹"],"red triangle pointed up":["🔺"],"red triangle pointed down":["🔻"],"diamond with a dot":["💠"],inside:["💠"],"radio button":["🔘"],"black square button":["🔲"],"white square button":["🔳"],"white circle":["⚪"],"black circle":["⚫"],"red circle":["🔴"],"blue circle":["🔵"],"chequered flag":["🏁"],"triangular flag":["🚩"],"crossed flags":["🎌"],"black flag":["🏴"],"white flag":["🏳"],Andorra:["🇦🇩"],"United Arab Emirates":["🇦🇪"],Afghanistan:["🇦🇫"],"Antigua & Barbuda":["🇦🇬"],Anguilla:["🇦🇮"],Albania:["🇦🇱"],Armenia:["🇦🇲"],Angola:["🇦🇴"],Antarctica:["🇦🇶"],Argentina:["🇦🇷"],"American Samoa":["🇦🇸"],Austria:["🇦🇹"],Aruba:["🇦🇼"],"Åland Islands":["🇦🇽"],Azerbaijan:["🇦🇿"],"Bosnia & Herzegovina":["🇧🇦"],Barbados:["🇧🇧"],Bangladesh:["🇧🇩"],Belgium:["🇧🇪"],"Burkina Faso":["🇧🇫"],Bulgaria:["🇧🇬"],Bahrain:["🇧🇭"],Burundi:["🇧🇮"],Benin:["🇧🇯"],"St. Barthélemy":["🇧🇱"],Bermuda:["🇧🇲"],Brunei:["🇧🇳"],Bolivia:["🇧🇴"],"Caribbean Netherlands":["🇧🇶"],Brazil:["🇧🇷"],Bahamas:["🇧🇸"],Bhutan:["🇧🇹"],Botswana:["🇧🇼"],Belarus:["🇧🇾"],Belize:["🇧🇿"],Canada:["🇨🇦"],"Cocos (Keeling) Islands":["🇨🇨"],"Congo - Kinshasa":["🇨🇩"],"Central African Republic":["🇨🇫"],"Congo - Brazzaville":["🇨🇬"],Switzerland:["🇨🇭"],"Côte d’Ivoire":["🇨🇮"],"Cook Islands":["🇨🇰"],Chile:["🇨🇱"],Cameroon:["🇨🇲"],China:["🇨🇳"],Colombia:["🇨🇴"],"Costa Rica":["🇨🇷"],Cuba:["🇨🇺"],"Cape Verde":["🇨🇻"],"Curaçao":["🇨🇼"],"Christmas Island":["🇨🇽"],Cyprus:["🇨🇾"],"Czech Republic":["🇨🇿"],Germany:["🇩🇪"],Djibouti:["🇩🇯"],Denmark:["🇩🇰"],Dominica:["🇩🇲"],"Dominican Republic":["🇩🇴"],Algeria:["🇩🇿"],Ecuador:["🇪🇨"],Estonia:["🇪🇪"],Egypt:["🇪🇬"],"Western Sahara":["🇪🇭"],Eritrea:["🇪🇷"],Spain:["🇪🇸"],Ethiopia:["🇪🇹"],"European Union":["🇪🇺"],Finland:["🇫🇮"],Fiji:["🇫🇯"],"Falkland Islands":["🇫🇰"],Micronesia:["🇫🇲"],"Faroe Islands":["🇫🇴"],France:["🇫🇷"],Gabon:["🇬🇦"],"United Kingdom":["🇬🇧"],Grenada:["🇬🇩"],Georgia:["🇬🇪"],"French Guiana":["🇬🇫"],Guernsey:["🇬🇬"],Ghana:["🇬🇭"],Gibraltar:["🇬🇮"],Greenland:["🇬🇱"],Gambia:["🇬🇲"],Guinea:["🇬🇳"],Guadeloupe:["🇬🇵"],"Equatorial Guinea":["🇬🇶"],Greece:["🇬🇷"],"South Georgia & South Sandwich Islands":["🇬🇸"],Guatemala:["🇬🇹"],Guam:["🇬🇺"],"Guinea-Bissau":["🇬🇼"],Guyana:["🇬🇾"],"Hong Kong SAR China":["🇭🇰"],Honduras:["🇭🇳"],Croatia:["🇭🇷"],Haiti:["🇭🇹"],Hungary:["🇭🇺"],"Canary Islands":["🇮🇨"],Indonesia:["🇮🇩"],Ireland:["🇮🇪"],Israel:["🇮🇱"],"Isle of Man":["🇮🇲"],India:["🇮🇳"],"British Indian Ocean Territory":["🇮🇴"],Iraq:["🇮🇶"],Iran:["🇮🇷"],Iceland:["🇮🇸"],Italy:["🇮🇹"],Jersey:["🇯🇪"],Jamaica:["🇯🇲"],Jordan:["🇯🇴"],Kenya:["🇰🇪"],Kyrgyzstan:["🇰🇬"],Cambodia:["🇰🇭"],Kiribati:["🇰🇮"],Comoros:["🇰🇲"],"St. Kitts & Nevis":["🇰🇳"],"North Korea":["🇰🇵"],"South Korea":["🇰🇷"],Kuwait:["🇰🇼"],"Cayman Islands":["🇰🇾"],Kazakhstan:["🇰🇿"],Laos:["🇱🇦"],Lebanon:["🇱🇧"],"St. Lucia":["🇱🇨"],Liechtenstein:["🇱🇮"],"Sri Lanka":["🇱🇰"],Liberia:["🇱🇷"],Lesotho:["🇱🇸"],Lithuania:["🇱🇹"],Luxembourg:["🇱🇺"],Latvia:["🇱🇻"],Libya:["🇱🇾"],Morocco:["🇲🇦"],Monaco:["🇲🇨"],Moldova:["🇲🇩"],Montenegro:["🇲🇪"],Madagascar:["🇲🇬"],"Marshall Islands":["🇲🇭"],Macedonia:["🇲🇰"],Mali:["🇲🇱"],"Myanmar (Burma)":["🇲🇲"],Mongolia:["🇲🇳"],"Macau SAR China":["🇲🇴"],"Northern Mariana Islands":["🇲🇵"],Martinique:["🇲🇶"],Mauritania:["🇲🇷"],Montserrat:["🇲🇸"],
Malta:["🇲🇹"],Mauritius:["🇲🇺"],Maldives:["🇲🇻"],Malawi:["🇲🇼"],Mexico:["🇲🇽"],Malaysia:["🇲🇾"],Mozambique:["🇲🇿"],Namibia:["🇳🇦"],"New Caledonia":["🇳🇨"],Niger:["🇳🇪"],"Norfolk Island":["🇳🇫"],Nigeria:["🇳🇬"],Nicaragua:["🇳🇮"],Netherlands:["🇳🇱"],Norway:["🇳🇴"],Nepal:["🇳🇵"],Nauru:["🇳🇷"],Niue:["🇳🇺"],"New Zealand":["🇳🇿"],Oman:["🇴🇲"],Panama:["🇵🇦"],Peru:["🇵🇪"],"French Polynesia":["🇵🇫"],"Papua New Guinea":["🇵🇬"],Philippines:["🇵🇭"],Pakistan:["🇵🇰"],Poland:["🇵🇱"],"St. Pierre & Miquelon":["🇵🇲"],"Pitcairn Islands":["🇵🇳"],"Puerto Rico":["🇵🇷"],"Palestinian Territories":["🇵🇸"],Portugal:["🇵🇹"],Palau:["🇵🇼"],Paraguay:["🇵🇾"],Qatar:["🇶🇦"],"Réunion":["🇷🇪"],Romania:["🇷🇴"],Serbia:["🇷🇸"],Russia:["🇷🇺"],Rwanda:["🇷🇼"],"Saudi Arabia":["🇸🇦"],"Solomon Islands":["🇸🇧"],Seychelles:["🇸🇨"],Sudan:["🇸🇩"],Sweden:["🇸🇪"],Singapore:["🇸🇬"],"St. Helena":["🇸🇭"],Slovenia:["🇸🇮"],Slovakia:["🇸🇰"],"Sierra Leone":["🇸🇱"],"San Marino":["🇸🇲"],Senegal:["🇸🇳"],Somalia:["🇸🇴"],Suriname:["🇸🇷"],"South Sudan":["🇸🇸"],"São Tomé & Príncipe":["🇸🇹"],"El Salvador":["🇸🇻"],"Sint Maarten":["🇸🇽"],Syria:["🇸🇾"],Swaziland:["🇸🇿"],"Turks & Caicos Islands":["🇹🇨"],Chad:["🇹🇩"],"French Southern Territories":["🇹🇫"],Togo:["🇹🇬"],Thailand:["🇹🇭"],Tajikistan:["🇹🇯"],Tokelau:["🇹🇰"],"Timor-Leste":["🇹🇱"],Turkmenistan:["🇹🇲"],Tunisia:["🇹🇳"],Tonga:["🇹🇴"],Turkey:["🇹🇷"],"Trinidad & Tobago":["🇹🇹"],Tuvalu:["🇹🇻"],Taiwan:["🇹🇼"],Tanzania:["🇹🇿"],Ukraine:["🇺🇦"],Uganda:["🇺🇬"],"United States":["🇺🇸"],Uruguay:["🇺🇾"],Uzbekistan:["🇺🇿"],"Vatican City":["🇻🇦"],"St. Vincent & Grenadines":["🇻🇨"],Venezuela:["🇻🇪"],"British Virgin Islands":["🇻🇬"],"U.S. Virgin Islands":["🇻🇮"],Vietnam:["🇻🇳"],Vanuatu:["🇻🇺"],"Wallis & Futuna":["🇼🇫"],Samoa:["🇼🇸"],Kosovo:["🇽🇰"],Yemen:["🇾🇪"],Mayotte:["🇾🇹"],"South Africa":["🇿🇦"],Zambia:["🇿🇲"],Zimbabwe:["🇿🇼"]}},function(e,t,n){e.exports=function(){return n(459)('/*! Copyright (c) 2015 WhatsApp Inc.  All Rights Reserved. */\n!function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var e={};return n.m=t,n.c=e,n.oe=function(t){throw t},n.p="/",n(n.s=31)}([function(t,n,e){!function(e,r){t.exports=n=r()}(this,function(){var t=t||function(t,n){var e={},r=e.lib={},i=r.Base=function(){function t(){}return{extend:function(n){t.prototype=this;var e=new t;return n&&e.mixIn(n),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=r.WordArray=i.extend({init:function(t,e){t=this.words=t||[],e!=n?this.sigBytes=e:this.sigBytes=4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var n=this.words,e=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=e[o>>>2]>>>24-o%4*8&255;n[r+o>>>2]|=a<<24-(r+o)%4*8}else for(var o=0;o<i;o+=4)n[r+o>>>2]=e[o>>>2];return this.sigBytes+=i,this},clamp:function(){var n=this.words,e=this.sigBytes;n[e>>>2]&=4294967295<<32-e%4*8,n.length=t.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(n){for(var e,r=[],i=function(n){var n=n,e=987654321,r=4294967295;return function(){e=36969*(65535&e)+(e>>16)&r,n=18e3*(65535&n)+(n>>16)&r;var i=(e<<16)+n&r;return i/=4294967296,i+=.5,i*(t.random()>.5?1:-1)}},a=0;a<n;a+=4){var u=i(4294967296*(e||t.random()));e=987654071*u(),r.push(4294967296*u()|0)}return new o.init(r,n)}}),a=e.enc={},u=a.Hex={stringify:function(t){for(var n=t.words,e=t.sigBytes,r=[],i=0;i<e;i++){var o=n[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var n=t.length,e=[],r=0;r<n;r+=2)e[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new o.init(e,n/2)}},c=a.Latin1={stringify:function(t){for(var n=t.words,e=t.sigBytes,r=[],i=0;i<e;i++){var o=n[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var n=t.length,e=[],r=0;r<n;r++)e[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new o.init(e,n)}},s=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(n){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=s.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(n){var e=this._data,r=e.words,i=e.sigBytes,a=this.blockSize,u=4*a,c=i/u;c=n?t.ceil(c):t.max((0|c)-this._minBufferSize,0);var s=c*a,f=t.min(4*s,i);if(s){for(var l=0;l<s;l+=a)this._doProcessBlock(r,l);var p=r.splice(0,s);e.sigBytes-=f}return new o.init(p,f)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),l=(r.Hasher=f.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){t&&this._append(t);var n=this._doFinalize();return n},blockSize:16,_createHelper:function(t){return function(n,e){return new t.init(e).finalize(n)}},_createHmacHelper:function(t){return function(n,e){return new l.HMAC.init(t,e).finalize(n)}}}),e.algo={});return e}(Math);return t})},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n,e){t.exports=!e(7)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(8);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n,e){var r=e(8),i=e(2).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,e){var r=e(2),i=e(1),o=e(14),a=e(45),u="prototype",c=function(t,n,e){var s,f,l,p=t&c.F,h=t&c.G,d=t&c.S,v=t&c.P,m=t&c.B,g=t&c.W,y=h?i:i[n]||(i[n]={}),_=y[u],x=h?r:d?r[n]:(r[n]||{})[u];h&&(e=n);for(s in e)f=!p&&x&&void 0!==x[s],f&&s in y||(l=f?x[s]:e[s],y[s]=h&&"function"!=typeof x[s]?e[s]:m&&f?o(l,r):g&&x[s]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[u]=t[u],n}(l):v&&"function"==typeof l?o(Function.call,l):l,v&&((y.virtual||(y.virtual={}))[s]=l,t&c.R&&_&&!_[s]&&a(_,s,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){t.exports=function(t){try{return!!t()}catch(n){return!0}}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,e){!function(r,i){t.exports=n=i(e(0))}(this,function(t){return function(){var n=t,e=n.lib,r=e.WordArray,i=n.enc;i.Base64={stringify:function(t){var n=t.words,e=t.sigBytes,r=this._map;t.clamp();for(var i=[],o=0;o<e;o+=3)for(var a=n[o>>>2]>>>24-o%4*8&255,u=n[o+1>>>2]>>>24-(o+1)%4*8&255,c=n[o+2>>>2]>>>24-(o+2)%4*8&255,s=a<<16|u<<8|c,f=0;f<4&&o+.75*f<e;f++)i.push(r.charAt(s>>>6*(3-f)&63));var l=r.charAt(64);if(l)for(;i.length%4;)i.push(l);return i.join("")},parse:function(t){var n=t.length,e=this._map,i=e.charAt(64);if(i){var o=t.indexOf(i);o!=-1&&(n=o)}for(var a=[],u=0,c=0;c<n;c++)if(c%4){var s=e.indexOf(t.charAt(c-1))<<c%4*2,f=e.indexOf(t.charAt(c))>>>6-c%4*2,l=s|f;a[u>>>2]|=l<<24-u%4*8,u++}return r.create(a,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),t.enc.Base64})},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,n,e,r){function i(t){l.isFunction(n)?this.message=n.apply(this,arguments):arguments.length>0?this.message=""+t:n?this.message=n:this.message=this.name;var e=this.message!==this.name?this.name+": "+this.message:this.name,i=new Error(e).stack;if(!i)try{throw new Error(e)}catch(o){i=o.stack,i||(i="Error: "+e+"\\n    at (unspecified)")}this.stack=i,l.isFunction(r)&&r.apply(this,l.tail(arguments))}return e=e||Error,i.prototype=(0,f["default"])(e.prototype),i.prototype.name=t,i}function o(t,n){return l.reduce(t,function(t,e,r){var o,a;return l.isString(r)?(o=r,a=e):o=e,t[o]=i(o,a,n),t},{})}function a(t){this.event=t;try{return(0,c["default"])(t)}catch(n){return""+t}}var u=e(35),c=r(u),s=e(12),f=r(s),l=e(24),p=i("WAPStatusCode"),h=i("401",null,p),d=i("404",null,p),v=i("500",null,p),m=i("WapDrop"),g=i("EphemeralDrop",null,m),y=i("LogoutDrop",null,m),_=i("Server5xxDrop",null,m),x=i("ConventionViolationDrop",null,m),w=i("BrowserReplacedDrop",null,m),b=i("ShouldLoop"),k=i("GaveUpRetry"),E=i("GUMError"),S=o({NotSupportedError:"The operation is not supported.",PermissionDeniedError:"The user did not grant permission for the operation",ConstraintNotSatisfiedError:"One of the mandatory Constraints could not be satisfied.",OverconstrainedError:"Due to changes in the environment, one or more mandatory constraints can no longer be satisfied.",NotFoundError:"The object can not be found here.",AbortError:"The operation was aborted.",SourceUnavailableError:"The source of the MediaStream could not be accessed due to a hardware error (e.g. lock from another process)."},E),A=i("MediaNeedsReupload"),j=i("MediaFileError"),z=i("InvalidMediaFileType",null,j),C=i("MediaFileTooLarge",function(t){return this.file=t,"File ("+t.type+") size = "+t.size},j),M=i("MediaEncryptionError",null,j),I=i("MediaFileFailedLoad",null,j),B=i("ImageError","Image failed to load.",null,function(t,n){this.src=t,this.status=n,this.target={src:t,status:n}}),O=i("ServerStatusError","Server replied with a fail status code",null,function(t,n){this.url=t,this.status=n}),R=i("ContactBlocked","Contact is blocked",null,function(t){this.contact=t}),T=i("CapabilityError"),U=i("CapabilityUnsupported",null,T,function(t){this.jidCapabilities=t}),D=i("CapabilityInvalid",null,T),W=i("CapabilityUnknown",null,T),F=i("MediaMissing","Media is no longer available on your phone"),L=i("MediaUnsupported","Media format is unsupported"),P=i("MediaLoadError",null,null,function(t){this.src=t}),q=i("MediaDragDropError",null,P,function(t){this.src=t}),N=i("SocketError",a),H=i("SocketClosed",a),K=i("SocketNotOpen",function(t){return"socket not open, is "+t}),J=i("BlockedByProxy");t.exports={define:i,defineAll:o,QueryDrop:i("QueryDrop"),WapDrop:m,EphemeralDrop:g,LogoutDrop:y,Server5xxDrop:_,ConventionViolationDrop:x,BrowserReplacedDrop:w,ShouldLoop:b,GaveUpRetry:k,MediaFileError:j,InvalidMediaFileType:z,MediaFileTooLarge:C,MediaEncryptionError:M,MediaFileFailedLoad:I,WAPStatusCode:p,E401:h,E404:d,E500:v,SocketError:N,SocketClosed:H,SocketNotOpen:K,BlockedByProxy:J,ImageError:B,ServerStatusError:O,ContactBlocked:R,MediaNeedsReupload:A,MediaMissing:F,MediaLoadError:P,MediaDragDropError:q,MediaUnsupportedError:L,CapabilityError:T,CapabilityUnsupported:U,CapabilityInvalid:D,CapabilityUnknown:W,CanNotSendUnencrypted:i("CanNotSendUnencrypted"),ActionError:i("ActionError","Could not perform action."),GUM:l.defaults(S,{GUMError:E,PERMISSION_DENIED:S.PermissionDeniedError,NOT_SUPPORTED_ERROR:S.ConstraintNotSatisfiedError,MANDATORY_UNSATISFIED_ERROR:S.NotFoundError}),Unmount:i("unmount"),ActiveChatChanged:i("ActiveChatChanged")}},function(t,n){"use strict";function e(t){if((Array.isArray(t)||t instanceof ArrayBuffer)&&(t=new Uint8Array(t)),t.length<=a)return r(t);for(var n=[],e=0;e<t.length;e+=a)n.push(r(t.subarray(e,e+a)));return n.join("")}function r(t){for(var n=Math.ceil(4*t.length/3),e=4*Math.ceil(t.length/3),r=new Array(e),i=0,o=0;i<e;i+=4,o+=3){var a=t[o]<<16|t[o+1]<<8|t[o+2];r[i]=a>>18,r[i+1]=a>>12&63,r[i+2]=a>>6&63,r[i+3]=63&a}for(var u=0;u<n;u++){var c=r[u];c<26?r[u]=65+c:c<52?r[u]=71+c:c<62?r[u]=c-4:62===c?r[u]=43:r[u]=47}for(var s=n;s<e;s++)r[s]=61;return String.fromCharCode.apply(String,r)}function i(t){for(var n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],e=t.length,r=new Int32Array(e+e%4),i=0;i<e;i++){var o=t.charCodeAt(i);if(65<=o&&o<=90)r[i]=o-65;else if(97<=o&&o<=122)r[i]=o-71;else if(48<=o&&o<=57)r[i]=o+4;else if(43===o)r[i]=62;else{if(47!==o){if(61===o){e=i;break}return null}r[i]=63}}for(var a=r.length/4,u=0,c=0;u<a;u++,c+=4)r[u]=r[c]<<18|r[c+1]<<12|r[c+2]<<6|r[c+3];for(var s=Math.floor(3*e/4),f=new Uint8Array(s),l=0,p=0;p+3<=s;l++,p+=3){var h=r[l];f[p]=h>>16,f[p+1]=h>>8&255,f[p+2]=255&h}switch(s-p){case 2:f[p]=r[l]>>16,f[p+1]=r[l]>>8&255;break;case 1:f[p]=r[l]>>16}return n?Array.prototype.slice.call(f):f.buffer}function o(t){return t.replace(/\\+/g,"-").replace(/\\//g,"_")}var a=3e3;t.exports={encode:e,decode:i,urlSafe:o}},function(t,n,e){t.exports={"default":e(39),__esModule:!0}},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(42);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,i){return t.call(n,e,r,i)}}return function(){return t.apply(n,arguments)}}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can\'t call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,e){t.exports=e(2).document&&document.documentElement},function(t,n,e){var r=e(4),i=e(46),o=e(59),a=Object.defineProperty;n.f=e(3)?Object.defineProperty:function(t,n,e){if(r(t),n=o(n,!0),r(e),i)try{return a(t,n,e)}catch(u){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(51),i=e(16);t.exports=Object.keys||function(t){return r(t,i)}},function(t,n,e){var r=e(54)("keys"),i=e(60);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(48),i=e(15);t.exports=function(t){return r(i(t))}},function(t,n,e){!function(r,i){t.exports=n=i(e(0))}(this,function(t){!function(){var n=t,e=n.lib,r=e.Base,i=n.enc,o=i.Utf8,a=n.algo;a.HMAC=r.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=o.parse(n));var e=t.blockSize,r=4*e;n.sigBytes>r&&(n=t.finalize(n)),n.clamp();for(var i=this._oKey=n.clone(),a=this._iKey=n.clone(),u=i.words,c=a.words,s=0;s<e;s++)u[s]^=1549556828,c[s]^=909522486;i.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var n=this._hasher,e=n.finalize(t);n.reset();var r=n.finalize(this._oKey.clone().concat(e));return r}})}()})},function(t,n,e){var r;(function(t,i){(function(){function o(t,n){return t.set(n[0],n[1]),t}function a(t,n){return t.add(n),t}function u(t,n,e){switch(e.length){case 0:return t.call(n);case 1:return t.call(n,e[0]);case 2:return t.call(n,e[0],e[1]);case 3:return t.call(n,e[0],e[1],e[2])}return t.apply(n,e)}function c(t,n,e,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];n(r,a,e(a),t)}return r}function s(t,n){for(var e=-1,r=null==t?0:t.length;++e<r&&n(t[e],e,t)!==!1;);return t}function f(t,n){for(var e=null==t?0:t.length;e--&&n(t[e],e,t)!==!1;);return t}function l(t,n){for(var e=-1,r=null==t?0:t.length;++e<r;)if(!n(t[e],e,t))return!1;return!0}function p(t,n){for(var e=-1,r=null==t?0:t.length,i=0,o=[];++e<r;){var a=t[e];n(a,e,t)&&(o[i++]=a)}return o}function h(t,n){var e=null==t?0:t.length;return!!e&&E(t,n,0)>-1}function d(t,n,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(e(n,t[r]))return!0;return!1}function v(t,n){for(var e=-1,r=null==t?0:t.length,i=Array(r);++e<r;)i[e]=n(t[e],e,t);return i}function m(t,n){for(var e=-1,r=n.length,i=t.length;++e<r;)t[i+e]=n[e];return t}function g(t,n,e,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(e=t[++i]);++i<o;)e=n(e,t[i],i,t);return e}function y(t,n,e,r){var i=null==t?0:t.length;for(r&&i&&(e=t[--i]);i--;)e=n(e,t[i],i,t);return e}function _(t,n){for(var e=-1,r=null==t?0:t.length;++e<r;)if(n(t[e],e,t))return!0;return!1}function x(t){return t.split("")}function w(t){return t.match(Hn)||[]}function b(t,n,e){var r;return e(t,function(t,e,i){if(n(t,e,i))return r=e,!1}),r}function k(t,n,e,r){for(var i=t.length,o=e+(r?1:-1);r?o--:++o<i;)if(n(t[o],o,t))return o;return-1}function E(t,n,e){return n===n?Z(t,n,e):k(t,A,e)}function S(t,n,e,r){for(var i=e-1,o=t.length;++i<o;)if(r(t[i],n))return i;return-1}function A(t){return t!==t}function j(t,n){var e=null==t?0:t.length;return e?B(t,n)/e:Dt}function z(t){return function(n){return null==n?it:n[t]}}function C(t){return function(n){return null==t?it:t[n]}}function M(t,n,e,r,i){return i(t,function(t,i,o){e=r?(r=!1,t):n(e,t,i,o)}),e}function I(t,n){var e=t.length;for(t.sort(n);e--;)t[e]=t[e].value;return t}function B(t,n){for(var e,r=-1,i=t.length;++r<i;){var o=n(t[r]);o!==it&&(e=e===it?o:e+o)}return e}function O(t,n){for(var e=-1,r=Array(t);++e<t;)r[e]=n(e);return r}function R(t,n){return v(n,function(n){return[n,t[n]]})}function T(t){return function(n){return t(n)}}function U(t,n){return v(n,function(n){return t[n]})}function D(t,n){return t.has(n)}function W(t,n){for(var e=-1,r=t.length;++e<r&&E(n,t[e],0)>-1;);return e}function F(t,n){for(var e=t.length;e--&&E(n,t[e],0)>-1;);return e}function L(t,n){for(var e=t.length,r=0;e--;)t[e]===n&&++r;return r}function P(t){return"\\\\"+er[t]}function q(t,n){return null==t?it:t[n]}function N(t){return $e.test(t)}function H(t){return Ve.test(t)}function K(t){for(var n,e=[];!(n=t.next()).done;)e.push(n.value);return e}function J(t){var n=-1,e=Array(t.size);return t.forEach(function(t,r){e[++n]=[r,t]}),e}function $(t,n){return function(e){return t(n(e))}}function V(t,n){for(var e=-1,r=t.length,i=0,o=[];++e<r;){var a=t[e];a!==n&&a!==lt||(t[e]=lt,o[i++]=e)}return o}function G(t){var n=-1,e=Array(t.size);return t.forEach(function(t){e[++n]=t}),e}function X(t){var n=-1,e=Array(t.size);return t.forEach(function(t){e[++n]=[t,t]}),e}function Z(t,n,e){for(var r=e-1,i=t.length;++r<i;)if(t[r]===n)return r;return-1}function Y(t,n,e){for(var r=e+1;r--;)if(t[r]===n)return r;return r}function Q(t){return N(t)?nt(t):_r(t)}function tt(t){return N(t)?et(t):x(t)}function nt(t){for(var n=Ke.lastIndex=0;Ke.test(t);)++n;return n}function et(t){return t.match(Ke)||[]}function rt(t){return t.match(Je)||[]}var it,ot="4.17.4",at=200,ut="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ct="Expected a function",st="__lodash_hash_undefined__",ft=500,lt="__lodash_placeholder__",pt=1,ht=2,dt=4,vt=1,mt=2,gt=1,yt=2,_t=4,xt=8,wt=16,bt=32,kt=64,Et=128,St=256,At=512,jt=30,zt="...",Ct=800,Mt=16,It=1,Bt=2,Ot=3,Rt=1/0,Tt=9007199254740991,Ut=1.7976931348623157e308,Dt=NaN,Wt=4294967295,Ft=Wt-1,Lt=Wt>>>1,Pt=[["ary",Et],["bind",gt],["bindKey",yt],["curry",xt],["curryRight",wt],["flip",At],["partial",bt],["partialRight",kt],["rearg",St]],qt="[object Arguments]",Nt="[object Array]",Ht="[object AsyncFunction]",Kt="[object Boolean]",Jt="[object Date]",$t="[object DOMException]",Vt="[object Error]",Gt="[object Function]",Xt="[object GeneratorFunction]",Zt="[object Map]",Yt="[object Number]",Qt="[object Null]",tn="[object Object]",nn="[object Promise]",en="[object Proxy]",rn="[object RegExp]",on="[object Set]",an="[object String]",un="[object Symbol]",cn="[object Undefined]",sn="[object WeakMap]",fn="[object WeakSet]",ln="[object ArrayBuffer]",pn="[object DataView]",hn="[object Float32Array]",dn="[object Float64Array]",vn="[object Int8Array]",mn="[object Int16Array]",gn="[object Int32Array]",yn="[object Uint8Array]",_n="[object Uint8ClampedArray]",xn="[object Uint16Array]",wn="[object Uint32Array]",bn=/\\b__p \\+= \'\';/g,kn=/\\b(__p \\+=) \'\' \\+/g,En=/(__e\\(.*?\\)|\\b__t\\)) \\+\\n\'\';/g,Sn=/&(?:amp|lt|gt|quot|#39);/g,An=/[&<>"\']/g,jn=RegExp(Sn.source),zn=RegExp(An.source),Cn=/<%-([\\s\\S]+?)%>/g,Mn=/<%([\\s\\S]+?)%>/g,In=/<%=([\\s\\S]+?)%>/g,Bn=/\\.|\\[(?:[^[\\]]*|(["\'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,On=/^\\w*$/,Rn=/^\\./,Tn=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|(["\'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,Un=/[\\\\^$.*+?()[\\]{}|]/g,Dn=RegExp(Un.source),Wn=/^\\s+|\\s+$/g,Fn=/^\\s+/,Ln=/\\s+$/,Pn=/\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,qn=/\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,Nn=/,? & /,Hn=/[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g,Kn=/\\\\(\\\\)?/g,Jn=/\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g,$n=/\\w*$/,Vn=/^[-+]0x[0-9a-f]+$/i,Gn=/^0b[01]+$/i,Xn=/^\\[object .+?Constructor\\]$/,Zn=/^0o[0-7]+$/i,Yn=/^(?:0|[1-9]\\d*)$/,Qn=/[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g,te=/($^)/,ne=/[\'\\n\\r\\u2028\\u2029\\\\]/g,ee="\\\\ud800-\\\\udfff",re="\\\\u0300-\\\\u036f",ie="\\\\ufe20-\\\\ufe2f",oe="\\\\u20d0-\\\\u20ff",ae=re+ie+oe,ue="\\\\u2700-\\\\u27bf",ce="a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff",se="\\\\xac\\\\xb1\\\\xd7\\\\xf7",fe="\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf",le="\\\\u2000-\\\\u206f",pe=" \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000",he="A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde",de="\\\\ufe0e\\\\ufe0f",ve=se+fe+le+pe,me="[\'’]",ge="["+ee+"]",ye="["+ve+"]",_e="["+ae+"]",xe="\\\\d+",we="["+ue+"]",be="["+ce+"]",ke="[^"+ee+ve+xe+ue+ce+he+"]",Ee="\\\\ud83c[\\\\udffb-\\\\udfff]",Se="(?:"+_e+"|"+Ee+")",Ae="[^"+ee+"]",je="(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}",ze="[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]",Ce="["+he+"]",Me="\\\\u200d",Ie="(?:"+be+"|"+ke+")",Be="(?:"+Ce+"|"+ke+")",Oe="(?:"+me+"(?:d|ll|m|re|s|t|ve))?",Re="(?:"+me+"(?:D|LL|M|RE|S|T|VE))?",Te=Se+"?",Ue="["+de+"]?",De="(?:"+Me+"(?:"+[Ae,je,ze].join("|")+")"+Ue+Te+")*",We="\\\\d*(?:(?:1st|2nd|3rd|(?![123])\\\\dth)\\\\b)",Fe="\\\\d*(?:(?:1ST|2ND|3RD|(?![123])\\\\dTH)\\\\b)",Le=Ue+Te+De,Pe="(?:"+[we,je,ze].join("|")+")"+Le,qe="(?:"+[Ae+_e+"?",_e,je,ze,ge].join("|")+")",Ne=RegExp(me,"g"),He=RegExp(_e,"g"),Ke=RegExp(Ee+"(?="+Ee+")|"+qe+Le,"g"),Je=RegExp([Ce+"?"+be+"+"+Oe+"(?="+[ye,Ce,"$"].join("|")+")",Be+"+"+Re+"(?="+[ye,Ce+Ie,"$"].join("|")+")",Ce+"?"+Ie+"+"+Oe,Ce+"+"+Re,Fe,We,xe,Pe].join("|"),"g"),$e=RegExp("["+Me+ee+ae+de+"]"),Ve=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ge=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xe=-1,Ze={};Ze[hn]=Ze[dn]=Ze[vn]=Ze[mn]=Ze[gn]=Ze[yn]=Ze[_n]=Ze[xn]=Ze[wn]=!0,Ze[qt]=Ze[Nt]=Ze[ln]=Ze[Kt]=Ze[pn]=Ze[Jt]=Ze[Vt]=Ze[Gt]=Ze[Zt]=Ze[Yt]=Ze[tn]=Ze[rn]=Ze[on]=Ze[an]=Ze[sn]=!1;var Ye={};Ye[qt]=Ye[Nt]=Ye[ln]=Ye[pn]=Ye[Kt]=Ye[Jt]=Ye[hn]=Ye[dn]=Ye[vn]=Ye[mn]=Ye[gn]=Ye[Zt]=Ye[Yt]=Ye[tn]=Ye[rn]=Ye[on]=Ye[an]=Ye[un]=Ye[yn]=Ye[_n]=Ye[xn]=Ye[wn]=!0,Ye[Vt]=Ye[Gt]=Ye[sn]=!1;var Qe={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"\'n","ſ":"s"},tr={"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;","\'":"&#39;"},nr={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":\'"\',"&#39;":"\'"},er={"\\\\":"\\\\","\'":"\'","\\n":"n","\\r":"r","\\u2028":"u2028","\\u2029":"u2029"},rr=parseFloat,ir=parseInt,or="object"==typeof t&&t&&t.Object===Object&&t,ar="object"==typeof self&&self&&self.Object===Object&&self,ur=or||ar||Function("return this")(),cr="object"==typeof n&&n&&!n.nodeType&&n,sr=cr&&"object"==typeof i&&i&&!i.nodeType&&i,fr=sr&&sr.exports===cr,lr=fr&&or.process,pr=function(){try{return lr&&lr.binding&&lr.binding("util")}catch(t){}}(),hr=pr&&pr.isArrayBuffer,dr=pr&&pr.isDate,vr=pr&&pr.isMap,mr=pr&&pr.isRegExp,gr=pr&&pr.isSet,yr=pr&&pr.isTypedArray,_r=z("length"),xr=C(Qe),wr=C(tr),br=C(nr),kr=function Sr(t){function n(t){if(sc(t)&&!wp(t)&&!(t instanceof i)){if(t instanceof r)return t;if(wf.call(t,"__wrapped__"))return aa(t)}return new r(t)}function e(){}function r(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=it}function i(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Wt,this.__views__=[]}function x(){var t=new i(this.__wrapped__);return t.__actions__=Li(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Li(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Li(this.__views__),t}function C(){if(this.__filtered__){var t=new i(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Z(){var t=this.__wrapped__.value(),n=this.__dir__,e=wp(t),r=n<0,i=e?t.length:0,o=Mo(0,i,this.__views__),a=o.start,u=o.end,c=u-a,s=r?u:a-1,f=this.__iteratees__,l=f.length,p=0,h=Zf(c,this.__takeCount__);if(!e||!r&&i==c&&h==c)return wi(t,this.__actions__);var d=[];t:for(;c--&&p<h;){s+=n;for(var v=-1,m=t[s];++v<l;){var g=f[v],y=g.iteratee,_=g.type,x=y(m);if(_==Bt)m=x;else if(!x){if(_==It)continue t;break t}}d[p++]=m}return d}function nt(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function et(){this.__data__=ul?ul(null):{},this.size=0}function Hn(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function ee(t){var n=this.__data__;if(ul){var e=n[t];return e===st?it:e}return wf.call(n,t)?n[t]:it}function re(t){var n=this.__data__;return ul?n[t]!==it:wf.call(n,t)}function ie(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=ul&&n===it?st:n,this}function oe(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function ae(){this.__data__=[],this.size=0}function ue(t){var n=this.__data__,e=Be(n,t);if(e<0)return!1;var r=n.length-1;return e==r?n.pop():Tf.call(n,e,1),--this.size,!0}function ce(t){var n=this.__data__,e=Be(n,t);return e<0?it:n[e][1]}function se(t){return Be(this.__data__,t)>-1}function fe(t,n){var e=this.__data__,r=Be(e,t);return r<0?(++this.size,e.push([t,n])):e[r][1]=n,this}function le(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function pe(){this.size=0,this.__data__={hash:new nt,map:new(rl||oe),string:new nt}}function he(t){var n=Ao(this,t)["delete"](t);return this.size-=n?1:0,n}function de(t){return Ao(this,t).get(t)}function ve(t){return Ao(this,t).has(t)}function me(t,n){var e=Ao(this,t),r=e.size;return e.set(t,n),this.size+=e.size==r?0:1,this}function ge(t){var n=-1,e=null==t?0:t.length;for(this.__data__=new le;++n<e;)this.add(t[n])}function ye(t){return this.__data__.set(t,st),this}function _e(t){return this.__data__.has(t)}function xe(t){var n=this.__data__=new oe(t);this.size=n.size}function we(){this.__data__=new oe,this.size=0}function be(t){var n=this.__data__,e=n["delete"](t);return this.size=n.size,e}function ke(t){return this.__data__.get(t)}function Ee(t){return this.__data__.has(t)}function Se(t,n){var e=this.__data__;if(e instanceof oe){var r=e.__data__;if(!rl||r.length<at-1)return r.push([t,n]),this.size=++e.size,this;e=this.__data__=new le(r)}return e.set(t,n),this.size=e.size,this}function Ae(t,n){var e=wp(t),r=!e&&xp(t),i=!e&&!r&&kp(t),o=!e&&!r&&!i&&zp(t),a=e||r||i||o,u=a?O(t.length,df):[],c=u.length;for(var s in t)!n&&!wf.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||o&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Wo(s,c))||u.push(s);return u}function je(t){var n=t.length;return n?t[ei(0,n-1)]:it}function ze(t,n){return ea(Li(t),We(n,0,t.length))}function Ce(t){return ea(Li(t))}function Me(t,n,e){(e===it||Gu(t[n],e))&&(e!==it||n in t)||Ue(t,n,e)}function Ie(t,n,e){var r=t[n];wf.call(t,n)&&Gu(r,e)&&(e!==it||n in t)||Ue(t,n,e)}function Be(t,n){for(var e=t.length;e--;)if(Gu(t[e][0],n))return e;return-1}function Oe(t,n,e,r){return _l(t,function(t,i,o){n(r,t,e(t),o)}),r}function Re(t,n){return t&&Pi(n,Hc(n),t)}function Te(t,n){return t&&Pi(n,Kc(n),t)}function Ue(t,n,e){"__proto__"==n&&Ff?Ff(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e}function De(t,n){for(var e=-1,r=n.length,i=uf(r),o=null==t;++e<r;)i[e]=o?it:Pc(t,n[e]);return i}function We(t,n,e){return t===t&&(e!==it&&(t=t<=e?t:e),n!==it&&(t=t>=n?t:n)),t}function Fe(t,n,e,r,i,o){var a,u=n&pt,c=n&ht,f=n&dt;if(e&&(a=i?e(t,r,i,o):e(t)),a!==it)return a;if(!cc(t))return t;var l=wp(t);if(l){if(a=Oo(t),!u)return Li(t,a)}else{var p=Il(t),h=p==Gt||p==Xt;if(kp(t))return zi(t,u);if(p==tn||p==qt||h&&!i){if(a=c||h?{}:Ro(t),!u)return c?Ni(t,Te(a,t)):qi(t,Re(a,t))}else{if(!Ye[p])return i?t:{};a=To(t,p,Fe,u)}}o||(o=new xe);var d=o.get(t);if(d)return d;o.set(t,a);var v=f?c?bo:wo:c?Kc:Hc,m=l?it:v(t);return s(m||t,function(r,i){m&&(i=r,r=t[i]),Ie(a,i,Fe(r,n,e,i,t,o))}),a}function Le(t){var n=Hc(t);return function(e){return Pe(e,t,n)}}function Pe(t,n,e){var r=e.length;if(null==t)return!r;for(t=pf(t);r--;){var i=e[r],o=n[i],a=t[i];if(a===it&&!(i in t)||!o(a))return!1}return!0}function qe(t,n,e){if("function"!=typeof t)throw new vf(ct);return Rl(function(){t.apply(it,e)},n)}function Ke(t,n,e,r){var i=-1,o=h,a=!0,u=t.length,c=[],s=n.length;if(!u)return c;e&&(n=v(n,T(e))),r?(o=d,a=!1):n.length>=at&&(o=D,a=!1,n=new ge(n));t:for(;++i<u;){var f=t[i],l=null==e?f:e(f);if(f=r||0!==f?f:0,a&&l===l){for(var p=s;p--;)if(n[p]===l)continue t;c.push(f)}else o(n,l,r)||c.push(f)}return c}function Je(t,n){var e=!0;return _l(t,function(t,r,i){return e=!!n(t,r,i)}),e}function $e(t,n,e){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=n(o);if(null!=a&&(u===it?a===a&&!xc(a):e(a,u)))var u=a,c=o}return c}function Ve(t,n,e,r){var i=t.length;for(e=Ac(e),e<0&&(e=-e>i?0:i+e),r=r===it||r>i?i:Ac(r),r<0&&(r+=i),r=e>r?0:jc(r);e<r;)t[e++]=n;return t}function Qe(t,n){var e=[];return _l(t,function(t,r,i){n(t,r,i)&&e.push(t)}),e}function tr(t,n,e,r,i){var o=-1,a=t.length;for(e||(e=Do),i||(i=[]);++o<a;){var u=t[o];n>0&&e(u)?n>1?tr(u,n-1,e,r,i):m(i,u):r||(i[i.length]=u)}return i}function nr(t,n){return t&&wl(t,n,Hc)}function er(t,n){return t&&bl(t,n,Hc)}function or(t,n){return p(n,function(n){return oc(t[n])})}function ar(t,n){n=Ai(n,t);for(var e=0,r=n.length;null!=t&&e<r;)t=t[ra(n[e++])];return e&&e==r?t:it}function cr(t,n,e){var r=n(t);return wp(t)?r:m(r,e(t))}function sr(t){return null==t?t===it?cn:Qt:Wf&&Wf in pf(t)?Co(t):Xo(t)}function lr(t,n){return t>n}function pr(t,n){return null!=t&&wf.call(t,n)}function _r(t,n){return null!=t&&n in pf(t)}function kr(t,n,e){return t>=Zf(n,e)&&t<Xf(n,e)}function Ar(t,n,e){for(var r=e?d:h,i=t[0].length,o=t.length,a=o,u=uf(o),c=1/0,s=[];a--;){var f=t[a];a&&n&&(f=v(f,T(n))),c=Zf(f.length,c),u[a]=!e&&(n||i>=120&&f.length>=120)?new ge(a&&f):it}f=t[0];var l=-1,p=u[0];t:for(;++l<i&&s.length<c;){var m=f[l],g=n?n(m):m;if(m=e||0!==m?m:0,!(p?D(p,g):r(s,g,e))){for(a=o;--a;){var y=u[a];if(!(y?D(y,g):r(t[a],g,e)))continue t}p&&p.push(g),s.push(m)}}return s}function jr(t,n,e,r){return nr(t,function(t,i,o){n(r,e(t),i,o)}),r}function zr(t,n,e){n=Ai(n,t),t=Yo(t,n);var r=null==t?t:t[ra(Sa(n))];return null==r?it:u(r,t,e)}function Cr(t){return sc(t)&&sr(t)==qt}function Mr(t){return sc(t)&&sr(t)==ln}function Ir(t){return sc(t)&&sr(t)==Jt}function Br(t,n,e,r,i){return t===n||(null==t||null==n||!sc(t)&&!sc(n)?t!==t&&n!==n:Or(t,n,e,r,Br,i))}function Or(t,n,e,r,i,o){var a=wp(t),u=wp(n),c=a?Nt:Il(t),s=u?Nt:Il(n);c=c==qt?tn:c,s=s==qt?tn:s;var f=c==tn,l=s==tn,p=c==s;if(p&&kp(t)){if(!kp(n))return!1;a=!0,f=!1}if(p&&!f)return o||(o=new xe),a||zp(t)?go(t,n,e,r,i,o):yo(t,n,c,e,r,i,o);if(!(e&vt)){var h=f&&wf.call(t,"__wrapped__"),d=l&&wf.call(n,"__wrapped__");if(h||d){var v=h?t.value():t,m=d?n.value():n;return o||(o=new xe),i(v,m,e,r,o)}}return!!p&&(o||(o=new xe),_o(t,n,e,r,i,o))}function Rr(t){return sc(t)&&Il(t)==Zt}function Tr(t,n,e,r){var i=e.length,o=i,a=!r;if(null==t)return!o;for(t=pf(t);i--;){var u=e[i];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){u=e[i];var c=u[0],s=t[c],f=u[1];if(a&&u[2]){if(s===it&&!(c in t))return!1}else{var l=new xe;if(r)var p=r(s,f,c,t,n,l);if(!(p===it?Br(f,s,vt|mt,r,l):p))return!1}}return!0}function Ur(t){if(!cc(t)||No(t))return!1;var n=oc(t)?jf:Xn;return n.test(ia(t))}function Dr(t){return sc(t)&&sr(t)==rn}function Wr(t){return sc(t)&&Il(t)==on}function Fr(t){return sc(t)&&uc(t.length)&&!!Ze[sr(t)]}function Lr(t){return"function"==typeof t?t:null==t?Rs:"object"==typeof t?wp(t)?Jr(t[0],t[1]):Kr(t):qs(t)}\nfunction Pr(t){if(!Ho(t))return Gf(t);var n=[];for(var e in pf(t))wf.call(t,e)&&"constructor"!=e&&n.push(e);return n}function qr(t){if(!cc(t))return Go(t);var n=Ho(t),e=[];for(var r in t)("constructor"!=r||!n&&wf.call(t,r))&&e.push(r);return e}function Nr(t,n){return t<n}function Hr(t,n){var e=-1,r=Xu(t)?uf(t.length):[];return _l(t,function(t,i,o){r[++e]=n(t,i,o)}),r}function Kr(t){var n=jo(t);return 1==n.length&&n[0][2]?Jo(n[0][0],n[0][1]):function(e){return e===t||Tr(e,t,n)}}function Jr(t,n){return Lo(t)&&Ko(n)?Jo(ra(t),n):function(e){var r=Pc(e,t);return r===it&&r===n?Nc(e,t):Br(n,r,vt|mt)}}function $r(t,n,e,r,i){t!==n&&wl(n,function(o,a){if(cc(o))i||(i=new xe),Vr(t,n,a,e,$r,r,i);else{var u=r?r(t[a],o,a+"",t,n,i):it;u===it&&(u=o),Me(t,a,u)}},Kc)}function Vr(t,n,e,r,i,o,a){var u=t[e],c=n[e],s=a.get(c);if(s)return void Me(t,e,s);var f=o?o(u,c,e+"",t,n,a):it,l=f===it;if(l){var p=wp(c),h=!p&&kp(c),d=!p&&!h&&zp(c);f=c,p||h||d?wp(u)?f=u:Zu(u)?f=Li(u):h?(l=!1,f=zi(c,!0)):d?(l=!1,f=Ti(c,!0)):f=[]:gc(c)||xp(c)?(f=u,xp(u)?f=Cc(u):(!cc(u)||r&&oc(u))&&(f=Ro(c))):l=!1}l&&(a.set(c,f),i(f,c,r,o,a),a["delete"](c)),Me(t,e,f)}function Gr(t,n){var e=t.length;if(e)return n+=n<0?e:0,Wo(n,e)?t[n]:it}function Xr(t,n,e){var r=-1;n=v(n.length?n:[Rs],T(So()));var i=Hr(t,function(t,e,i){var o=v(n,function(n){return n(t)});return{criteria:o,index:++r,value:t}});return I(i,function(t,n){return Di(t,n,e)})}function Zr(t,n){return Yr(t,n,function(n,e){return Nc(t,e)})}function Yr(t,n,e){for(var r=-1,i=n.length,o={};++r<i;){var a=n[r],u=ar(t,a);e(u,a)&&ci(o,Ai(a,t),u)}return o}function Qr(t){return function(n){return ar(n,t)}}function ti(t,n,e,r){var i=r?S:E,o=-1,a=n.length,u=t;for(t===n&&(n=Li(n)),e&&(u=v(t,T(e)));++o<a;)for(var c=0,s=n[o],f=e?e(s):s;(c=i(u,f,c,r))>-1;)u!==t&&Tf.call(u,c,1),Tf.call(t,c,1);return t}function ni(t,n){for(var e=t?n.length:0,r=e-1;e--;){var i=n[e];if(e==r||i!==o){var o=i;Wo(i)?Tf.call(t,i,1):yi(t,i)}}return t}function ei(t,n){return t+Hf(tl()*(n-t+1))}function ri(t,n,e,r){for(var i=-1,o=Xf(Nf((n-t)/(e||1)),0),a=uf(o);o--;)a[r?o:++i]=t,t+=e;return a}function ii(t,n){var e="";if(!t||n<1||n>Tt)return e;do n%2&&(e+=t),n=Hf(n/2),n&&(t+=t);while(n);return e}function oi(t,n){return Tl(Zo(t,n,Rs),t+"")}function ai(t){return je(rs(t))}function ui(t,n){var e=rs(t);return ea(e,We(n,0,e.length))}function ci(t,n,e,r){if(!cc(t))return t;n=Ai(n,t);for(var i=-1,o=n.length,a=o-1,u=t;null!=u&&++i<o;){var c=ra(n[i]),s=e;if(i!=a){var f=u[c];s=r?r(f,c,u):it,s===it&&(s=cc(f)?f:Wo(n[i+1])?[]:{})}Ie(u,c,s),u=u[c]}return t}function si(t){return ea(rs(t))}function fi(t,n,e){var r=-1,i=t.length;n<0&&(n=-n>i?0:i+n),e=e>i?i:e,e<0&&(e+=i),i=n>e?0:e-n>>>0,n>>>=0;for(var o=uf(i);++r<i;)o[r]=t[r+n];return o}function li(t,n){var e;return _l(t,function(t,r,i){return e=n(t,r,i),!e}),!!e}function pi(t,n,e){var r=0,i=null==t?r:t.length;if("number"==typeof n&&n===n&&i<=Lt){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!xc(a)&&(e?a<=n:a<n)?r=o+1:i=o}return i}return hi(t,n,Rs,e)}function hi(t,n,e,r){n=e(n);for(var i=0,o=null==t?0:t.length,a=n!==n,u=null===n,c=xc(n),s=n===it;i<o;){var f=Hf((i+o)/2),l=e(t[f]),p=l!==it,h=null===l,d=l===l,v=xc(l);if(a)var m=r||d;else m=s?d&&(r||p):u?d&&p&&(r||!h):c?d&&p&&!h&&(r||!v):!h&&!v&&(r?l<=n:l<n);m?i=f+1:o=f}return Zf(o,Ft)}function di(t,n){for(var e=-1,r=t.length,i=0,o=[];++e<r;){var a=t[e],u=n?n(a):a;if(!e||!Gu(u,c)){var c=u;o[i++]=0===a?0:a}}return o}function vi(t){return"number"==typeof t?t:xc(t)?Dt:+t}function mi(t){if("string"==typeof t)return t;if(wp(t))return v(t,mi)+"";if(xc(t))return gl?gl.call(t):"";var n=t+"";return"0"==n&&1/t==-Rt?"-0":n}function gi(t,n,e){var r=-1,i=h,o=t.length,a=!0,u=[],c=u;if(e)a=!1,i=d;else if(o>=at){var s=n?null:jl(t);if(s)return G(s);a=!1,i=D,c=new ge}else c=n?[]:u;t:for(;++r<o;){var f=t[r],l=n?n(f):f;if(f=e||0!==f?f:0,a&&l===l){for(var p=c.length;p--;)if(c[p]===l)continue t;n&&c.push(l),u.push(f)}else i(c,l,e)||(c!==u&&c.push(l),u.push(f))}return u}function yi(t,n){return n=Ai(n,t),t=Yo(t,n),null==t||delete t[ra(Sa(n))]}function _i(t,n,e,r){return ci(t,n,e(ar(t,n)),r)}function xi(t,n,e,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&n(t[o],o,t););return e?fi(t,r?0:o,r?o+1:i):fi(t,r?o+1:0,r?i:o)}function wi(t,n){var e=t;return e instanceof i&&(e=e.value()),g(n,function(t,n){return n.func.apply(n.thisArg,m([t],n.args))},e)}function bi(t,n,e){var r=t.length;if(r<2)return r?gi(t[0]):[];for(var i=-1,o=uf(r);++i<r;)for(var a=t[i],u=-1;++u<r;)u!=i&&(o[i]=Ke(o[i]||a,t[u],n,e));return gi(tr(o,1),n,e)}function ki(t,n,e){for(var r=-1,i=t.length,o=n.length,a={};++r<i;){var u=r<o?n[r]:it;e(a,t[r],u)}return a}function Ei(t){return Zu(t)?t:[]}function Si(t){return"function"==typeof t?t:Rs}function Ai(t,n){return wp(t)?t:Lo(t,n)?[t]:Ul(Ic(t))}function ji(t,n,e){var r=t.length;return e=e===it?r:e,!n&&e>=r?t:fi(t,n,e)}function zi(t,n){if(n)return t.slice();var e=t.length,r=If?If(e):new t.constructor(e);return t.copy(r),r}function Ci(t){var n=new t.constructor(t.byteLength);return new Mf(n).set(new Mf(t)),n}function Mi(t,n){var e=n?Ci(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function Ii(t,n,e){var r=n?e(J(t),pt):J(t);return g(r,o,new t.constructor)}function Bi(t){var n=new t.constructor(t.source,$n.exec(t));return n.lastIndex=t.lastIndex,n}function Oi(t,n,e){var r=n?e(G(t),pt):G(t);return g(r,a,new t.constructor)}function Ri(t){return ml?pf(ml.call(t)):{}}function Ti(t,n){var e=n?Ci(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function Ui(t,n){if(t!==n){var e=t!==it,r=null===t,i=t===t,o=xc(t),a=n!==it,u=null===n,c=n===n,s=xc(n);if(!u&&!s&&!o&&t>n||o&&a&&c&&!u&&!s||r&&a&&c||!e&&c||!i)return 1;if(!r&&!o&&!s&&t<n||s&&e&&i&&!r&&!o||u&&e&&i||!a&&i||!c)return-1}return 0}function Di(t,n,e){for(var r=-1,i=t.criteria,o=n.criteria,a=i.length,u=e.length;++r<a;){var c=Ui(i[r],o[r]);if(c){if(r>=u)return c;var s=e[r];return c*("desc"==s?-1:1)}}return t.index-n.index}function Wi(t,n,e,r){for(var i=-1,o=t.length,a=e.length,u=-1,c=n.length,s=Xf(o-a,0),f=uf(c+s),l=!r;++u<c;)f[u]=n[u];for(;++i<a;)(l||i<o)&&(f[e[i]]=t[i]);for(;s--;)f[u++]=t[i++];return f}function Fi(t,n,e,r){for(var i=-1,o=t.length,a=-1,u=e.length,c=-1,s=n.length,f=Xf(o-u,0),l=uf(f+s),p=!r;++i<f;)l[i]=t[i];for(var h=i;++c<s;)l[h+c]=n[c];for(;++a<u;)(p||i<o)&&(l[h+e[a]]=t[i++]);return l}function Li(t,n){var e=-1,r=t.length;for(n||(n=uf(r));++e<r;)n[e]=t[e];return n}function Pi(t,n,e,r){var i=!e;e||(e={});for(var o=-1,a=n.length;++o<a;){var u=n[o],c=r?r(e[u],t[u],u,e,t):it;c===it&&(c=t[u]),i?Ue(e,u,c):Ie(e,u,c)}return e}function qi(t,n){return Pi(t,Cl(t),n)}function Ni(t,n){return Pi(t,Ml(t),n)}function Hi(t,n){return function(e,r){var i=wp(e)?c:Oe,o=n?n():{};return i(e,t,So(r,2),o)}}function Ki(t){return oi(function(n,e){var r=-1,i=e.length,o=i>1?e[i-1]:it,a=i>2?e[2]:it;for(o=t.length>3&&"function"==typeof o?(i--,o):it,a&&Fo(e[0],e[1],a)&&(o=i<3?it:o,i=1),n=pf(n);++r<i;){var u=e[r];u&&t(n,u,r,o)}return n})}function Ji(t,n){return function(e,r){if(null==e)return e;if(!Xu(e))return t(e,r);for(var i=e.length,o=n?i:-1,a=pf(e);(n?o--:++o<i)&&r(a[o],o,a)!==!1;);return e}}function $i(t){return function(n,e,r){for(var i=-1,o=pf(n),a=r(n),u=a.length;u--;){var c=a[t?u:++i];if(e(o[c],c,o)===!1)break}return n}}function Vi(t,n,e){function r(){var n=this&&this!==ur&&this instanceof r?o:t;return n.apply(i?e:this,arguments)}var i=n&gt,o=Zi(t);return r}function Gi(t){return function(n){n=Ic(n);var e=N(n)?tt(n):it,r=e?e[0]:n.charAt(0),i=e?ji(e,1).join(""):n.slice(1);return r[t]()+i}}function Xi(t){return function(n){return g(Cs(ss(n).replace(Ne,"")),t,"")}}function Zi(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var e=yl(t.prototype),r=t.apply(e,n);return cc(r)?r:e}}function Yi(t,n,e){function r(){for(var o=arguments.length,a=uf(o),c=o,s=Eo(r);c--;)a[c]=arguments[c];var f=o<3&&a[0]!==s&&a[o-1]!==s?[]:V(a,s);if(o-=f.length,o<e)return so(t,n,no,r.placeholder,it,a,f,it,it,e-o);var l=this&&this!==ur&&this instanceof r?i:t;return u(l,this,a)}var i=Zi(t);return r}function Qi(t){return function(n,e,r){var i=pf(n);if(!Xu(n)){var o=So(e,3);n=Hc(n),e=function(t){return o(i[t],t,i)}}var a=t(n,e,r);return a>-1?i[o?n[a]:a]:it}}function to(t){return xo(function(n){var e=n.length,i=e,o=r.prototype.thru;for(t&&n.reverse();i--;){var a=n[i];if("function"!=typeof a)throw new vf(ct);if(o&&!u&&"wrapper"==ko(a))var u=new r([],(!0))}for(i=u?i:e;++i<e;){a=n[i];var c=ko(a),s="wrapper"==c?zl(a):it;u=s&&qo(s[0])&&s[1]==(Et|xt|bt|St)&&!s[4].length&&1==s[9]?u[ko(s[0])].apply(u,s[3]):1==a.length&&qo(a)?u[c]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&wp(r))return u.plant(r).value();for(var i=0,o=e?n[i].apply(this,t):r;++i<e;)o=n[i].call(this,o);return o}})}function no(t,n,e,r,i,o,a,u,c,s){function f(){for(var g=arguments.length,y=uf(g),_=g;_--;)y[_]=arguments[_];if(d)var x=Eo(f),w=L(y,x);if(r&&(y=Wi(y,r,i,d)),o&&(y=Fi(y,o,a,d)),g-=w,d&&g<s){var b=V(y,x);return so(t,n,no,f.placeholder,e,y,b,u,c,s-g)}var k=p?e:this,E=h?k[t]:t;return g=y.length,u?y=Qo(y,u):v&&g>1&&y.reverse(),l&&c<g&&(y.length=c),this&&this!==ur&&this instanceof f&&(E=m||Zi(E)),E.apply(k,y)}var l=n&Et,p=n&gt,h=n&yt,d=n&(xt|wt),v=n&At,m=h?it:Zi(t);return f}function eo(t,n){return function(e,r){return jr(e,t,n(r),{})}}function ro(t,n){return function(e,r){var i;if(e===it&&r===it)return n;if(e!==it&&(i=e),r!==it){if(i===it)return r;"string"==typeof e||"string"==typeof r?(e=mi(e),r=mi(r)):(e=vi(e),r=vi(r)),i=t(e,r)}return i}}function io(t){return xo(function(n){return n=v(n,T(So())),oi(function(e){var r=this;return t(n,function(t){return u(t,r,e)})})})}function oo(t,n){n=n===it?" ":mi(n);var e=n.length;if(e<2)return e?ii(n,t):n;var r=ii(n,Nf(t/Q(n)));return N(n)?ji(tt(r),0,t).join(""):r.slice(0,t)}function ao(t,n,e,r){function i(){for(var n=-1,c=arguments.length,s=-1,f=r.length,l=uf(f+c),p=this&&this!==ur&&this instanceof i?a:t;++s<f;)l[s]=r[s];for(;c--;)l[s++]=arguments[++n];return u(p,o?e:this,l)}var o=n&gt,a=Zi(t);return i}function uo(t){return function(n,e,r){return r&&"number"!=typeof r&&Fo(n,e,r)&&(e=r=it),n=Sc(n),e===it?(e=n,n=0):e=Sc(e),r=r===it?n<e?1:-1:Sc(r),ri(n,e,r,t)}}function co(t){return function(n,e){return"string"==typeof n&&"string"==typeof e||(n=zc(n),e=zc(e)),t(n,e)}}function so(t,n,e,r,i,o,a,u,c,s){var f=n&xt,l=f?a:it,p=f?it:a,h=f?o:it,d=f?it:o;n|=f?bt:kt,n&=~(f?kt:bt),n&_t||(n&=~(gt|yt));var v=[t,n,i,h,l,d,p,u,c,s],m=e.apply(it,v);return qo(t)&&Ol(m,v),m.placeholder=r,ta(m,t,n)}function fo(t){var n=lf[t];return function(t,e){if(t=zc(t),e=null==e?0:Zf(Ac(e),292)){var r=(Ic(t)+"e").split("e"),i=n(r[0]+"e"+(+r[1]+e));return r=(Ic(i)+"e").split("e"),+(r[0]+"e"+(+r[1]-e))}return n(t)}}function lo(t){return function(n){var e=Il(n);return e==Zt?J(n):e==on?X(n):R(n,t(n))}}function po(t,n,e,r,i,o,a,u){var c=n&yt;if(!c&&"function"!=typeof t)throw new vf(ct);var s=r?r.length:0;if(s||(n&=~(bt|kt),r=i=it),a=a===it?a:Xf(Ac(a),0),u=u===it?u:Ac(u),s-=i?i.length:0,n&kt){var f=r,l=i;r=i=it}var p=c?it:zl(t),h=[t,n,e,r,i,f,l,o,a,u];if(p&&Vo(h,p),t=h[0],n=h[1],e=h[2],r=h[3],i=h[4],u=h[9]=h[9]===it?c?0:t.length:Xf(h[9]-s,0),!u&&n&(xt|wt)&&(n&=~(xt|wt)),n&&n!=gt)d=n==xt||n==wt?Yi(t,n,u):n!=bt&&n!=(gt|bt)||i.length?no.apply(it,h):ao(t,n,e,r);else var d=Vi(t,n,e);var v=p?kl:Ol;return ta(v(d,h),t,n)}function ho(t,n,e,r){return t===it||Gu(t,yf[e])&&!wf.call(r,e)?n:t}function vo(t,n,e,r,i,o){return cc(t)&&cc(n)&&(o.set(n,t),$r(t,n,it,vo,o),o["delete"](n)),t}function mo(t){return gc(t)?it:t}function go(t,n,e,r,i,o){var a=e&vt,u=t.length,c=n.length;if(u!=c&&!(a&&c>u))return!1;var s=o.get(t);if(s&&o.get(n))return s==n;var f=-1,l=!0,p=e&mt?new ge:it;for(o.set(t,n),o.set(n,t);++f<u;){var h=t[f],d=n[f];if(r)var v=a?r(d,h,f,n,t,o):r(h,d,f,t,n,o);if(v!==it){if(v)continue;l=!1;break}if(p){if(!_(n,function(t,n){if(!D(p,n)&&(h===t||i(h,t,e,r,o)))return p.push(n)})){l=!1;break}}else if(h!==d&&!i(h,d,e,r,o)){l=!1;break}}return o["delete"](t),o["delete"](n),l}function yo(t,n,e,r,i,o,a){switch(e){case pn:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case ln:return!(t.byteLength!=n.byteLength||!o(new Mf(t),new Mf(n)));case Kt:case Jt:case Yt:return Gu(+t,+n);case Vt:return t.name==n.name&&t.message==n.message;case rn:case an:return t==n+"";case Zt:var u=J;case on:var c=r&vt;if(u||(u=G),t.size!=n.size&&!c)return!1;var s=a.get(t);if(s)return s==n;r|=mt,a.set(t,n);var f=go(u(t),u(n),r,i,o,a);return a["delete"](t),f;case un:if(ml)return ml.call(t)==ml.call(n)}return!1}function _o(t,n,e,r,i,o){var a=e&vt,u=wo(t),c=u.length,s=wo(n),f=s.length;if(c!=f&&!a)return!1;for(var l=c;l--;){var p=u[l];if(!(a?p in n:wf.call(n,p)))return!1}var h=o.get(t);if(h&&o.get(n))return h==n;var d=!0;o.set(t,n),o.set(n,t);for(var v=a;++l<c;){p=u[l];var m=t[p],g=n[p];if(r)var y=a?r(g,m,p,n,t,o):r(m,g,p,t,n,o);if(!(y===it?m===g||i(m,g,e,r,o):y)){d=!1;break}v||(v="constructor"==p)}if(d&&!v){var _=t.constructor,x=n.constructor;_!=x&&"constructor"in t&&"constructor"in n&&!("function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x)&&(d=!1)}return o["delete"](t),o["delete"](n),d}function xo(t){return Tl(Zo(t,it,ga),t+"")}function wo(t){return cr(t,Hc,Cl)}function bo(t){return cr(t,Kc,Ml)}function ko(t){for(var n=t.name+"",e=sl[n],r=wf.call(sl,n)?e.length:0;r--;){var i=e[r],o=i.func;if(null==o||o==t)return i.name}return n}function Eo(t){var e=wf.call(n,"placeholder")?n:t;return e.placeholder}function So(){var t=n.iteratee||Ts;return t=t===Ts?Lr:t,arguments.length?t(arguments[0],arguments[1]):t}function Ao(t,n){var e=t.__data__;return Po(n)?e["string"==typeof n?"string":"hash"]:e.map}function jo(t){for(var n=Hc(t),e=n.length;e--;){var r=n[e],i=t[r];n[e]=[r,i,Ko(i)]}return n}function zo(t,n){var e=q(t,n);return Ur(e)?e:it}function Co(t){var n=wf.call(t,Wf),e=t[Wf];try{t[Wf]=it;var r=!0}catch(i){}var o=Ef.call(t);return r&&(n?t[Wf]=e:delete t[Wf]),o}function Mo(t,n,e){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":n-=a;break;case"take":n=Zf(n,t+a);break;case"takeRight":t=Xf(t,n-a)}}return{start:t,end:n}}function Io(t){var n=t.match(qn);return n?n[1].split(Nn):[]}function Bo(t,n,e){n=Ai(n,t);for(var r=-1,i=n.length,o=!1;++r<i;){var a=ra(n[r]);if(!(o=null!=t&&e(t,a)))break;t=t[a]}return o||++r!=i?o:(i=null==t?0:t.length,!!i&&uc(i)&&Wo(a,i)&&(wp(t)||xp(t)))}function Oo(t){var n=t.length,e=t.constructor(n);return n&&"string"==typeof t[0]&&wf.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function Ro(t){return"function"!=typeof t.constructor||Ho(t)?{}:yl(Bf(t))}function To(t,n,e,r){var i=t.constructor;switch(n){case ln:return Ci(t);case Kt:case Jt:return new i((+t));case pn:return Mi(t,r);case hn:case dn:case vn:case mn:case gn:case yn:case _n:case xn:case wn:return Ti(t,r);case Zt:return Ii(t,r,e);case Yt:case an:return new i(t);case rn:return Bi(t);case on:return Oi(t,r,e);case un:return Ri(t)}}function Uo(t,n){var e=n.length;if(!e)return t;var r=e-1;return n[r]=(e>1?"& ":"")+n[r],n=n.join(e>2?", ":" "),t.replace(Pn,"{\\n/* [wrapped with "+n+"] */\\n")}function Do(t){return wp(t)||xp(t)||!!(Uf&&t&&t[Uf])}function Wo(t,n){return n=null==n?Tt:n,!!n&&("number"==typeof t||Yn.test(t))&&t>-1&&t%1==0&&t<n}function Fo(t,n,e){if(!cc(e))return!1;var r=typeof n;return!!("number"==r?Xu(e)&&Wo(n,e.length):"string"==r&&n in e)&&Gu(e[n],t)}function Lo(t,n){if(wp(t))return!1;var e=typeof t;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!xc(t))||(On.test(t)||!Bn.test(t)||null!=n&&t in pf(n))}function Po(t){var n=typeof t;return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t}function qo(t){var e=ko(t),r=n[e];if("function"!=typeof r||!(e in i.prototype))return!1;if(t===r)return!0;var o=zl(r);return!!o&&t===o[0]}function No(t){return!!kf&&kf in t}function Ho(t){var n=t&&t.constructor,e="function"==typeof n&&n.prototype||yf;return t===e}function Ko(t){return t===t&&!cc(t)}function Jo(t,n){return function(e){return null!=e&&(e[t]===n&&(n!==it||t in pf(e)))}}function $o(t){var n=Tu(t,function(t){return e.size===ft&&e.clear(),t}),e=n.cache;return n}function Vo(t,n){var e=t[1],r=n[1],i=e|r,o=i<(gt|yt|Et),a=r==Et&&e==xt||r==Et&&e==St&&t[7].length<=n[8]||r==(Et|St)&&n[7].length<=n[8]&&e==xt;if(!o&&!a)return t;r&gt&&(t[2]=n[2],i|=e&gt?0:_t);var u=n[3];if(u){var c=t[3];t[3]=c?Wi(c,u,n[4]):u,t[4]=c?V(t[3],lt):n[4]}return u=n[5],u&&(c=t[5],t[5]=c?Fi(c,u,n[6]):u,t[6]=c?V(t[5],lt):n[6]),u=n[7],u&&(t[7]=u),r&Et&&(t[8]=null==t[8]?n[8]:Zf(t[8],n[8])),null==t[9]&&(t[9]=n[9]),t[0]=n[0],t[1]=i,t}function Go(t){var n=[];if(null!=t)for(var e in pf(t))n.push(e);return n}function Xo(t){return Ef.call(t)}function Zo(t,n,e){return n=Xf(n===it?t.length-1:n,0),function(){for(var r=arguments,i=-1,o=Xf(r.length-n,0),a=uf(o);++i<o;)a[i]=r[n+i];i=-1;for(var c=uf(n+1);++i<n;)c[i]=r[i];return c[n]=e(a),u(t,this,c)}}function Yo(t,n){return n.length<2?t:ar(t,fi(n,0,-1))}function Qo(t,n){for(var e=t.length,r=Zf(n.length,e),i=Li(t);r--;){var o=n[r];t[r]=Wo(o,e)?i[o]:it}return t}function ta(t,n,e){var r=n+"";return Tl(t,Uo(r,oa(Io(r),e)))}function na(t){var n=0,e=0;return function(){var r=Yf(),i=Mt-(r-e);if(e=r,i>0){if(++n>=Ct)return arguments[0]}else n=0;return t.apply(it,arguments)}}function ea(t,n){var e=-1,r=t.length,i=r-1;for(n=n===it?r:n;++e<n;){var o=ei(e,i),a=t[o];t[o]=t[e],t[e]=a}return t.length=n,t}function ra(t){if("string"==typeof t||xc(t))return t;var n=t+"";return"0"==n&&1/t==-Rt?"-0":n}function ia(t){if(null!=t){try{return xf.call(t)}catch(n){}try{return t+""}catch(n){}}return""}function oa(t,n){return s(Pt,function(e){var r="_."+e[0];n&e[1]&&!h(t,r)&&t.push(r)}),t.sort()}function aa(t){if(t instanceof i)return t.clone();var n=new r(t.__wrapped__,t.__chain__);return n.__actions__=Li(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function ua(t,n,e){n=(e?Fo(t,n,e):n===it)?1:Xf(Ac(n),0);var r=null==t?0:t.length;if(!r||n<1)return[];for(var i=0,o=0,a=uf(Nf(r/n));i<r;)a[o++]=fi(t,i,i+=n);return a}function ca(t){for(var n=-1,e=null==t?0:t.length,r=0,i=[];++n<e;){var o=t[n];o&&(i[r++]=o)}return i}function sa(){var t=arguments.length;if(!t)return[];for(var n=uf(t-1),e=arguments[0],r=t;r--;)n[r-1]=arguments[r];return m(wp(e)?Li(e):[e],tr(n,1))}function fa(t,n,e){var r=null==t?0:t.length;return r?(n=e||n===it?1:Ac(n),fi(t,n<0?0:n,r)):[]}function la(t,n,e){var r=null==t?0:t.length;return r?(n=e||n===it?1:Ac(n),n=r-n,fi(t,0,n<0?0:n)):[]}function pa(t,n){return t&&t.length?xi(t,So(n,3),!0,!0):[]}function ha(t,n){return t&&t.length?xi(t,So(n,3),!0):[]}function da(t,n,e,r){var i=null==t?0:t.length;return i?(e&&"number"!=typeof e&&Fo(t,n,e)&&(e=0,r=i),Ve(t,n,e,r)):[]}function va(t,n,e){var r=null==t?0:t.length;if(!r)return-1;var i=null==e?0:Ac(e);return i<0&&(i=Xf(r+i,0)),k(t,So(n,3),i)}function ma(t,n,e){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return e!==it&&(i=Ac(e),i=e<0?Xf(r+i,0):Zf(i,r-1)),k(t,So(n,3),i,!0)}function ga(t){var n=null==t?0:t.length;return n?tr(t,1):[]}function ya(t){var n=null==t?0:t.length;return n?tr(t,Rt):[]}function _a(t,n){var e=null==t?0:t.length;return e?(n=n===it?1:Ac(n),tr(t,n)):[]}function xa(t){for(var n=-1,e=null==t?0:t.length,r={};++n<e;){var i=t[n];r[i[0]]=i[1]}return r}function wa(t){return t&&t.length?t[0]:it}function ba(t,n,e){var r=null==t?0:t.length;if(!r)return-1;var i=null==e?0:Ac(e);return i<0&&(i=Xf(r+i,0)),E(t,n,i)}function ka(t){var n=null==t?0:t.length;return n?fi(t,0,-1):[]}function Ea(t,n){return null==t?"":Vf.call(t,n)}function Sa(t){var n=null==t?0:t.length;return n?t[n-1]:it}function Aa(t,n,e){var r=null==t?0:t.length;if(!r)return-1;var i=r;return e!==it&&(i=Ac(e),i=i<0?Xf(r+i,0):Zf(i,r-1)),n===n?Y(t,n,i):k(t,A,i,!0)}function ja(t,n){return t&&t.length?Gr(t,Ac(n)):it}function za(t,n){return t&&t.length&&n&&n.length?ti(t,n):t}function Ca(t,n,e){return t&&t.length&&n&&n.length?ti(t,n,So(e,2)):t}function Ma(t,n,e){return t&&t.length&&n&&n.length?ti(t,n,it,e):t}function Ia(t,n){var e=[];if(!t||!t.length)return e;var r=-1,i=[],o=t.length;for(n=So(n,3);++r<o;){var a=t[r];n(a,r,t)&&(e.push(a),i.push(r))}return ni(t,i),e}function Ba(t){return null==t?t:nl.call(t)}function Oa(t,n,e){var r=null==t?0:t.length;return r?(e&&"number"!=typeof e&&Fo(t,n,e)?(n=0,e=r):(n=null==n?0:Ac(n),e=e===it?r:Ac(e)),fi(t,n,e)):[]}function Ra(t,n){return pi(t,n)}function Ta(t,n,e){return hi(t,n,So(e,2))}function Ua(t,n){var e=null==t?0:t.length;if(e){var r=pi(t,n);if(r<e&&Gu(t[r],n))return r}return-1}function Da(t,n){return pi(t,n,!0)}function Wa(t,n,e){return hi(t,n,So(e,2),!0)}function Fa(t,n){var e=null==t?0:t.length;if(e){var r=pi(t,n,!0)-1;if(Gu(t[r],n))return r}return-1}function La(t){return t&&t.length?di(t):[]}function Pa(t,n){return t&&t.length?di(t,So(n,2)):[]}function qa(t){var n=null==t?0:t.length;return n?fi(t,1,n):[]}function Na(t,n,e){return t&&t.length?(n=e||n===it?1:Ac(n),fi(t,0,n<0?0:n)):[]}function Ha(t,n,e){var r=null==t?0:t.length;return r?(n=e||n===it?1:Ac(n),n=r-n,fi(t,n<0?0:n,r)):[]}function Ka(t,n){return t&&t.length?xi(t,So(n,3),!1,!0):[]}function Ja(t,n){return t&&t.length?xi(t,So(n,3)):[]}function $a(t){return t&&t.length?gi(t):[]}function Va(t,n){return t&&t.length?gi(t,So(n,2)):[]}function Ga(t,n){return n="function"==typeof n?n:it,t&&t.length?gi(t,it,n):[]}function Xa(t){if(!t||!t.length)return[];var n=0;return t=p(t,function(t){if(Zu(t))return n=Xf(t.length,n),!0}),O(n,function(n){return v(t,z(n))})}function Za(t,n){if(!t||!t.length)return[];var e=Xa(t);return null==n?e:v(e,function(t){return u(n,it,t)})}function Ya(t,n){return ki(t||[],n||[],Ie)}function Qa(t,n){return ki(t||[],n||[],ci)}function tu(t){var e=n(t);return e.__chain__=!0,e}function nu(t,n){return n(t),t}function eu(t,n){return n(t)}function ru(){return tu(this)}function iu(){return new r(this.value(),this.__chain__)}function ou(){this.__values__===it&&(this.__values__=Ec(this.value()));var t=this.__index__>=this.__values__.length,n=t?it:this.__values__[this.__index__++];return{done:t,value:n}}function au(){return this}function uu(t){for(var n,r=this;r instanceof e;){var i=aa(r);i.__index__=0,i.__values__=it,n?o.__wrapped__=i:n=i;var o=i;r=r.__wrapped__}return o.__wrapped__=t,n}function cu(){var t=this.__wrapped__;if(t instanceof i){var n=t;return this.__actions__.length&&(n=new i(this)),n=n.reverse(),n.__actions__.push({func:eu,args:[Ba],thisArg:it}),new r(n,this.__chain__)}return this.thru(Ba)}function su(){return wi(this.__wrapped__,this.__actions__)}function fu(t,n,e){var r=wp(t)?l:Je;return e&&Fo(t,n,e)&&(n=it),r(t,So(n,3))}function lu(t,n){var e=wp(t)?p:Qe;return e(t,So(n,3))}function pu(t,n){return tr(yu(t,n),1)}function hu(t,n){return tr(yu(t,n),Rt)}function du(t,n,e){return e=e===it?1:Ac(e),tr(yu(t,n),e)}function vu(t,n){var e=wp(t)?s:_l;return e(t,So(n,3))}function mu(t,n){var e=wp(t)?f:xl;return e(t,So(n,3))}function gu(t,n,e,r){t=Xu(t)?t:rs(t),e=e&&!r?Ac(e):0;var i=t.length;return e<0&&(e=Xf(i+e,0)),_c(t)?e<=i&&t.indexOf(n,e)>-1:!!i&&E(t,n,e)>-1}function yu(t,n){var e=wp(t)?v:Hr;return e(t,So(n,3))}function _u(t,n,e,r){return null==t?[]:(wp(n)||(n=null==n?[]:[n]),e=r?it:e,wp(e)||(e=null==e?[]:[e]),Xr(t,n,e))}function xu(t,n,e){var r=wp(t)?g:M,i=arguments.length<3;return r(t,So(n,4),e,i,_l)}function wu(t,n,e){var r=wp(t)?y:M,i=arguments.length<3;return r(t,So(n,4),e,i,xl)}function bu(t,n){var e=wp(t)?p:Qe;return e(t,Uu(So(n,3)))}function ku(t){var n=wp(t)?je:ai;return n(t)}function Eu(t,n,e){n=(e?Fo(t,n,e):n===it)?1:Ac(n);var r=wp(t)?ze:ui;return r(t,n)}function Su(t){var n=wp(t)?Ce:si;return n(t)}function Au(t){if(null==t)return 0;if(Xu(t))return _c(t)?Q(t):t.length;var n=Il(t);return n==Zt||n==on?t.size:Pr(t).length}function ju(t,n,e){var r=wp(t)?_:li;return e&&Fo(t,n,e)&&(n=it),r(t,So(n,3))}function zu(t,n){if("function"!=typeof n)throw new vf(ct);return t=Ac(t),function(){if(--t<1)return n.apply(this,arguments)}}function Cu(t,n,e){return n=e?it:n,n=t&&null==n?t.length:n,po(t,Et,it,it,it,it,n)}function Mu(t,n){var e;if("function"!=typeof n)throw new vf(ct);return t=Ac(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=it),e}}function Iu(t,n,e){n=e?it:n;var r=po(t,xt,it,it,it,it,it,n);return r.placeholder=Iu.placeholder,r}function Bu(t,n,e){n=e?it:n;var r=po(t,wt,it,it,it,it,it,n);return r.placeholder=Bu.placeholder,r}function Ou(t,n,e){function r(n){var e=p,r=h;return p=h=it,y=n,v=t.apply(r,e)}function i(t){return y=t,m=Rl(u,n),_?r(t):v}function o(t){var e=t-g,r=t-y,i=n-e;return x?Zf(i,d-r):i}function a(t){var e=t-g,r=t-y;return g===it||e>=n||e<0||x&&r>=d}function u(){var t=sp();return a(t)?c(t):void(m=Rl(u,o(t)))}function c(t){return m=it,w&&p?r(t):(p=h=it,v)}function s(){m!==it&&Al(m),y=0,p=g=h=m=it}function f(){return m===it?v:c(sp())}function l(){var t=sp(),e=a(t);if(p=arguments,h=this,g=t,e){if(m===it)return i(g);if(x)return m=Rl(u,n),r(g)}return m===it&&(m=Rl(u,n)),v}var p,h,d,v,m,g,y=0,_=!1,x=!1,w=!0;if("function"!=typeof t)throw new vf(ct);return n=zc(n)||0,cc(e)&&(_=!!e.leading,x="maxWait"in e,d=x?Xf(zc(e.maxWait)||0,n):d,w="trailing"in e?!!e.trailing:w),l.cancel=s,l.flush=f,l}function Ru(t){return po(t,At)}function Tu(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new vf(ct);var e=function(){var r=arguments,i=n?n.apply(this,r):r[0],o=e.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return e.cache=o.set(i,a)||o,a};return e.cache=new(Tu.Cache||le),e}function Uu(t){if("function"!=typeof t)throw new vf(ct);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function Du(t){return Mu(2,t)}function Wu(t,n){if("function"!=typeof t)throw new vf(ct);return n=n===it?n:Ac(n),oi(t,n)}function Fu(t,n){if("function"!=typeof t)throw new vf(ct);return n=null==n?0:Xf(Ac(n),0),oi(function(e){var r=e[n],i=ji(e,0,n);return r&&m(i,r),u(t,this,i)})}function Lu(t,n,e){var r=!0,i=!0;if("function"!=typeof t)throw new vf(ct);return cc(e)&&(r="leading"in e?!!e.leading:r,i="trailing"in e?!!e.trailing:i),Ou(t,n,{leading:r,maxWait:n,trailing:i})}function Pu(t){return Cu(t,1)}function qu(t,n){return vp(Si(n),t)}function Nu(){if(!arguments.length)return[];var t=arguments[0];return wp(t)?t:[t]}function Hu(t){return Fe(t,dt)}function Ku(t,n){return n="function"==typeof n?n:it,Fe(t,dt,n)}function Ju(t){return Fe(t,pt|dt)}function $u(t,n){return n="function"==typeof n?n:it,Fe(t,pt|dt,n)}function Vu(t,n){return null==n||Pe(t,n,Hc(n))}function Gu(t,n){return t===n||t!==t&&n!==n}function Xu(t){return null!=t&&uc(t.length)&&!oc(t)}function Zu(t){return sc(t)&&Xu(t)}function Yu(t){return t===!0||t===!1||sc(t)&&sr(t)==Kt}function Qu(t){return sc(t)&&1===t.nodeType&&!gc(t)}function tc(t){if(null==t)return!0;if(Xu(t)&&(wp(t)||"string"==typeof t||"function"==typeof t.splice||kp(t)||zp(t)||xp(t)))return!t.length;var n=Il(t);if(n==Zt||n==on)return!t.size;if(Ho(t))return!Pr(t).length;for(var e in t)if(wf.call(t,e))return!1;return!0}function nc(t,n){return Br(t,n)}function ec(t,n,e){e="function"==typeof e?e:it;var r=e?e(t,n):it;return r===it?Br(t,n,it,e):!!r}function rc(t){if(!sc(t))return!1;var n=sr(t);return n==Vt||n==$t||"string"==typeof t.message&&"string"==typeof t.name&&!gc(t)}function ic(t){return"number"==typeof t&&$f(t)}function oc(t){if(!cc(t))return!1;var n=sr(t);return n==Gt||n==Xt||n==Ht||n==en}function ac(t){return"number"==typeof t&&t==Ac(t)}function uc(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Tt}function cc(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}function sc(t){return null!=t&&"object"==typeof t}function fc(t,n){return t===n||Tr(t,n,jo(n))}function lc(t,n,e){return e="function"==typeof e?e:it,Tr(t,n,jo(n),e)}function pc(t){return mc(t)&&t!=+t}function hc(t){if(Bl(t))throw new sf(ut);return Ur(t)}function dc(t){return null===t}function vc(t){return null==t}function mc(t){return"number"==typeof t||sc(t)&&sr(t)==Yt}function gc(t){if(!sc(t)||sr(t)!=tn)return!1;var n=Bf(t);if(null===n)return!0;var e=wf.call(n,"constructor")&&n.constructor;return"function"==typeof e&&e instanceof e&&xf.call(e)==Sf}function yc(t){return ac(t)&&t>=-Tt&&t<=Tt}function _c(t){return"string"==typeof t||!wp(t)&&sc(t)&&sr(t)==an}function xc(t){return"symbol"==typeof t||sc(t)&&sr(t)==un}function wc(t){return t===it}function bc(t){return sc(t)&&Il(t)==sn}function kc(t){return sc(t)&&sr(t)==fn}function Ec(t){if(!t)return[];if(Xu(t))return _c(t)?tt(t):Li(t);if(Df&&t[Df])return K(t[Df]());var n=Il(t),e=n==Zt?J:n==on?G:rs;return e(t)}function Sc(t){if(!t)return 0===t?t:0;if(t=zc(t),t===Rt||t===-Rt){var n=t<0?-1:1;return n*Ut}return t===t?t:0}function Ac(t){var n=Sc(t),e=n%1;return n===n?e?n-e:n:0}function jc(t){return t?We(Ac(t),0,Wt):0}function zc(t){if("number"==typeof t)return t;if(xc(t))return Dt;if(cc(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=cc(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Wn,"");var e=Gn.test(t);return e||Zn.test(t)?ir(t.slice(2),e?2:8):Vn.test(t)?Dt:+t}function Cc(t){return Pi(t,Kc(t))}function Mc(t){return t?We(Ac(t),-Tt,Tt):0===t?t:0}function Ic(t){return null==t?"":mi(t)}function Bc(t,n){var e=yl(t);return null==n?e:Re(e,n)}function Oc(t,n){return b(t,So(n,3),nr)}function Rc(t,n){return b(t,So(n,3),er)}function Tc(t,n){return null==t?t:wl(t,So(n,3),Kc)}function Uc(t,n){return null==t?t:bl(t,So(n,3),Kc)}function Dc(t,n){return t&&nr(t,So(n,3))}function Wc(t,n){return t&&er(t,So(n,3))}function Fc(t){return null==t?[]:or(t,Hc(t))}function Lc(t){return null==t?[]:or(t,Kc(t))}function Pc(t,n,e){var r=null==t?it:ar(t,n);return r===it?e:r}function qc(t,n){return null!=t&&Bo(t,n,pr)}function Nc(t,n){return null!=t&&Bo(t,n,_r)}function Hc(t){return Xu(t)?Ae(t):Pr(t)}function Kc(t){return Xu(t)?Ae(t,!0):qr(t)}function Jc(t,n){var e={};return n=So(n,3),nr(t,function(t,r,i){Ue(e,n(t,r,i),t)}),e}function $c(t,n){var e={};return n=So(n,3),nr(t,function(t,r,i){Ue(e,r,n(t,r,i))}),e}function Vc(t,n){return Gc(t,Uu(So(n)))}function Gc(t,n){if(null==t)return{};var e=v(bo(t),function(t){return[t]});return n=So(n),Yr(t,e,function(t,e){return n(t,e[0])})}function Xc(t,n,e){n=Ai(n,t);var r=-1,i=n.length;for(i||(i=1,t=it);++r<i;){var o=null==t?it:t[ra(n[r])];o===it&&(r=i,o=e),t=oc(o)?o.call(t):o}return t}function Zc(t,n,e){return null==t?t:ci(t,n,e)}function Yc(t,n,e,r){return r="function"==typeof r?r:it,null==t?t:ci(t,n,e,r)}function Qc(t,n,e){var r=wp(t),i=r||kp(t)||zp(t);if(n=So(n,4),null==e){var o=t&&t.constructor;e=i?r?new o:[]:cc(t)&&oc(o)?yl(Bf(t)):{}}return(i?s:nr)(t,function(t,r,i){return n(e,t,r,i)}),e}function ts(t,n){return null==t||yi(t,n)}function ns(t,n,e){return null==t?t:_i(t,n,Si(e))}function es(t,n,e,r){return r="function"==typeof r?r:it,null==t?t:_i(t,n,Si(e),r)}function rs(t){return null==t?[]:U(t,Hc(t))}function is(t){return null==t?[]:U(t,Kc(t))}function os(t,n,e){return e===it&&(e=n,n=it),e!==it&&(e=zc(e),e=e===e?e:0),n!==it&&(n=zc(n),n=n===n?n:0),We(zc(t),n,e)}function as(t,n,e){return n=Sc(n),e===it?(e=n,n=0):e=Sc(e),t=zc(t),kr(t,n,e)}function us(t,n,e){if(e&&"boolean"!=typeof e&&Fo(t,n,e)&&(n=e=it),e===it&&("boolean"==typeof n?(e=n,n=it):"boolean"==typeof t&&(e=t,t=it)),t===it&&n===it?(t=0,n=1):(t=Sc(t),n===it?(n=t,t=0):n=Sc(n)),t>n){var r=t;t=n,n=r}if(e||t%1||n%1){var i=tl();return Zf(t+i*(n-t+rr("1e-"+((i+"").length-1))),n)}return ei(t,n)}function cs(t){return th(Ic(t).toLowerCase())}function ss(t){return t=Ic(t),t&&t.replace(Qn,xr).replace(He,"")}function fs(t,n,e){t=Ic(t),n=mi(n);var r=t.length;e=e===it?r:We(Ac(e),0,r);var i=e;return e-=n.length,e>=0&&t.slice(e,i)==n}function ls(t){return t=Ic(t),t&&zn.test(t)?t.replace(An,wr):t}function ps(t){return t=Ic(t),t&&Dn.test(t)?t.replace(Un,"\\\\$&"):t}function hs(t,n,e){\nt=Ic(t),n=Ac(n);var r=n?Q(t):0;if(!n||r>=n)return t;var i=(n-r)/2;return oo(Hf(i),e)+t+oo(Nf(i),e)}function ds(t,n,e){t=Ic(t),n=Ac(n);var r=n?Q(t):0;return n&&r<n?t+oo(n-r,e):t}function vs(t,n,e){t=Ic(t),n=Ac(n);var r=n?Q(t):0;return n&&r<n?oo(n-r,e)+t:t}function ms(t,n,e){return e||null==n?n=0:n&&(n=+n),Qf(Ic(t).replace(Fn,""),n||0)}function gs(t,n,e){return n=(e?Fo(t,n,e):n===it)?1:Ac(n),ii(Ic(t),n)}function ys(){var t=arguments,n=Ic(t[0]);return t.length<3?n:n.replace(t[1],t[2])}function _s(t,n,e){return e&&"number"!=typeof e&&Fo(t,n,e)&&(n=e=it),(e=e===it?Wt:e>>>0)?(t=Ic(t),t&&("string"==typeof n||null!=n&&!Ap(n))&&(n=mi(n),!n&&N(t))?ji(tt(t),0,e):t.split(n,e)):[]}function xs(t,n,e){return t=Ic(t),e=null==e?0:We(Ac(e),0,t.length),n=mi(n),t.slice(e,e+n.length)==n}function ws(t,e,r){var i=n.templateSettings;r&&Fo(t,e,r)&&(e=it),t=Ic(t),e=Op({},e,i,ho);var o,a,u=Op({},e.imports,i.imports,ho),c=Hc(u),s=U(u,c),f=0,l=e.interpolate||te,p="__p += \'",h=hf((e.escape||te).source+"|"+l.source+"|"+(l===In?Jn:te).source+"|"+(e.evaluate||te).source+"|$","g"),d="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++Xe+"]")+"\\n";t.replace(h,function(n,e,r,i,u,c){return r||(r=i),p+=t.slice(f,c).replace(ne,P),e&&(o=!0,p+="\' +\\n__e("+e+") +\\n\'"),u&&(a=!0,p+="\';\\n"+u+";\\n__p += \'"),r&&(p+="\' +\\n((__t = ("+r+")) == null ? \'\' : __t) +\\n\'"),f=c+n.length,n}),p+="\';\\n";var v=e.variable;v||(p="with (obj) {\\n"+p+"\\n}\\n"),p=(a?p.replace(bn,""):p).replace(kn,"$1").replace(En,"$1;"),p="function("+(v||"obj")+") {\\n"+(v?"":"obj || (obj = {});\\n")+"var __t, __p = \'\'"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\\nfunction print() { __p += __j.call(arguments, \'\') }\\n":";\\n")+p+"return __p\\n}";var m=nh(function(){return ff(c,d+"return "+p).apply(it,s)});if(m.source=p,rc(m))throw m;return m}function bs(t){return Ic(t).toLowerCase()}function ks(t){return Ic(t).toUpperCase()}function Es(t,n,e){if(t=Ic(t),t&&(e||n===it))return t.replace(Wn,"");if(!t||!(n=mi(n)))return t;var r=tt(t),i=tt(n),o=W(r,i),a=F(r,i)+1;return ji(r,o,a).join("")}function Ss(t,n,e){if(t=Ic(t),t&&(e||n===it))return t.replace(Ln,"");if(!t||!(n=mi(n)))return t;var r=tt(t),i=F(r,tt(n))+1;return ji(r,0,i).join("")}function As(t,n,e){if(t=Ic(t),t&&(e||n===it))return t.replace(Fn,"");if(!t||!(n=mi(n)))return t;var r=tt(t),i=W(r,tt(n));return ji(r,i).join("")}function js(t,n){var e=jt,r=zt;if(cc(n)){var i="separator"in n?n.separator:i;e="length"in n?Ac(n.length):e,r="omission"in n?mi(n.omission):r}t=Ic(t);var o=t.length;if(N(t)){var a=tt(t);o=a.length}if(e>=o)return t;var u=e-Q(r);if(u<1)return r;var c=a?ji(a,0,u).join(""):t.slice(0,u);if(i===it)return c+r;if(a&&(u+=c.length-u),Ap(i)){if(t.slice(u).search(i)){var s,f=c;for(i.global||(i=hf(i.source,Ic($n.exec(i))+"g")),i.lastIndex=0;s=i.exec(f);)var l=s.index;c=c.slice(0,l===it?u:l)}}else if(t.indexOf(mi(i),u)!=u){var p=c.lastIndexOf(i);p>-1&&(c=c.slice(0,p))}return c+r}function zs(t){return t=Ic(t),t&&jn.test(t)?t.replace(Sn,br):t}function Cs(t,n,e){return t=Ic(t),n=e?it:n,n===it?H(t)?rt(t):w(t):t.match(n)||[]}function Ms(t){var n=null==t?0:t.length,e=So();return t=n?v(t,function(t){if("function"!=typeof t[1])throw new vf(ct);return[e(t[0]),t[1]]}):[],oi(function(e){for(var r=-1;++r<n;){var i=t[r];if(u(i[0],this,e))return u(i[1],this,e)}})}function Is(t){return Le(Fe(t,pt))}function Bs(t){return function(){return t}}function Os(t,n){return null==t||t!==t?n:t}function Rs(t){return t}function Ts(t){return Lr("function"==typeof t?t:Fe(t,pt))}function Us(t){return Kr(Fe(t,pt))}function Ds(t,n){return Jr(t,Fe(n,pt))}function Ws(t,n,e){var r=Hc(n),i=or(n,r);null!=e||cc(n)&&(i.length||!r.length)||(e=n,n=t,t=this,i=or(n,Hc(n)));var o=!(cc(e)&&"chain"in e&&!e.chain),a=oc(t);return s(i,function(e){var r=n[e];t[e]=r,a&&(t.prototype[e]=function(){var n=this.__chain__;if(o||n){var e=t(this.__wrapped__),i=e.__actions__=Li(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),e.__chain__=n,e}return r.apply(t,m([this.value()],arguments))})}),t}function Fs(){return ur._===this&&(ur._=Af),this}function Ls(){}function Ps(t){return t=Ac(t),oi(function(n){return Gr(n,t)})}function qs(t){return Lo(t)?z(ra(t)):Qr(t)}function Ns(t){return function(n){return null==t?it:ar(t,n)}}function Hs(){return[]}function Ks(){return!1}function Js(){return{}}function $s(){return""}function Vs(){return!0}function Gs(t,n){if(t=Ac(t),t<1||t>Tt)return[];var e=Wt,r=Zf(t,Wt);n=So(n),t-=Wt;for(var i=O(r,n);++e<t;)n(e);return i}function Xs(t){return wp(t)?v(t,ra):xc(t)?[t]:Li(Ul(Ic(t)))}function Zs(t){var n=++bf;return Ic(t)+n}function Ys(t){return t&&t.length?$e(t,Rs,lr):it}function Qs(t,n){return t&&t.length?$e(t,So(n,2),lr):it}function tf(t){return j(t,Rs)}function nf(t,n){return j(t,So(n,2))}function ef(t){return t&&t.length?$e(t,Rs,Nr):it}function rf(t,n){return t&&t.length?$e(t,So(n,2),Nr):it}function of(t){return t&&t.length?B(t,Rs):0}function af(t,n){return t&&t.length?B(t,So(n,2)):0}t=null==t?ur:Er.defaults(ur.Object(),t,Er.pick(ur,Ge));var uf=t.Array,cf=t.Date,sf=t.Error,ff=t.Function,lf=t.Math,pf=t.Object,hf=t.RegExp,df=t.String,vf=t.TypeError,mf=uf.prototype,gf=ff.prototype,yf=pf.prototype,_f=t["__core-js_shared__"],xf=gf.toString,wf=yf.hasOwnProperty,bf=0,kf=function(){var t=/[^.]+$/.exec(_f&&_f.keys&&_f.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ef=yf.toString,Sf=xf.call(pf),Af=ur._,jf=hf("^"+xf.call(wf).replace(Un,"\\\\$&").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,"$1.*?")+"$"),zf=fr?t.Buffer:it,Cf=t.Symbol,Mf=t.Uint8Array,If=zf?zf.allocUnsafe:it,Bf=$(pf.getPrototypeOf,pf),Of=pf.create,Rf=yf.propertyIsEnumerable,Tf=mf.splice,Uf=Cf?Cf.isConcatSpreadable:it,Df=Cf?Cf.iterator:it,Wf=Cf?Cf.toStringTag:it,Ff=function(){try{var t=zo(pf,"defineProperty");return t({},"",{}),t}catch(n){}}(),Lf=t.clearTimeout!==ur.clearTimeout&&t.clearTimeout,Pf=cf&&cf.now!==ur.Date.now&&cf.now,qf=t.setTimeout!==ur.setTimeout&&t.setTimeout,Nf=lf.ceil,Hf=lf.floor,Kf=pf.getOwnPropertySymbols,Jf=zf?zf.isBuffer:it,$f=t.isFinite,Vf=mf.join,Gf=$(pf.keys,pf),Xf=lf.max,Zf=lf.min,Yf=cf.now,Qf=t.parseInt,tl=lf.random,nl=mf.reverse,el=zo(t,"DataView"),rl=zo(t,"Map"),il=zo(t,"Promise"),ol=zo(t,"Set"),al=zo(t,"WeakMap"),ul=zo(pf,"create"),cl=al&&new al,sl={},fl=ia(el),ll=ia(rl),pl=ia(il),hl=ia(ol),dl=ia(al),vl=Cf?Cf.prototype:it,ml=vl?vl.valueOf:it,gl=vl?vl.toString:it,yl=function(){function t(){}return function(n){if(!cc(n))return{};if(Of)return Of(n);t.prototype=n;var e=new t;return t.prototype=it,e}}();n.templateSettings={escape:Cn,evaluate:Mn,interpolate:In,variable:"",imports:{_:n}},n.prototype=e.prototype,n.prototype.constructor=n,r.prototype=yl(e.prototype),r.prototype.constructor=r,i.prototype=yl(e.prototype),i.prototype.constructor=i,nt.prototype.clear=et,nt.prototype["delete"]=Hn,nt.prototype.get=ee,nt.prototype.has=re,nt.prototype.set=ie,oe.prototype.clear=ae,oe.prototype["delete"]=ue,oe.prototype.get=ce,oe.prototype.has=se,oe.prototype.set=fe,le.prototype.clear=pe,le.prototype["delete"]=he,le.prototype.get=de,le.prototype.has=ve,le.prototype.set=me,ge.prototype.add=ge.prototype.push=ye,ge.prototype.has=_e,xe.prototype.clear=we,xe.prototype["delete"]=be,xe.prototype.get=ke,xe.prototype.has=Ee,xe.prototype.set=Se;var _l=Ji(nr),xl=Ji(er,!0),wl=$i(),bl=$i(!0),kl=cl?function(t,n){return cl.set(t,n),t}:Rs,El=Ff?function(t,n){return Ff(t,"toString",{configurable:!0,enumerable:!1,value:Bs(n),writable:!0})}:Rs,Sl=oi,Al=Lf||function(t){return ur.clearTimeout(t)},jl=ol&&1/G(new ol([,-0]))[1]==Rt?function(t){return new ol(t)}:Ls,zl=cl?function(t){return cl.get(t)}:Ls,Cl=Kf?function(t){return null==t?[]:(t=pf(t),p(Kf(t),function(n){return Rf.call(t,n)}))}:Hs,Ml=Kf?function(t){for(var n=[];t;)m(n,Cl(t)),t=Bf(t);return n}:Hs,Il=sr;(el&&Il(new el(new ArrayBuffer(1)))!=pn||rl&&Il(new rl)!=Zt||il&&Il(il.resolve())!=nn||ol&&Il(new ol)!=on||al&&Il(new al)!=sn)&&(Il=function(t){var n=sr(t),e=n==tn?t.constructor:it,r=e?ia(e):"";if(r)switch(r){case fl:return pn;case ll:return Zt;case pl:return nn;case hl:return on;case dl:return sn}return n});var Bl=_f?oc:Ks,Ol=na(kl),Rl=qf||function(t,n){return ur.setTimeout(t,n)},Tl=na(El),Ul=$o(function(t){var n=[];return Rn.test(t)&&n.push(""),t.replace(Tn,function(t,e,r,i){n.push(r?i.replace(Kn,"$1"):e||t)}),n}),Dl=oi(function(t,n){return Zu(t)?Ke(t,tr(n,1,Zu,!0)):[]}),Wl=oi(function(t,n){var e=Sa(n);return Zu(e)&&(e=it),Zu(t)?Ke(t,tr(n,1,Zu,!0),So(e,2)):[]}),Fl=oi(function(t,n){var e=Sa(n);return Zu(e)&&(e=it),Zu(t)?Ke(t,tr(n,1,Zu,!0),it,e):[]}),Ll=oi(function(t){var n=v(t,Ei);return n.length&&n[0]===t[0]?Ar(n):[]}),Pl=oi(function(t){var n=Sa(t),e=v(t,Ei);return n===Sa(e)?n=it:e.pop(),e.length&&e[0]===t[0]?Ar(e,So(n,2)):[]}),ql=oi(function(t){var n=Sa(t),e=v(t,Ei);return n="function"==typeof n?n:it,n&&e.pop(),e.length&&e[0]===t[0]?Ar(e,it,n):[]}),Nl=oi(za),Hl=xo(function(t,n){var e=null==t?0:t.length,r=De(t,n);return ni(t,v(n,function(t){return Wo(t,e)?+t:t}).sort(Ui)),r}),Kl=oi(function(t){return gi(tr(t,1,Zu,!0))}),Jl=oi(function(t){var n=Sa(t);return Zu(n)&&(n=it),gi(tr(t,1,Zu,!0),So(n,2))}),$l=oi(function(t){var n=Sa(t);return n="function"==typeof n?n:it,gi(tr(t,1,Zu,!0),it,n)}),Vl=oi(function(t,n){return Zu(t)?Ke(t,n):[]}),Gl=oi(function(t){return bi(p(t,Zu))}),Xl=oi(function(t){var n=Sa(t);return Zu(n)&&(n=it),bi(p(t,Zu),So(n,2))}),Zl=oi(function(t){var n=Sa(t);return n="function"==typeof n?n:it,bi(p(t,Zu),it,n)}),Yl=oi(Xa),Ql=oi(function(t){var n=t.length,e=n>1?t[n-1]:it;return e="function"==typeof e?(t.pop(),e):it,Za(t,e)}),tp=xo(function(t){var n=t.length,e=n?t[0]:0,o=this.__wrapped__,a=function(n){return De(n,t)};return!(n>1||this.__actions__.length)&&o instanceof i&&Wo(e)?(o=o.slice(e,+e+(n?1:0)),o.__actions__.push({func:eu,args:[a],thisArg:it}),new r(o,this.__chain__).thru(function(t){return n&&!t.length&&t.push(it),t})):this.thru(a)}),np=Hi(function(t,n,e){wf.call(t,e)?++t[e]:Ue(t,e,1)}),ep=Qi(va),rp=Qi(ma),ip=Hi(function(t,n,e){wf.call(t,e)?t[e].push(n):Ue(t,e,[n])}),op=oi(function(t,n,e){var r=-1,i="function"==typeof n,o=Xu(t)?uf(t.length):[];return _l(t,function(t){o[++r]=i?u(n,t,e):zr(t,n,e)}),o}),ap=Hi(function(t,n,e){Ue(t,e,n)}),up=Hi(function(t,n,e){t[e?0:1].push(n)},function(){return[[],[]]}),cp=oi(function(t,n){if(null==t)return[];var e=n.length;return e>1&&Fo(t,n[0],n[1])?n=[]:e>2&&Fo(n[0],n[1],n[2])&&(n=[n[0]]),Xr(t,tr(n,1),[])}),sp=Pf||function(){return ur.Date.now()},fp=oi(function(t,n,e){var r=gt;if(e.length){var i=V(e,Eo(fp));r|=bt}return po(t,r,n,e,i)}),lp=oi(function(t,n,e){var r=gt|yt;if(e.length){var i=V(e,Eo(lp));r|=bt}return po(n,r,t,e,i)}),pp=oi(function(t,n){return qe(t,1,n)}),hp=oi(function(t,n,e){return qe(t,zc(n)||0,e)});Tu.Cache=le;var dp=Sl(function(t,n){n=1==n.length&&wp(n[0])?v(n[0],T(So())):v(tr(n,1),T(So()));var e=n.length;return oi(function(r){for(var i=-1,o=Zf(r.length,e);++i<o;)r[i]=n[i].call(this,r[i]);return u(t,this,r)})}),vp=oi(function(t,n){var e=V(n,Eo(vp));return po(t,bt,it,n,e)}),mp=oi(function(t,n){var e=V(n,Eo(mp));return po(t,kt,it,n,e)}),gp=xo(function(t,n){return po(t,St,it,it,it,n)}),yp=co(lr),_p=co(function(t,n){return t>=n}),xp=Cr(function(){return arguments}())?Cr:function(t){return sc(t)&&wf.call(t,"callee")&&!Rf.call(t,"callee")},wp=uf.isArray,bp=hr?T(hr):Mr,kp=Jf||Ks,Ep=dr?T(dr):Ir,Sp=vr?T(vr):Rr,Ap=mr?T(mr):Dr,jp=gr?T(gr):Wr,zp=yr?T(yr):Fr,Cp=co(Nr),Mp=co(function(t,n){return t<=n}),Ip=Ki(function(t,n){if(Ho(n)||Xu(n))return void Pi(n,Hc(n),t);for(var e in n)wf.call(n,e)&&Ie(t,e,n[e])}),Bp=Ki(function(t,n){Pi(n,Kc(n),t)}),Op=Ki(function(t,n,e,r){Pi(n,Kc(n),t,r)}),Rp=Ki(function(t,n,e,r){Pi(n,Hc(n),t,r)}),Tp=xo(De),Up=oi(function(t){return t.push(it,ho),u(Op,it,t)}),Dp=oi(function(t){return t.push(it,vo),u(qp,it,t)}),Wp=eo(function(t,n,e){t[n]=e},Bs(Rs)),Fp=eo(function(t,n,e){wf.call(t,n)?t[n].push(e):t[n]=[e]},So),Lp=oi(zr),Pp=Ki(function(t,n,e){$r(t,n,e)}),qp=Ki(function(t,n,e,r){$r(t,n,e,r)}),Np=xo(function(t,n){var e={};if(null==t)return e;var r=!1;n=v(n,function(n){return n=Ai(n,t),r||(r=n.length>1),n}),Pi(t,bo(t),e),r&&(e=Fe(e,pt|ht|dt,mo));for(var i=n.length;i--;)yi(e,n[i]);return e}),Hp=xo(function(t,n){return null==t?{}:Zr(t,n)}),Kp=lo(Hc),Jp=lo(Kc),$p=Xi(function(t,n,e){return n=n.toLowerCase(),t+(e?cs(n):n)}),Vp=Xi(function(t,n,e){return t+(e?"-":"")+n.toLowerCase()}),Gp=Xi(function(t,n,e){return t+(e?" ":"")+n.toLowerCase()}),Xp=Gi("toLowerCase"),Zp=Xi(function(t,n,e){return t+(e?"_":"")+n.toLowerCase()}),Yp=Xi(function(t,n,e){return t+(e?" ":"")+th(n)}),Qp=Xi(function(t,n,e){return t+(e?" ":"")+n.toUpperCase()}),th=Gi("toUpperCase"),nh=oi(function(t,n){try{return u(t,it,n)}catch(e){return rc(e)?e:new sf(e)}}),eh=xo(function(t,n){return s(n,function(n){n=ra(n),Ue(t,n,fp(t[n],t))}),t}),rh=to(),ih=to(!0),oh=oi(function(t,n){return function(e){return zr(e,t,n)}}),ah=oi(function(t,n){return function(e){return zr(t,e,n)}}),uh=io(v),ch=io(l),sh=io(_),fh=uo(),lh=uo(!0),ph=ro(function(t,n){return t+n},0),hh=fo("ceil"),dh=ro(function(t,n){return t/n},1),vh=fo("floor"),mh=ro(function(t,n){return t*n},1),gh=fo("round"),yh=ro(function(t,n){return t-n},0);return n.after=zu,n.ary=Cu,n.assign=Ip,n.assignIn=Bp,n.assignInWith=Op,n.assignWith=Rp,n.at=Tp,n.before=Mu,n.bind=fp,n.bindAll=eh,n.bindKey=lp,n.castArray=Nu,n.chain=tu,n.chunk=ua,n.compact=ca,n.concat=sa,n.cond=Ms,n.conforms=Is,n.constant=Bs,n.countBy=np,n.create=Bc,n.curry=Iu,n.curryRight=Bu,n.debounce=Ou,n.defaults=Up,n.defaultsDeep=Dp,n.defer=pp,n.delay=hp,n.difference=Dl,n.differenceBy=Wl,n.differenceWith=Fl,n.drop=fa,n.dropRight=la,n.dropRightWhile=pa,n.dropWhile=ha,n.fill=da,n.filter=lu,n.flatMap=pu,n.flatMapDeep=hu,n.flatMapDepth=du,n.flatten=ga,n.flattenDeep=ya,n.flattenDepth=_a,n.flip=Ru,n.flow=rh,n.flowRight=ih,n.fromPairs=xa,n.functions=Fc,n.functionsIn=Lc,n.groupBy=ip,n.initial=ka,n.intersection=Ll,n.intersectionBy=Pl,n.intersectionWith=ql,n.invert=Wp,n.invertBy=Fp,n.invokeMap=op,n.iteratee=Ts,n.keyBy=ap,n.keys=Hc,n.keysIn=Kc,n.map=yu,n.mapKeys=Jc,n.mapValues=$c,n.matches=Us,n.matchesProperty=Ds,n.memoize=Tu,n.merge=Pp,n.mergeWith=qp,n.method=oh,n.methodOf=ah,n.mixin=Ws,n.negate=Uu,n.nthArg=Ps,n.omit=Np,n.omitBy=Vc,n.once=Du,n.orderBy=_u,n.over=uh,n.overArgs=dp,n.overEvery=ch,n.overSome=sh,n.partial=vp,n.partialRight=mp,n.partition=up,n.pick=Hp,n.pickBy=Gc,n.property=qs,n.propertyOf=Ns,n.pull=Nl,n.pullAll=za,n.pullAllBy=Ca,n.pullAllWith=Ma,n.pullAt=Hl,n.range=fh,n.rangeRight=lh,n.rearg=gp,n.reject=bu,n.remove=Ia,n.rest=Wu,n.reverse=Ba,n.sampleSize=Eu,n.set=Zc,n.setWith=Yc,n.shuffle=Su,n.slice=Oa,n.sortBy=cp,n.sortedUniq=La,n.sortedUniqBy=Pa,n.split=_s,n.spread=Fu,n.tail=qa,n.take=Na,n.takeRight=Ha,n.takeRightWhile=Ka,n.takeWhile=Ja,n.tap=nu,n.throttle=Lu,n.thru=eu,n.toArray=Ec,n.toPairs=Kp,n.toPairsIn=Jp,n.toPath=Xs,n.toPlainObject=Cc,n.transform=Qc,n.unary=Pu,n.union=Kl,n.unionBy=Jl,n.unionWith=$l,n.uniq=$a,n.uniqBy=Va,n.uniqWith=Ga,n.unset=ts,n.unzip=Xa,n.unzipWith=Za,n.update=ns,n.updateWith=es,n.values=rs,n.valuesIn=is,n.without=Vl,n.words=Cs,n.wrap=qu,n.xor=Gl,n.xorBy=Xl,n.xorWith=Zl,n.zip=Yl,n.zipObject=Ya,n.zipObjectDeep=Qa,n.zipWith=Ql,n.entries=Kp,n.entriesIn=Jp,n.extend=Bp,n.extendWith=Op,Ws(n,n),n.add=ph,n.attempt=nh,n.camelCase=$p,n.capitalize=cs,n.ceil=hh,n.clamp=os,n.clone=Hu,n.cloneDeep=Ju,n.cloneDeepWith=$u,n.cloneWith=Ku,n.conformsTo=Vu,n.deburr=ss,n.defaultTo=Os,n.divide=dh,n.endsWith=fs,n.eq=Gu,n.escape=ls,n.escapeRegExp=ps,n.every=fu,n.find=ep,n.findIndex=va,n.findKey=Oc,n.findLast=rp,n.findLastIndex=ma,n.findLastKey=Rc,n.floor=vh,n.forEach=vu,n.forEachRight=mu,n.forIn=Tc,n.forInRight=Uc,n.forOwn=Dc,n.forOwnRight=Wc,n.get=Pc,n.gt=yp,n.gte=_p,n.has=qc,n.hasIn=Nc,n.head=wa,n.identity=Rs,n.includes=gu,n.indexOf=ba,n.inRange=as,n.invoke=Lp,n.isArguments=xp,n.isArray=wp,n.isArrayBuffer=bp,n.isArrayLike=Xu,n.isArrayLikeObject=Zu,n.isBoolean=Yu,n.isBuffer=kp,n.isDate=Ep,n.isElement=Qu,n.isEmpty=tc,n.isEqual=nc,n.isEqualWith=ec,n.isError=rc,n.isFinite=ic,n.isFunction=oc,n.isInteger=ac,n.isLength=uc,n.isMap=Sp,n.isMatch=fc,n.isMatchWith=lc,n.isNaN=pc,n.isNative=hc,n.isNil=vc,n.isNull=dc,n.isNumber=mc,n.isObject=cc,n.isObjectLike=sc,n.isPlainObject=gc,n.isRegExp=Ap,n.isSafeInteger=yc,n.isSet=jp,n.isString=_c,n.isSymbol=xc,n.isTypedArray=zp,n.isUndefined=wc,n.isWeakMap=bc,n.isWeakSet=kc,n.join=Ea,n.kebabCase=Vp,n.last=Sa,n.lastIndexOf=Aa,n.lowerCase=Gp,n.lowerFirst=Xp,n.lt=Cp,n.lte=Mp,n.max=Ys,n.maxBy=Qs,n.mean=tf,n.meanBy=nf,n.min=ef,n.minBy=rf,n.stubArray=Hs,n.stubFalse=Ks,n.stubObject=Js,n.stubString=$s,n.stubTrue=Vs,n.multiply=mh,n.nth=ja,n.noConflict=Fs,n.noop=Ls,n.now=sp,n.pad=hs,n.padEnd=ds,n.padStart=vs,n.parseInt=ms,n.random=us,n.reduce=xu,n.reduceRight=wu,n.repeat=gs,n.replace=ys,n.result=Xc,n.round=gh,n.runInContext=Sr,n.sample=ku,n.size=Au,n.snakeCase=Zp,n.some=ju,n.sortedIndex=Ra,n.sortedIndexBy=Ta,n.sortedIndexOf=Ua,n.sortedLastIndex=Da,n.sortedLastIndexBy=Wa,n.sortedLastIndexOf=Fa,n.startCase=Yp,n.startsWith=xs,n.subtract=yh,n.sum=of,n.sumBy=af,n.template=ws,n.times=Gs,n.toFinite=Sc,n.toInteger=Ac,n.toLength=jc,n.toLower=bs,n.toNumber=zc,n.toSafeInteger=Mc,n.toString=Ic,n.toUpper=ks,n.trim=Es,n.trimEnd=Ss,n.trimStart=As,n.truncate=js,n.unescape=zs,n.uniqueId=Zs,n.upperCase=Qp,n.upperFirst=th,n.each=vu,n.eachRight=mu,n.first=wa,Ws(n,function(){var t={};return nr(n,function(e,r){wf.call(n.prototype,r)||(t[r]=e)}),t}(),{chain:!1}),n.VERSION=ot,s(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){n[t].placeholder=n}),s(["drop","take"],function(t,n){i.prototype[t]=function(e){e=e===it?1:Xf(Ac(e),0);var r=this.__filtered__&&!n?new i(this):this.clone();return r.__filtered__?r.__takeCount__=Zf(e,r.__takeCount__):r.__views__.push({size:Zf(e,Wt),type:t+(r.__dir__<0?"Right":"")}),r},i.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}}),s(["filter","map","takeWhile"],function(t,n){var e=n+1,r=e==It||e==Ot;i.prototype[t]=function(t){var n=this.clone();return n.__iteratees__.push({iteratee:So(t,3),type:e}),n.__filtered__=n.__filtered__||r,n}}),s(["head","last"],function(t,n){var e="take"+(n?"Right":"");i.prototype[t]=function(){return this[e](1).value()[0]}}),s(["initial","tail"],function(t,n){var e="drop"+(n?"":"Right");i.prototype[t]=function(){return this.__filtered__?new i(this):this[e](1)}}),i.prototype.compact=function(){return this.filter(Rs)},i.prototype.find=function(t){return this.filter(t).head()},i.prototype.findLast=function(t){return this.reverse().find(t)},i.prototype.invokeMap=oi(function(t,n){return"function"==typeof t?new i(this):this.map(function(e){return zr(e,t,n)})}),i.prototype.reject=function(t){return this.filter(Uu(So(t)))},i.prototype.slice=function(t,n){t=Ac(t);var e=this;return e.__filtered__&&(t>0||n<0)?new i(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==it&&(n=Ac(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},i.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},i.prototype.toArray=function(){return this.take(Wt)},nr(i.prototype,function(t,e){var o=/^(?:filter|find|map|reject)|While$/.test(e),a=/^(?:head|last)$/.test(e),u=n[a?"take"+("last"==e?"Right":""):e],c=a||/^find/.test(e);u&&(n.prototype[e]=function(){var e=this.__wrapped__,s=a?[1]:arguments,f=e instanceof i,l=s[0],p=f||wp(e),h=function(t){var e=u.apply(n,m([t],s));return a&&d?e[0]:e};p&&o&&"function"==typeof l&&1!=l.length&&(f=p=!1);var d=this.__chain__,v=!!this.__actions__.length,g=c&&!d,y=f&&!v;if(!c&&p){e=y?e:new i(this);var _=t.apply(e,s);return _.__actions__.push({func:eu,args:[h],thisArg:it}),new r(_,d)}return g&&y?t.apply(this,s):(_=this.thru(h),g?a?_.value()[0]:_.value():_)})}),s(["pop","push","shift","sort","splice","unshift"],function(t){var e=mf[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);n.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var n=this.value();return e.apply(wp(n)?n:[],t)}return this[r](function(n){return e.apply(wp(n)?n:[],t)})}}),nr(i.prototype,function(t,e){var r=n[e];if(r){var i=r.name+"",o=sl[i]||(sl[i]=[]);o.push({name:e,func:r})}}),sl[no(it,yt).name]=[{name:"wrapper",func:it}],i.prototype.clone=x,i.prototype.reverse=C,i.prototype.value=Z,n.prototype.at=tp,n.prototype.chain=ru,n.prototype.commit=iu,n.prototype.next=ou,n.prototype.plant=uu,n.prototype.reverse=cu,n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=su,n.prototype.first=n.prototype.head,Df&&(n.prototype[Df]=au),n},Er=kr();ur._=Er,r=function(){return Er}.call(n,e,n,i),!(r!==it&&(i.exports=r))}).call(this)}).call(n,function(){return this}(),e(71)(t))},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){return CryptoJS.lib.WordArray.create(new Uint8Array(t))}function o(t,n){return t instanceof ArrayBuffer||t instanceof Uint8Array||(t=new Uint8Array(t)),n instanceof ArrayBuffer||n instanceof Uint8Array||(n=new Uint8Array(n)),l.build(t,n).readBuffer()}var a=e(34),u=r(a),c=e(10),s=e(32),f=e(11),l=e(33),p=e(30),h={image:"WhatsApp Image Keys",IMAGE:"WhatsApp Image Keys",video:"WhatsApp Video Keys",VIDEO:"WhatsApp Video Keys",audio:"WhatsApp Audio Keys",ptt:"WhatsApp Audio Keys",AUDIO:"WhatsApp Audio Keys",document:"WhatsApp Document Keys",DOCUMENT:"WhatsApp Document Keys"},d={decryptE2EMediaWithWebCrypto:function(t,n,e,r){if(n.length<10)throw new c.MediaEncryptionError("ciphertext too short: "+n.length);var i=this.computeKeys(t,e),a=i.iv,u=i.cipherKey,s=i.macKey,l={name:"HMAC",hash:{name:"SHA-256"}},h={name:"AES-CBC",iv:new Uint8Array(a)};return this.getWebCrypto().then(function(e){var i=f.encode(n.slice(-10)),d=n.slice(0,-10),v=o(a,d);return e.importKey("raw",new Uint8Array(s),l,!1,["sign"]).then(function(t){return e.sign(l,t,v)}).then(function(t){var n=f.encode(new Uint8Array(t)),e=f.encode(f.decode(n).slice(0,10));if(!e||!i||e!==i)throw new c.MediaEncryptionError("hmac fail computed: "+e+" given: "+i)}).then(function(){return e.importKey("raw",new Uint8Array(u),h,!1,["decrypt"])}).then(function(t){return e.decrypt(h,t,d)}).then(function(n){return new Blob([n],{type:p.getMediaMimeType(t,n,r)})})})["catch"](c.MediaEncryptionError,function(t){throw t})["catch"](function(t){return!(t instanceof c.MediaEncryptionError)},function(t){throw new c.MediaEncryptionError("encryption error: "+t+"; stack: "+t.stack)})},encryptE2EMediaWithWebCrypto:function(t,n,e){var r=this.computeKeys(t,e),i=r.iv,a=r.cipherKey,u=r.macKey,s={name:"HMAC",hash:{name:"SHA-256"}},f={name:"AES-CBC",iv:new Uint8Array(i)};return this.getWebCrypto().then(function(t){return t.importKey("raw",new Uint8Array(a),f,!1,["encrypt"]).then(function(e){return t.encrypt(f,e,n)}).then(function(n){var e=o(i,n);return t.importKey("raw",new Uint8Array(u),s,!1,["sign"]).then(function(n){return t.sign(s,n,e)}).then(function(t){var e=t.slice(0,10),r=o(n,e);return new Blob([r])})})})["catch"](c.MediaEncryptionError,function(t){throw t})["catch"](function(t){return!(t instanceof c.MediaEncryptionError)},function(t){throw new c.MediaEncryptionError("encryption error: "+t+"; stack: "+t.stack)})},decryptE2EMediaWithCryptoJS:function(t,n,e,r){try{if(n.length<10)throw new c.MediaEncryptionError("ciphertext too short: "+n.length);var a=this.computeKeys(t,e),u=a.iv,s=a.cipherKey,l=a.macKey,h=f.encode(n.slice(-10)),d=n.slice(0,-10),v=o(u,d),m=CryptoJS.lib.WordArray.create(v),g=CryptoJS.HmacSHA256(m,i(l)).toString(CryptoJS.enc.Base64),y=f.encode(f.decode(g).slice(0,10));if(!y||!h||y!==h)throw new c.MediaEncryptionError("hmac fail computed: "+y+" given: "+h);var _=CryptoJS.AES.decrypt({ciphertext:CryptoJS.lib.WordArray.create(d),salt:void 0},i(s),{iv:i(u),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}),x=f.decode(_.toString(CryptoJS.enc.Base64));return new Blob([x],{type:p.getMediaMimeType(t,x,r)})}catch(w){throw w instanceof c.MediaEncryptionError?w:new c.MediaEncryptionError("unknown decrypt error: "+w+" stack: "+w.stack)}},encryptE2EMediaWithCryptoJS:function(t,n,e){try{var r=this.computeKeys(t,e),o=r.iv,a=r.cipherKey,u=r.macKey,s=CryptoJS.AES.encrypt(CryptoJS.lib.WordArray.create(n),i(a),{iv:i(o),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}),l=s.iv.concat(s.ciphertext),p=CryptoJS.HmacSHA256(l,i(u));p.sigBytes=10,p.clamp();var h=s.ciphertext.concat(p),d=f.decode(h.toString(CryptoJS.enc.Base64));return new Blob([d])}catch(v){throw v instanceof c.MediaEncryptionError?v:new c.MediaEncryptionError("unknown encrypt error: "+v+" stack: "+v.stack)}},computeKeys:function(t,n){var e=h[t];if(!n||!e)throw new c.MediaEncryptionError("computeKeys fail: !!mediakey: "+!!n+" info: "+e+" type: "+t);var r=s.extractAndExpand(f.decode(n),void 0,e,112,!0);if(!r||r.length<112)throw new c.MediaEncryptionError("computeKeys:hkdf error");return{iv:r.slice(0,16),cipherKey:r.slice(16,48),macKey:r.slice(48,80),refKey:r.slice(80,112)}},getWebCryptoObject:function(){return new u["default"](function(t,n){var e=window.crypto||window.msCrypto;e?t(e):n("browser doesn\'t support crypto")})},getWebCrypto:function(){return this.getWebCryptoObject().then(function(t){var n=t.subtle||t.webkitSubtle;return n?n:u["default"].reject("browser doesn\'t support crypto.subtle")})}};t.exports=d},function(t,n,e){!function(r,i,o){t.exports=n=i(e(0),e(9),e(66),e(65),e(64))}(this,function(t){return function(){var n=t,e=n.lib,r=e.BlockCipher,i=n.algo,o=[],a=[],u=[],c=[],s=[],f=[],l=[],p=[],h=[],d=[];!function(){for(var t=[],n=0;n<256;n++)n<128?t[n]=n<<1:t[n]=n<<1^283;for(var e=0,r=0,n=0;n<256;n++){var i=r^r<<1^r<<2^r<<3^r<<4;i=i>>>8^255&i^99,o[e]=i,a[i]=e;var v=t[e],m=t[v],g=t[m],y=257*t[i]^16843008*i;u[e]=y<<24|y>>>8,c[e]=y<<16|y>>>16,s[e]=y<<8|y>>>24,f[e]=y;var y=16843009*g^65537*m^257*v^16843008*e;l[i]=y<<24|y>>>8,p[i]=y<<16|y>>>16,h[i]=y<<8|y>>>24,d[i]=y,e?(e=v^t[t[t[g^v]]],r^=t[t[r]]):e=r=1}}();var v=[0,1,2,4,8,16,32,64,128,27,54],m=i.AES=r.extend({_doReset:function(){for(var t=this._key,n=t.words,e=t.sigBytes/4,r=this._nRounds=e+6,i=4*(r+1),a=this._keySchedule=[],u=0;u<i;u++)if(u<e)a[u]=n[u];else{var c=a[u-1];u%e?e>6&&u%e==4&&(c=o[c>>>24]<<24|o[c>>>16&255]<<16|o[c>>>8&255]<<8|o[255&c]):(c=c<<8|c>>>24,c=o[c>>>24]<<24|o[c>>>16&255]<<16|o[c>>>8&255]<<8|o[255&c],c^=v[u/e|0]<<24),a[u]=a[u-e]^c}for(var s=this._invKeySchedule=[],f=0;f<i;f++){var u=i-f;if(f%4)var c=a[u];else var c=a[u-4];f<4||u<=4?s[f]=c:s[f]=l[o[c>>>24]]^p[o[c>>>16&255]]^h[o[c>>>8&255]]^d[o[255&c]]}},encryptBlock:function(t,n){this._doCryptBlock(t,n,this._keySchedule,u,c,s,f,o)},decryptBlock:function(t,n){var e=t[n+1];t[n+1]=t[n+3],t[n+3]=e,this._doCryptBlock(t,n,this._invKeySchedule,l,p,h,d,a);var e=t[n+1];t[n+1]=t[n+3],t[n+3]=e},_doCryptBlock:function(t,n,e,r,i,o,a,u){for(var c=this._nRounds,s=t[n]^e[0],f=t[n+1]^e[1],l=t[n+2]^e[2],p=t[n+3]^e[3],h=4,d=1;d<c;d++){var v=r[s>>>24]^i[f>>>16&255]^o[l>>>8&255]^a[255&p]^e[h++],m=r[f>>>24]^i[l>>>16&255]^o[p>>>8&255]^a[255&s]^e[h++],g=r[l>>>24]^i[p>>>16&255]^o[s>>>8&255]^a[255&f]^e[h++],y=r[p>>>24]^i[s>>>16&255]^o[f>>>8&255]^a[255&l]^e[h++];s=v,f=m,l=g,p=y}var v=(u[s>>>24]<<24|u[f>>>16&255]<<16|u[l>>>8&255]<<8|u[255&p])^e[h++],m=(u[f>>>24]<<24|u[l>>>16&255]<<16|u[p>>>8&255]<<8|u[255&s])^e[h++],g=(u[l>>>24]<<24|u[p>>>16&255]<<16|u[s>>>8&255]<<8|u[255&f])^e[h++],y=(u[p>>>24]<<24|u[s>>>16&255]<<16|u[f>>>8&255]<<8|u[255&l])^e[h++];t[n]=v,t[n+1]=m,t[n+2]=g,t[n+3]=y},keySize:8});n.AES=r._createHelper(m)}(),t.AES})},function(t,n,e){!function(r,i,o){t.exports=n=i(e(0),e(68),e(23))}(this,function(t){return t.HmacSHA256})},function(t,n,e){!function(r,i){t.exports=n=i(e(0))}(this,function(t){return function(){if("function"==typeof ArrayBuffer){var n=t,e=n.lib,r=e.WordArray,i=r.init,o=r.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var n=t.byteLength,e=[],r=0;r<n;r++)e[r>>>2]|=t[r]<<24-r%4*8;i.call(this,e,n)}else i.apply(this,arguments)};o.prototype=r}}(),t.lib.WordArray})},function(t,n,e){"use strict";function r(t,n,e,i){if(o.isArray(t)||o.isString(t)){o.isString(t)&&(t=[t]);for(var a=0;a<t.length;a++)n[t[a]]=i+e}else for(var u in t)r(t[u],n,u,i+e)}function i(t){var n;try{n=t?JSON.parse(t):a}catch(e){return null}var i={};return r(n,i,"",""),i}var o=e(24),a=e(70);t.exports=i},function(t,n,e){"use strict";function r(){return _.chain(u).pickBy(function(t,n){return"document"===t.msgType&&t.canSend}).keys().value().join(",")}var i=e(29),o=e(10),a=e(69),u={"text/plain":{ext:"TXT",msgType:"document",icon:"icon-doc-txt",canSend:!1},"text/rtf":{ext:"RTF",msgType:"document",icon:"icon-doc-doc",canSend:!1,signatureMimetype:"application/rtf"},"application/zip":{ext:"ZIP",msgType:"document"},"application/pdf":{ext:"PDF",msgType:"document",icon:"icon-doc-pdf",canSend:!0,signatureMimetype:"application/pdf",previewType:"pdf"},"application/msword":{ext:"DOC",msgType:"document",icon:"icon-doc-doc",canSend:!1,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.ms-excel":{ext:"XLS",msgType:"document",icon:"icon-doc-xls",canSend:!1,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.ms-powerpoint":{ext:"PPT",msgType:"document",icon:"icon-doc-ppt",canSend:!1,signatureMimetype:"application/x-msi",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{ext:"DOCX",msgType:"document",icon:"icon-doc-doc",canSend:!1,signatureMimetype:"application/zip",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{ext:"PPTX",msgType:"document",icon:"icon-doc-ppt",canSend:!1,signatureMimetype:"application/zip",previewType:"msoffice"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{ext:"XLSX",msgType:"document",icon:"icon-doc-xls",canSend:!1,signatureMimetype:"application/zip",previewType:"msoffice"},"audio/aac":{msgType:"audio"},"audio/mp4":{msgType:"audio"},"audio/amr":{msgType:"audio"},"audio/mpeg":{msgType:"audio"},"audio/ogg; codecs=opus":{msgType:"audio"},"video/mp4":{msgType:"video"},"video/3gpp":{msgType:"video"},"image/jpeg":{msgType:"image"}},c={MIMETYPES:u,DOC_MIMES:r(),EXT_TO_MIME:i(),updateDocMimes:function(t){if("*"===t)c.DOC_MIMES="*";else if(_.isString(t)){var n=t.split(",");for(var e in u){var i=u[e];"document"===i.msgType&&(_.isString(i.ext)&&n.indexOf(i.ext.toLowerCase())>-1?i.canSend=!0:i.canSend=!1)}c.DOC_MIMES=r()}},isAllowedDocumentMimetype:function(t,n){var e=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];for(var r in u){var i=u[r];if("document"===i.msgType){var o=e?i.signatureMimetype:r;if(o===t&&i.canSend&&n&&n.toLowerCase().endsWith(i.ext.toLowerCase()))return r}}return!1},getExtension:function(t){var n=u[t];return n?"."+(n.ext||t.split("/")[1]).toLowerCase():""},previewType:function(t){var n=_.find(u,function(n,e){return n.previewType&&(e===t||n.signatureMimetype===t)});return n?n.previewType:void 0},getMediaMimeType:function(t,n,e){if(e)return e;var r=a(new Uint8Array(n,0,Math.min(262,n.byteLength)));if(r)return r.mime;if("image"===t)return"image/jpeg";throw new o.MediaEncryptionError("unknown mime decrypt error for type:"+t)}};t.exports=c},function(t,n,e){"use strict";function r(t){var n=t.data,e=n.type,r=n.buffer,i=n.mediaKey,a=n.mimetype;postMessage(o.decryptE2EMediaWithCryptoJS(e,r,i,a))}function i(t){var n=t.data,e=n.type,r=n.buffer,i=n.mediaKey;postMessage(o.encryptE2EMediaWithCryptoJS(e,r,i))}self.CryptoJS=e(0),e(28),e(9),e(27),e(26);var o=e(25);self.onmessage=function(t){switch(t.data.command){case"decrypt-e2e-media":r(t);break;case"encrypt-e2e-media":i(t);break;default:throw new Error("unknown crypto worker command: "+t.data.command)}}},function(t,n,e){"use strict";function r(t){return"string"==typeof t?t:CryptoJS.lib.WordArray.create(new Uint8Array(t))}function i(t,n){return c.decode(t.toString(CryptoJS.enc.Base64),!!n)}function o(t){var n=arguments.length<=1||void 0===arguments[1]?new Uint8Array(s):arguments[1],e=arguments[2];\nreturn i(CryptoJS.HmacSHA256(r(t),r(n)),e)}function a(t,n,e,o){if(e<0||e>255*s)return null;var a=r(t),u=r(n),c=Math.ceil(e/s),f=new Array(c+1);f[0]="";for(var l=new Uint8Array(1),p=0;p<c;p++){l[0]=p+1;var h=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,a);h.update(f[p]),h.update(u),h.update(r(l)),f[p+1]=h.finalize()}for(var d=new Uint8Array(e),v=0,m=0;v<c;v++)for(var g=new Uint8Array(i(f[v+1])),y=0;y<s&&m<e;y++,m++)d[m]=g[y];return o?Array.prototype.slice.call(d):d.buffer}function u(t,n,e,r,i){return a(o(t,n),e,r,i)}var c=e(11),s=32;t.exports={extract:o,expand:a,extractAndExpand:u}},function(t,n){"use strict";function e(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0],n=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];t instanceof ArrayBuffer&&(t=new Uint8Array(t)),"number"==typeof t?(this._buffer=new Uint8Array(t),this._readEndIndex=0):t instanceof ArrayBuffer?(this._buffer=new Uint8Array(t),this._readEndIndex=t.byteLength):t instanceof Uint8Array?(this._buffer=t,this._readEndIndex=t.length):(this._buffer=null,this._readEndIndex=0),this._readIndex=0,this._writeIndex=this._readEndIndex,this._view=null,this._littleEndian=!!n,this._hiddenWrites=0}function r(){for(var t=0,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];for(var a=0;a<r.length;a++){var u=r[a];"string"==typeof u?t+=i(u):"number"==typeof u?t++:u instanceof e?t+=u.size():u instanceof ArrayBuffer?t+=u.byteLength:u instanceof Uint8Array&&(t+=u.length)}var c=new e(t);return c.write.apply(c,r),c}function i(t){if(t===m)return g;for(var n=0,e=0;e<t.length;e++){var r=t.charCodeAt(e);r<128?n++:r<2048?n+=2:r<55296||57344<=r&&r<=65535?n+=3:(a(t,e,r),e++,n+=4)}return m=t,g=n}function o(t,n,e){t._hiddenWrites++;var r=t._writeIndex;try{n(t,e),r=t._writeIndex}finally{t._hiddenWrites--,t._writeIndex=r}}function a(t,n,e){if(e<55296||56320<=e)throw new TypeError("Invalid first surrogate at wchar-position "+n+\' in "\'+t+\'"\');if(++n===t.length)throw new TypeError(\'String ends with incomplete surrogate pair in "\'+t+\'"\');var r=t.charCodeAt(n);if(r<56320||57344<=r)throw new TypeError("Invalid second surrogate at wchar-position "+n+\' in "\'+t+\'"\')}function u(t,n,e,r){if("number"!=typeof t||t!==t||Math.floor(t)!==t||t<n||t>=e)throw new TypeError("string"==typeof t?\'WriteError: string "\'+t+\'" is not a valid \'+r:"WriteError: "+t+" is not a valid "+r)}function c(t){return t._view||(t._view=new DataView(t._buffer.buffer,t._buffer.byteOffset))}function s(t,n){if(n<0)throw new Error("ReadError: given negative number of bytes to read");var e=t._readIndex,r=e+n;if(r>t._readEndIndex)throw new Error(e===t._readEndIndex?"ReadError: tried to read from depleted binary":"ReadError: tried to read beyond end of binary");return t._readIndex=r,e}function f(t,n){var e=t._writeIndex,r=e+n,i=t._buffer;if(!i||r>i.length){var o=Math.max(r,i?2*i.length:64),a=new Uint8Array(o);i&&a.set(i),t._buffer=a,t._view=null}return t._writeIndex=r,t._hiddenWrites||(t._readEndIndex=r),e}function l(t,n,e){var r=s(e,8),i=c(e),o=i.getInt32(n?r+4:r,n),a=i.getInt32(n?r:r+4,n);return h(t,o,a)}function p(t,n,e){var r=f(e,8),i=t<0;i&&(t=-t);var o=Math.floor(t/4294967296),a=t-4294967296*o,u=c(e);if(u.setUint32(n?r+4:r,o,n),u.setUint32(n?r:r+4,a,n),i){for(var s=e._buffer,l=r;l<r+8;l++)s[l]=255&~s[l];var p=255;if(n)for(var h=r;h<r+8&&255===p;h++)p=s[h],s[h]=255===p?0:p+1;else for(var d=r+7;d>=r&&255===p;d--)p=s[d],s[d]=255===p?0:p+1}}function h(t,n,r){var i=n>>20,o=0===i||t&&i===-1,a=n>=0?n:t?n:4294967296+n,u=r>=0?r:4294967296+r,c=4294967296*a+u;return o?c:e.onLongLong(c,t,n,r)}var d=65533,v=new Uint8Array(10);e.prototype={size:function(){return this._readEndIndex-this._readIndex},peek:function(t){var n=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1],e=this._readIndex;try{return t(this,n)}finally{this._readIndex=e}},advance:function(t){s(this,t)},readUint8:function(){return this._buffer[s(this,1)]},readInt8:function(){var t=s(this,1);return c(this).getInt8(t)},readUint16:function(){var t=arguments.length<=0||void 0===arguments[0]?this._littleEndian:arguments[0],n=s(this,2);return c(this).getUint16(n,t)},readInt32:function(){var t=arguments.length<=0||void 0===arguments[0]?this._littleEndian:arguments[0],n=s(this,4);return c(this).getInt32(n,t)},readUint32:function(){var t=arguments.length<=0||void 0===arguments[0]?this._littleEndian:arguments[0],n=s(this,4);return c(this).getUint32(n,t)},readInt64:function(){var t=arguments.length<=0||void 0===arguments[0]?this._littleEndian:arguments[0];return l(!0,t,this)},readUint64:function(){var t=arguments.length<=0||void 0===arguments[0]?this._littleEndian:arguments[0];return l(!1,t,this)},readFloat32:function(){var t=arguments.length<=0||void 0===arguments[0]?this._littleEndian:arguments[0],n=s(this,4);return c(this).getFloat32(n,t)},readFloat64:function(){var t=arguments.length<=0||void 0===arguments[0]?this._littleEndian:arguments[0],n=s(this,8);return c(this).getFloat64(n,t)},readVarInt:function(){var t=this._readIndex,n=this._readEndIndex-t,e=this._buffer;n<=0&&s(this,1);var r=void 0,i=e[t];for(r=1;r<n&&r<11&&128&i;r++)i=e[t+r];var o=r;if(o>10||10===o&&e[t+9]>1)throw new Error("ParseError: varint exceeds 64 bits");128&i&&s(this,o+1),s(this,o);var a=0,u=0;for(r=0;r<3&&r<o;r++,u+=7)a|=(127&e[t+r])<<u;if(o<4)return a;var c=0;for(u=0,r=3;r<6&&r<o;r++,u+=7)c|=(127&e[t+r])<<u;if(o<5)return c<<21|a;if(o<7)return 2097152*c+a;var f=0;for(u=0,r=6;r<9&&r<o;r++,u+=7)f|=(127&e[t+r])<<u;10===o&&(f|=(1&e[t+9])<<21);var l=f<<10|c>>11,p=c<<21|a;return h(!0,l,p)},readBuffer:function(){var t=arguments.length<=0||void 0===arguments[0]?this.size():arguments[0];if(0===t)return new ArrayBuffer(0);var n=s(this,t),e=this._buffer,r=n+e.byteOffset,i=e.buffer;return 0===r&&this._readIndex===i.byteLength?i:i.slice(r,r+t)},readByteArray:function(){var t=arguments.length<=0||void 0===arguments[0]?this.size():arguments[0];if(0===t)return new Uint8Array(0);var n=s(this,t);return this._buffer.subarray(n,n+t)},readBinary:function(){var t=arguments.length<=0||void 0===arguments[0]?this.size():arguments[0],n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1];if(0===t)return new e((void 0),n);var r=s(this,t),i=this._buffer.subarray(r,r+t);return new e(i,n)},readString:function(t){for(var n=s(this,t),e=n+t,r=this._buffer,i=[],o=void 0,a=n,u=t;a<e;a++,u--){i.length>5e3&&(o||(o=[]),o.push(String.fromCharCode.apply(String,i)),i=[]);var c=0|r[a];if(0===(128&c))i.push(c);else if(u>=2&&192===(224&c)){var f=0|r[a+1];if(128===(192&f)){var l=(31&c)<<6|63&f;l>=128?(a++,u--,i.push(l)):i.push(d)}else i.push(d)}else if(u>=3&&224===(240&c)){var p=0|r[a+1],h=0|r[a+2];if(128===(192&p)&&128===(192&h)){var v=(15&c)<<12|(63&p)<<6|63&h;v>=2048&&!(55296<=v&&v<57344)?(a+=2,u-=2,i.push(v)):i.push(d)}else i.push(d)}else if(u>=4&&240===(248&c)){var m=0|r[a+1],g=0|r[a+2],y=0|r[a+3];if(128===(192&m)&&128===(192&g)&&128===(192&y)){var _=(7&c)<<18|(63&m)<<12|(63&g)<<6|63&y;if(_>=65536&&_<=1114111){a+=3,u-=3;var x=_-65536;i.push(55296|x>>10,56320|1023&x)}else i.push(d)}else i.push(d)}else i.push(d)}var w=String.fromCharCode.apply(String,i);return o?(o.push(w),o.join("")):w},write:function(){for(var t=0;t<arguments.length;t++){var n=arguments[t];"string"==typeof n?this.writeString(n):"number"==typeof n?this.writeUint8(n):n instanceof e?this.writeBinary(n):n instanceof ArrayBuffer?this.writeBuffer(n):n instanceof Uint8Array&&this.writeByteArray(n)}},writeUint8:function(t){u(t,0,256,"uint8");var n=f(this,1);this._buffer[n]=t},writeInt8:function(t){u(t,-128,128,"signed int8");var n=f(this,1);this._buffer[n]=t},writeUint16:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1];u(t,0,65536,"uint16");var e=f(this,2);c(this).setUint16(e,t,n)},writeInt16:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1];u(t,-32768,32768,"signed int16");var e=f(this,2);c(this).setInt16(e,t,n)},writeUint32:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1];u(t,0,4294967296,"uint32");var e=f(this,4);c(this).setUint32(e,t,n)},writeInt32:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1];u(t,-2147483648,2147483648,"signed int32");var e=f(this,4);c(this).setInt32(e,t,n)},writeUint64:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1];u(t,-0x8000000000000000,0x8000000000000000,"signed int64"),p(t,n,this)},writeInt64:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1];u(t,0,0x10000000000000000,"uint64"),p(t,n,this)},writeFloat32:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1],e=f(this,4);c(this).setFloat32(e,t,n)},writeFloat64:function(t){var n=arguments.length<=1||void 0===arguments[1]?this._littleEndian:arguments[1],e=f(this,8);c(this).setFloat64(e,t,n)},writeVarInt:function(t){u(t,-0x8000000000000000,0x8000000000000000,"varint (signed int64)");var n=t<0;n&&(t=-t);for(var e=t<128&&1||t<16384&&2||t<2097152&&3||t<268435456&&4||t<34359738368&&5||t<4398046511104&&6||t<562949953421312&&7||t<72057594037927940&&8||9,r=f(this,n?10:e),i=this._buffer,o=t,a=r,c=e;c>4;c--){var s=Math.floor(o/128),l=o-128*s;i[a++]=128|127&l,o=s}for(;c>1;c--)i[a++]=128|127&o,o>>=7;if(i[a++]=o,n){for(var p=r;p<a;p++)i[p]=128|127&~i[p];for(var h=a;h<r+9;h++)i[h]=255;i[r+9]=1;for(var d=255,v=r;v<r+9&&255===d;v++)d=i[v],i[v]=255===d?128:d+1}},writeBinary:function(t){var n=t._readIndex,e=t._readEndIndex;if(n!==e){var r=f(this,e-n);this._buffer.set(t._buffer.subarray(n,e),r)}},writeBuffer:function(t){this.writeByteArray(new Uint8Array(t))},writeByteArray:function(t){var n=f(this,t.length);this._buffer.set(t,n)},writeString:function(t){for(var n=f(this,i(t)),e=this._buffer,r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o<128)e[n++]=o;else if(o<2048)e[n++]=192|o>>6,e[n++]=128|63&o;else if(o<55296||57344<=o)e[n++]=224|o>>12,e[n++]=128|o>>6&63,e[n++]=128|63&o;else{var a=65536+((1023&o)<<10|1023&t.charCodeAt(++r));e[n++]=240|a>>18,e[n++]=128|a>>12&63,e[n++]=128|a>>6&63,e[n++]=128|63&a}}},writeBytes:function(){for(var t=0;t<arguments.length;t++)u(arguments[t],0,256,"byte");for(var n=f(this,arguments.length),e=this._buffer,r=0;r<arguments.length;r++)e[n+r]=arguments[r]},writeWithVarIntLength:function(t,n){var e=this._writeIndex;o(this,t,n);var r=this._writeIndex;this.writeVarInt(r-e);for(var i=this._writeIndex-r,a=this._buffer,u=0;u<i;u++)v[u]=a[r+u];for(var c=r-1;c>=e;c--)a[c+i]=a[c];for(var s=0;s<i;s++)a[e+s]=v[s]}},e.onLongLong=function(t){throw new Error("ReadError: integer exceeded 52 bits ("+t+")")},e.build=r;var m="",g=0;e.numUtf8Bytes=i,t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,n){var e=this;this._flags=0,this._value=void 0,this._onFulfilled=void 0,this._onRejected=void 0,this._context=void 0,this._resolveLevel=0,this._control=void 0,this.x=void 0,this._parent=void 0,this._child=void 0,this._children=void 0,this.control=void 0,n&&(this._context=n["this"]),"function"==typeof t&&(this._onFulfilled=t,this._flags|=at,this._flags|=pt,T(t,this._context,function(t){return S(e,0,!0,!1,t)},function(t){return S(e,0,!1,!1,t)}))}function o(t){if(void 0===t)return gt;if(k(t))return t;var n=new i;return S(n,0,!0,!1,t),W(n,ht),n}function a(t){var n=new i;return n._value=t,W(n,ot|ht),nt.push(n),n}function u(t){return new i(function(n,e){function r(t){if(0===--i){for(var e=[],r=0;r<o.length;r++){var a=o[r];e.push(a&&a._flags&vt?a._value:t)}n(e)}return t}var i=t.length;if(0===i)return void n([]);for(var o=new Array(t.length),a=0;a<t.length;a++)o[a]=E(t[a],r,e)})}function c(t,n){this.errors=t||[],this.message=n||this.errors.length+" errors"}function s(t){var n="";if(t._flags&lt){var e=t._onFulfilled||t._onRejected;n=e.call(t._context,Y)}else if(t._control)n=".addRawControl("+t._control.name+", "+t._control.foo+")";else if(t._flags&ct)n=".endWithControls("+(0,H["default"])(t.control)+")";else if(t._flags&ht)n=t._flags&it?"Promise.resolve("+(void 0===t._value?"":t._value)+")":"Promise.reject("+(void 0===t._value?"":t._value)+")";else if(t._flags&pt)switch(t._flags&vt){case ot:n="new Promise("+t._onFulfilled+")";break;case mt:n="new Promise("+t._onFulfilled+")";break;case it:n="new Promise("+t._onFulfilled+")"}else t._onFulfilled&&t._onRejected?n=".then("+t._onFulfilled+", "+t._onRejected+")":t._onFulfilled?n=".then("+t._onFulfilled+")":t._onRejected&&(n=".catch("+t._onRejected+")");return n}function f(t,n){return new i(function(e){var r=b(n);k(r)&&W(r,ut),setTimeout(e,t,r)})}function l(t){this.message=t||"StackPromise timed out"}function p(t,n){var e=void 0;if(arguments.length>2){e=new Array(arguments.length-2);for(var r=2;r<arguments.length;r++)e[r-2]=arguments[r]}return new i(function(r){r(t.apply(n,e))})}function h(t,n,e,r){this.name=t,this.foo=n,this.lightning=!!e,this.canRunMultipleTimes=!!r}function d(t,n){function e(){for(var e=void 0,r=t._parent;r&&!(r._flags&vt)&&!(r._flags&ct);r=r._parent)!r._control||r._control.name!==n||r._flags&at||(e=r);if(!e)return i.NO_ACTIVE_CONTROL;e._control.canRunMultipleTimes||W(e,at);var o=void 0;if(arguments.length>0){o=new Array(arguments.length);for(var a=0;a<arguments.length;a++)o[a]=arguments[a]}return e._control.foo.call(e._context,function(t){return A(e,e._resolveLevel,!0,!1,t)},function(t){return A(e,e._resolveLevel,!1,!1,t)},e._parent,o)}return e}function v(t){this.message=t,this.stack=new Error(t||this.name).stack}function m(t,n,e,r){n(new v(r&&r[0]))}function g(){0===J&&(V.length||nt.length)&&(J=1,_t||(_t=y()),_t())}function y(){var t=void 0,n=void 0;return"undefined"==typeof MutationObserver||window&&window.navigator&&window.navigator.standalone?"function"==typeof L["default"]?function(){(0,L["default"])(R)}:function(){setTimeout(R,0)}:(t=document.createElement("div"),n=new MutationObserver(R),n.observe(t,{attributes:!0}),function(){t.setAttribute("tick",1&K)})}function _(t){return t===Y?".tap()":X}function x(t,n){W(t,ut),n._parent=t,t._children?t._children.push(n):t._child?(t._children=[t._child,n],t._child=void 0):t._child=n}function w(t){if(t&&("object"==typeof t||"function"==typeof t)){var n=void 0;try{n=t.then}catch(e){return tt=e,Q}if("function"==typeof n)return n}}function b(t){if(!t||k(t))return t;var n=w(t);return n===Q?a(tt):n?new i(function(e,r){n.call(t,e,r)}):t}function k(t){return t instanceof i}function E(t,n,e){t=b(t);var r=k(t),i=void 0,u=void 0,c=!1,s=void 0;if(r){if(!(t._flags&vt))return W(t.then(n,e),st);W(t,ut),c=!!(t._flags&ft),s=t._context,i=t._flags&it?n:e,u=t._value}else i=n,u=t;if(!i)return o(t).then();u=D(i,s,u,!0);var f=void 0;if(u===Q)f=a(tt);else{if(u===Z)return o(t).then(n,e);if(u===X)return r?t.then():o(t);f=o(u)}return c&&(f=f.cancellable()),void 0!==s&&(f=f.bind(s)),f}function S(t,n,e,r,i){if(n===t._resolveLevel){var o=++t._resolveLevel;if(W(t,at),!e)return void I(t,!1,r,i);if(i===t)t._parent=void 0,I(t,!1,r,new TypeError("promise resolved to itself"));else if(k(i)){var a=i._flags&vt;a===mt?x(i,t):(t._parent=i,W(t,dt),W(i,ut),I(t,a===it,r,i._value))}else{var u=w(i);u===Q?(t._parent=void 0,I(t,!1,r,tt)):u?(t._parent=void 0,T(u,i,function(n){return S(t,o,!0,!1,n)},function(n){return S(t,o,!1,!1,n)})):I(t,!0,r,i)}}}function A(t,n,e,r,i){n===t._resolveLevel&&(j(t),S(t,n,e,r,i))}function j(t){if(t._parent){var n=t._parent;if(t._parent=void 0,n._child===t)n._child=void 0;else if(n._children){for(var e=n._children,r=0;r<e.length;r++)if(e[r]===t){e.splice(r,1);break}0===e.length&&(n._children=void 0)}}}function z(t){if(null===t||void 0===t)throw new Error("Invalid .catch guard "+t);if("function"==typeof t)return t;if("object"==typeof t)throw new Error("Object guards in .catch are currently unsupported");return function(n){return n===t}}function C(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r===Error||r.prototype instanceof Error){if(n instanceof r)return!0}else if(r(n))return!0}return!1}function M(t,n){function e(e,r){return e===Y?".catch(..., "+n+")":t&&!C(t,e)?X:r?Z:n.call(this,e)}return e}function I(t,n,e,r){if(W(t,at|(n?it:ot)),t._value=r,t._child)B(t._child,n,e,r,t),t._child=void 0;else if(t._children){var i=t._children;t._children=void 0;for(var o=0;o<i.length;o++)B(i[o],n,e,r,t)}else n||t._flags&ut||nt.push(t)}function B(t,n,e,r,i){t._resolveLevel++;var o=U(t,n);if(o&&t._flags&st){W(t,at);var a=D(o,t._context,r,!0);if(a!==Z)return void(a===Q?(t._parent=void 0,I(t,!1,e,tt)):a===X?I(t,n,e,r):(t._parent=void 0,S(t,t._resolveLevel,!0,e,a)));t._flags&=~at}o?((e?G:V).push(t),g()):I(t,n,e,r)}function O(t,n){for(;0!==t.length;)n.push(t.pop())}function R(){for(;0!==$.length||0!==V.length;){0===$.length&&O(V,$);var t=$.pop(),n=t._parent,e=!!(n&&n._flags&it),r=n&&n._value,o=U(t,e);if(W(t,at),o){var a=void 0;do a=D(o,t._context,r,!1);while(a===Z);a===Q?(r=tt,e=!1,t._parent=void 0):a!==X&&(r=a,e=!0,t._parent=void 0)}t._flags&vt||(S(t,t._resolveLevel,e,!0,r),O(G,$))}for(J--,K++;0!==nt.length;){var u=nt.pop();u._flags&ut||rt.push(u)}for(;0!==et.length;){var c=et.pop();c._flags&ut||i.onPossiblyUnhandledRejection(c._value,c)}var s=et;et=rt,rt=s}function T(t,n,e,r){try{t.call(n,e,r)}catch(i){r(i)}}function U(t,n){if(!(t._flags&at))return n?t._onFulfilled:t._onRejected}function D(t,n,e,r){try{return r?t.call(n,e,!0):t.call(n,e)}catch(i){return tt=i,Q}}function W(t,n){return t._flags|=n,t}var F=e(37),L=r(F),P=e(12),q=r(P),N=e(36),H=r(N),K=0,J=0,$=[],V=[],G=[],X={sentinel:"CONTINUE_AS_IF_NO_HANDLER"},Z={sentinel:"RETRY_ASYNCHRONOUSLY"},Y={sentinel:"TO_STRING"},Q={sentinel:"DID_ERROR"},tt=null,nt=[],et=[],rt=[],it=1,ot=2,at=4,ut=8,ct=16,st=32,ft=64,lt=128,pt=256,ht=512,dt=1024,vt=it|ot,mt=0,gt=void 0;i.resolve=o,i.reject=a,i.prototype.then=function(t,n){"function"!=typeof t&&(t=void 0),"function"!=typeof n&&(n=void 0);var e=new i;e._onFulfilled=t,e._onRejected=n,e._context=this._context,this._flags&ft&&W(e,ft);var r=this._flags&vt;return r===mt?x(this,e):(W(this,ut),(r===it?t:n)?(e._parent=this,V.push(e),g()):(e._parent=this,W(e,r),e._value=this._value,r===ot&&nt.push(e))),e},i.prototype["catch"]=function(t){var n=arguments.length-1;if(0===n)return this.then(void 0,t);for(var e=new Array(n),r=0;r<n;r++)e[r]=z(arguments[r]);var i=M(e,arguments[n]),o=E(this,void 0,i);return o._onRejected&&W(o,lt),o},i.prototype.bind=function(t){var n=this.then();return n._context=t,n},i.prototype.end=function(t){var n=this.then();if(W(n,ct),n.control={},n._context=void 0,t){var e=t.controls;if(e)for(var r=0;r<e.length;r++){var i=e[r];n.control[i]=d(n,i)}return n}},i.prototype.endWithControls=function(){var t=this.then();W(t,ct),t.control={},t._context=void 0;for(var n=0;n<arguments.length;n++){var e=arguments[n];t.control[e]=d(t,e)}return t},i.all=u,i.any=function(t){return new i(function(n,e){function r(t){if(0===--i){for(var n=[],r=0;r<o.length;r++){var a=o[r];n.push(a&&a._flags&vt?a._value:t)}e(new c(n))}return t}var i=t.length;0===i&&e(new c([],"StackPromise.any called with []"));for(var o=new Array(t.length),a=0;a<t.length;a++)o[a]=E(t[a],n,r)})},i.props=function(t){function n(t){for(var n={},r=0;r<t.length;r++)n[e[r]]=t[r];return n}var e=(0,H["default"])(t),r=i.all(e.map(function(n){return t[n]}));switch(r._flags&vt){case ot:return r;case mt:return W(r.then(n),st);case it:return r._value=n(r._value),r}},i.map=function(t,n){function e(t){return function(e){return r&&n(e,t)}}var r=!0,i=u(t.map(function(t,n){return o(t).then(e(n))}));switch(i._flags&vt){case ot:r=!1;break;case mt:i=i["catch"](function(){return r=!1,X}),W(i,st);break;case it:}return i},i.reduce=function(t,n,e){return o(t).reduce(n,e)},i.prototype.reduce=function(t,n){return n=b(n),E(this,function(e,r){function i(){for(var e=o.length;;){var r=s,a=o[r];if(k(a))switch(a._flags&vt){case ot:return a;case mt:return a.then(i);case it:a=a._value}if(k(n))switch(n._flags&vt){case ot:return n;case mt:return n.then(i);case it:n=n._value}var u=t.call(c,n,a,r,e);if(++s===e)return u;if(u=b(u),k(u))switch(u._flags&vt){case ot:return u;case mt:return n=u,u.then(i);case it:W(u,ut),n=u._value}else n=u}}if(0===e.length)return n;if(r)return Z;for(var o=new Array(e.length),a=0;a<e.length;a++){var u=o[a]=b(e[a]);k(u)&&W(u,ut)}var c=this,s=0;return i()})},i.each=function(t,n){return o(t).each(n)},i.prototype.each=function(t){function n(n,r,i,o){return e.push(r),t.call(this,r,i,o)}var e=[];return this.reduce(n)["return"](e)},i.mapSeries=function(t,n){return o(t).mapSeries(n)},i.prototype.mapSeries=function(t){function n(n,e,r,i){var o=b(t.call(this,e,r,i));return k(o)?o.then(function(t){return n.push(t),n}):(n.push(o),n)}return this.reduce(n,[])},i.race=function(t){var n=b(t);if(k(n)){var e=n.then(function(t){return i.race(t)});return e._context=void 0,e._flags&=~ft,e}return new i(function(t,e){for(var r=0;r<n.length;r++){var i=b(n[r]);if(!k(i)||i._flags&vt)for(t(i),r++;r<n.length;r++){var o=n[r];k(o)&&W(o,ut)}else i.then(t,e)}})},c.prototype=(0,q["default"])(Error.prototype,{name:{value:"AggregateError"}}),i.AggregateError=c,i.onPossiblyUnhandledRejection=function(t,n){console.error("StackPromise did not catch "+t,n,t)},i.prototype.toString=function(){for(var t=[],n=void 0,e=this,r=!1;e;e=e._parent){n=e,!r&&e._flags&vt&&(r=!0,e._flags&ht||(e._flags&it?t.push("[resolved value: "+e._value+"]"):t.push("[rejected reason: "+e._value+"]")));var i=s(e);e._flags&dt&&(i="~"+i),t.push(i)}return t.reverse(),n._flags&(ht|pt)||(t[0]="[Promise]"+t[0]),t.join("\\n")},i.delay=f,i.prototype.delay=function(t){return this.then(function(n){return f(t,n)})},i.prototype.timeout=function(t,n){function e(e){return e===Y?".timeout("+t+", "+n+")":(clearTimeout(r),X)}if((this._flags&vt)!==mt)return this.then();var r=void 0,i=this.then(e,e);return W(i,st|lt),r=setTimeout(function(t,n){if(!(t._flags&vt)){var e=n instanceof Error?n:new l(n);A(t,0,!1,!1,e)}},t,i,n),i},l.prototype=(0,q["default"])(Error.prototype,{name:{value:"TimeoutError"}}),i.TimeoutError=l,i.prototype.isFulfilled=function(){return!!(this._flags&it)},i.prototype.isRejected=function(){return!!(this._flags&ot)},i.prototype.isPending=function(){return!(this._flags&vt)},i.prototype.value=function(){if(this._flags&it)return this._value;throw new Error(this._flags&ot?"value() called on StackPromise that was rejected":"value() called on StackPromise that is pending")},i.prototype.reason=function(){if(this._flags&ot)return this._value;throw new Error(this._flags&it?"reason() called on StackPromise that was fulfilled, not rejected":"reason() called on StackPromise that is pending")},i.callSynchronously=p,i.wrap=function(t){return function(){var n=this,e=void 0;if(arguments.length>0){e=new Array(arguments.length);for(var r=0;r<arguments.length;r++)e[r]=arguments[r]}var i=void 0,a=function(r){if(r===Y)return".wrap("+t+").apply("+n+", ["+e+"])";var o=t.apply(n,e);return k(o)&&o._flags&ut&&W(i,ut),o};return i=o().then(a),W(i,lt),i}},i.wrapSync=function(t){return function(){try{return o(t.apply(this,arguments))}catch(n){return a(n)}}},i.loop=function(t,n){return o(n).loop(t)},i.prototype.loop=function(t){var n=E(this.then(function(e){function r(e){return p(t,i,a,e,o++).then(function(t){if(!(n._flags&vt))return r(t)})}var i=this,o=0,a=function(t){return A(n,0,!0,!1,t)};return r(e)}),function(n){return n===Y?".loop("+t+")":X});return W(n,lt),n},i.prototype.checkpoint=function(t){return t=o(t),this.then(function(n){return t._flags&ot?t:n})},i.prototype["finally"]=function(t){function n(n){return n===Y?".finally("+t+")":(t.call(this,n),X)}return W(this.then(n,n),lt)},i.prototype.get=function(t){var n=this.then(function(n){return n===Y?".get(\'"+t+"\')":n[t]});return W(n,lt),n},i.prototype.tap=function(t){function n(n){return n===Y?".tap("+t+")":(t.call(this,n),X)}return"function"!=typeof t?W(this.then(_),lt):W(this.then(n),lt)},i.prototype.spread=function(t){var n=this.then(function(n){return n===Y?".spread("+t+")":t.apply(this,n)});return W(n,lt),n},i.prototype["return"]=function(t){switch(this._flags&vt){case ot:return this.then();case mt:case it:t=b(t),k(t)&&W(t,ut);var n=E(this,function(n){return n===Y?".return("+t+")":t});return W(n,lt),n}},i.prototype["throw"]=function(t){return this["return"](a(t))},i.Control=h,i.NO_ACTIVE_CONTROL=new Error("No active control was found."),i.prototype.addControl=function(t){if(!(t instanceof h))throw new Error("addControl must be given Control, but got "+t);var n=this.then(t.lightning?void 0:_);return n._control=t,n},i.prototype.addRawControl=function(t,n,e,r){return this.addControl(new h(t,n,e,r))},i.prototype.addResolveControl=function(t,n,e,r){function i(t,e,r,i){try{t(n.apply(this,i))}catch(o){e(o)}}return this.addControl(new h(t,i,e,r))},i.prototype.addRejectControl=function(t,n,e,r){function i(t,e,r,i){try{e(n.apply(this,i))}catch(o){e(o)}}return this.addControl(new h(t,i,e,r))},v.prototype=(0,q["default"])(Error.prototype,{name:{value:"CancellationError"}}),i.CancellationError=v;var yt=new h("cancel",m,(!1),(!1));i.prototype.addCancelControl=function(){return W(this.addControl(yt),ft)},i.sit=function(t,n){var e=new i;return e._control=new h(t,function(t,e,r,i){t(n?n.apply(void 0,i):i&&i[0])}),e},i.prototype.cancellable=function(){return W(this.then(),ft)},i.prototype.uncancellable=function(){var t=this.then();return t._flags&=~ft,t},i.prototype.cancel=function(t){for(var n=void 0,e=this;e&&!(e._flags&vt);e=e._parent)e._flags&ft&&(n=e);if(n)if(void 0===t&&(t=new v),U(n,!1)){var r=new i;j(n),x(r,n),A(r,0,!1,!1,t)}else A(n,n._resolveLevel,!1,!1,t)};var _t=void 0;gt=new i,S(gt,0,!0,!1,void 0),t.exports=i},function(t,n,e){t.exports={"default":e(38),__esModule:!0}},function(t,n,e){t.exports={"default":e(40),__esModule:!0}},function(t,n,e){t.exports={"default":e(41),__esModule:!0}},function(t,n,e){var r=e(1),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},function(t,n,e){e(61);var r=e(1).Object;t.exports=function(t,n){return r.create(t,n)}},function(t,n,e){e(62),t.exports=e(1).Object.keys},function(t,n,e){e(63),t.exports=e(1).setImmediate},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,e){var r=e(22),i=e(57),o=e(56);t.exports=function(t){return function(n,e,a){var u,c=r(n),s=i(c.length),f=o(a,s);if(t&&e!=e){for(;s>f;)if(u=c[f++],u!=u)return!0}else for(;s>f;f++)if((t||f in c)&&c[f]===e)return t||f||0;return!t&&-1}}},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(18),i=e(53);t.exports=e(3)?function(t,n,e){return r.f(t,n,i(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){t.exports=!e(3)&&!e(7)(function(){return 7!=Object.defineProperty(e(5)("div"),"a",{get:function(){return 7}}).a})},function(t,n){t.exports=function(t,n,e){var r=void 0===e;switch(n.length){case 0:return r?t():t.call(e);case 1:return r?t(n[0]):t.call(e,n[0]);case 2:return r?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return r?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return r?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3])}return t.apply(e,n)}},function(t,n,e){var r=e(13);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(4),i=e(50),o=e(16),a=e(20)("IE_PROTO"),u=function(){},c="prototype",s=function(){var t,n=e(5)("iframe"),r=o.length,i="<",a=">";for(n.style.display="none",e(17).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),s=t.F;r--;)delete s[c][o[r]];return s()};t.exports=Object.create||function(t,n){var e;return null!==t?(u[c]=r(t),e=new u,u[c]=null,e[a]=t):e=s(),void 0===n?e:i(e,n)}},function(t,n,e){var r=e(18),i=e(4),o=e(19);t.exports=e(3)?Object.defineProperties:function(t,n){i(t);for(var e,a=o(n),u=a.length,c=0;u>c;)r.f(t,e=a[c++],n[e]);return t}},function(t,n,e){var r=e(44),i=e(22),o=e(43)(!1),a=e(20)("IE_PROTO");t.exports=function(t,n){var e,u=i(t),c=0,s=[];for(e in u)e!=a&&r(u,e)&&s.push(e);for(;n.length>c;)r(u,e=n[c++])&&(~o(s,e)||s.push(e));return s}},function(t,n,e){var r=e(6),i=e(1),o=e(7);t.exports=function(t,n){var e=(i.Object||{})[t]||Object[t],a={};a[t]=n(e),r(r.S+r.F*o(function(){e(1)}),"Object",a)}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n,e){var r=e(2),i="__core-js_shared__",o=r[i]||(r[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,e){var r,i,o,a=e(14),u=e(47),c=e(17),s=e(5),f=e(2),l=f.process,p=f.setImmediate,h=f.clearImmediate,d=f.MessageChannel,v=0,m={},g="onreadystatechange",y=function(){var t=+this;if(m.hasOwnProperty(t)){var n=m[t];delete m[t],n()}},_=function(t){y.call(t.data)};p&&h||(p=function(t){for(var n=[],e=1;arguments.length>e;)n.push(arguments[e++]);return m[++v]=function(){u("function"==typeof t?t:Function(t),n)},r(v),v},h=function(t){delete m[t]},"process"==e(13)(l)?r=function(t){l.nextTick(a(y,t,1))}:d?(i=new d,o=i.port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(r=function(t){f.postMessage(t+"","*")},f.addEventListener("message",_,!1)):r=g in s("script")?function(t){c.appendChild(s("script"))[g]=function(){c.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:p,clear:h}},function(t,n,e){var r=e(21),i=Math.max,o=Math.min;t.exports=function(t,n){return t=r(t),t<0?i(t+n,0):o(t,n)}},function(t,n,e){var r=e(21),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){var r=e(8);t.exports=function(t,n){if(!r(t))return t;var e,i;if(n&&"function"==typeof(e=t.toString)&&!r(i=e.call(t)))return i;if("function"==typeof(e=t.valueOf)&&!r(i=e.call(t)))return i;if(!n&&"function"==typeof(e=t.toString)&&!r(i=e.call(t)))return i;throw TypeError("Can\'t convert object to primitive value")}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n,e){var r=e(6);r(r.S,"Object",{create:e(49)})},function(t,n,e){var r=e(58),i=e(19);e(52)("keys",function(){return function(t){return i(r(t))}})},function(t,n,e){var r=e(6),i=e(55);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,e){!function(r,i){t.exports=n=i(e(0))}(this,function(t){t.lib.Cipher||function(n){var e=t,r=e.lib,i=r.Base,o=r.WordArray,a=r.BufferedBlockAlgorithm,u=e.enc,c=(u.Utf8,u.Base64),s=e.algo,f=s.EvpKDF,l=r.Cipher=a.extend({cfg:i.extend(),createEncryptor:function(t,n){return this.create(this._ENC_XFORM_MODE,t,n)},createDecryptor:function(t,n){return this.create(this._DEC_XFORM_MODE,t,n)},init:function(t,n,e){this.cfg=this.cfg.extend(e),this._xformMode=t,this._key=n,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){t&&this._append(t);var n=this._doFinalize();return n},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?k:x}return function(n){return{encrypt:function(e,r,i){return t(r).encrypt(n,e,r,i)},decrypt:function(e,r,i){return t(r).decrypt(n,e,r,i)}}}}()}),p=(r.StreamCipher=l.extend({_doFinalize:function(){var t=this._process(!0);return t},blockSize:1}),e.mode={}),h=r.BlockCipherMode=i.extend({createEncryptor:function(t,n){return this.Encryptor.create(t,n)},createDecryptor:function(t,n){return this.Decryptor.create(t,n)},init:function(t,n){this._cipher=t,this._iv=n}}),d=p.CBC=function(){function t(t,e,r){var i=this._iv;if(i){var o=i;this._iv=n}else var o=this._prevBlock;for(var a=0;a<r;a++)t[e+a]^=o[a]}var e=h.extend();return e.Encryptor=e.extend({processBlock:function(n,e){var r=this._cipher,i=r.blockSize;t.call(this,n,e,i),r.encryptBlock(n,e),this._prevBlock=n.slice(e,e+i)}}),e.Decryptor=e.extend({processBlock:function(n,e){var r=this._cipher,i=r.blockSize,o=n.slice(e,e+i);\nr.decryptBlock(n,e),t.call(this,n,e,i),this._prevBlock=o}}),e}(),v=e.pad={},m=v.Pkcs7={pad:function(t,n){for(var e=4*n,r=e-t.sigBytes%e,i=r<<24|r<<16|r<<8|r,a=[],u=0;u<r;u+=4)a.push(i);var c=o.create(a,r);t.concat(c)},unpad:function(t){var n=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=n}},g=(r.BlockCipher=l.extend({cfg:l.cfg.extend({mode:d,padding:m}),reset:function(){l.reset.call(this);var t=this.cfg,n=t.iv,e=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=e.createEncryptor;else{var r=e.createDecryptor;this._minBufferSize=1}this._mode=r.call(e,this,n&&n.words)},_doProcessBlock:function(t,n){this._mode.processBlock(t,n)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var n=this._process(!0)}else{var n=this._process(!0);t.unpad(n)}return n},blockSize:4}),r.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}})),y=e.format={},_=y.OpenSSL={stringify:function(t){var n=t.ciphertext,e=t.salt;if(e)var r=o.create([1398893684,1701076831]).concat(e).concat(n);else var r=n;return r.toString(c)},parse:function(t){var n=c.parse(t),e=n.words;if(1398893684==e[0]&&1701076831==e[1]){var r=o.create(e.slice(2,4));e.splice(0,4),n.sigBytes-=16}return g.create({ciphertext:n,salt:r})}},x=r.SerializableCipher=i.extend({cfg:i.extend({format:_}),encrypt:function(t,n,e,r){r=this.cfg.extend(r);var i=t.createEncryptor(e,r),o=i.finalize(n),a=i.cfg;return g.create({ciphertext:o,key:e,iv:a.iv,algorithm:t,mode:a.mode,padding:a.padding,blockSize:t.blockSize,formatter:r.format})},decrypt:function(t,n,e,r){r=this.cfg.extend(r),n=this._parse(n,r.format);var i=t.createDecryptor(e,r).finalize(n.ciphertext);return i},_parse:function(t,n){return"string"==typeof t?n.parse(t,this):t}}),w=e.kdf={},b=w.OpenSSL={execute:function(t,n,e,r){r||(r=o.random(8));var i=f.create({keySize:n+e}).compute(t,r),a=o.create(i.words.slice(n),4*e);return i.sigBytes=4*n,g.create({key:i,iv:a,salt:r})}},k=r.PasswordBasedCipher=x.extend({cfg:x.cfg.extend({kdf:b}),encrypt:function(t,n,e,r){r=this.cfg.extend(r);var i=r.kdf.execute(e,t.keySize,t.ivSize);r.iv=i.iv;var o=x.encrypt.call(this,t,n,i.key,r);return o.mixIn(i),o},decrypt:function(t,n,e,r){r=this.cfg.extend(r),n=this._parse(n,r.format);var i=r.kdf.execute(e,t.keySize,t.ivSize,n.salt);r.iv=i.iv;var o=x.decrypt.call(this,t,n,i.key,r);return o}})}()})},function(t,n,e){!function(r,i,o){t.exports=n=i(e(0),e(67),e(23))}(this,function(t){return function(){var n=t,e=n.lib,r=e.Base,i=e.WordArray,o=n.algo,a=o.MD5,u=o.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:a,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,n){for(var e=this.cfg,r=e.hasher.create(),o=i.create(),a=o.words,u=e.keySize,c=e.iterations;a.length<u;){s&&r.update(s);var s=r.update(t).finalize(n);r.reset();for(var f=1;f<c;f++)s=r.finalize(s),r.reset();o.concat(s)}return o.sigBytes=4*u,o}});n.EvpKDF=function(t,n,e){return u.create(e).compute(t,n)}}(),t.EvpKDF})},function(t,n,e){!function(r,i){t.exports=n=i(e(0))}(this,function(t){return function(n){function e(t,n,e,r,i,o,a){var u=t+(n&e|~n&r)+i+a;return(u<<o|u>>>32-o)+n}function r(t,n,e,r,i,o,a){var u=t+(n&r|e&~r)+i+a;return(u<<o|u>>>32-o)+n}function i(t,n,e,r,i,o,a){var u=t+(n^e^r)+i+a;return(u<<o|u>>>32-o)+n}function o(t,n,e,r,i,o,a){var u=t+(e^(n|~r))+i+a;return(u<<o|u>>>32-o)+n}var a=t,u=a.lib,c=u.WordArray,s=u.Hasher,f=a.algo,l=[];!function(){for(var t=0;t<64;t++)l[t]=4294967296*n.abs(n.sin(t+1))|0}();var p=f.MD5=s.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,n){for(var a=0;a<16;a++){var u=n+a,c=t[u];t[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var s=this._hash.words,f=t[n+0],p=t[n+1],h=t[n+2],d=t[n+3],v=t[n+4],m=t[n+5],g=t[n+6],y=t[n+7],_=t[n+8],x=t[n+9],w=t[n+10],b=t[n+11],k=t[n+12],E=t[n+13],S=t[n+14],A=t[n+15],j=s[0],z=s[1],C=s[2],M=s[3];j=e(j,z,C,M,f,7,l[0]),M=e(M,j,z,C,p,12,l[1]),C=e(C,M,j,z,h,17,l[2]),z=e(z,C,M,j,d,22,l[3]),j=e(j,z,C,M,v,7,l[4]),M=e(M,j,z,C,m,12,l[5]),C=e(C,M,j,z,g,17,l[6]),z=e(z,C,M,j,y,22,l[7]),j=e(j,z,C,M,_,7,l[8]),M=e(M,j,z,C,x,12,l[9]),C=e(C,M,j,z,w,17,l[10]),z=e(z,C,M,j,b,22,l[11]),j=e(j,z,C,M,k,7,l[12]),M=e(M,j,z,C,E,12,l[13]),C=e(C,M,j,z,S,17,l[14]),z=e(z,C,M,j,A,22,l[15]),j=r(j,z,C,M,p,5,l[16]),M=r(M,j,z,C,g,9,l[17]),C=r(C,M,j,z,b,14,l[18]),z=r(z,C,M,j,f,20,l[19]),j=r(j,z,C,M,m,5,l[20]),M=r(M,j,z,C,w,9,l[21]),C=r(C,M,j,z,A,14,l[22]),z=r(z,C,M,j,v,20,l[23]),j=r(j,z,C,M,x,5,l[24]),M=r(M,j,z,C,S,9,l[25]),C=r(C,M,j,z,d,14,l[26]),z=r(z,C,M,j,_,20,l[27]),j=r(j,z,C,M,E,5,l[28]),M=r(M,j,z,C,h,9,l[29]),C=r(C,M,j,z,y,14,l[30]),z=r(z,C,M,j,k,20,l[31]),j=i(j,z,C,M,m,4,l[32]),M=i(M,j,z,C,_,11,l[33]),C=i(C,M,j,z,b,16,l[34]),z=i(z,C,M,j,S,23,l[35]),j=i(j,z,C,M,p,4,l[36]),M=i(M,j,z,C,v,11,l[37]),C=i(C,M,j,z,y,16,l[38]),z=i(z,C,M,j,w,23,l[39]),j=i(j,z,C,M,E,4,l[40]),M=i(M,j,z,C,f,11,l[41]),C=i(C,M,j,z,d,16,l[42]),z=i(z,C,M,j,g,23,l[43]),j=i(j,z,C,M,x,4,l[44]),M=i(M,j,z,C,k,11,l[45]),C=i(C,M,j,z,A,16,l[46]),z=i(z,C,M,j,h,23,l[47]),j=o(j,z,C,M,f,6,l[48]),M=o(M,j,z,C,y,10,l[49]),C=o(C,M,j,z,S,15,l[50]),z=o(z,C,M,j,m,21,l[51]),j=o(j,z,C,M,k,6,l[52]),M=o(M,j,z,C,d,10,l[53]),C=o(C,M,j,z,w,15,l[54]),z=o(z,C,M,j,p,21,l[55]),j=o(j,z,C,M,_,6,l[56]),M=o(M,j,z,C,A,10,l[57]),C=o(C,M,j,z,g,15,l[58]),z=o(z,C,M,j,E,21,l[59]),j=o(j,z,C,M,v,6,l[60]),M=o(M,j,z,C,b,10,l[61]),C=o(C,M,j,z,h,15,l[62]),z=o(z,C,M,j,x,21,l[63]),s[0]=s[0]+j|0,s[1]=s[1]+z|0,s[2]=s[2]+C|0,s[3]=s[3]+M|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;e[i>>>5]|=128<<24-i%32;var o=n.floor(r/4294967296),a=r;e[(i+64>>>9<<4)+15]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e[(i+64>>>9<<4)+14]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(e.length+1),this._process();for(var u=this._hash,c=u.words,s=0;s<4;s++){var f=c[s];c[s]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}return u},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}});a.MD5=s._createHelper(p),a.HmacMD5=s._createHmacHelper(p)}(Math),t.MD5})},function(t,n,e){!function(r,i){t.exports=n=i(e(0))}(this,function(t){return function(){var n=t,e=n.lib,r=e.WordArray,i=e.Hasher,o=n.algo,a=[],u=o.SHA1=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,n){for(var e=this._hash.words,r=e[0],i=e[1],o=e[2],u=e[3],c=e[4],s=0;s<80;s++){if(s<16)a[s]=0|t[n+s];else{var f=a[s-3]^a[s-8]^a[s-14]^a[s-16];a[s]=f<<1|f>>>31}var l=(r<<5|r>>>27)+c+a[s];l+=s<20?(i&o|~i&u)+1518500249:s<40?(i^o^u)+1859775393:s<60?(i&o|i&u|o&u)-1894007588:(i^o^u)-899497514,c=u,u=o,o=i<<30|i>>>2,i=r,r=l}e[0]=e[0]+r|0,e[1]=e[1]+i|0,e[2]=e[2]+o|0,e[3]=e[3]+u|0,e[4]=e[4]+c|0},_doFinalize:function(){var t=this._data,n=t.words,e=8*this._nDataBytes,r=8*t.sigBytes;return n[r>>>5]|=128<<24-r%32,n[(r+64>>>9<<4)+14]=Math.floor(e/4294967296),n[(r+64>>>9<<4)+15]=e,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});n.SHA1=i._createHelper(u),n.HmacSHA1=i._createHmacHelper(u)}(),t.SHA1})},function(t,n,e){!function(r,i){t.exports=n=i(e(0))}(this,function(t){return function(n){var e=t,r=e.lib,i=r.WordArray,o=r.Hasher,a=e.algo,u=[],c=[];!function(){function t(t){for(var e=n.sqrt(t),r=2;r<=e;r++)if(!(t%r))return!1;return!0}function e(t){return 4294967296*(t-(0|t))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(u[i]=e(n.pow(r,.5))),c[i]=e(n.pow(r,1/3)),i++),r++}();var s=[],f=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(u.slice(0))},_doProcessBlock:function(t,n){for(var e=this._hash.words,r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],f=e[5],l=e[6],p=e[7],h=0;h<64;h++){if(h<16)s[h]=0|t[n+h];else{var d=s[h-15],v=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,m=s[h-2],g=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;s[h]=v+s[h-7]+g+s[h-16]}var y=u&f^~u&l,_=r&i^r&o^i&o,x=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),w=(u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25),b=p+w+y+c[h]+s[h],k=x+_;p=l,l=f,f=u,u=a+b|0,a=o,o=i,i=r,r=b+k|0}e[0]=e[0]+r|0,e[1]=e[1]+i|0,e[2]=e[2]+o|0,e[3]=e[3]+a|0,e[4]=e[4]+u|0,e[5]=e[5]+f|0,e[6]=e[6]+l|0,e[7]=e[7]+p|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[(i+64>>>9<<4)+14]=n.floor(r/4294967296),e[(i+64>>>9<<4)+15]=r,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=o._createHelper(f),e.HmacSHA256=o._createHmacHelper(f)}(Math),t.SHA256})},function(t,n){"use strict";t.exports=function(t){return t&&t.length>1?255===t[0]&&216===t[1]&&255===t[2]?{ext:"jpg",mime:"image/jpeg"}:137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?{ext:"png",mime:"image/png"}:71===t[0]&&73===t[1]&&70===t[2]?{ext:"gif",mime:"image/gif"}:87===t[8]&&69===t[9]&&66===t[10]&&80===t[11]?{ext:"webp",mime:"image/webp"}:(73===t[0]&&73===t[1]&&42===t[2]&&0===t[3]||77===t[0]&&77===t[1]&&0===t[2]&&42===t[3])&&67===t[8]&&82===t[9]?{ext:"cr2",mime:"image/x-canon-cr2"}:73===t[0]&&73===t[1]&&42===t[2]&&0===t[3]||77===t[0]&&77===t[1]&&0===t[2]&&42===t[3]?{ext:"tif",mime:"image/tiff"}:66===t[0]&&77===t[1]?{ext:"bmp",mime:"image/bmp"}:73===t[0]&&73===t[1]&&188===t[2]?{ext:"jxr",mime:"image/vnd.ms-photo"}:56===t[0]&&66===t[1]&&80===t[2]&&83===t[3]?{ext:"psd",mime:"image/vnd.adobe.photoshop"}:80===t[0]&&75===t[1]&&3===t[2]&&4===t[3]&&109===t[30]&&105===t[31]&&109===t[32]&&101===t[33]&&116===t[34]&&121===t[35]&&112===t[36]&&101===t[37]&&97===t[38]&&112===t[39]&&112===t[40]&&108===t[41]&&105===t[42]&&99===t[43]&&97===t[44]&&116===t[45]&&105===t[46]&&111===t[47]&&110===t[48]&&47===t[49]&&101===t[50]&&112===t[51]&&117===t[52]&&98===t[53]&&43===t[54]&&122===t[55]&&105===t[56]&&112===t[57]?{ext:"epub",mime:"application/epub+zip"}:80===t[0]&&75===t[1]&&3===t[2]&&4===t[3]&&77===t[30]&&69===t[31]&&84===t[32]&&65===t[33]&&45===t[34]&&73===t[35]&&78===t[36]&&70===t[37]&&47===t[38]&&109===t[39]&&111===t[40]&&122===t[41]&&105===t[42]&&108===t[43]&&108===t[44]&&97===t[45]&&46===t[46]&&114===t[47]&&115===t[48]&&97===t[49]?{ext:"xpi",mime:"application/x-xpinstall"}:80!==t[0]||75!==t[1]||3!==t[2]&&5!==t[2]&&7!==t[2]||4!==t[3]&&6!==t[3]&&8!==t[3]?117===t[257]&&115===t[258]&&116===t[259]&&97===t[260]&&114===t[261]?{ext:"tar",mime:"application/x-tar"}:82!==t[0]||97!==t[1]||114!==t[2]||33!==t[3]||26!==t[4]||7!==t[5]||0!==t[6]&&1!==t[6]?31===t[0]&&139===t[1]&&8===t[2]?{ext:"gz",mime:"application/gzip"}:66===t[0]&&90===t[1]&&104===t[2]?{ext:"bz2",mime:"application/x-bzip2"}:55===t[0]&&122===t[1]&&188===t[2]&&175===t[3]&&39===t[4]&&28===t[5]?{ext:"7z",mime:"application/x-7z-compressed"}:120===t[0]&&1===t[1]?{ext:"dmg",mime:"application/x-apple-diskimage"}:0===t[0]&&0===t[1]&&0===t[2]&&(24===t[3]||32===t[3])&&102===t[4]&&116===t[5]&&121===t[6]&&112===t[7]||51===t[0]&&103===t[1]&&112===t[2]&&53===t[3]||0===t[0]&&0===t[1]&&0===t[2]&&28===t[3]&&102===t[4]&&116===t[5]&&121===t[6]&&112===t[7]&&109===t[8]&&112===t[9]&&52===t[10]&&50===t[11]&&109===t[16]&&112===t[17]&&52===t[18]&&49===t[19]&&109===t[20]&&112===t[21]&&52===t[22]&&50===t[23]&&105===t[24]&&115===t[25]&&111===t[26]&&109===t[27]||0===t[0]&&0===t[1]&&0===t[2]&&28===t[3]&&102===t[4]&&116===t[5]&&121===t[6]&&112===t[7]&&105===t[8]&&115===t[9]&&111===t[10]&&109===t[11]||0===t[0]&&0===t[1]&&0===t[2]&&28===t[3]&&102===t[4]&&116===t[5]&&121===t[6]&&112===t[7]&&109===t[8]&&112===t[9]&&52===t[10]&&50===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&0===t[15]?{ext:"mp4",mime:"video/mp4"}:0===t[0]&&0===t[1]&&0===t[2]&&28===t[3]&&102===t[4]&&116===t[5]&&121===t[6]&&112===t[7]&&77===t[8]&&52===t[9]&&86===t[10]?{ext:"m4v",mime:"video/x-m4v"}:77===t[0]&&84===t[1]&&104===t[2]&&100===t[3]?{ext:"mid",mime:"audio/midi"}:109===t[31]&&97===t[32]&&116===t[33]&&114===t[34]&&111===t[35]&&115===t[36]&&107===t[37]&&97===t[38]?{ext:"mkv",mime:"video/x-matroska"}:26===t[0]&&69===t[1]&&223===t[2]&&163===t[3]?{ext:"webm",mime:"video/webm"}:0===t[0]&&0===t[1]&&0===t[2]&&20===t[3]&&102===t[4]&&116===t[5]&&121===t[6]&&112===t[7]?{ext:"mov",mime:"video/quicktime"}:82===t[0]&&73===t[1]&&70===t[2]&&70===t[3]&&65===t[8]&&86===t[9]&&73===t[10]?{ext:"avi",mime:"video/x-msvideo"}:48===t[0]&&38===t[1]&&178===t[2]&&117===t[3]&&142===t[4]&&102===t[5]&&207===t[6]&&17===t[7]&&166===t[8]&&217===t[9]?{ext:"wmv",mime:"video/x-ms-wmv"}:0===t[0]&&0===t[1]&&1===t[2]&&"b"===t[3].toString(16)[0]?{ext:"mpg",mime:"video/mpeg"}:73===t[0]&&68===t[1]&&51===t[2]||255===t[0]&&251===t[1]?{ext:"mp3",mime:"audio/mpeg"}:102===t[4]&&116===t[5]&&121===t[6]&&112===t[7]&&77===t[8]&&52===t[9]&&65===t[10]||77===t[0]&&52===t[1]&&65===t[2]&&32===t[3]?{ext:"m4a",mime:"audio/m4a"}:79===t[28]&&112===t[29]&&117===t[30]&&115===t[31]&&72===t[32]&&101===t[33]&&97===t[34]&&100===t[35]?{ext:"opus",mime:"audio/opus"}:79===t[0]&&103===t[1]&&103===t[2]&&83===t[3]?{ext:"ogg",mime:"audio/ogg"}:102===t[0]&&76===t[1]&&97===t[2]&&67===t[3]?{ext:"flac",mime:"audio/x-flac"}:82===t[0]&&73===t[1]&&70===t[2]&&70===t[3]&&87===t[8]&&65===t[9]&&86===t[10]&&69===t[11]?{ext:"wav",mime:"audio/x-wav"}:35===t[0]&&33===t[1]&&65===t[2]&&77===t[3]&&82===t[4]&&10===t[5]?{ext:"amr",mime:"audio/amr"}:37===t[0]&&80===t[1]&&68===t[2]&&70===t[3]?{ext:"pdf",mime:"application/pdf"}:77===t[0]&&90===t[1]?{ext:"exe",mime:"application/x-msdownload"}:67!==t[0]&&70!==t[0]||87!==t[1]||83!==t[2]?123===t[0]&&92===t[1]&&114===t[2]&&116===t[3]&&102===t[4]?{ext:"rtf",mime:"application/rtf"}:119===t[0]&&79===t[1]&&70===t[2]&&70===t[3]&&(0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]||79===t[4]&&84===t[5]&&84===t[6]&&79===t[7])?{ext:"woff",mime:"application/font-woff"}:119===t[0]&&79===t[1]&&70===t[2]&&50===t[3]&&(0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]||79===t[4]&&84===t[5]&&84===t[6]&&79===t[7])?{ext:"woff2",mime:"application/font-woff"}:76===t[34]&&80===t[35]&&(0===t[8]&&0===t[9]&&1===t[10]||1===t[8]&&0===t[9]&&2===t[10]||2===t[8]&&0===t[9]&&2===t[10])?{ext:"eot",mime:"application/octet-stream"}:0===t[0]&&1===t[1]&&0===t[2]&&0===t[3]&&0===t[4]?{ext:"ttf",mime:"application/font-sfnt"}:79===t[0]&&84===t[1]&&84===t[2]&&79===t[3]&&0===t[4]?{ext:"otf",mime:"application/font-sfnt"}:0===t[0]&&0===t[1]&&1===t[2]&&0===t[3]?{ext:"ico",mime:"image/x-icon"}:70===t[0]&&76===t[1]&&86===t[2]&&1===t[3]?{ext:"flv",mime:"video/x-flv"}:37===t[0]&&33===t[1]?{ext:"ps",mime:"application/postscript"}:253===t[0]&&55===t[1]&&122===t[2]&&88===t[3]&&90===t[4]&&0===t[5]?{ext:"xz",mime:"application/x-xz"}:83===t[0]&&81===t[1]&&76===t[2]&&105===t[3]?{ext:"sqlite",mime:"application/x-sqlite3"}:78===t[0]&&69===t[1]&&83===t[2]&&26===t[3]?{ext:"nes",mime:"application/x-nintendo-nes-rom"}:67===t[0]&&114===t[1]&&50===t[2]&&52===t[3]?{ext:"crx",mime:"application/x-google-chrome-extension"}:77===t[0]&&83===t[1]&&67===t[2]&&70===t[3]||73===t[0]&&83===t[1]&&99===t[2]&&40===t[3]?{ext:"cab",mime:"application/vnd.ms-cab-compressed"}:33===t[0]&&60===t[1]&&97===t[2]&&114===t[3]&&99===t[4]&&104===t[5]&&62===t[6]&&10===t[7]&&100===t[8]&&101===t[9]&&98===t[10]&&105===t[11]&&97===t[12]&&110===t[13]&&45===t[14]&&98===t[15]&&105===t[16]&&110===t[17]&&97===t[18]&&114===t[19]&&121===t[20]?{ext:"deb",mime:"application/x-deb"}:33===t[0]&&60===t[1]&&97===t[2]&&114===t[3]&&99===t[4]&&104===t[5]&&62===t[6]?{ext:"ar",mime:"application/x-unix-archive"}:237===t[0]&&171===t[1]&&238===t[2]&&219===t[3]?{ext:"rpm",mime:"application/x-rpm"}:31===t[0]&&160===t[1]||31===t[0]&&157===t[1]?{ext:"Z",mime:"application/x-compress"}:76===t[0]&&90===t[1]&&73===t[2]&&80===t[3]?{ext:"lz",mime:"application/x-lzip"}:208===t[0]&&207===t[1]&&17===t[2]&&224===t[3]&&161===t[4]&&177===t[5]&&26===t[6]&&225===t[7]?{ext:"msi",mime:"application/x-msi"}:null:{ext:"swf",mime:"application/x-shockwave-flash"}:{ext:"rar",mime:"application/x-rar-compressed"}:{ext:"zip",mime:"application/zip"}:null}},function(t,n){t.exports={"application/":{applixware:"aw","atom+xml":"atom","atomcat+xml":"atomcat","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-":{capability:"cdmia",container:"cdmic",domain:"cdmid",object:"cdmio",queue:"cdmiq"},"davmount+xml":"davmount","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc",ecmascript:"ecma","emma+xml":"emma","epub+zip":"epub",exi:"exi","font-":{tdpfr:"pfr",woff:"woff"},"gml+xml":"gml","gpx+xml":"gpx",gxf:"gxf",hyperstudio:"stk","inkml+xml":["ink","inkml"],ipfix:"ipfix","java-":{archive:"jar",vm:"class","serialized-object":"ser"},javascript:"js",json:"json","jsonml+json":"jsonml","lost+xml":"lostxml","mac-":{binhex40:"hqx",compactpro:"cpt"},"mads+xml":"mads",marc:"mrc","marcxml+xml":"mrcx",mathematica:["ma","nb","mb"],"mathml+xml":"mathml",mbox:"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods",mp21:["m21","mp21"],mp4:"mp4s",msword:["doc","dot"],mxf:"mxf",oda:"oda",ogg:"ogx","omdoc+xml":"omdoc",onenote:["onetoc","onetoc2","onetmp","onepkg"],oxps:"oxps",pdf:"pdf","pgp-":{encrypted:"pgp",signature:["asc","sig"]},pkcs10:"p10","pkcs7-":{mime:["p7m","p7c"],signature:"p7s"},pkcs8:"p8","pkix-":{cert:"cer",crl:"crl",pkipath:"pkipath","attr-cert":"ac"},pkixcmp:"pki","pls+xml":"pls",postscript:["ai","eps","ps"],"pskc+xml":"pskcxml","rdf+xml":"rdf","reginfo+xml":"rif","resource-":{"lists+xml":"rl","lists-diff+xml":"rld"},"rpki-":{ghostbusters:"gbr",manifest:"mft",roa:"roa"},"rsd+xml":"rsd","rss+xml":"rss",rtf:"rtf","sbml+xml":"sbml","scvp-":{"cv-":{request:"scq",response:"scs"},"vp-":{request:"spq",response:"spp"}},sdp:"sdp","set-":{"payment-initiation":"setpay","registration-initiation":"setreg"},"shf+xml":"shf","smil+xml":["smi","smil"],"sparql-":{query:"rq","results+xml":"srx"},srgs:"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","vnd.":{acucobol:"acu",acucorp:["atc","acutc"],"adobe.":{fxp:["fxp","fxpl"],"xdp+xml":"xdp",xfdf:"xfdf","formscentral.fcdt":"fcdt","air-application-installer-package+zip":"air"},"apple.":{"installer+xml":"mpkg",mpegurl:"m3u8"},audiograph:"aep",bmi:"bmi",businessobjects:"rep","chemdraw+xml":"cdxml",cinderella:"cdy",claymore:"cla",commonspace:"csp",cosmocaller:"cmc","crick.":{clicker:"clkx","clicker.":{keyboard:"clkk",palette:"clkp",template:"clkt",wordbank:"clkw"}},"curl.":{car:"car",pcurl:"pcurl"},dart:"dart","dece.":{data:["uvf","uvvf","uvd","uvvd"],"ttml+xml":["uvt","uvvt"],unspecified:["uvx","uvvx"],zip:["uvz","uvvz"]},dna:"dna",dpgraph:"dpg",dreamfactory:"dfac","dvb.":{ait:"ait",service:"svc"},dynageo:"geo",enliven:"nml","epson.":{esf:"esf",msf:"msf",quickanime:"qam",salt:"slt",ssf:"ssf"},"eszigno3+xml":["es3","et3"],"ezpix-":{album:"ez2","package":"ez3"},fdf:"fdf","fdsn.":{mseed:"mseed",seed:["seed","dataless"]},flographit:"gph",framemaker:["fm","frame","maker","book"],"frogans.":{fnc:"fnc",ltf:"ltf"},"fujitsu.":{oasys:"oas",oasys2:"oa2",oasys3:"oa3",oasysgp:"fg5",oasysprs:"bh2"},"fujixerox.":{ddd:"ddd",docuworks:"xdw","docuworks.binder":"xbd"},fuzzysheet:"fzs","geogebra.":{file:"ggb",tool:"ggt"},geonext:"gxt",geoplan:"g2w",geospace:"g3w",gmx:"gmx",grafeq:["gqf","gqs"],"groove-":{account:"gac",help:"ghf",injector:"grv","tool-":{message:"gtm",template:"tpl"},vcard:"vcg","identity-message":"gim"},"hal+xml":"hal",hbci:"hbci","hp-":{hpgl:"hpgl",hpid:"hpid",hps:"hps",jlyt:"jlt",pcl:"pcl",pclxl:"pclxl"},"ibm.":{minipay:"mpy",modcap:["afp","listafp","list3820"],"rights-management":"irm","secure-container":"sc"},iccprofile:["icc","icm"],igloader:"igl","immervision-":{ivp:"ivp",ivu:"ivu"},intergeo:"i2g","intu.":{qbo:"qbo",qfx:"qfx"},jam:"jam",jisp:"jisp",kahootz:["ktz","ktr"],"kde.":{karbon:"karbon",kchart:"chrt",kformula:"kfo",kivio:"flw",kontour:"kon",kpresenter:["kpr","kpt"],kspread:"ksp",kword:["kwd","kwt"]},kenameaapp:"htke",kidspiration:"kia",kinar:["kne","knp"],koan:["skp","skd","skt","skm"],"lotus-":{approach:"apr",freelance:"pre",notes:"nsf",organizer:"org",screencam:"scm",wordpro:"lwp","1-2-3":"123"},mcd:"mcd",medcalcdata:"mc1",mfer:"mwf",mfmp:"mfm","micrografx.":{flo:"flo",igx:"igx"},mif:"mif","mobius.":{daf:"daf",dis:"dis",mbk:"mbk",mqy:"mqy",msl:"msl",plc:"plc",txf:"txf"},"mophun.":{application:"mpn",certificate:"mpc"},"ms-":{artgalry:"cil",excel:["xls","xlm","xla","xlc","xlt","xlw"],"excel.":{"sheet.":{"macroenabled.12":"xlsm","binary.macroenabled.12":"xlsb"},"addin.macroenabled.12":"xlam","template.macroenabled.12":"xltm"},fontobject:"eot",htmlhelp:"chm",ims:"ims",lrm:"lrm",officetheme:"thmx","pki.":{seccat:"cat",stl:"stl"},powerpoint:["ppt","pps","pot"],"powerpoint.":{"addin.macroenabled.12":"ppam","presentation.macroenabled.12":"pptm","slide.macroenabled.12":"sldm","slideshow.macroenabled.12":"ppsm","template.macroenabled.12":"potm"},project:["mpp","mpt"],"word.":{"document.macroenabled.12":"docm","template.macroenabled.12":"dotm"},works:["wps","wks","wcm","wdb"],wpl:"wpl",xpsdocument:"xps","cab-compressed":"cab"},mseq:"mseq",musician:"mus",mynfc:"taglet",nitf:["ntf","nitf"],"noblenet-":{directory:"nnd",sealer:"nns",web:"nnw"},"nokia.":{"radio-":{preset:"rpst",presets:"rpss"},"n-gage.":{data:"ngdat","symbian.install":"n-gage"}},"novadigm.":{edm:"edm",edx:"edx",ext:"ext"},"osgi.":{dp:"dp",subsystem:"esa"},palm:["pdb","pqa","oprc"],pawaafile:"paw","pg.":{format:"str",osasli:"ei6"},picsel:"efif",pocketlearn:"plf",powerbuilder6:"pbd","recordare.":{musicxml:"mxl","musicxml+xml":"musicxml"},"rn-":{realmedia:"rm","realmedia-vbr":"rmvb"},seemail:"see",sema:"sema",semd:"semd",semf:"semf",smaf:"mmf","spotfire.":{dxp:"dxp",sfs:"sfs"},"stardivision.":{calc:"sdc",draw:"sda",impress:"sdd",math:"smf",writer:["sdw","vor"],"writer-global":"sgl"},"stepmania.":{"package":"smzip",stepchart:"sm"},svd:"svd","syncml+xml":"xsm","syncml.":{"dm+wbxml":"bdm","dm+xml":"xdm"},trueapp:"tra",ufdl:["ufd","ufdl"],umajin:"umj",unity:"unityweb","uoml+xml":"uoml",vcx:"vcx",visio:["vsd","vst","vss","vsw"],visionary:"vis",vsf:"vsf","wap.":{wbxml:"wbxml",wmlc:"wmlc",wmlscriptc:"wmlsc"},webturbo:"wtb",wordperfect:"wpd",wqd:"wqd",xara:"xar",xfdl:"xfdl","yamaha.":{"hv-":{dic:"hvd",script:"hvs",voice:"hvp"},openscoreformat:"osf","smaf-":{audio:"saf",phrase:"spf"},"openscoreformat.osfpvg+xml":"osfpvg"},zul:["zir","zirz"],"3gpp2.tcap":"tcap","accpac.simply.":{aso:"aso",imp:"imp"},"ahead.space":"ahead","airzip.filesecure.":{azf:"azf",azs:"azs"},"amazon.ebook":"azw","americandynamics.acc":"acc","amiga.ami":"ami","anser-web-":{"certificate-issue-initiation":"cii","funds-transfer-initiation":"fti"},"aristanetworks.swi":"swi","blueice.multipass":"mpm","cloanto.rp9":"rp9","clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"cluetrust.cartomobile-":{config:"c11amc","config-pkg":"c11amz"},"contact.cmsg":"cdbcmsg","criticaltools.wbs+xml":"wbs","ctc-posml":"pml","cups-ppd":"ppd","dolby.mlp":"mlp","ds-keypoint":"kpxx","ecowin.chart":"mag","fluxtime.clip":"ftc","fsc.weblaunch":"fsc","genomatix.tuxedo":"txd","geometry-explorer":["gex","gre"],"google-earth.":{"kml+xml":"kml",kmz:"kmz"},"handheld-entertainment+xml":"zmm","insors.igm":"igm","intercon.formnet":["xpw","xpx"],"ipunplugged.rcprofile":"rcprofile","irepository.package+xml":"irp","is-xpr":"xpr","isac.fcs":"fcs","kodak-descriptor":"sse","las.las+xml":"lasxml","macports.portpkg":"portpkg","mediastation.cdkey":"cdkey","mozilla.xul+xml":"xul","muvee.style":"msty","neurolanguage.nlu":"nlu","oasis.opendocument.":{chart:"odc",database:"odb",formula:"odf",graphics:"odg",image:"odi",presentation:"odp",spreadsheet:"ods",text:"odt","text-":{master:"odm",template:"ott",web:"oth"},"chart-template":"otc","formula-template":"odft","graphics-template":"otg","image-template":"oti","presentation-template":"otp","spreadsheet-template":"ots"},"olpc-sugar":"xo","oma.dd2+xml":"dd2","openofficeorg.extension":"oxt","openxmlformats-officedocument.":{"presentationml.":{presentation:"pptx",slide:"sldx",slideshow:"ppsx",template:"potx"},"spreadsheetml.":{sheet:"xlsx",template:"xltx"},"wordprocessingml.":{document:"docx",template:"dotx"}},"pmi.widget":"wg","previewsystems.box":"box","proteus.magazine":"mgz","pvi.ptid1":"ptid","quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"realvnc.bed":"bed","rig.cryptonote":"cryptonote","rim.cod":"cod","route66.link66+xml":"link66","sailingtracker.track":"st","shana.informed.":{formdata:"ifm",formtemplate:"itp",interchange:"iif","package":"ipk"},"simtech-mindmapper":["twd","twds"],"smart.teacher":"teacher","solent.sdkm+xml":["sdkm","sdkd"],"sun.xml.":{calc:"sxc",draw:"sxd",impress:"sxi",math:"sxm",writer:"sxw","writer.":{global:"sxg",template:"stw"},"calc.template":"stc","draw.template":"std","impress.template":"sti"},"sus-calendar":["sus","susp"],"symbian.install":["sis","sisx"],"tcpdump.pcap":["pcap","cap","dmp"],"tmobile-livetv":"tmo","trid.tpt":"tpt","triscape.mxs":"mxs","uiq.theme":"utz","wolfram.player":"nbp","wt.stf":"stf","zzazz.deck+xml":"zaz","3gpp.pic-bw-":{large:"plb",small:"psb","var":"pvb"},"3m.post-it-notes":"pwn","android.package-archive":"apk","antix.game-component":"atx","astraea-software.iota":"iota","chipnuts.karaoke-mmd":"mmd","data-vision.rdz":"rdz","denovo.fcselayout-link":"fe_launch","hhe.lesson-player":"les","hydrostatix.sof-data":"sfd-hdstx","jcp.javame.midlet-rms":"rms","joost.joda-archive":"joda","llamagraphics.life-balance.":{desktop:"lbd","exchange+xml":"lbe"},"osgeo.mapguide.package":"mgp","publishare-delta-tree":"qps","tao.intent-module-archive":"tao","yellowriver-custom-menu":"cmp"},"voicexml+xml":"vxml",widget:"wgt",winhlp:"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-":{abiword:"abw","authorware-":{bin:["aab","x32","u32","vox"],map:"aam",seg:"aas"},bcpio:"bcpio",bittorrent:"torrent",blorb:["blb","blorb"],bzip:"bz",bzip2:["bz2","boz"],cbr:["cbr","cba","cbt","cbz","cb7"],cdlink:"vcd",chat:"chat",conference:"nsc",cpio:"cpio",csh:"csh",director:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],doom:"wad","dtbncx+xml":"ncx","dtbook+xml":"dtb","dtbresource+xml":"res",dvi:"dvi",envoy:"evy",eva:"eva","font-":{bdf:"bdf",ghostscript:"gsf",otf:"otf",pcf:"pcf",snf:"snf",ttf:["ttf","ttc"],type1:["pfa","pfb","pfm","afm"],"linux-psf":"psf"},freearc:"arc",futuresplash:"spl",glulx:"ulx",gnumeric:"gnumeric",gtar:"gtar",hdf:"hdf",latex:"latex",mie:"mie","ms-":{application:"application",shortcut:"lnk",wmd:"wmd",wmz:"wmz",xbap:"xbap"},msaccess:"mdb",msbinder:"obd",mscardfile:"crd",msclip:"clp",msdownload:["exe","dll","com","bat","msi"],msmediaview:["mvb","m13","m14"],msmetafile:["wmf","wmz","emf","emz"],msmoney:"mny",mspublisher:"pub",msschedule:"scd",msterminal:"trm",mswrite:"wri",netcdf:["nc","cdf"],nzb:"nzb",pkcs12:["p12","pfx"],"pkcs7-":{certificates:["p7b","spc"],certreqresp:"p7r"},sh:"sh",shar:"shar",sql:"sql",stuffit:"sit",stuffitx:"sitx",subrip:"srt",sv4cpio:"sv4cpio",sv4crc:"sv4crc",tads:"gam",tar:"tar",tcl:"tcl",tex:"tex",texinfo:["texinfo","texi"],tgif:"obj",ustar:"ustar",xfig:"fig","xliff+xml":"xlf",xpinstall:"xpi",xz:"xz",zmachine:["z1","z2","z3","z4","z5","z6","z7","z8"],"7z-compressed":"7z","ace-compressed":"ace","apple-diskimage":"dmg","cfs-compressed":"cfs","chess-pgn":"pgn","debian-package":["deb","udeb"],"dgc-compressed":"dgc","gca-compressed":"gca","gramps-xml":"gramps","install-instructions":"install","iso9660-image":"iso","lzh-compressed":["lzh","lha"],"mobipocket-ebook":["prc","mobi"],"rar-compressed":"rar","shockwave-flash":"swf","silverlight-app":"xap","t3vm-image":"t3","tex-tfm":"tfm","wais-source":"src","java-jnlp-file":"jnlp","research-info-systems":"ris","x509-ca-cert":["der","crt"]},"xaml+xml":"xaml","xenc+xml":"xenc","xhtml+xml":["xhtml","xht"],xml:["xml","xsl"],"xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xspf+xml":"xspf","xv+xml":["mxml","xhvml","xvml","xvm"],yang:"yang","yin+xml":"yin",zip:"zip","andrew-inset":"ez","cu-seeme":"cu","octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy"],"oebps-package+xml":"opf","pics-rules":"prf","prs.cww":"cww","rls-services+xml":"rs","timestamped-data":"tsd","xcap-diff+xml":"xdf","xml-dtd":"dtd","patch-ops-error+xml":"xer","relax-ng-compact-syntax":"rnc"},"audio/":{adpcm:"adp",basic:["au","snd"],midi:["mid","midi","kar","rmi"],mp4:["m4a","mp4a"],mpeg:["mpga","mp2","mp2a","mp3","m2a","m3a"],ogg:["oga","ogg","spx"],s3m:"s3m",silk:"sil","vnd.":{dra:"dra",dts:"dts","nuera.":{ecelp4800:"ecelp4800",ecelp7470:"ecelp7470",ecelp9600:"ecelp9600"},rip:"rip","dece.audio":["uva","uvva"],"digital-winds":"eol","dts.hd":"dtshd","lucent.voice":"lvp","ms-playready.media.pya":"pya"},webm:"weba","x-":{aac:"aac",aiff:["aif","aiff","aifc"],caf:"caf",flac:"flac",matroska:"mka",mpegurl:"m3u","ms-":{wax:"wax",wma:"wma"},"pn-":{realaudio:["ram","ra"],"realaudio-plugin":"rmp"},wav:"wav"},xm:"xm"},"image/":{bmp:"bmp",cgm:"cgm",g3fax:"g3",gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],ktx:"ktx",png:"png",sgi:"sgi","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"vnd.":{djvu:["djvu","djv"],dwg:"dwg",dxf:"dxf",fastbidsheet:"fbs",fpx:"fpx",fst:"fst","ms-":{modi:"mdi",photo:"wdp"},xiff:"xif","adobe.photoshop":"psd","dece.graphic":["uvi","uvvi","uvg","uvvg"],"dvb.subtitle":"sub","fujixerox.edmics-":{mmr:"mmr",rlc:"rlc"},"net-fpx":"npx","wap.wbmp":"wbmp"},webp:"webp","x-":{"3ds":"3ds",cmx:"cmx",freehand:["fh","fhc","fh4","fh5","fh7"],icon:"ico",pcx:"pcx",pict:["pic","pct"],"portable-":{anymap:"pnm",bitmap:"pbm",graymap:"pgm",pixmap:"ppm"},rgb:"rgb",tga:"tga",xbitmap:"xbm",xpixmap:"xpm",xwindowdump:"xwd","cmu-raster":"ras","mrsid-image":"sid"},"prs.btif":"btif"},"model/":{iges:["igs","iges"],mesh:["msh","mesh","silo"],"vnd.":{"collada+xml":"dae",dwf:"dwf",gdl:"gdl",gtw:"gtw",mts:"mts",vtu:"vtu"},vrml:["wrl","vrml"],"x3d+binary":["x3db","x3dbz"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":["x3d","x3dz"]},"text/":{calendar:["ics","ifb"],css:"css",csv:"csv",html:["html","htm"],n3:"n3",plain:["txt","text","conf","def","list","log","in"],richtext:"rtx",sgml:["sgml","sgm"],troff:["t","tr","roff","man","me","ms"],turtle:"ttl",vcard:"vcard","vnd.":{curl:"curl","curl.":{dcurl:"dcurl",mcurl:"mcurl",scurl:"scurl"},fly:"fly",graphviz:"gv","in3d.":{"3dml":"3dml",spot:"spot"},"wap.":{wml:"wml",wmlscript:"wmls"},"dvb.subtitle":"sub","fmi.flexstor":"flx","sun.j2me.app-descriptor":"jad"},"x-":{asm:["s","asm"],c:["c","cc","cxx","cpp","h","hh","dic"],fortran:["f","for","f77","f90"],nfo:"nfo",opml:"opml",pascal:["p","pas"],setext:"etx",sfv:"sfv",uuencode:"uu",vcalendar:"vcs",vcard:"vcf","java-source":"java"},"cache-manifest":"appcache","uri-list":["uri","uris","urls"],"prs.lines.tag":"dsc","tab-separated-values":"tsv"},"video/":{"3gpp":"3gp","3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],mp4:["mp4","mp4v","mpg4"],mpeg:["mpeg","mpg","mpe","m1v","m2v"],ogg:"ogv",quicktime:["qt","mov"],"vnd.":{"dece.":{hd:["uvh","uvvh"],mobile:["uvm","uvvm"],pd:["uvp","uvvp"],sd:["uvs","uvvs"],video:["uvv","uvvv"]},fvt:"fvt",mpegurl:["mxu","m4u"],vivo:"viv","dvb.file":"dvb","uvvu.mp4":["uvu","uvvu"],"ms-playready.media.pyv":"pyv"},webm:"webm","x-":{f4v:"f4v",fli:"fli",flv:"flv",m4v:"m4v",matroska:["mkv","mk3d","mks"],mng:"mng","ms-":{asf:["asf","asx"],vob:"vob",wm:"wm",wmv:"wmv",wmx:"wmx",wvx:"wvx"},msvideo:"avi",smv:"smv","sgi-movie":"movie"}},"chemical/x-":{cdx:"cdx",cif:"cif",cmdf:"cmdf",cml:"cml",csml:"csml",xyz:"xyz"},"message/rfc822":["eml","mime"],"x-conference/x-cooltalk":"ice"}},function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}]);',n.p+"661c28367f9e7c1c509a.worker.js");
}},function(e,t,n){e.exports=function(){return new Worker(n.p+"fd80ce843d0b3f094582.worker.js")}},function(e,t,n){e.exports=function(){return new Worker(n.p+"pdf.worker.js")}}]));